{"file_contents":{"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"replit.md":{"content":"# اللجنة الرياضية - شركة أبراج لخدمات الطاقة\n\n## نظرة عامة\nمنصة ويب شاملة للجنة الرياضية بشركة أبراج لخدمات الطاقة. التطبيق مصمم لعرض وإدارة الأنشطة الرياضية والترفيهية للموظفين وأسرهم مع دعم كامل للمصادقة والتسجيل في الفعاليات والمنتدى التفاعلي.\n\n## التقنيات المستخدمة\n\n### Frontend\n- **React** مع **TypeScript**\n- **Wouter** للتوجيه (Routing)\n- **TanStack Query** لإدارة حالة البيانات\n- **Tailwind CSS** للتصميم\n- **Shadcn UI** للمكونات الجاهزة\n- **Framer Motion** للحركات والانتقالات\n\n### Backend\n- **Express.js** مع **TypeScript**\n- **PostgreSQL** مع **Drizzle ORM**\n- **Passport.js** للمصادقة مع Sessions\n- **bcrypt** لتشفير كلمات المرور\n\n### التصميم\n- تصميم عربي (RTL) بالكامل\n- دعم الوضع الليلي (Dark Mode)\n- تصميم متجاوب لجميع الأجهزة\n- خطوط عربية احترافية (IBM Plex Sans Arabic, Tajawal)\n- ألوان رياضية حيوية (أزرق، برتقالي، أخضر، ذهبي)\n\n## الصفحات الرئيسية\n\n### 1. الصفحة الرئيسية (`/`)\n- قسم Hero جذاب مع صورة خلفية رياضية\n- إحصائيات متحركة (عدد الفعاليات، المشاركين، الإنجازات)\n- عرض الخدمات الرئيسية\n- شريط أخبار متحرك\n- الرؤية والرسالة\n\n### 2. صفحة الفعاليات (`/events`)\n- عرض جميع الفعاليات من قاعدة البيانات\n- عداد تنازلي لكل فعالية\n- تفاصيل كاملة (التاريخ، المكان، المشاركون، الشروط)\n- شريط تقدم للمقاعد المتاحة\n- زر تسجيل مع تكامل المصادقة\n- عرض حالة التسجيل للمستخدم\n\n### 3. المنتدى التفاعلي (`/forum`) - جديد!\n- حائط اجتماعي للموظفين\n- نشر منشورات نصية\n- نظام التعليقات\n- نظام الإعجابات\n- تصفية حسب الفئة (كرة قدم، كرة سلة، جري، عائلي، عام)\n\n### 4. نظام البطولات والدوريات (`/leagues`) - جديد!\n- **صفحة البطولات** `/leagues` - عرض جميع البطولات مع التصفية حسب الحالة\n- **تفاصيل البطولة** `/leagues/:id` - الترتيب، المباريات، الهدافين، الفرق\n- **تفاصيل المباراة** `/matches/:id` - الأحداث، التشكيلات، التعليقات\n- أنواع البطولات: دوري كامل (Round Robin)، خروج مغلوب (Knockout)، مجموعات (Groups)، مجموعات + خروج مغلوب (Groups + Knockout)\n- تسجيل الفرق واللاعبين\n- توليد جدول المباريات تلقائياً\n- تتبع النتائج والترتيب والهدافين\n- تعليقات المباريات المباشرة\n- دعم البث المباشر والملخصات\n\n### 5. المعرض (`/gallery`)\n- معرض صور للفعاليات السابقة\n- تصفية حسب نوع النشاط\n- تأثيرات Hover جذابة\n- عرض التاريخ والوصف لكل صورة\n\n### 6. النتائج والإنجازات (`/results`)\n- نتائج البطولات السابقة\n- لوحة الصدارة للأقسام\n- اللاعبون المميزون\n- عرض المراكز الثلاثة الأولى بتصميم مميز\n\n### 7. من نحن (`/about`)\n- نبذة عن اللجنة\n- الرؤية والرسالة\n- القيم والأهداف\n- الإنجازات بالأرقام\n\n### 8. صفحات المصادقة\n- **تسجيل الدخول** (`/login`) - نموذج تسجيل دخول مع تحقق\n- **إنشاء حساب** (`/register`) - تسجيل موظف جديد مع معلومات العمل\n- **الملف الشخصي** (`/profile`) - عرض معلومات المستخدم وجدول الدوام\n- **فعالياتي** (`/my-events`) - الفعاليات المسجل فيها المستخدم\n\n### 9. لوحة التحكم الإدارية (`/admin`)\n- للمديرين وأعضاء اللجنة فقط\n- إحصائيات شاملة\n- إدارة الفعاليات (إضافة/عرض)\n- إدارة البطولات (إضافة/عرض/توليد جدول المباريات)\n- إدارة الأخبار (إضافة/عرض)\n- إدارة النتائج (إضافة/عرض)\n\n## نظام المصادقة\n\n### الميزات\n- تسجيل موظفين جدد مع رقم الموظف\n- تسجيل دخول آمن مع bcrypt\n- جلسات مستمرة مع connect-pg-simple\n- صلاحيات متعددة (موظف، مدير، عضو لجنة)\n- جدول الورديات (2 أسبوع عمل / 2 أسبوع إجازة)\n\n### حسابات الاختبار\n```\nاسم المستخدم: ahmed.ali | كلمة المرور: password123 (موظف)\nاسم المستخدم: admin | كلمة المرور: password123 (مدير)\n```\n\n## نظام الإشعارات\n\n### الميزات\n- إشعارات داخل التطبيق\n- عداد للإشعارات غير المقروءة\n- أيقونة الجرس في الـ Header\n- إشعارات للتعليقات والإعجابات\n- تعليم الكل كمقروء\n\n## نموذج البيانات (PostgreSQL)\n\n### User (المستخدم)\n```typescript\n{\n  id: string\n  username: string\n  password: string (hashed)\n  fullName: string\n  email: string\n  employeeId: string\n  department: string\n  position: string\n  phoneNumber: string\n  shiftPattern: string // 2weeks_on_2weeks_off, normal, flexible\n  currentShiftStatus: string // available, on_shift, off_shift\n  role: string // employee, admin, committee_member\n  isActive: boolean\n  accountType: string // standard, player, committee\n  committeeTitle: string // المسمى في اللجنة (للأعضاء فقط)\n  profileImageUrl: string // صورة شخصية\n  employeeCardImageUrl: string // صورة بطاقة العمل\n  nationalIdImageUrl: string // صورة الهوية\n  playerInfo: string // JSON: { number, position, level, dateOfBirth, healthStatus, primaryJersey }\n  workStartDate: Date // تاريخ بداية الدوام\n  workEndDate: Date // تاريخ نهاية الدوام\n}\n```\n\n### Event (الفعالية)\n```typescript\n{\n  id: string\n  title: string\n  description: string\n  category: string // football, basketball, marathon, family\n  date: Date\n  location: string\n  maxParticipants: number\n  currentParticipants: number\n  imageUrl: string\n  status: string\n  requirements: string\n}\n```\n\n### EventRegistration (التسجيل في الفعاليات)\n```typescript\n{\n  id: string\n  eventId: string\n  userId: string\n  registrationDate: Date\n  status: string // confirmed, waitlist, cancelled, attended\n  teamName: string\n}\n```\n\n### Notification (الإشعارات)\n```typescript\n{\n  id: string\n  userId: string\n  title: string\n  message: string\n  type: string // info, success, warning, event, registration\n  isRead: boolean\n  createdAt: Date\n}\n```\n\n### ForumPost (منشور المنتدى)\n```typescript\n{\n  id: string\n  userId: string\n  content: string\n  category: string\n  likesCount: number\n  commentsCount: number\n  createdAt: Date\n}\n```\n\n### ForumComment (تعليق)\n```typescript\n{\n  id: string\n  postId: string\n  userId: string\n  content: string\n  createdAt: Date\n}\n```\n\n## API Endpoints\n\n### المصادقة\n- `POST /api/auth/register` - تسجيل مستخدم جديد\n- `POST /api/auth/login` - تسجيل الدخول\n- `POST /api/auth/logout` - تسجيل الخروج\n- `GET /api/auth/me` - معلومات المستخدم الحالي\n\n### الفعاليات\n- `GET /api/events` - جلب جميع الفعاليات\n- `GET /api/events/:id` - جلب فعالية محددة\n- `POST /api/events` - إنشاء فعالية (admin)\n- `POST /api/events/:id/register` - التسجيل في فعالية\n- `GET /api/my-registrations` - فعاليات المستخدم\n- `DELETE /api/registrations/:id` - إلغاء التسجيل\n\n### الإشعارات\n- `GET /api/notifications` - جلب الإشعارات\n- `GET /api/notifications/unread-count` - عدد غير المقروءة\n- `POST /api/notifications/:id/read` - تعليم كمقروء\n- `POST /api/notifications/read-all` - قراءة الكل\n\n### المنتدى\n- `GET /api/forum/posts` - جلب المنشورات\n- `POST /api/forum/posts` - إنشاء منشور\n- `DELETE /api/forum/posts/:id` - حذف منشور\n- `GET /api/forum/posts/:id/comments` - تعليقات المنشور\n- `POST /api/forum/posts/:id/comments` - إضافة تعليق\n- `POST /api/forum/posts/:id/like` - إعجاب/إلغاء إعجاب\n\n### أخرى\n- `GET /api/news` - جلب الأخبار\n- `POST /api/news` - إضافة خبر (admin)\n- `GET /api/results` - جلب النتائج\n- `POST /api/results` - إضافة نتيجة (admin)\n- `GET /api/gallery` - جلب المعرض\n- `GET /api/stats` - الإحصائيات\n\n## الميزات الخاصة\n\n### Dark Mode\n- دعم كامل للوضع الليلي\n- تخزين التفضيل في LocalStorage\n- تبديل سلس بين الأوضاع\n\n### RTL Support\n- تصميم كامل يدعم الاتجاه من اليمين لليسار\n- خطوط عربية احترافية\n- تناسق كامل في جميع المكونات\n\n### Animations\n- عداد تنازلي حي لكل فعالية\n- أرقام متحركة في الإحصائيات\n- تأثيرات Hover ناعمة\n- شريط أخبار متحرك\n\n### Responsive Design\n- تصميم متجاوب لجميع الأحجام\n- قائمة Mobile منفصلة\n- Grid مرن للبطاقات\n\n## الإعدادات\n\n### Environment Variables\n- `DATABASE_URL` - رابط قاعدة البيانات PostgreSQL\n- `SESSION_SECRET` - مفتاح الجلسات\n\n### Scripts\n- `npm run dev` - تشغيل التطبيق في وضع التطوير\n- `npm run build` - بناء التطبيق للإنتاج\n- `npm run db:push` - تحديث قاعدة البيانات\n\n## آخر التحديثات\n\n**ديسمبر 2025 - تحديث نموذج التسجيل**\n- نموذج تسجيل تفاعلي محسّن مع 3 أنواع حسابات\n- دعم حساب اللاعب مع حقول خاصة (رقم القميص، المركز، المستوى)\n- دعم حساب عضو اللجنة مع المسمى الإداري\n- رفع الصور (الصورة الشخصية، بطاقة العمل، الهوية)\n- تقويم لتحديد تواريخ العمل والتوافر\n- تخزين بيانات اللاعب كـ JSON في قاعدة البيانات\n\n**ديسمبر 2024 - Phase 2**\n- نظام المصادقة الكامل مع Passport.js\n- التسجيل في الفعاليات\n- لوحة التحكم الإدارية\n- نظام الإشعارات داخل التطبيق\n- المنتدى التفاعلي مع التعليقات والإعجابات\n- ترحيل قاعدة البيانات إلى PostgreSQL\n\n**يناير 2025 - Phase 1**\n- إطلاق النسخة الأولى (MVP)\n- 5 صفحات رئيسية\n- تصميم عربي كامل مع Dark Mode\n- بيانات تجريبية شاملة\n- API endpoints جاهزة\n","path":null,"size_bytes":11395,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/header.tsx":{"content":"import { Link, useLocation } from \"wouter\";\nimport { Menu, X, User, LogOut, LogIn, Shield, MessageSquare, Calendar, Users } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { ThemeToggle } from \"@/components/theme-toggle\";\nimport { NotificationsDropdown } from \"@/components/notifications-dropdown\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useState } from \"react\";\nimport logoImage from \"@assets/ABRJ.OM_-_Copy_1765276224339.png\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\n\nexport function Header() {\n  const [location, navigate] = useLocation();\n  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);\n  const { user, isAuthenticated, logout } = useAuth();\n\n  const isAdmin = user?.role === \"admin\" || user?.role === \"committee_member\";\n\n  const navItems = [\n    { href: \"/\", label: \"الرئيسية\" },\n    { href: \"/events\", label: \"الفعاليات\" },\n    { href: \"/leagues\", label: \"البطولات\" },\n    { href: \"/bracket\", label: \"التصفيات\" },\n    { href: \"/forum\", label: \"المنتدى\" },\n    { href: \"/gallery\", label: \"المعرض\" },\n    { href: \"/results\", label: \"النتائج\" },\n    { href: \"/about\", label: \"من نحن\" },\n  ];\n\n  const adminNavItems = [\n    { href: \"/admin\", label: \"لوحة التحكم\", icon: Shield },\n    { href: \"/team-wizard\", label: \"معالج الفرق\", icon: Users },\n  ];\n\n  return (\n    <header className=\"sticky top-0 z-50 w-full border-b bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60\">\n      <div className=\"container mx-auto flex h-16 items-center justify-between px-4 md:px-6\">\n        {/* Logo and Title */}\n        <Link href=\"/\" data-testid=\"link-home\">\n          <div className=\"flex items-center gap-3 cursor-pointer hover-elevate rounded-md px-3 py-2 transition-colors\">\n            <img \n              src={logoImage} \n              alt=\"شعار أبراج\" \n              className=\"h-10 w-10 object-contain\"\n            />\n            <div className=\"flex flex-col\">\n              <h1 className=\"text-lg font-display font-bold leading-tight\">اللجنة الرياضية</h1>\n              <p className=\"text-xs text-muted-foreground\">شركة أبراج لخدمات الطاقة</p>\n            </div>\n          </div>\n        </Link>\n\n        {/* Desktop Navigation */}\n        <nav className=\"hidden md:flex items-center gap-2\">\n          {navItems.map((item) => (\n            <Link key={item.href} href={item.href} data-testid={`link-${item.label}`}>\n              <Button\n                variant={location === item.href ? \"secondary\" : \"ghost\"}\n                className=\"text-base font-medium\"\n              >\n                {item.label}\n              </Button>\n            </Link>\n          ))}\n          {isAuthenticated && isAdmin && (\n            <>\n              <div className=\"w-px h-6 bg-border mx-1\" />\n              {adminNavItems.map((item) => (\n                <Link key={item.href} href={item.href} data-testid={`link-admin-${item.label}`}>\n                  <Button\n                    variant={location === item.href ? \"secondary\" : \"ghost\"}\n                    className=\"text-base font-medium gap-2\"\n                  >\n                    <item.icon className=\"h-4 w-4\" />\n                    {item.label}\n                  </Button>\n                </Link>\n              ))}\n            </>\n          )}\n        </nav>\n\n        {/* Right side actions */}\n        <div className=\"flex items-center gap-2\">\n          <ThemeToggle />\n          <NotificationsDropdown />\n          \n          {/* Auth buttons */}\n          {isAuthenticated ? (\n            <div className=\"hidden md:block\">\n              <DropdownMenu>\n                <DropdownMenuTrigger asChild>\n                  <Button variant=\"ghost\" className=\"gap-2\" data-testid=\"button-user-menu\">\n                    <User className=\"h-4 w-4\" />\n                    <span>{user?.fullName}</span>\n                  </Button>\n                </DropdownMenuTrigger>\n                <DropdownMenuContent align=\"end\">\n                  <DropdownMenuLabel>حسابي</DropdownMenuLabel>\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem onClick={() => navigate(\"/profile\")} data-testid=\"menu-profile\">\n                    <User className=\"ml-2 h-4 w-4\" />\n                    الملف الشخصي\n                  </DropdownMenuItem>\n                  <DropdownMenuItem onClick={() => navigate(\"/my-events\")} data-testid=\"menu-my-events\">\n                    <Calendar className=\"ml-2 h-4 w-4\" />\n                    فعالياتي\n                  </DropdownMenuItem>\n                  {(user?.role === \"admin\" || user?.role === \"committee_member\") && (\n                    <>\n                      <DropdownMenuItem onClick={() => navigate(\"/admin\")} data-testid=\"menu-admin\">\n                        <Shield className=\"ml-2 h-4 w-4\" />\n                        لوحة التحكم\n                      </DropdownMenuItem>\n                      <DropdownMenuItem onClick={() => navigate(\"/team-wizard\")} data-testid=\"menu-team-wizard\">\n                        <Users className=\"ml-2 h-4 w-4\" />\n                        معالج الفرق\n                      </DropdownMenuItem>\n                    </>\n                  )}\n                  <DropdownMenuSeparator />\n                  <DropdownMenuItem onClick={logout} data-testid=\"button-logout\">\n                    <LogOut className=\"ml-2 h-4 w-4\" />\n                    تسجيل الخروج\n                  </DropdownMenuItem>\n                </DropdownMenuContent>\n              </DropdownMenu>\n            </div>\n          ) : (\n            <div className=\"hidden md:flex gap-2\">\n              <Button variant=\"ghost\" onClick={() => navigate(\"/login\")} data-testid=\"button-login-header\">\n                <LogIn className=\"ml-2 h-4 w-4\" />\n                تسجيل الدخول\n              </Button>\n              <Button onClick={() => navigate(\"/register\")} data-testid=\"button-register-header\">\n                إنشاء حساب\n              </Button>\n            </div>\n          )}\n          \n          {/* Mobile menu button */}\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            className=\"md:hidden\"\n            onClick={() => setMobileMenuOpen(!mobileMenuOpen)}\n            data-testid=\"button-mobile-menu\"\n          >\n            {mobileMenuOpen ? (\n              <X className=\"h-5 w-5\" />\n            ) : (\n              <Menu className=\"h-5 w-5\" />\n            )}\n          </Button>\n        </div>\n      </div>\n\n      {/* Mobile Navigation */}\n      {mobileMenuOpen && (\n        <div className=\"md:hidden border-t bg-card\">\n          <nav className=\"container mx-auto flex flex-col p-4 gap-2\">\n            {navItems.map((item) => (\n              <Link key={item.href} href={item.href}>\n                <Button\n                  variant={location === item.href ? \"secondary\" : \"ghost\"}\n                  className=\"w-full justify-start text-base font-medium\"\n                  onClick={() => setMobileMenuOpen(false)}\n                  data-testid={`mobile-link-${item.label}`}\n                >\n                  {item.label}\n                </Button>\n              </Link>\n            ))}\n            \n            {/* Mobile auth buttons */}\n            <div className=\"border-t pt-2 mt-2\">\n              {isAuthenticated ? (\n                <>\n                  <div className=\"px-3 py-2 text-sm text-muted-foreground\">\n                    {user?.fullName}\n                  </div>\n                  <Button\n                    variant=\"ghost\"\n                    className=\"w-full justify-start\"\n                    onClick={() => {\n                      navigate(\"/profile\");\n                      setMobileMenuOpen(false);\n                    }}\n                    data-testid=\"mobile-menu-profile\"\n                  >\n                    <User className=\"ml-2 h-4 w-4\" />\n                    الملف الشخصي\n                  </Button>\n                  <Button\n                    variant=\"ghost\"\n                    className=\"w-full justify-start\"\n                    onClick={() => {\n                      navigate(\"/my-events\");\n                      setMobileMenuOpen(false);\n                    }}\n                    data-testid=\"mobile-menu-my-events\"\n                  >\n                    <Calendar className=\"ml-2 h-4 w-4\" />\n                    فعالياتي\n                  </Button>\n                  {isAdmin && (\n                    <>\n                      <Button\n                        variant=\"ghost\"\n                        className=\"w-full justify-start\"\n                        onClick={() => {\n                          navigate(\"/admin\");\n                          setMobileMenuOpen(false);\n                        }}\n                        data-testid=\"mobile-menu-admin\"\n                      >\n                        <Shield className=\"ml-2 h-4 w-4\" />\n                        لوحة التحكم\n                      </Button>\n                      <Button\n                        variant=\"ghost\"\n                        className=\"w-full justify-start\"\n                        onClick={() => {\n                          navigate(\"/team-wizard\");\n                          setMobileMenuOpen(false);\n                        }}\n                        data-testid=\"mobile-menu-team-wizard\"\n                      >\n                        <Users className=\"ml-2 h-4 w-4\" />\n                        معالج الفرق\n                      </Button>\n                    </>\n                  )}\n                  <Button\n                    variant=\"ghost\"\n                    className=\"w-full justify-start\"\n                    onClick={() => {\n                      logout();\n                      setMobileMenuOpen(false);\n                    }}\n                    data-testid=\"mobile-button-logout\"\n                  >\n                    <LogOut className=\"ml-2 h-4 w-4\" />\n                    تسجيل الخروج\n                  </Button>\n                </>\n              ) : (\n                <>\n                  <Button\n                    variant=\"ghost\"\n                    className=\"w-full justify-start\"\n                    onClick={() => {\n                      navigate(\"/login\");\n                      setMobileMenuOpen(false);\n                    }}\n                    data-testid=\"mobile-button-login\"\n                  >\n                    <LogIn className=\"ml-2 h-4 w-4\" />\n                    تسجيل الدخول\n                  </Button>\n                  <Button\n                    className=\"w-full justify-start\"\n                    onClick={() => {\n                      navigate(\"/register\");\n                      setMobileMenuOpen(false);\n                    }}\n                    data-testid=\"mobile-button-register\"\n                  >\n                    إنشاء حساب\n                  </Button>\n                </>\n              )}\n            </div>\n          </nav>\n        </div>\n      )}\n    </header>\n  );\n}\n","path":null,"size_bytes":11270,"size_tokens":null},"client/src/pages/my-events.tsx":{"content":"import { Calendar, MapPin, Trophy, Trash2, Loader2, CheckCircle, Clock } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { Event, EventRegistration } from \"@shared/schema\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from \"@/components/ui/alert-dialog\";\n\nconst categoryLabels: Record<string, string> = {\n  football: \"كرة قدم\",\n  family: \"عائلي\",\n  marathon: \"جري\",\n  basketball: \"كرة سلة\",\n};\n\nconst statusLabels: Record<string, string> = {\n  confirmed: \"مؤكد\",\n  waitlist: \"قائمة الانتظار\",\n  cancelled: \"ملغي\",\n  attended: \"حضر\",\n};\n\nconst statusColors: Record<string, string> = {\n  confirmed: \"bg-success text-success-foreground\",\n  waitlist: \"bg-gold text-gold-foreground\",\n  cancelled: \"bg-destructive text-destructive-foreground\",\n  attended: \"bg-primary text-primary-foreground\",\n};\n\nexport default function MyEvents() {\n  const { isAuthenticated, isLoading: authLoading } = useAuth();\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const queryClient = useQueryClient();\n\n  const { data: registrations = [], isLoading } = useQuery<EventRegistration[]>({\n    queryKey: [\"/api/my-registrations\"],\n    enabled: isAuthenticated,\n  });\n\n  const { data: events = [] } = useQuery<Event[]>({\n    queryKey: [\"/api/events\"],\n  });\n\n  const cancelMutation = useMutation({\n    mutationFn: async (registrationId: string) => {\n      return await apiRequest(\"DELETE\", `/api/registrations/${registrationId}`, {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم إلغاء التسجيل\",\n        description: \"تم إلغاء تسجيلك في الفعالية بنجاح\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-registrations\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/events\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"فشل إلغاء التسجيل\",\n        description: error.message || \"حدث خطأ أثناء إلغاء التسجيل\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const getEventById = (eventId: string) => {\n    return events.find((e) => e.id === eventId);\n  };\n\n  if (authLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full text-center p-8\">\n          <Trophy className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n          <h2 className=\"text-2xl font-bold mb-4\">يجب تسجيل الدخول</h2>\n          <p className=\"text-muted-foreground mb-6\">\n            يرجى تسجيل الدخول لعرض فعالياتك المسجلة\n          </p>\n          <Button onClick={() => navigate(\"/login\")} data-testid=\"button-login\">\n            تسجيل الدخول\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen py-12\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        {/* Header */}\n        <div className=\"text-center space-y-4 mb-12\">\n          <Badge variant=\"outline\" className=\"text-base px-4 py-2\" data-testid=\"badge-my-events\">\n            فعالياتي\n          </Badge>\n          <h1 className=\"text-4xl md:text-5xl font-display font-bold\">\n            الفعاليات المسجل فيها\n          </h1>\n          <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n            تابع جميع الفعاليات التي سجلت فيها وإدارة مشاركاتك\n          </p>\n        </div>\n\n        {registrations.length === 0 ? (\n          <Card className=\"max-w-xl mx-auto text-center p-12\">\n            <Trophy className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-xl font-bold mb-2\">لم تسجل في أي فعالية بعد</h3>\n            <p className=\"text-muted-foreground mb-6\">\n              تصفح الفعاليات القادمة وسجل مشاركتك الآن\n            </p>\n            <Button onClick={() => navigate(\"/events\")} data-testid=\"button-browse-events\">\n              تصفح الفعاليات\n            </Button>\n          </Card>\n        ) : (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {registrations.map((registration) => {\n              const event = getEventById(registration.eventId);\n              if (!event) return null;\n\n              const eventDate = new Date(event.date);\n              const isPast = eventDate < new Date();\n\n              return (\n                <Card key={registration.id} className=\"hover-elevate transition-all\" data-testid={`card-registration-${registration.id}`}>\n                  <CardHeader className=\"pb-3\">\n                    <div className=\"flex justify-between items-start gap-2\">\n                      <CardTitle className=\"text-lg font-display leading-tight\">\n                        {event.title}\n                      </CardTitle>\n                      <Badge className={statusColors[registration.status]}>\n                        {statusLabels[registration.status] || registration.status}\n                      </Badge>\n                    </div>\n                    <Badge variant=\"outline\" className=\"w-fit\">\n                      {categoryLabels[event.category] || event.category}\n                    </Badge>\n                  </CardHeader>\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"space-y-2 text-sm\">\n                      <div className=\"flex items-center gap-2 text-muted-foreground\">\n                        <Calendar className=\"h-4 w-4\" />\n                        <span>\n                          {eventDate.toLocaleDateString('ar-SA', {\n                            weekday: 'long',\n                            year: 'numeric',\n                            month: 'long',\n                            day: 'numeric',\n                          })}\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-muted-foreground\">\n                        <MapPin className=\"h-4 w-4\" />\n                        <span>{event.location}</span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-muted-foreground\">\n                        <Clock className=\"h-4 w-4\" />\n                        <span>\n                          تاريخ التسجيل: {new Date(registration.registrationDate).toLocaleDateString('ar-SA')}\n                        </span>\n                      </div>\n                    </div>\n\n                    {registration.teamName && (\n                      <div className=\"bg-muted/50 rounded-md p-3\">\n                        <p className=\"text-sm\">\n                          <span className=\"font-medium\">الفريق:</span> {registration.teamName}\n                        </p>\n                      </div>\n                    )}\n\n                    <div className=\"flex gap-2 pt-2\">\n                      {isPast ? (\n                        <Badge variant=\"outline\" className=\"w-full justify-center py-2\">\n                          <CheckCircle className=\"h-4 w-4 ml-1\" />\n                          فعالية منتهية\n                        </Badge>\n                      ) : registration.status !== \"cancelled\" ? (\n                        <AlertDialog>\n                          <AlertDialogTrigger asChild>\n                            <Button\n                              variant=\"outline\"\n                              className=\"w-full\"\n                              data-testid={`button-cancel-${registration.id}`}\n                            >\n                              <Trash2 className=\"h-4 w-4 ml-1\" />\n                              إلغاء التسجيل\n                            </Button>\n                          </AlertDialogTrigger>\n                          <AlertDialogContent>\n                            <AlertDialogHeader>\n                              <AlertDialogTitle>إلغاء التسجيل</AlertDialogTitle>\n                              <AlertDialogDescription>\n                                هل أنت متأكد من إلغاء تسجيلك في فعالية \"{event.title}\"؟\n                                لا يمكن التراجع عن هذا الإجراء.\n                              </AlertDialogDescription>\n                            </AlertDialogHeader>\n                            <AlertDialogFooter className=\"gap-2\">\n                              <AlertDialogCancel>تراجع</AlertDialogCancel>\n                              <AlertDialogAction\n                                onClick={() => cancelMutation.mutate(registration.id)}\n                                className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                              >\n                                {cancelMutation.isPending ? (\n                                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                                ) : (\n                                  \"تأكيد الإلغاء\"\n                                )}\n                              </AlertDialogAction>\n                            </AlertDialogFooter>\n                          </AlertDialogContent>\n                        </AlertDialog>\n                      ) : (\n                        <Badge variant=\"secondary\" className=\"w-full justify-center py-2\">\n                          ملغي\n                        </Badge>\n                      )}\n                    </div>\n                  </CardContent>\n                </Card>\n              );\n            })}\n          </div>\n        )}\n\n        {/* Stats */}\n        {registrations.length > 0 && (\n          <div className=\"mt-12 grid grid-cols-2 md:grid-cols-4 gap-4\">\n            <Card className=\"p-6 text-center\">\n              <p className=\"text-3xl font-bold text-primary\">{registrations.length}</p>\n              <p className=\"text-sm text-muted-foreground\">إجمالي التسجيلات</p>\n            </Card>\n            <Card className=\"p-6 text-center\">\n              <p className=\"text-3xl font-bold text-success\">\n                {registrations.filter((r) => r.status === \"confirmed\").length}\n              </p>\n              <p className=\"text-sm text-muted-foreground\">تسجيلات مؤكدة</p>\n            </Card>\n            <Card className=\"p-6 text-center\">\n              <p className=\"text-3xl font-bold text-gold\">\n                {registrations.filter((r) => r.status === \"waitlist\").length}\n              </p>\n              <p className=\"text-sm text-muted-foreground\">قائمة انتظار</p>\n            </Card>\n            <Card className=\"p-6 text-center\">\n              <p className=\"text-3xl font-bold text-muted-foreground\">\n                {registrations.filter((r) => r.status === \"attended\").length}\n              </p>\n              <p className=\"text-sm text-muted-foreground\">تم الحضور</p>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":12007,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\nimport { storage } from \"./storage\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  // Initialize sample data on first run\n  await storage.initializeSampleData();\n  \n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (app.get(\"env\") === \"development\") {\n    await setupVite(app, server);\n  } else {\n    serveStatic(app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n})();\n","path":null,"size_bytes":2187,"size_tokens":null},"client/src/pages/results.tsx":{"content":"import { Trophy, Medal, Award, Crown, Star } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport awardsImage from \"@assets/generated_images/Championship_awards_display_421aecd4.png\";\n\nexport default function Results() {\n  const tournaments = [\n    {\n      id: 1,\n      name: \"بطولة كرة القدم السنوية 2024\",\n      category: \"كرة قدم\",\n      date: \"ديسمبر 2024\",\n      winner: \"فريق الهندسة\",\n      runnerUp: \"فريق المالية\",\n      thirdPlace: \"فريق التشغيل\",\n      stats: {\n        teams: 16,\n        matches: 28,\n        goals: 87,\n      },\n    },\n    {\n      id: 2,\n      name: \"دوري كرة السلة الداخلي 2024\",\n      category: \"كرة سلة\",\n      date: \"نوفمبر 2024\",\n      winner: \"فريق تقنية المعلومات\",\n      runnerUp: \"فريق الموارد البشرية\",\n      thirdPlace: \"فريق المشتريات\",\n      stats: {\n        teams: 8,\n        matches: 16,\n        goals: 892,\n      },\n    },\n    {\n      id: 3,\n      name: \"ماراثون أبراج الخيري 2024\",\n      category: \"جري\",\n      date: \"أكتوبر 2024\",\n      winner: \"أحمد المطيري\",\n      runnerUp: \"محمد العتيبي\",\n      thirdPlace: \"خالد السالم\",\n      stats: {\n        teams: 245,\n        matches: 1,\n        goals: 0,\n      },\n    },\n  ];\n\n  const featuredAthletes = [\n    {\n      id: 1,\n      name: \"عبدالله الشمري\",\n      position: \"مهندس كهرباء\",\n      department: \"قسم الهندسة\",\n      achievements: \"هداف بطولة كرة القدم 2024 (18 هدف)\",\n      sport: \"كرة قدم\",\n    },\n    {\n      id: 2,\n      name: \"سارة القحطاني\",\n      position: \"محلل أعمال\",\n      department: \"قسم تقنية المعلومات\",\n      achievements: \"أفضل لاعبة في دوري كرة السلة النسائي\",\n      sport: \"كرة سلة\",\n    },\n    {\n      id: 3,\n      name: \"محمد الدوسري\",\n      position: \"مدير مشروع\",\n      department: \"قسم التشغيل\",\n      achievements: \"بطل ماراثون أبراج 2024 - 2023\",\n      sport: \"جري\",\n    },\n    {\n      id: 4,\n      name: \"فاطمة العمري\",\n      position: \"مدير موارد بشرية\",\n      department: \"الموارد البشرية\",\n      achievements: \"أفضل رياضية للعام 2024\",\n      sport: \"متعدد\",\n    },\n  ];\n\n  const leaderboard = [\n    { rank: 1, department: \"قسم الهندسة\", points: 450, trophies: 5, color: \"text-gold\" },\n    { rank: 2, department: \"قسم تقنية المعلومات\", points: 380, trophies: 4, color: \"text-muted-foreground\" },\n    { rank: 3, department: \"قسم المالية\", points: 320, trophies: 3, color: \"text-victory\" },\n    { rank: 4, department: \"قسم الموارد البشرية\", points: 290, trophies: 2, color: \"text-foreground\" },\n    { rank: 5, department: \"قسم التشغيل\", points: 250, trophies: 2, color: \"text-foreground\" },\n  ];\n\n  return (\n    <div className=\"min-h-screen py-12\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        {/* Header */}\n        <div className=\"text-center space-y-4 mb-16\">\n          <Badge variant=\"outline\" className=\"text-base px-4 py-2\" data-testid=\"badge-results\">\n            النتائج والإنجازات\n          </Badge>\n          <h1 className=\"text-4xl md:text-6xl font-display font-bold\">\n            لوحة الشرف والبطولات\n          </h1>\n          <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto\">\n            نتائج البطولات وتكريم الأبطال والمتميزين رياضياً\n          </p>\n        </div>\n\n        {/* Hero Image */}\n        <div className=\"relative h-80 rounded-xl overflow-hidden mb-16\">\n          <img\n            src={awardsImage}\n            alt=\"الجوائز والبطولات\"\n            className=\"w-full h-full object-cover\"\n          />\n          <div className=\"absolute inset-0 bg-gradient-to-t from-background via-background/50 to-transparent\" />\n          <div className=\"absolute bottom-8 left-0 right-0 text-center\">\n            <h2 className=\"text-4xl md:text-5xl font-display font-bold text-foreground drop-shadow-lg\">\n              احتفاء بالتميز الرياضي\n            </h2>\n          </div>\n        </div>\n\n        {/* Tournaments Results */}\n        <section className=\"mb-20\">\n          <div className=\"flex items-center gap-3 mb-8\">\n            <Trophy className=\"h-8 w-8 text-primary\" />\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold\">نتائج البطولات</h2>\n          </div>\n          \n          <div className=\"space-y-6\">\n            {tournaments.map((tournament) => (\n              <Card key={tournament.id} className=\"overflow-hidden\" data-testid={`tournament-${tournament.id}`}>\n                <CardHeader className=\"bg-card border-b\">\n                  <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\n                    <div>\n                      <CardTitle className=\"text-2xl font-display mb-2\">{tournament.name}</CardTitle>\n                      <div className=\"flex flex-wrap gap-2\">\n                        <Badge variant=\"secondary\">{tournament.category}</Badge>\n                        <Badge variant=\"outline\">{tournament.date}</Badge>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-6 text-center\">\n                      <div>\n                        <div className=\"text-2xl font-bold text-primary\">{tournament.stats.teams}</div>\n                        <div className=\"text-xs text-muted-foreground\">فريق</div>\n                      </div>\n                      <div>\n                        <div className=\"text-2xl font-bold text-victory\">{tournament.stats.matches}</div>\n                        <div className=\"text-xs text-muted-foreground\">مباراة</div>\n                      </div>\n                    </div>\n                  </div>\n                </CardHeader>\n                <CardContent className=\"p-8\">\n                  <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n                    {/* First Place */}\n                    <div className=\"text-center space-y-4 p-6 rounded-xl bg-gradient-to-br from-gold/20 to-gold/5 border-2 border-gold/30\">\n                      <div className=\"w-20 h-20 mx-auto rounded-full bg-gold text-gold-foreground flex items-center justify-center\">\n                        <Crown className=\"h-10 w-10\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-muted-foreground mb-1\">البطل</p>\n                        <h3 className=\"text-xl font-display font-bold\">{tournament.winner}</h3>\n                      </div>\n                      <Badge className=\"bg-gold text-gold-foreground\">المركز الأول</Badge>\n                    </div>\n\n                    {/* Second Place */}\n                    <div className=\"text-center space-y-4 p-6 rounded-xl bg-muted/50 border-2 border-muted\">\n                      <div className=\"w-20 h-20 mx-auto rounded-full bg-muted text-muted-foreground flex items-center justify-center\">\n                        <Medal className=\"h-10 w-10\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-muted-foreground mb-1\">الوصيف</p>\n                        <h3 className=\"text-xl font-display font-bold\">{tournament.runnerUp}</h3>\n                      </div>\n                      <Badge variant=\"secondary\">المركز الثاني</Badge>\n                    </div>\n\n                    {/* Third Place */}\n                    <div className=\"text-center space-y-4 p-6 rounded-xl bg-gradient-to-br from-victory/20 to-victory/5 border-2 border-victory/30\">\n                      <div className=\"w-20 h-20 mx-auto rounded-full bg-victory text-victory-foreground flex items-center justify-center\">\n                        <Award className=\"h-10 w-10\" />\n                      </div>\n                      <div>\n                        <p className=\"text-sm text-muted-foreground mb-1\">المركز الثالث</p>\n                        <h3 className=\"text-xl font-display font-bold\">{tournament.thirdPlace}</h3>\n                      </div>\n                      <Badge className=\"bg-victory text-victory-foreground\">المركز الثالث</Badge>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Leaderboard */}\n        <section className=\"mb-20\">\n          <div className=\"flex items-center gap-3 mb-8\">\n            <Star className=\"h-8 w-8 text-primary\" />\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold\">لوحة الصدارة - الأقسام</h2>\n          </div>\n\n          <Card>\n            <CardContent className=\"p-0\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full\">\n                  <thead className=\"bg-muted\">\n                    <tr>\n                      <th className=\"text-right p-4 font-display font-bold\">المركز</th>\n                      <th className=\"text-right p-4 font-display font-bold\">القسم</th>\n                      <th className=\"text-center p-4 font-display font-bold\">النقاط</th>\n                      <th className=\"text-center p-4 font-display font-bold\">البطولات</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {leaderboard.map((item) => (\n                      <tr \n                        key={item.rank} \n                        className=\"border-b last:border-b-0 hover:bg-muted/50 transition-colors\"\n                        data-testid={`leaderboard-${item.rank}`}\n                      >\n                        <td className=\"p-4\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className={`w-10 h-10 rounded-md ${item.rank === 1 ? 'bg-gold text-gold-foreground' : 'bg-muted'} flex items-center justify-center font-bold`}>\n                              {item.rank}\n                            </div>\n                            {item.rank === 1 && <Crown className=\"h-5 w-5 text-gold\" />}\n                          </div>\n                        </td>\n                        <td className=\"p-4\">\n                          <p className=\"font-display font-bold text-lg\">{item.department}</p>\n                        </td>\n                        <td className=\"p-4 text-center\">\n                          <Badge variant=\"secondary\" className=\"text-base font-mono\">{item.points}</Badge>\n                        </td>\n                        <td className=\"p-4 text-center\">\n                          <div className=\"flex items-center justify-center gap-1\">\n                            <Trophy className={`h-5 w-5 ${item.color}`} />\n                            <span className=\"font-bold\">{item.trophies}</span>\n                          </div>\n                        </td>\n                      </tr>\n                    ))}\n                  </tbody>\n                </table>\n              </div>\n            </CardContent>\n          </Card>\n        </section>\n\n        {/* Featured Athletes */}\n        <section>\n          <div className=\"flex items-center gap-3 mb-8\">\n            <Award className=\"h-8 w-8 text-primary\" />\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold\">اللاعبون المميزون</h2>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {featuredAthletes.map((athlete) => (\n              <Card key={athlete.id} className=\"text-center hover-elevate active-elevate-2 transition-all\" data-testid={`athlete-${athlete.id}`}>\n                <CardContent className=\"p-6 space-y-4\">\n                  <div className=\"w-24 h-24 mx-auto rounded-full bg-gradient-to-br from-primary to-victory flex items-center justify-center text-4xl font-display font-bold text-primary-foreground\">\n                    {athlete.name.split(' ').map(n => n[0]).join('')}\n                  </div>\n                  <div>\n                    <h3 className=\"text-xl font-display font-bold mb-1\">{athlete.name}</h3>\n                    <p className=\"text-sm text-muted-foreground\">{athlete.position}</p>\n                    <Badge variant=\"outline\" className=\"mt-2\">{athlete.department}</Badge>\n                  </div>\n                  <div className=\"pt-4 border-t\">\n                    <Trophy className=\"h-6 w-6 mx-auto text-gold mb-2\" />\n                    <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                      {athlete.achievements}\n                    </p>\n                  </div>\n                  <Badge className=\"bg-primary\">{athlete.sport}</Badge>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":13248,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"client/src/components/theme-provider.tsx":{"content":"import { createContext, useContext, useEffect, useState } from \"react\";\n\ntype Theme = \"light\" | \"dark\";\n\ntype ThemeProviderProps = {\n  children: React.ReactNode;\n  defaultTheme?: Theme;\n};\n\ntype ThemeProviderState = {\n  theme: Theme;\n  setTheme: (theme: Theme) => void;\n};\n\nconst initialState: ThemeProviderState = {\n  theme: \"light\",\n  setTheme: () => null,\n};\n\nconst ThemeProviderContext = createContext<ThemeProviderState>(initialState);\n\nexport function ThemeProvider({\n  children,\n  defaultTheme = \"light\",\n}: ThemeProviderProps) {\n  const [theme, setTheme] = useState<Theme>(\n    () => (localStorage.getItem(\"theme\") as Theme) || defaultTheme\n  );\n\n  useEffect(() => {\n    const root = document.documentElement;\n    root.classList.remove(\"light\", \"dark\");\n    root.classList.add(theme);\n    localStorage.setItem(\"theme\", theme);\n  }, [theme]);\n\n  return (\n    <ThemeProviderContext.Provider value={{ theme, setTheme }}>\n      {children}\n    </ThemeProviderContext.Provider>\n  );\n}\n\nexport const useTheme = () => {\n  const context = useContext(ThemeProviderContext);\n  if (context === undefined)\n    throw new Error(\"useTheme must be used within a ThemeProvider\");\n  return context;\n};\n","path":null,"size_bytes":1191,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":2263,"size_tokens":null},"design_guidelines.md":{"content":"# Design Guidelines: لجنة الرياضية - أبراج لخدمات الطاقة\n\n## Design Approach\n\n**Reference-Based Strategy**: Drawing inspiration from modern sports community platforms (Strava, Nike Run Club, TeamSnap) combined with corporate wellness aesthetics. The design celebrates athletic achievement while maintaining professional credibility suitable for a corporate environment.\n\n## Color Palette\n\n**Primary Colors:**\n- Brand Energy Blue: 210 85% 45% (vibrant, trustworthy, energetic)\n- Victory Orange: 25 95% 55% (celebration, achievement, warmth)\n- Deep Navy: 220 40% 15% (professionalism, stability)\n\n**Neutral Foundation:**\n- Light mode backgrounds: 0 0% 98%, 0 0% 95%\n- Dark mode backgrounds: 220 15% 8%, 220 15% 12%\n- Text: Light mode 220 15% 20%, Dark mode 0 0% 95%\n\n**Accent (Use Sparingly):**\n- Success Green: 145 70% 45% (achievements, wins)\n- Gold Trophy: 45 90% 55% (championships only)\n\n## Typography\n\n**Font Families:**\n- Primary: 'IBM Plex Sans Arabic' (Google Fonts) - clean, modern, excellent Arabic support\n- Display/Headers: 'Tajawal' (Google Fonts) - bold, impactful for headlines\n- Numbers/Stats: 'Rubik' - for scores and statistics\n\n**Scale:**\n- Hero Headlines: text-5xl md:text-7xl font-bold\n- Section Titles: text-3xl md:text-4xl font-bold\n- Event Cards: text-xl font-semibold\n- Body: text-base md:text-lg\n- Captions: text-sm\n\n## Layout System\n\n**Spacing Primitives**: Use Tailwind units: 4, 6, 8, 12, 16, 20, 24, 32\n- Component padding: p-6 md:p-8\n- Section spacing: py-16 md:py-24\n- Card gaps: gap-6 md:gap-8\n- Container max-width: max-w-7xl\n\n**Grid Systems:**\n- Events: grid-cols-1 md:grid-cols-2 lg:grid-cols-3\n- Featured Athletes: grid-cols-2 md:grid-cols-4\n- Gallery: Masonry-style grid-cols-2 md:grid-cols-3 lg:grid-cols-4\n\n## Component Library\n\n**Navigation (Arabic RTL):**\n- Fixed header with logo (right), navigation links (center), CTA button (left)\n- Mobile: Hamburger menu (left side for RTL)\n- Sticky on scroll with subtle shadow\n\n**Hero Section:**\n- Full-width dynamic sports imagery (team celebrating, action shots)\n- Overlaid text with gradient overlay (from navy to transparent)\n- Bold Arabic headline + supporting text\n- Primary CTA button with backdrop-blur\n\n**Event Cards:**\n- Rounded corners (rounded-xl), shadow-lg\n- Image top (16:9 ratio), content below\n- Sport icon badge (absolute positioned)\n- Countdown timer component for upcoming events\n- Gradient border on hover\n\n**Stats Counter:**\n- Large numbers with animated count-up\n- Icon + label below each stat\n- 4-column grid on desktop, 2-column mobile\n\n**Achievement Badges:**\n- Circular design with trophy/medal icons\n- Gold/silver/bronze color variations\n- Player photo with achievement overlay\n\n**Gallery Cards:**\n- Hover overlay with event name + date\n- Lightbox modal for full view\n- Filter tabs by sport type\n\n**News Ticker:**\n- Horizontal auto-scroll marquee\n- Pause on hover\n- Sport emoji + news text format\n\n**Footer:**\n- 3-column layout (about, quick links, contact)\n- Social media icons\n- Company logo + tagline\n\n## Images\n\n**Hero Section:** Large, dynamic sports photography - ideally showing company employees in action during events (football match, family sports day, marathon). Landscape orientation, 1920x1080 minimum. Should convey energy, teamwork, and joy.\n\n**Event Cards:** Each event type needs representative imagery:\n- Football tournaments: Action shots on pitch\n- Family days: Mixed groups enjoying activities  \n- Marathons: Runners in company jerseys\n- Gym activities: Indoor sports facilities\n\n**Gallery:** Authentic photos from past company events, showing real employees participating, celebrating, and enjoying activities. Mix of action shots and group celebrations.\n\n**Featured Athletes:** Professional headshots or action portraits of standout employee-athletes with trophy/achievement context.\n\n## Animations\n\n**Minimal & Purposeful:**\n- Stats counter: Count-up animation on scroll into view\n- Event cards: Subtle lift on hover (transform scale-105)\n- News ticker: Smooth auto-scroll\n- Gallery images: Fade-in overlay on hover\n- **No** page transitions, parallax, or complex scroll effects\n\n## RTL Considerations\n\n- All layouts use `dir=\"rtl\"` on root\n- Icons/arrows flip appropriately\n- Text alignment: text-right by default\n- Navigation order: logo right, links center, CTA left\n- Card layouts maintain natural RTL flow\n\n## Accessibility\n\n- Consistent dark mode with proper contrast ratios\n- All interactive elements have focus states (ring-2 ring-offset-2)\n- Images have descriptive alt text in Arabic\n- Countdown timers show both visual and text representations\n- Color is never the only indicator (use icons + text)","path":null,"size_bytes":4673,"size_tokens":null},"client/src/pages/gallery.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Trophy, Heart, Footprints, Dumbbell, Filter, Loader2 } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport type { Gallery } from \"@shared/schema\";\nimport footballImage from \"@assets/generated_images/Football_tournament_event_d6ff718f.png\";\nimport familyImage from \"@assets/generated_images/Family_sports_day_fb7dc0d7.png\";\nimport marathonImage from \"@assets/generated_images/Marathon_running_event_b03a4441.png\";\nimport basketballImage from \"@assets/generated_images/Basketball_tournament_action_c6044c35.png\";\nimport awardsImage from \"@assets/generated_images/Championship_awards_display_421aecd4.png\";\nimport heroImage from \"@assets/generated_images/Sports_celebration_hero_image_857d51d1.png\";\n\nconst categoryImages: Record<string, string> = {\n  football: footballImage,\n  family: familyImage,\n  marathon: marathonImage,\n  basketball: basketballImage,\n  awards: awardsImage,\n  celebration: heroImage,\n};\n\nexport default function GalleryPage() {\n  const [activeFilter, setActiveFilter] = useState<string>(\"all\");\n\n  const { data: galleryItems = [], isLoading } = useQuery<Gallery[]>({\n    queryKey: [\"/api/gallery\"],\n  });\n\n  const categories = [\n    { id: \"all\", label: \"الكل\", icon: Filter },\n    { id: \"football\", label: \"كرة القدم\", icon: Trophy },\n    { id: \"family\", label: \"عائلي\", icon: Heart },\n    { id: \"marathon\", label: \"جري وماراثون\", icon: Footprints },\n    { id: \"basketball\", label: \"كرة السلة\", icon: Dumbbell },\n  ];\n\n  const filteredGallery = activeFilter === \"all\" \n    ? galleryItems \n    : galleryItems.filter(item => item.category === activeFilter);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen py-12\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        {/* Header */}\n        <div className=\"text-center space-y-4 mb-12\">\n          <Badge variant=\"outline\" className=\"text-base px-4 py-2\" data-testid=\"badge-gallery\">\n            معرض الصور\n          </Badge>\n          <h1 className=\"text-4xl md:text-6xl font-display font-bold\">\n            لحظات لا تُنسى\n          </h1>\n          <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto\">\n            استعراض أجمل اللحظات من فعالياتنا وأنشطتنا الرياضية\n          </p>\n        </div>\n\n        {/* Filter Buttons */}\n        <div className=\"flex flex-wrap justify-center gap-3 mb-12\">\n          {categories.map((category) => {\n            const Icon = category.icon;\n            const isActive = activeFilter === category.id;\n            return (\n              <Button\n                key={category.id}\n                variant={isActive ? \"default\" : \"outline\"}\n                onClick={() => setActiveFilter(category.id)}\n                className=\"gap-2\"\n                data-testid={`filter-${category.id}`}\n              >\n                <Icon className=\"h-4 w-4\" />\n                {category.label}\n              </Button>\n            );\n          })}\n        </div>\n\n        {/* Gallery Grid */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {filteredGallery.map((item) => {\n            const image = item.imageUrl || categoryImages[item.category] || footballImage;\n            return (\n              <Card \n                key={item.id} \n                className=\"overflow-hidden group hover-elevate active-elevate-2 transition-all cursor-pointer\"\n                data-testid={`gallery-item-${item.id}`}\n              >\n                <div className=\"relative h-64 overflow-hidden\">\n                  <img\n                    src={image}\n                    alt={item.title}\n                    className=\"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500\"\n                  />\n                  <div className=\"absolute inset-0 bg-gradient-to-t from-background/90 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300\" />\n                  <div className=\"absolute bottom-0 left-0 right-0 p-4 translate-y-full group-hover:translate-y-0 transition-transform duration-300\">\n                    <Badge className=\"mb-2\">{item.eventDate ? new Date(item.eventDate).toLocaleDateString('ar-SA', { year: 'numeric', month: 'long' }) : \"\"}</Badge>\n                    <h3 className=\"text-lg font-bold text-foreground\">{item.title}</h3>\n                    {item.description && (\n                      <p className=\"text-sm text-muted-foreground mt-1\">{item.description}</p>\n                    )}\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n\n        {filteredGallery.length === 0 && (\n          <Card className=\"p-12 text-center\">\n            <Trophy className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-xl font-bold mb-2\">لا توجد صور في هذا القسم</h3>\n            <p className=\"text-muted-foreground\">جرب اختيار قسم آخر</p>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":5472,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/pages/register.tsx":{"content":"import { useState } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useLocation } from \"wouter\";\nimport { useQueryClient } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage, FormDescription } from \"@/components/ui/form\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Trophy, Upload, CalendarIcon, User, Users, Shirt } from \"lucide-react\";\nimport { z } from \"zod\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\nimport { cn } from \"@/lib/utils\";\n\nconst registerFormSchema = z.object({\n  username: z.string().min(3, \"اسم المستخدم يجب أن يكون 3 أحرف على الأقل\"),\n  password: z.string().min(6, \"كلمة المرور يجب أن تكون 6 أحرف على الأقل\"),\n  confirmPassword: z.string().min(6, \"كلمة المرور يجب أن تكون 6 أحرف على الأقل\"),\n  fullName: z.string().min(1, \"الاسم الكامل مطلوب\"),\n  email: z.string().email(\"البريد الإلكتروني غير صحيح\"),\n  employeeId: z.string().min(1, \"رقم الموظف مطلوب\"),\n  department: z.string().min(1, \"القسم مطلوب\"),\n  position: z.string().min(1, \"المنصب مطلوب\"),\n  phoneNumber: z.string().optional(),\n  shiftPattern: z.string().default(\"2weeks_on_2weeks_off\"),\n  accountType: z.enum([\"standard\", \"player\", \"committee\"]),\n  committeeTitle: z.string().optional(),\n  workStartDate: z.date().optional(),\n  workEndDate: z.date().optional(),\n  playerNumber: z.string().optional(),\n  playerPosition: z.string().optional(),\n  playerLevel: z.string().optional(),\n  playerDateOfBirth: z.date().optional(),\n  playerHealthStatus: z.string().optional(),\n  playerPrimaryJersey: z.string().optional(),\n}).refine((data) => data.password === data.confirmPassword, {\n  message: \"كلمات المرور غير متطابقة\",\n  path: [\"confirmPassword\"],\n}).refine((data) => {\n  if (data.accountType === \"committee\" && !data.committeeTitle) {\n    return false;\n  }\n  return true;\n}, {\n  message: \"المسمى في اللجنة مطلوب\",\n  path: [\"committeeTitle\"],\n});\n\ntype RegisterFormData = z.infer<typeof registerFormSchema>;\n\nexport default function Register() {\n  const [, navigate] = useLocation();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [profileImage, setProfileImage] = useState<File | null>(null);\n  const [employeeCardImage, setEmployeeCardImage] = useState<File | null>(null);\n  const [nationalIdImage, setNationalIdImage] = useState<File | null>(null);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  const form = useForm<RegisterFormData>({\n    resolver: zodResolver(registerFormSchema),\n    defaultValues: {\n      username: \"\",\n      password: \"\",\n      confirmPassword: \"\",\n      fullName: \"\",\n      email: \"\",\n      employeeId: \"\",\n      department: \"\",\n      position: \"\",\n      phoneNumber: \"\",\n      shiftPattern: \"2weeks_on_2weeks_off\",\n      accountType: \"standard\",\n      committeeTitle: \"\",\n      playerNumber: \"\",\n      playerPosition: \"\",\n      playerLevel: \"\",\n      playerHealthStatus: \"fit\",\n      playerPrimaryJersey: \"\",\n    },\n  });\n\n  const accountType = form.watch(\"accountType\");\n\n  const onSubmit = async (data: RegisterFormData) => {\n    setIsSubmitting(true);\n    try {\n      const formData = new FormData();\n      \n      formData.append(\"username\", data.username);\n      formData.append(\"password\", data.password);\n      formData.append(\"fullName\", data.fullName);\n      formData.append(\"email\", data.email);\n      formData.append(\"employeeId\", data.employeeId);\n      formData.append(\"department\", data.department);\n      formData.append(\"position\", data.position);\n      formData.append(\"phoneNumber\", data.phoneNumber || \"\");\n      formData.append(\"shiftPattern\", data.shiftPattern);\n      formData.append(\"accountType\", data.accountType);\n      \n      if (data.committeeTitle) {\n        formData.append(\"committeeTitle\", data.committeeTitle);\n      }\n      \n      if (data.workStartDate) {\n        formData.append(\"workStartDate\", data.workStartDate.toISOString());\n      }\n      if (data.workEndDate) {\n        formData.append(\"workEndDate\", data.workEndDate.toISOString());\n      }\n\n      if (data.accountType === \"player\") {\n        const playerInfo = {\n          number: data.playerNumber,\n          position: data.playerPosition,\n          level: data.playerLevel,\n          dateOfBirth: data.playerDateOfBirth?.toISOString(),\n          healthStatus: data.playerHealthStatus,\n          primaryJersey: data.playerPrimaryJersey,\n        };\n        formData.append(\"playerInfo\", JSON.stringify(playerInfo));\n      }\n\n      if (profileImage) {\n        formData.append(\"profileImage\", profileImage);\n      }\n      if (employeeCardImage) {\n        formData.append(\"employeeCardImage\", employeeCardImage);\n      }\n      if (nationalIdImage) {\n        formData.append(\"nationalIdImage\", nationalIdImage);\n      }\n\n      const response = await fetch(\"/api/auth/register\", {\n        method: \"POST\",\n        body: formData,\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || \"فشل إنشاء الحساب\");\n      }\n\n      // Invalidate auth query to update user state\n      await queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n\n      toast({\n        title: \"تم إنشاء الحساب بنجاح\",\n        description: \"مرحباً بك في اللجنة الرياضية\",\n      });\n      navigate(\"/\");\n    } catch (error: any) {\n      toast({\n        title: \"فشل إنشاء الحساب\",\n        description: error.message || \"حدث خطأ أثناء إنشاء الحساب\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const handleImageChange = (\n    e: React.ChangeEvent<HTMLInputElement>,\n    setter: (file: File | null) => void\n  ) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      setter(file);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-orange-50 dark:from-gray-900 dark:to-gray-800 p-4\">\n      <Card className=\"w-full max-w-3xl\">\n        <CardHeader className=\"text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"bg-primary/10 p-4 rounded-full\">\n              <Trophy className=\"w-12 h-12 text-primary\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-2xl\">إنشاء حساب جديد</CardTitle>\n          <CardDescription>\n            انضم إلى اللجنة الرياضية - شركة أبراج لخدمات الطاقة\n          </CardDescription>\n        </CardHeader>\n        <Form {...form}>\n          <form onSubmit={form.handleSubmit(onSubmit)}>\n            <CardContent className=\"space-y-6\">\n              <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-semibold flex items-center gap-2\">\n                  <User className=\"w-5 h-5\" />\n                  المعلومات الأساسية\n                </h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"fullName\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-fullname\">الاسم الكامل *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-fullname\" placeholder=\"الاسم الكامل\" className=\"text-right\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"username\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-username\">اسم المستخدم *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-username\" placeholder=\"اسم المستخدم\" className=\"text-right\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"email\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-email\">البريد الإلكتروني *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-email\" type=\"email\" placeholder=\"example@abraj.com\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"employeeId\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-employeeid\">رقم الموظف *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-employeeid\" placeholder=\"EMP001\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"department\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-department\">القسم *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-department\" placeholder=\"قسم الهندسة\" className=\"text-right\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"position\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-position\">المنصب *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-position\" placeholder=\"مهندس كهرباء\" className=\"text-right\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"phoneNumber\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-phone\">رقم الجوال</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-phone\" type=\"tel\" placeholder=\"05xxxxxxxx\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-semibold flex items-center gap-2\">\n                  <Users className=\"w-5 h-5\" />\n                  نوع الحساب\n                </h3>\n                <FormField\n                  control={form.control}\n                  name=\"accountType\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel data-testid=\"label-account-type\">نوع الحساب *</FormLabel>\n                      <Select onValueChange={field.onChange} defaultValue={field.value}>\n                        <FormControl>\n                          <SelectTrigger data-testid=\"select-account-type\">\n                            <SelectValue placeholder=\"اختر نوع الحساب\" />\n                          </SelectTrigger>\n                        </FormControl>\n                        <SelectContent>\n                          <SelectItem value=\"standard\">مستخدم عادي</SelectItem>\n                          <SelectItem value=\"player\">لاعب</SelectItem>\n                          <SelectItem value=\"committee\">عضو اللجنة الإدارية</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <FormDescription>\n                        {accountType === \"standard\" && \"يمكنك التسجيل في الفعاليات ومشاهدة المحتوى\"}\n                        {accountType === \"player\" && \"ستظهر حقول إضافية لتسجيل بيانات اللاعب\"}\n                        {accountType === \"committee\" && \"ستحصل على صلاحيات إدارية إضافية\"}\n                      </FormDescription>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {accountType === \"committee\" && (\n                  <FormField\n                    control={form.control}\n                    name=\"committeeTitle\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-committee-title\">المسمى في إدارة اللجنة *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-committee-title\" placeholder=\"مثال: رئيس اللجنة، أمين الصندوق\" className=\"text-right\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                )}\n              </div>\n\n              {accountType === \"player\" && (\n                <div className=\"space-y-4 p-4 bg-muted/50 rounded-lg\">\n                  <h3 className=\"text-lg font-semibold flex items-center gap-2\">\n                    <Shirt className=\"w-5 h-5\" />\n                    معلومات اللاعب\n                  </h3>\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <FormField\n                      control={form.control}\n                      name=\"playerNumber\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>رقم القميص</FormLabel>\n                          <FormControl>\n                            <Input {...field} data-testid=\"input-player-number\" type=\"number\" placeholder=\"10\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"playerPosition\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>المركز</FormLabel>\n                          <Select onValueChange={field.onChange} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-player-position\">\n                                <SelectValue placeholder=\"اختر المركز\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              <SelectItem value=\"goalkeeper\">حارس مرمى</SelectItem>\n                              <SelectItem value=\"defender\">مدافع</SelectItem>\n                              <SelectItem value=\"midfielder\">لاعب وسط</SelectItem>\n                              <SelectItem value=\"forward\">مهاجم</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"playerLevel\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>المستوى</FormLabel>\n                          <Select onValueChange={field.onChange} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-player-level\">\n                                <SelectValue placeholder=\"اختر المستوى\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              <SelectItem value=\"beginner\">مبتدئ</SelectItem>\n                              <SelectItem value=\"intermediate\">متوسط</SelectItem>\n                              <SelectItem value=\"advanced\">متقدم</SelectItem>\n                              <SelectItem value=\"professional\">محترف</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"playerHealthStatus\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>الحالة الصحية</FormLabel>\n                          <Select onValueChange={field.onChange} defaultValue={field.value}>\n                            <FormControl>\n                              <SelectTrigger data-testid=\"select-player-health\">\n                                <SelectValue placeholder=\"اختر الحالة\" />\n                              </SelectTrigger>\n                            </FormControl>\n                            <SelectContent>\n                              <SelectItem value=\"fit\">لائق</SelectItem>\n                              <SelectItem value=\"injured\">مصاب</SelectItem>\n                              <SelectItem value=\"recovering\">يتعافى</SelectItem>\n                            </SelectContent>\n                          </Select>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"playerDateOfBirth\"\n                      render={({ field }) => (\n                        <FormItem className=\"flex flex-col\">\n                          <FormLabel>تاريخ الميلاد</FormLabel>\n                          <Popover>\n                            <PopoverTrigger asChild>\n                              <FormControl>\n                                <Button\n                                  variant=\"outline\"\n                                  className={cn(\n                                    \"w-full justify-start text-right font-normal\",\n                                    !field.value && \"text-muted-foreground\"\n                                  )}\n                                  data-testid=\"button-player-dob\"\n                                >\n                                  <CalendarIcon className=\"ml-2 h-4 w-4\" />\n                                  {field.value ? format(field.value, \"PPP\", { locale: ar }) : \"اختر التاريخ\"}\n                                </Button>\n                              </FormControl>\n                            </PopoverTrigger>\n                            <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                              <Calendar\n                                mode=\"single\"\n                                selected={field.value}\n                                onSelect={field.onChange}\n                                disabled={(date) => date > new Date() || date < new Date(\"1950-01-01\")}\n                                initialFocus\n                              />\n                            </PopoverContent>\n                          </Popover>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n\n                    <FormField\n                      control={form.control}\n                      name=\"playerPrimaryJersey\"\n                      render={({ field }) => (\n                        <FormItem>\n                          <FormLabel>لون القميص الأساسي</FormLabel>\n                          <FormControl>\n                            <Input {...field} data-testid=\"input-player-jersey\" placeholder=\"أحمر، أزرق، أخضر...\" className=\"text-right\" />\n                          </FormControl>\n                          <FormMessage />\n                        </FormItem>\n                      )}\n                    />\n                  </div>\n                </div>\n              )}\n\n              <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-semibold flex items-center gap-2\">\n                  <CalendarIcon className=\"w-5 h-5\" />\n                  نظام الدوام والتوافر\n                </h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"shiftPattern\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-shift\">نظام الدوام</FormLabel>\n                        <Select onValueChange={field.onChange} defaultValue={field.value}>\n                          <FormControl>\n                            <SelectTrigger data-testid=\"select-shift\">\n                              <SelectValue placeholder=\"اختر نظام الدوام\" />\n                            </SelectTrigger>\n                          </FormControl>\n                          <SelectContent>\n                            <SelectItem value=\"2weeks_on_2weeks_off\">2 أسبوع عمل / 2 أسبوع إجازة</SelectItem>\n                            <SelectItem value=\"normal\">دوام عادي (دوام كامل)</SelectItem>\n                            <SelectItem value=\"flexible\">دوام مرن</SelectItem>\n                          </SelectContent>\n                        </Select>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"workStartDate\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-col\">\n                        <FormLabel>تاريخ بداية العمل</FormLabel>\n                        <Popover>\n                          <PopoverTrigger asChild>\n                            <FormControl>\n                              <Button\n                                variant=\"outline\"\n                                className={cn(\n                                  \"w-full justify-start text-right font-normal\",\n                                  !field.value && \"text-muted-foreground\"\n                                )}\n                                data-testid=\"button-work-start\"\n                              >\n                                <CalendarIcon className=\"ml-2 h-4 w-4\" />\n                                {field.value ? format(field.value, \"PPP\", { locale: ar }) : \"اختر التاريخ\"}\n                              </Button>\n                            </FormControl>\n                          </PopoverTrigger>\n                          <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                            <Calendar\n                              mode=\"single\"\n                              selected={field.value}\n                              onSelect={field.onChange}\n                              initialFocus\n                            />\n                          </PopoverContent>\n                        </Popover>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"workEndDate\"\n                    render={({ field }) => (\n                      <FormItem className=\"flex flex-col\">\n                        <FormLabel>تاريخ نهاية العمل</FormLabel>\n                        <Popover>\n                          <PopoverTrigger asChild>\n                            <FormControl>\n                              <Button\n                                variant=\"outline\"\n                                className={cn(\n                                  \"w-full justify-start text-right font-normal\",\n                                  !field.value && \"text-muted-foreground\"\n                                )}\n                                data-testid=\"button-work-end\"\n                              >\n                                <CalendarIcon className=\"ml-2 h-4 w-4\" />\n                                {field.value ? format(field.value, \"PPP\", { locale: ar }) : \"اختر التاريخ\"}\n                              </Button>\n                            </FormControl>\n                          </PopoverTrigger>\n                          <PopoverContent className=\"w-auto p-0\" align=\"start\">\n                            <Calendar\n                              mode=\"single\"\n                              selected={field.value}\n                              onSelect={field.onChange}\n                              initialFocus\n                            />\n                          </PopoverContent>\n                        </Popover>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </div>\n\n              <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-semibold flex items-center gap-2\">\n                  <Upload className=\"w-5 h-5\" />\n                  الصور والمستندات\n                </h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                  <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium\">صورة شخصية</label>\n                    <div className=\"flex items-center gap-2\">\n                      <Input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={(e) => handleImageChange(e, setProfileImage)}\n                        className=\"cursor-pointer\"\n                        data-testid=\"input-profile-image\"\n                      />\n                    </div>\n                    {profileImage && (\n                      <p className=\"text-xs text-muted-foreground\">{profileImage.name}</p>\n                    )}\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium\">صورة بطاقة العمل</label>\n                    <div className=\"flex items-center gap-2\">\n                      <Input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={(e) => handleImageChange(e, setEmployeeCardImage)}\n                        className=\"cursor-pointer\"\n                        data-testid=\"input-employee-card\"\n                      />\n                    </div>\n                    {employeeCardImage && (\n                      <p className=\"text-xs text-muted-foreground\">{employeeCardImage.name}</p>\n                    )}\n                  </div>\n\n                  <div className=\"space-y-2\">\n                    <label className=\"text-sm font-medium\">صورة الهوية</label>\n                    <div className=\"flex items-center gap-2\">\n                      <Input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={(e) => handleImageChange(e, setNationalIdImage)}\n                        className=\"cursor-pointer\"\n                        data-testid=\"input-national-id\"\n                      />\n                    </div>\n                    {nationalIdImage && (\n                      <p className=\"text-xs text-muted-foreground\">{nationalIdImage.name}</p>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"space-y-4\">\n                <h3 className=\"text-lg font-semibold\">كلمة المرور</h3>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                  <FormField\n                    control={form.control}\n                    name=\"password\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-password\">كلمة المرور *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-password\" type=\"password\" placeholder=\"6 أحرف على الأقل\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n\n                  <FormField\n                    control={form.control}\n                    name=\"confirmPassword\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel data-testid=\"label-confirm-password\">تأكيد كلمة المرور *</FormLabel>\n                        <FormControl>\n                          <Input {...field} data-testid=\"input-confirm-password\" type=\"password\" placeholder=\"أعد إدخال كلمة المرور\" />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                </div>\n              </div>\n            </CardContent>\n            <CardFooter className=\"flex flex-col gap-4\">\n              <Button\n                type=\"submit\"\n                className=\"w-full\"\n                disabled={isSubmitting}\n                data-testid=\"button-register\"\n              >\n                {isSubmitting ? \"جاري إنشاء الحساب...\" : \"إنشاء حساب\"}\n              </Button>\n              <div className=\"text-sm text-center text-muted-foreground\">\n                لديك حساب بالفعل؟{\" \"}\n                <button\n                  type=\"button\"\n                  className=\"text-primary hover:underline\"\n                  onClick={() => navigate(\"/login\")}\n                  data-testid=\"link-login\"\n                >\n                  تسجيل الدخول\n                </button>\n              </div>\n            </CardFooter>\n          </form>\n        </Form>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":31897,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"client/src/pages/login.tsx":{"content":"import { useState } from \"react\";\nimport { useLocation } from \"wouter\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Trophy } from \"lucide-react\";\n\nexport default function Login() {\n  const [, navigate] = useLocation();\n  const { login } = useAuth();\n  const { toast } = useToast();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    try {\n      await login(username, password);\n      toast({\n        title: \"تم تسجيل الدخول بنجاح\",\n        description: \"مرحباً بك في اللجنة الرياضية\",\n      });\n      navigate(\"/\");\n    } catch (error: any) {\n      toast({\n        title: \"فشل تسجيل الدخول\",\n        description: error.message || \"يرجى التحقق من اسم المستخدم وكلمة المرور\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-orange-50 dark:from-gray-900 dark:to-gray-800 p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"bg-primary/10 p-4 rounded-full\">\n              <Trophy className=\"w-12 h-12 text-primary\" />\n            </div>\n          </div>\n          <CardTitle className=\"text-2xl\">تسجيل الدخول</CardTitle>\n          <CardDescription>\n            مرحباً بك في اللجنة الرياضية - شركة أبراج\n          </CardDescription>\n        </CardHeader>\n        <form onSubmit={handleSubmit}>\n          <CardContent className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"username\" data-testid=\"label-username\">\n                اسم المستخدم\n              </Label>\n              <Input\n                id=\"username\"\n                data-testid=\"input-username\"\n                type=\"text\"\n                placeholder=\"أدخل اسم المستخدم\"\n                value={username}\n                onChange={(e) => setUsername(e.target.value)}\n                required\n                disabled={isLoading}\n                className=\"text-right\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\" data-testid=\"label-password\">\n                كلمة المرور\n              </Label>\n              <Input\n                id=\"password\"\n                data-testid=\"input-password\"\n                type=\"password\"\n                placeholder=\"أدخل كلمة المرور\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                required\n                disabled={isLoading}\n                className=\"text-right\"\n              />\n            </div>\n          </CardContent>\n          <CardFooter className=\"flex flex-col gap-4\">\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              disabled={isLoading}\n              data-testid=\"button-login\"\n            >\n              {isLoading ? \"جاري تسجيل الدخول...\" : \"تسجيل الدخول\"}\n            </Button>\n            <div className=\"text-sm text-center text-muted-foreground\">\n              ليس لديك حساب؟{\" \"}\n              <button\n                type=\"button\"\n                className=\"text-primary hover:underline\"\n                onClick={() => navigate(\"/register\")}\n                data-testid=\"link-register\"\n              >\n                إنشاء حساب جديد\n              </button>\n            </div>\n          </CardFooter>\n        </form>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":4222,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n        // Sports theme colors\n        victory: {\n          DEFAULT: \"hsl(var(--victory) / <alpha-value>)\",\n          foreground: \"hsl(var(--victory-foreground) / <alpha-value>)\",\n        },\n        success: {\n          DEFAULT: \"hsl(var(--success) / <alpha-value>)\",\n          foreground: \"hsl(var(--success-foreground) / <alpha-value>)\",\n        },\n        gold: {\n          DEFAULT: \"hsl(var(--gold) / <alpha-value>)\",\n          foreground: \"hsl(var(--gold-foreground) / <alpha-value>)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"IBM Plex Sans Arabic\", \"var(--font-sans)\"],\n        display: [\"Tajawal\", \"var(--font-sans)\"],\n        mono: [\"Rubik\", \"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n        \"fade-in\": {\n          from: { opacity: \"0\", transform: \"translateY(10px)\" },\n          to: { opacity: \"1\", transform: \"translateY(0)\" },\n        },\n        \"slide-in-right\": {\n          from: { transform: \"translateX(-100%)\" },\n          to: { transform: \"translateX(0)\" },\n        },\n        \"count-up\": {\n          from: { transform: \"scale(0.8)\", opacity: \"0\" },\n          to: { transform: \"scale(1)\", opacity: \"1\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n        \"fade-in\": \"fade-in 0.5s ease-out\",\n        \"slide-in-right\": \"slide-in-right 0.3s ease-out\",\n        \"count-up\": \"count-up 0.6s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":5186,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { AlertCircle, Home } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center py-12\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-12 pb-8 text-center space-y-6\">\n          <div className=\"flex justify-center\">\n            <div className=\"w-20 h-20 rounded-full bg-destructive/10 flex items-center justify-center\">\n              <AlertCircle className=\"h-12 w-12 text-destructive\" />\n            </div>\n          </div>\n          \n          <div className=\"space-y-2\">\n            <h1 className=\"text-6xl font-display font-bold text-primary\">404</h1>\n            <h2 className=\"text-2xl font-display font-bold\">الصفحة غير موجودة</h2>\n            <p className=\"text-muted-foreground\">\n              عذراً، الصفحة التي تبحث عنها غير موجودة أو تم نقلها\n            </p>\n          </div>\n\n          <Link href=\"/\">\n            <Button size=\"lg\" className=\"gap-2\" data-testid=\"button-home\">\n              <Home className=\"h-5 w-5\" />\n              العودة للرئيسية\n            </Button>\n          </Link>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":1393,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/pages/admin.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { \n  Calendar, Users, Trophy, ImageIcon, Newspaper, \n  Plus, Pencil, Trash2, Loader2, Shield, BarChart3, Target, Upload, Phone, MapPin,\n  Goal, AlertTriangle, User as UserIcon, Clock, X, Shuffle, Settings\n} from \"lucide-react\";\nimport { TeamBox, TeamColorPicker, getTeamColor, isLightColor } from \"@/components/TeamBox\";\nimport { \n  PieChart, Pie, Cell, BarChart, Bar, XAxis, YAxis, \n  CartesianGrid, Tooltip, Legend, ResponsiveContainer \n} from 'recharts';\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { Event, News, Result, Stats, User, Gallery, Tournament, MatchWithTeams, Player, MatchEvent } from \"@shared/schema\";\nimport { Tabs as DialogTabs, TabsContent as DialogTabsContent, TabsList as DialogTabsList, TabsTrigger as DialogTabsTrigger } from \"@/components/ui/tabs\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\n\nexport default function Admin() {\n  const { user, isAuthenticated, isLoading: authLoading } = useAuth();\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const queryClient = useQueryClient();\n  const [activeTab, setActiveTab] = useState(\"dashboard\");\n  const [selectedTournamentId, setSelectedTournamentId] = useState<string>(\"\");\n\n  const isAdmin = user?.role === \"admin\" || user?.role === \"committee_member\";\n\n  const { data: stats } = useQuery<Stats>({\n    queryKey: [\"/api/stats\"],\n    enabled: isAdmin,\n  });\n\n  const { data: events = [] } = useQuery<Event[]>({\n    queryKey: [\"/api/events\"],\n    enabled: isAdmin,\n  });\n\n  const { data: news = [] } = useQuery<News[]>({\n    queryKey: [\"/api/news\"],\n    enabled: isAdmin,\n  });\n\n  const { data: results = [] } = useQuery<Result[]>({\n    queryKey: [\"/api/results\"],\n    enabled: isAdmin,\n  });\n\n  const { data: allUsers = [] } = useQuery<Omit<User, 'password'>[]>({\n    queryKey: [\"/api/users\"],\n    enabled: isAdmin,\n  });\n\n  const { data: gallery = [] } = useQuery<Gallery[]>({\n    queryKey: [\"/api/gallery\"],\n    enabled: isAdmin,\n  });\n\n  const { data: tournamentsList = [] } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n    enabled: isAdmin,\n  });\n\n  const { data: heroSetting } = useQuery<{ key: string; value: string | null }>({\n    queryKey: ['/api/settings/hero_image'],\n    enabled: isAdmin,\n  });\n\n  const [heroImagePreview, setHeroImagePreview] = useState<string>(\"\");\n  const heroFileInputRef = useRef<HTMLInputElement>(null);\n\n  const updateHeroImageMutation = useMutation({\n    mutationFn: async (imageUrl: string) => {\n      return await apiRequest(\"POST\", \"/api/settings/hero_image\", { value: imageUrl });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تحديث صورة الصفحة الرئيسية بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: ['/api/settings/hero_image'] });\n      setHeroImagePreview(\"\");\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث الصورة\", variant: \"destructive\" });\n    },\n  });\n\n  const uploadHeroImageMutation = useMutation({\n    mutationFn: async (file: File) => {\n      const formData = new FormData();\n      formData.append(\"image\", file);\n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formData,\n      });\n      if (!response.ok) throw new Error(\"Upload failed\");\n      return response.json();\n    },\n    onSuccess: (data) => {\n      setHeroImagePreview(data.url);\n    },\n    onError: () => {\n      toast({ title: \"فشل رفع الصورة\", variant: \"destructive\" });\n    },\n  });\n\n  const handleHeroFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (file) {\n      uploadHeroImageMutation.mutate(file);\n    }\n  };\n\n  const saveHeroImage = () => {\n    if (heroImagePreview) {\n      updateHeroImageMutation.mutate(heroImagePreview);\n    }\n  };\n\n  const { data: matchesList = [], isLoading: matchesLoading } = useQuery<MatchWithTeams[]>({\n    queryKey: [\"/api/tournaments\", selectedTournamentId, \"matches\"],\n    queryFn: async () => {\n      if (!selectedTournamentId) return [];\n      const response = await fetch(`/api/tournaments/${selectedTournamentId}/matches`);\n      if (!response.ok) throw new Error(\"Failed to fetch matches\");\n      return response.json();\n    },\n    enabled: isAdmin && !!selectedTournamentId,\n  });\n\n  const updateMatchMutation = useMutation({\n    mutationFn: async ({ matchId, data }: { matchId: string; data: any }) => {\n      return await apiRequest(\"PATCH\", `/api/matches/${matchId}`, data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تحديث نتيجة المباراة\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", selectedTournamentId, \"matches\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث النتيجة\", variant: \"destructive\" });\n    },\n  });\n\n  const updateRoleMutation = useMutation({\n    mutationFn: async ({ userId, role }: { userId: string; role: string }) => {\n      return await apiRequest(\"PATCH\", `/api/users/${userId}/role`, { role });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تحديث الصلاحية\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث الصلاحية\", variant: \"destructive\" });\n    },\n  });\n\n  const updateStatusMutation = useMutation({\n    mutationFn: async ({ userId, isActive }: { userId: string; isActive: boolean }) => {\n      return await apiRequest(\"PATCH\", `/api/users/${userId}/status`, { isActive });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تحديث حالة المستخدم\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/users\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث الحالة\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteTournamentMutation = useMutation({\n    mutationFn: async (tournamentId: string) => {\n      return await apiRequest(\"DELETE\", `/api/tournaments/${tournamentId}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حذف البطولة بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل حذف البطولة\", variant: \"destructive\" });\n    },\n  });\n\n  const [tournamentToDelete, setTournamentToDelete] = useState<Tournament | null>(null);\n  const [drawTournament, setDrawTournament] = useState<Tournament | null>(null);\n  const [drawGroups, setDrawGroups] = useState<number>(2);\n\n  const randomDrawMutation = useMutation({\n    mutationFn: async ({ tournamentId, numberOfGroups }: { tournamentId: string; numberOfGroups: number }) => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/random-draw`, { numberOfGroups });\n    },\n    onSuccess: async (response) => {\n      const data = await response.json();\n      toast({ title: \"تمت القرعة بنجاح\", description: data.message });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      setDrawTournament(null);\n    },\n    onError: () => {\n      toast({ title: \"فشل إجراء القرعة\", variant: \"destructive\" });\n    },\n  });\n\n  if (authLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full text-center p-8\">\n          <Shield className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n          <h2 className=\"text-2xl font-bold mb-4\">يجب تسجيل الدخول</h2>\n          <p className=\"text-muted-foreground mb-6\">\n            يرجى تسجيل الدخول للوصول إلى لوحة التحكم\n          </p>\n          <Button onClick={() => navigate(\"/login\")} data-testid=\"button-login\">\n            تسجيل الدخول\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!isAdmin) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full text-center p-8\">\n          <Shield className=\"h-16 w-16 mx-auto text-destructive mb-4\" />\n          <h2 className=\"text-2xl font-bold mb-4\">غير مصرح</h2>\n          <p className=\"text-muted-foreground mb-6\">\n            ليس لديك صلاحية للوصول إلى لوحة التحكم الإدارية\n          </p>\n          <Button onClick={() => navigate(\"/\")} data-testid=\"button-home\">\n            العودة للرئيسية\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen py-8\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-display font-bold\">لوحة التحكم</h1>\n            <p className=\"text-muted-foreground\">إدارة الفعاليات والمحتوى</p>\n          </div>\n          <Badge className=\"bg-primary\">{user.role === \"admin\" ? \"مدير\" : \"عضو لجنة\"}</Badge>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-4 md:grid-cols-9 lg:w-auto lg:inline-grid gap-1\">\n            <TabsTrigger value=\"dashboard\" data-testid=\"tab-dashboard\">\n              <BarChart3 className=\"h-4 w-4 ml-2\" />\n              الإحصائيات\n            </TabsTrigger>\n            <TabsTrigger value=\"events\" data-testid=\"tab-events\">\n              <Calendar className=\"h-4 w-4 ml-2\" />\n              الفعاليات\n            </TabsTrigger>\n            <TabsTrigger value=\"tournaments\" data-testid=\"tab-tournaments\">\n              <Target className=\"h-4 w-4 ml-2\" />\n              البطولات\n            </TabsTrigger>\n            <TabsTrigger value=\"matches\" data-testid=\"tab-matches\">\n              <Trophy className=\"h-4 w-4 ml-2\" />\n              المباريات\n            </TabsTrigger>\n            <TabsTrigger value=\"news\" data-testid=\"tab-news\">\n              <Newspaper className=\"h-4 w-4 ml-2\" />\n              الأخبار\n            </TabsTrigger>\n            <TabsTrigger value=\"results\" data-testid=\"tab-results\">\n              <Trophy className=\"h-4 w-4 ml-2\" />\n              النتائج\n            </TabsTrigger>\n            <TabsTrigger value=\"users\" data-testid=\"tab-users\">\n              <Users className=\"h-4 w-4 ml-2\" />\n              المستخدمين\n            </TabsTrigger>\n            <TabsTrigger value=\"gallery\" data-testid=\"tab-gallery\">\n              <ImageIcon className=\"h-4 w-4 ml-2\" />\n              المعرض\n            </TabsTrigger>\n            <TabsTrigger value=\"settings\" data-testid=\"tab-settings\">\n              <Settings className=\"h-4 w-4 ml-2\" />\n              الإعدادات\n            </TabsTrigger>\n          </TabsList>\n\n          {/* Dashboard Tab */}\n          <TabsContent value=\"dashboard\" className=\"space-y-6\">\n            {/* Stats Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n              <Card data-testid=\"stat-events\">\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">إجمالي الفعاليات</CardTitle>\n                  <Calendar className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.totalEvents || 0}</div>\n                  <p className=\"text-xs text-muted-foreground\">فعالية نشطة</p>\n                </CardContent>\n              </Card>\n              <Card data-testid=\"stat-participants\">\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">المشاركون</CardTitle>\n                  <Users className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.totalParticipants || 0}</div>\n                  <p className=\"text-xs text-muted-foreground\">مشارك مسجل</p>\n                </CardContent>\n              </Card>\n              <Card data-testid=\"stat-achievements\">\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">الإنجازات</CardTitle>\n                  <Trophy className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.totalAchievements || 0}</div>\n                  <p className=\"text-xs text-muted-foreground\">إنجاز محقق</p>\n                </CardContent>\n              </Card>\n              <Card data-testid=\"stat-sports\">\n                <CardHeader className=\"flex flex-row items-center justify-between gap-2 pb-2\">\n                  <CardTitle className=\"text-sm font-medium\">الأنشطة</CardTitle>\n                  <BarChart3 className=\"h-4 w-4 text-muted-foreground\" />\n                </CardHeader>\n                <CardContent>\n                  <div className=\"text-2xl font-bold\">{stats?.activeSports || 0}</div>\n                  <p className=\"text-xs text-muted-foreground\">نشاط رياضي</p>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Charts Section */}\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              {/* Events by Category Pie Chart */}\n              <Card data-testid=\"chart-events-category\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Calendar className=\"h-5 w-5\" />\n                    توزيع الفعاليات حسب النوع\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-[300px]\">\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                      <PieChart>\n                        <Pie\n                          data={[\n                            { name: 'كرة قدم', value: events.filter(e => e.category === 'football').length, color: '#3B82F6' },\n                            { name: 'كرة سلة', value: events.filter(e => e.category === 'basketball').length, color: '#F97316' },\n                            { name: 'ماراثون', value: events.filter(e => e.category === 'marathon').length, color: '#22C55E' },\n                            { name: 'عائلي', value: events.filter(e => e.category === 'family').length, color: '#A855F7' },\n                          ].filter(d => d.value > 0)}\n                          cx=\"50%\"\n                          cy=\"50%\"\n                          labelLine={false}\n                          label={({ name, percent }) => `${name} ${(percent * 100).toFixed(0)}%`}\n                          outerRadius={100}\n                          fill=\"#8884d8\"\n                          dataKey=\"value\"\n                        >\n                          {[\n                            { name: 'كرة قدم', value: events.filter(e => e.category === 'football').length, color: '#3B82F6' },\n                            { name: 'كرة سلة', value: events.filter(e => e.category === 'basketball').length, color: '#F97316' },\n                            { name: 'ماراثون', value: events.filter(e => e.category === 'marathon').length, color: '#22C55E' },\n                            { name: 'عائلي', value: events.filter(e => e.category === 'family').length, color: '#A855F7' },\n                          ].filter(d => d.value > 0).map((entry, index) => (\n                            <Cell key={`cell-${index}`} fill={entry.color} />\n                          ))}\n                        </Pie>\n                        <Tooltip />\n                        <Legend />\n                      </PieChart>\n                    </ResponsiveContainer>\n                  </div>\n                </CardContent>\n              </Card>\n\n              {/* Overview Bar Chart */}\n              <Card data-testid=\"chart-overview\">\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <BarChart3 className=\"h-5 w-5\" />\n                    نظرة عامة على النظام\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"h-[300px]\">\n                    <ResponsiveContainer width=\"100%\" height=\"100%\">\n                      <BarChart\n                        data={[\n                          { name: 'الفعاليات', value: events.length, fill: '#3B82F6' },\n                          { name: 'البطولات', value: tournamentsList.length, fill: '#F97316' },\n                          { name: 'المستخدمين', value: allUsers.length, fill: '#22C55E' },\n                          { name: 'الأخبار', value: news.length, fill: '#A855F7' },\n                        ]}\n                        margin={{ top: 20, right: 30, left: 20, bottom: 5 }}\n                      >\n                        <CartesianGrid strokeDasharray=\"3 3\" />\n                        <XAxis dataKey=\"name\" />\n                        <YAxis />\n                        <Tooltip />\n                        <Bar dataKey=\"value\" radius={[4, 4, 0, 0]}>\n                          {[\n                            { name: 'الفعاليات', value: events.length, fill: '#3B82F6' },\n                            { name: 'البطولات', value: tournamentsList.length, fill: '#F97316' },\n                            { name: 'المستخدمين', value: allUsers.length, fill: '#22C55E' },\n                            { name: 'الأخبار', value: news.length, fill: '#A855F7' },\n                          ].map((entry, index) => (\n                            <Cell key={`cell-${index}`} fill={entry.fill} />\n                          ))}\n                        </Bar>\n                      </BarChart>\n                    </ResponsiveContainer>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Quick Stats Cards */}\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n              <Card data-testid=\"stat-tournaments\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center\">\n                      <Target className=\"h-6 w-6 text-orange-600\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">البطولات النشطة</p>\n                      <p className=\"text-2xl font-bold\">{tournamentsList.filter(t => t.status === 'ongoing' || t.status === 'registration').length}</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card data-testid=\"stat-users\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center\">\n                      <Users className=\"h-6 w-6 text-green-600\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">إجمالي المستخدمين</p>\n                      <p className=\"text-2xl font-bold\">{allUsers.length}</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n              <Card data-testid=\"stat-news\">\n                <CardContent className=\"p-6\">\n                  <div className=\"flex items-center gap-4\">\n                    <div className=\"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 rounded-full flex items-center justify-center\">\n                      <Newspaper className=\"h-6 w-6 text-purple-600\" />\n                    </div>\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">الأخبار المنشورة</p>\n                      <p className=\"text-2xl font-bold\">{news.length}</p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            </div>\n\n            {/* Recent Activity */}\n            <Card>\n              <CardHeader>\n                <CardTitle>آخر الفعاليات</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"space-y-4\">\n                  {events.slice(0, 5).map((event) => (\n                    <div key={event.id} className=\"flex items-center justify-between border-b pb-2\">\n                      <div>\n                        <p className=\"font-medium\">{event.title}</p>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {new Date(event.date).toLocaleDateString('ar-SA')}\n                        </p>\n                      </div>\n                      <Badge variant=\"outline\">\n                        {event.currentParticipants || 0} مشارك\n                      </Badge>\n                    </div>\n                  ))}\n                  {events.length === 0 && (\n                    <p className=\"text-center text-muted-foreground py-4\">لا توجد فعاليات بعد</p>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* Events Tab */}\n          <TabsContent value=\"events\" className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold\">إدارة الفعاليات</h2>\n              <AddEventDialog />\n            </div>\n            <div className=\"grid gap-4\">\n              {events.map((event) => (\n                <Card key={event.id} data-testid={`admin-event-${event.id}`}>\n                  <CardContent className=\"flex items-center justify-between p-4\">\n                    <div className=\"flex-1\">\n                      <h3 className=\"font-medium\">{event.title}</h3>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {new Date(event.date).toLocaleDateString('ar-SA')} - {event.location}\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Badge variant=\"outline\">\n                        {event.currentParticipants || 0} / {event.maxParticipants || \"∞\"}\n                      </Badge>\n                      <Badge>{event.status}</Badge>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </TabsContent>\n\n          {/* Tournaments Tab */}\n          <TabsContent value=\"tournaments\" className=\"space-y-6\">\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Target className=\"h-5 w-5\" />\n                  إدارة البطولات\n                </CardTitle>\n                <Dialog>\n                  <DialogTrigger asChild>\n                    <Button data-testid=\"button-add-tournament\">\n                      <Plus className=\"h-4 w-4 ml-2\" />\n                      إضافة بطولة\n                    </Button>\n                  </DialogTrigger>\n                  <DialogContent className=\"max-w-2xl\" dir=\"rtl\">\n                    <DialogHeader>\n                      <DialogTitle>إضافة بطولة جديدة</DialogTitle>\n                    </DialogHeader>\n                    <AddTournamentForm onSuccess={() => queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] })} />\n                  </DialogContent>\n                </Dialog>\n              </CardHeader>\n              <CardContent>\n                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                  {tournamentsList.map((t) => (\n                    <Card key={t.id} className=\"hover-elevate\" data-testid={`card-admin-tournament-${t.id}`}>\n                      <CardContent className=\"p-4\">\n                        <div className=\"flex items-center gap-3 mb-3\">\n                          <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\n                            <Target className=\"h-6 w-6 text-primary\" />\n                          </div>\n                          <div>\n                            <h4 className=\"font-bold\">{t.name}</h4>\n                            <Badge \n                              className={\n                                t.status === \"registration\" ? \"bg-emerald-500\" :\n                                t.status === \"ongoing\" ? \"bg-orange-500\" : \"bg-gray-500\"\n                              }\n                            >\n                              {t.status === \"registration\" ? \"التسجيل مفتوح\" :\n                               t.status === \"ongoing\" ? \"جارية\" : \"منتهية\"}\n                            </Badge>\n                          </div>\n                        </div>\n                        <p className=\"text-sm text-muted-foreground line-clamp-2 mb-3\">{t.description}</p>\n                        <div className=\"flex gap-2\">\n                          <Button \n                            variant=\"outline\" \n                            size=\"sm\" \n                            className=\"flex-1\"\n                            onClick={() => window.open(`/leagues/${t.id}`, '_blank')}\n                            data-testid={`button-view-${t.id}`}\n                          >\n                            عرض\n                          </Button>\n                          <Button \n                            variant=\"default\" \n                            size=\"sm\" \n                            className=\"flex-1\"\n                            onClick={() => navigate(`/admin/tournaments/${t.id}/edit`)}\n                            data-testid={`button-edit-tournament-${t.id}`}\n                          >\n                            <Pencil className=\"h-4 w-4 ml-1\" />\n                            تعديل\n                          </Button>\n                          {t.hasGroupStage && t.status === \"registration\" && (\n                            <Button \n                              variant=\"secondary\" \n                              size=\"icon\"\n                              onClick={() => {\n                                setDrawTournament(t);\n                                setDrawGroups(t.numberOfGroups || 2);\n                              }}\n                              data-testid={`button-draw-${t.id}`}\n                              title=\"قرعة عشوائية\"\n                            >\n                              <Shuffle className=\"h-4 w-4\" />\n                            </Button>\n                          )}\n                          <Button \n                            variant=\"destructive\" \n                            size=\"icon\"\n                            onClick={() => setTournamentToDelete(t)}\n                            data-testid={`button-delete-tournament-${t.id}`}\n                          >\n                            <Trash2 className=\"h-4 w-4\" />\n                          </Button>\n                        </div>\n                      </CardContent>\n                    </Card>\n                  ))}\n                  {tournamentsList.length === 0 && (\n                    <div className=\"col-span-full text-center py-8 text-muted-foreground\">\n                      <Target className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                      <p>لا توجد بطولات بعد</p>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n\n            {/* Delete Tournament Confirmation Dialog */}\n            <AlertDialog open={!!tournamentToDelete} onOpenChange={(open) => !open && setTournamentToDelete(null)}>\n              <AlertDialogContent dir=\"rtl\">\n                <AlertDialogHeader>\n                  <AlertDialogTitle>تأكيد حذف البطولة</AlertDialogTitle>\n                  <AlertDialogDescription>\n                    هل أنت متأكد من حذف بطولة \"{tournamentToDelete?.name}\"؟ \n                    سيتم حذف جميع البيانات المرتبطة بها (الفرق، المباريات، النتائج).\n                    هذا الإجراء لا يمكن التراجع عنه.\n                  </AlertDialogDescription>\n                </AlertDialogHeader>\n                <AlertDialogFooter className=\"flex-row-reverse gap-2\">\n                  <AlertDialogCancel data-testid=\"button-cancel-delete\">إلغاء</AlertDialogCancel>\n                  <AlertDialogAction\n                    className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                    onClick={() => {\n                      if (tournamentToDelete) {\n                        deleteTournamentMutation.mutate(tournamentToDelete.id);\n                        setTournamentToDelete(null);\n                      }\n                    }}\n                    data-testid=\"button-confirm-delete\"\n                  >\n                    {deleteTournamentMutation.isPending ? (\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\n                    ) : (\n                      <>\n                        <Trash2 className=\"h-4 w-4 ml-2\" />\n                        حذف\n                      </>\n                    )}\n                  </AlertDialogAction>\n                </AlertDialogFooter>\n              </AlertDialogContent>\n            </AlertDialog>\n\n            {/* Random Draw Dialog */}\n            <Dialog open={!!drawTournament} onOpenChange={(open) => !open && setDrawTournament(null)}>\n              <DialogContent dir=\"rtl\" className=\"sm:max-w-md\">\n                <DialogHeader>\n                  <DialogTitle className=\"flex items-center gap-2\">\n                    <Shuffle className=\"h-5 w-5 text-primary\" />\n                    القرعة العشوائية\n                  </DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4 py-4\">\n                  <p className=\"text-muted-foreground text-sm\">\n                    سيتم توزيع الفرق المسجلة في \"{drawTournament?.name}\" على المجموعات بشكل عشوائي.\n                  </p>\n                  <div className=\"space-y-2\">\n                    <Label htmlFor=\"drawGroups\">عدد المجموعات</Label>\n                    <Select\n                      value={drawGroups.toString()}\n                      onValueChange={(val) => setDrawGroups(parseInt(val))}\n                    >\n                      <SelectTrigger id=\"drawGroups\" data-testid=\"select-draw-groups\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"2\">مجموعتان (2)</SelectItem>\n                        <SelectItem value=\"4\">4 مجموعات</SelectItem>\n                        <SelectItem value=\"6\">6 مجموعات</SelectItem>\n                        <SelectItem value=\"8\">8 مجموعات</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"flex gap-2 pt-4\">\n                    <Button\n                      variant=\"outline\"\n                      className=\"flex-1\"\n                      onClick={() => setDrawTournament(null)}\n                      data-testid=\"button-cancel-draw\"\n                    >\n                      إلغاء\n                    </Button>\n                    <Button\n                      className=\"flex-1\"\n                      onClick={() => {\n                        if (drawTournament) {\n                          randomDrawMutation.mutate({\n                            tournamentId: drawTournament.id,\n                            numberOfGroups: drawGroups\n                          });\n                        }\n                      }}\n                      disabled={randomDrawMutation.isPending}\n                      data-testid=\"button-confirm-draw\"\n                    >\n                      {randomDrawMutation.isPending ? (\n                        <Loader2 className=\"h-4 w-4 animate-spin ml-2\" />\n                      ) : (\n                        <Shuffle className=\"h-4 w-4 ml-2\" />\n                      )}\n                      إجراء القرعة\n                    </Button>\n                  </div>\n                </div>\n              </DialogContent>\n            </Dialog>\n          </TabsContent>\n\n          {/* Matches Tab */}\n          <TabsContent value=\"matches\" className=\"space-y-6\">\n            <Card>\n              <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Trophy className=\"h-5 w-5\" />\n                  إدارة نتائج المباريات\n                </CardTitle>\n                <Select\n                  value={selectedTournamentId}\n                  onValueChange={setSelectedTournamentId}\n                >\n                  <SelectTrigger className=\"w-[250px]\" data-testid=\"select-tournament-matches\">\n                    <SelectValue placeholder=\"اختر البطولة\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    {tournamentsList.map((t) => (\n                      <SelectItem key={t.id} value={t.id}>{t.name}</SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </CardHeader>\n              <CardContent>\n                {!selectedTournamentId ? (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Trophy className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>اختر بطولة لعرض مبارياتها</p>\n                  </div>\n                ) : matchesLoading ? (\n                  <div className=\"flex justify-center py-8\">\n                    <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n                  </div>\n                ) : matchesList.length === 0 ? (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Trophy className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>لا توجد مباريات في هذه البطولة</p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-4\">\n                    {matchesList.map((match) => {\n                      const isCompleted = match.status === \"completed\";\n                      const isLive = match.status === \"live\";\n                      const homeWon = isCompleted && (match.homeScore ?? 0) > (match.awayScore ?? 0);\n                      const awayWon = isCompleted && (match.awayScore ?? 0) > (match.homeScore ?? 0);\n                      \n                      return (\n                        <Card key={match.id} className={`hover-elevate ${isLive ? \"ring-2 ring-red-500\" : \"\"}`} data-testid={`card-match-${match.id}`}>\n                          <CardContent className=\"p-4\">\n                            <div className=\"flex items-center justify-between gap-4\">\n                              <div className=\"flex items-center gap-3 flex-1\">\n                                <TeamBox \n                                  team={match.homeTeam}\n                                  showLogo={true}\n                                  isWinner={homeWon}\n                                  size=\"md\"\n                                />\n                                \n                                <div className=\"flex flex-col items-center px-3\">\n                                  {isLive && <Badge className=\"bg-red-500 animate-pulse text-xs mb-1\">مباشر</Badge>}\n                                  <InlineScoreEditor\n                                    match={match}\n                                    onSave={(data) => updateMatchMutation.mutate({ matchId: match.id, data })}\n                                    isPending={updateMatchMutation.isPending}\n                                  />\n                                </div>\n                                \n                                <TeamBox \n                                  team={match.awayTeam}\n                                  showLogo={true}\n                                  isWinner={awayWon}\n                                  size=\"md\"\n                                />\n                              </div>\n                              \n                              <div className=\"flex items-center gap-3\">\n                                <div className=\"text-left\">\n                                  <Badge\n                                    className={\n                                      match.status === \"completed\" ? \"bg-green-500\" :\n                                      match.status === \"live\" ? \"bg-red-500\" :\n                                      match.status === \"postponed\" ? \"bg-yellow-500\" : \"bg-gray-500\"\n                                    }\n                                  >\n                                    {match.status === \"completed\" ? \"انتهت\" :\n                                     match.status === \"live\" ? \"مباشر\" :\n                                     match.status === \"postponed\" ? \"مؤجلة\" : \"مقررة\"}\n                                  </Badge>\n                                  <p className=\"text-xs text-muted-foreground mt-1\">\n                                    الجولة {match.round}\n                                  </p>\n                                </div>\n                                <EditMatchDialog\n                                  match={match}\n                                  onSave={(data) => updateMatchMutation.mutate({ matchId: match.id, data })}\n                                  isPending={updateMatchMutation.isPending}\n                                />\n                              </div>\n                            </div>\n                            {match.matchDate && (\n                              <p className=\"text-xs text-muted-foreground mt-2\">\n                                {new Date(match.matchDate).toLocaleDateString('ar-SA')} - {match.venue || \"غير محدد\"}\n                              </p>\n                            )}\n                          </CardContent>\n                        </Card>\n                      );\n                    })}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          {/* News Tab */}\n          <TabsContent value=\"news\" className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold\">إدارة الأخبار</h2>\n              <AddNewsDialog />\n            </div>\n            <div className=\"grid gap-4\">\n              {news.map((item) => (\n                <Card key={item.id} data-testid={`admin-news-${item.id}`}>\n                  <CardContent className=\"flex items-center justify-between p-4\">\n                    <div className=\"flex-1\">\n                      <h3 className=\"font-medium\">{item.title}</h3>\n                      <p className=\"text-sm text-muted-foreground line-clamp-1\">\n                        {item.content}\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <p className=\"text-sm text-muted-foreground\">\n                        {new Date(item.date).toLocaleDateString('ar-SA')}\n                      </p>\n                      <Badge variant=\"outline\">{item.category}</Badge>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </TabsContent>\n\n          {/* Results Tab */}\n          <TabsContent value=\"results\" className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold\">إدارة النتائج</h2>\n              <AddResultDialog />\n            </div>\n            <div className=\"grid gap-4\">\n              {results.map((result) => (\n                <Card key={result.id} data-testid={`admin-result-${result.id}`}>\n                  <CardContent className=\"flex items-center justify-between p-4\">\n                    <div className=\"flex-1\">\n                      <h3 className=\"font-medium\">{result.tournamentName}</h3>\n                      <p className=\"text-sm text-muted-foreground\">\n                        الفائز: {result.winner}\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <p className=\"text-sm text-muted-foreground\">\n                        {new Date(result.date).toLocaleDateString('ar-SA')}\n                      </p>\n                      <Badge variant=\"outline\">{result.category}</Badge>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </TabsContent>\n\n          {/* Gallery Tab */}\n          <TabsContent value=\"gallery\" className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold\">إدارة المعرض</h2>\n              <AddGalleryDialog />\n            </div>\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {gallery.map((item) => (\n                <Card key={item.id} data-testid={`admin-gallery-${item.id}`}>\n                  <div className=\"h-40 overflow-hidden\">\n                    {item.imageUrl && (\n                      <img\n                        src={item.imageUrl}\n                        alt={item.title}\n                        className=\"w-full h-full object-cover\"\n                      />\n                    )}\n                  </div>\n                  <CardContent className=\"p-4\">\n                    <h3 className=\"font-medium\">{item.title}</h3>\n                    <p className=\"text-sm text-muted-foreground\">{item.description}</p>\n                    <div className=\"flex items-center justify-between mt-2\">\n                      <Badge variant=\"outline\">{item.category}</Badge>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {item.eventDate ? new Date(item.eventDate).toLocaleDateString('ar-SA') : ''}\n                      </span>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </TabsContent>\n\n          {/* Users Tab */}\n          <TabsContent value=\"users\" className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold\">إدارة المستخدمين</h2>\n              <Badge variant=\"outline\">{allUsers.length} مستخدم</Badge>\n            </div>\n            <div className=\"grid gap-4\">\n              {allUsers.map((userItem) => (\n                <Card key={userItem.id} data-testid={`admin-user-${userItem.id}`}>\n                  <CardContent className=\"flex items-center justify-between p-4\">\n                    <div className=\"flex-1\">\n                      <h3 className=\"font-medium\">{userItem.fullName}</h3>\n                      <p className=\"text-sm text-muted-foreground\">\n                        {userItem.department} - {userItem.position}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground\">\n                        {userItem.email} | رقم الموظف: {userItem.employeeId}\n                      </p>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Select\n                        value={userItem.role}\n                        onValueChange={(role) => updateRoleMutation.mutate({ userId: userItem.id, role })}\n                        disabled={updateRoleMutation.isPending || userItem.id === user?.id}\n                      >\n                        <SelectTrigger className=\"w-[140px]\" data-testid={`select-role-${userItem.id}`}>\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"employee\">موظف</SelectItem>\n                          <SelectItem value=\"committee_member\">عضو لجنة</SelectItem>\n                          <SelectItem value=\"admin\">مدير</SelectItem>\n                        </SelectContent>\n                      </Select>\n                      <Button\n                        variant={userItem.isActive ? \"destructive\" : \"default\"}\n                        size=\"sm\"\n                        onClick={() => updateStatusMutation.mutate({ userId: userItem.id, isActive: !userItem.isActive })}\n                        disabled={updateStatusMutation.isPending || userItem.id === user?.id}\n                        data-testid={`toggle-status-${userItem.id}`}\n                      >\n                        {userItem.isActive ? \"تعطيل\" : \"تفعيل\"}\n                      </Button>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          </TabsContent>\n\n          {/* Settings Tab */}\n          <TabsContent value=\"settings\" className=\"space-y-6\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold\">إعدادات الموقع</h2>\n            </div>\n            \n            {/* Hero Image Settings */}\n            <Card data-testid=\"card-hero-settings\">\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <ImageIcon className=\"h-5 w-5\" />\n                  صورة الصفحة الرئيسية\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {/* Current Image Preview */}\n                <div className=\"space-y-2\">\n                  <Label>الصورة الحالية</Label>\n                  <div className=\"relative aspect-video w-full max-w-2xl overflow-hidden rounded-lg border\">\n                    <img\n                      src={heroImagePreview || heroSetting?.value || \"/attached_assets/WhatsApp_Image_2025-12-14_at_1.09.59_AM_1765663609189.jpg\"}\n                      alt=\"صورة الصفحة الرئيسية\"\n                      className=\"w-full h-full object-cover\"\n                      data-testid=\"img-hero-preview\"\n                    />\n                  </div>\n                </div>\n\n                {/* Upload New Image */}\n                <div className=\"space-y-2\">\n                  <Label>رفع صورة جديدة</Label>\n                  <div className=\"flex items-center gap-4\">\n                    <input\n                      type=\"file\"\n                      accept=\"image/*\"\n                      className=\"hidden\"\n                      ref={heroFileInputRef}\n                      onChange={handleHeroFileChange}\n                      data-testid=\"input-hero-file\"\n                    />\n                    <Button\n                      type=\"button\"\n                      variant=\"outline\"\n                      onClick={() => heroFileInputRef.current?.click()}\n                      disabled={uploadHeroImageMutation.isPending}\n                      data-testid=\"button-upload-hero\"\n                    >\n                      {uploadHeroImageMutation.isPending ? (\n                        <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                      ) : (\n                        <Upload className=\"h-4 w-4 ml-2\" />\n                      )}\n                      اختيار صورة\n                    </Button>\n                    {heroImagePreview && (\n                      <Badge variant=\"outline\" className=\"text-success\">\n                        تم رفع الصورة - جاهزة للحفظ\n                      </Badge>\n                    )}\n                  </div>\n                </div>\n\n                {/* Save Button */}\n                {heroImagePreview && (\n                  <Button\n                    onClick={saveHeroImage}\n                    disabled={updateHeroImageMutation.isPending}\n                    className=\"w-full sm:w-auto\"\n                    data-testid=\"button-save-hero\"\n                  >\n                    {updateHeroImageMutation.isPending ? (\n                      <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                    ) : null}\n                    حفظ الصورة\n                  </Button>\n                )}\n\n                <p className=\"text-sm text-muted-foreground\">\n                  يفضل استخدام صورة بحجم 1920x600 بكسل للحصول على أفضل عرض\n                </p>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n\nfunction AddEventDialog() {\n  const [open, setOpen] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const [formData, setFormData] = useState({\n    title: \"\",\n    description: \"\",\n    category: \"football\",\n    date: \"\",\n    location: \"\",\n    maxParticipants: \"\",\n    requirements: \"\",\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/events\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تمت الإضافة\", description: \"تم إضافة الفعالية بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/events\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n      setOpen(false);\n      setFormData({\n        title: \"\",\n        description: \"\",\n        category: \"football\",\n        date: \"\",\n        location: \"\",\n        maxParticipants: \"\",\n        requirements: \"\",\n      });\n    },\n    onError: () => {\n      toast({ title: \"فشلت الإضافة\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      ...formData,\n      date: new Date(formData.date),\n      maxParticipants: formData.maxParticipants ? parseInt(formData.maxParticipants) : null,\n      imageUrl: \"/assets/football.png\",\n      status: \"upcoming\",\n    });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button data-testid=\"button-add-event\">\n          <Plus className=\"h-4 w-4 ml-2\" />\n          إضافة فعالية\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle>إضافة فعالية جديدة</DialogTitle>\n        </DialogHeader>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <Label>عنوان الفعالية</Label>\n            <Input\n              value={formData.title}\n              onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>الوصف</Label>\n            <Textarea\n              value={formData.description}\n              onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>النوع</Label>\n            <Select\n              value={formData.category}\n              onValueChange={(value) => setFormData({ ...formData, category: value })}\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"football\">كرة قدم</SelectItem>\n                <SelectItem value=\"basketball\">كرة سلة</SelectItem>\n                <SelectItem value=\"marathon\">ماراثون</SelectItem>\n                <SelectItem value=\"family\">عائلي</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          <div>\n            <Label>التاريخ والوقت</Label>\n            <Input\n              type=\"datetime-local\"\n              value={formData.date}\n              onChange={(e) => setFormData({ ...formData, date: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>المكان</Label>\n            <Input\n              value={formData.location}\n              onChange={(e) => setFormData({ ...formData, location: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>الحد الأقصى للمشاركين</Label>\n            <Input\n              type=\"number\"\n              value={formData.maxParticipants}\n              onChange={(e) => setFormData({ ...formData, maxParticipants: e.target.value })}\n            />\n          </div>\n          <div>\n            <Label>الشروط</Label>\n            <Textarea\n              value={formData.requirements}\n              onChange={(e) => setFormData({ ...formData, requirements: e.target.value })}\n            />\n          </div>\n          <Button type=\"submit\" className=\"w-full\" disabled={mutation.isPending}>\n            {mutation.isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"إضافة\"}\n          </Button>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction AddNewsDialog() {\n  const [open, setOpen] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const [formData, setFormData] = useState({\n    title: \"\",\n    content: \"\",\n    category: \"announcement\",\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/news\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تمت الإضافة\", description: \"تم إضافة الخبر بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/news\"] });\n      setOpen(false);\n      setFormData({ title: \"\", content: \"\", category: \"announcement\" });\n    },\n    onError: () => {\n      toast({ title: \"فشلت الإضافة\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({ ...formData, date: new Date() });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button data-testid=\"button-add-news\">\n          <Plus className=\"h-4 w-4 ml-2\" />\n          إضافة خبر\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle>إضافة خبر جديد</DialogTitle>\n        </DialogHeader>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <Label>العنوان</Label>\n            <Input\n              value={formData.title}\n              onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>المحتوى</Label>\n            <Textarea\n              value={formData.content}\n              onChange={(e) => setFormData({ ...formData, content: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>النوع</Label>\n            <Select\n              value={formData.category}\n              onValueChange={(value) => setFormData({ ...formData, category: value })}\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"announcement\">إعلان</SelectItem>\n                <SelectItem value=\"result\">نتيجة</SelectItem>\n                <SelectItem value=\"achievement\">إنجاز</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          <Button type=\"submit\" className=\"w-full\" disabled={mutation.isPending}>\n            {mutation.isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"إضافة\"}\n          </Button>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction AddResultDialog() {\n  const [open, setOpen] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const [formData, setFormData] = useState({\n    tournamentName: \"\",\n    winner: \"\",\n    runnerUp: \"\",\n    thirdPlace: \"\",\n    category: \"football\",\n    date: \"\",\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/results\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تمت الإضافة\", description: \"تم إضافة النتيجة بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/results\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n      setOpen(false);\n      setFormData({\n        tournamentName: \"\",\n        winner: \"\",\n        runnerUp: \"\",\n        thirdPlace: \"\",\n        category: \"football\",\n        date: \"\",\n      });\n    },\n    onError: () => {\n      toast({ title: \"فشلت الإضافة\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      ...formData,\n      date: new Date(formData.date),\n    });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button data-testid=\"button-add-result\">\n          <Plus className=\"h-4 w-4 ml-2\" />\n          إضافة نتيجة\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle>إضافة نتيجة جديدة</DialogTitle>\n        </DialogHeader>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <Label>اسم البطولة</Label>\n            <Input\n              value={formData.tournamentName}\n              onChange={(e) => setFormData({ ...formData, tournamentName: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>الفائز (المركز الأول)</Label>\n            <Input\n              value={formData.winner}\n              onChange={(e) => setFormData({ ...formData, winner: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>المركز الثاني</Label>\n            <Input\n              value={formData.runnerUp}\n              onChange={(e) => setFormData({ ...formData, runnerUp: e.target.value })}\n            />\n          </div>\n          <div>\n            <Label>المركز الثالث</Label>\n            <Input\n              value={formData.thirdPlace}\n              onChange={(e) => setFormData({ ...formData, thirdPlace: e.target.value })}\n            />\n          </div>\n          <div>\n            <Label>النوع</Label>\n            <Select\n              value={formData.category}\n              onValueChange={(value) => setFormData({ ...formData, category: value })}\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"football\">كرة قدم</SelectItem>\n                <SelectItem value=\"basketball\">كرة سلة</SelectItem>\n                <SelectItem value=\"marathon\">ماراثون</SelectItem>\n                <SelectItem value=\"family\">عائلي</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          <div>\n            <Label>التاريخ</Label>\n            <Input\n              type=\"date\"\n              value={formData.date}\n              onChange={(e) => setFormData({ ...formData, date: e.target.value })}\n              required\n            />\n          </div>\n          <Button type=\"submit\" className=\"w-full\" disabled={mutation.isPending}>\n            {mutation.isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"إضافة\"}\n          </Button>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction AddGalleryDialog() {\n  const [open, setOpen] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const [formData, setFormData] = useState({\n    title: \"\",\n    description: \"\",\n    category: \"football\",\n    imageUrl: \"\",\n    eventDate: \"\",\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/gallery\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تمت الإضافة\", description: \"تم إضافة الصورة بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/gallery\"] });\n      setOpen(false);\n      setFormData({ title: \"\", description: \"\", category: \"football\", imageUrl: \"\", eventDate: \"\" });\n    },\n    onError: () => {\n      toast({ title: \"فشلت الإضافة\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      ...formData,\n      eventDate: formData.eventDate ? new Date(formData.eventDate) : new Date(),\n    });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button data-testid=\"button-add-gallery\">\n          <Plus className=\"h-4 w-4 ml-2\" />\n          إضافة صورة\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-md\">\n        <DialogHeader>\n          <DialogTitle>إضافة صورة جديدة</DialogTitle>\n        </DialogHeader>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <Label>العنوان</Label>\n            <Input\n              value={formData.title}\n              onChange={(e) => setFormData({ ...formData, title: e.target.value })}\n              required\n            />\n          </div>\n          <div>\n            <Label>الوصف</Label>\n            <Textarea\n              value={formData.description}\n              onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n            />\n          </div>\n          <div>\n            <Label>رابط الصورة</Label>\n            <Input\n              value={formData.imageUrl}\n              onChange={(e) => setFormData({ ...formData, imageUrl: e.target.value })}\n              placeholder=\"https://example.com/image.jpg\"\n            />\n          </div>\n          <div>\n            <Label>النوع</Label>\n            <Select\n              value={formData.category}\n              onValueChange={(value) => setFormData({ ...formData, category: value })}\n            >\n              <SelectTrigger>\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"football\">كرة قدم</SelectItem>\n                <SelectItem value=\"basketball\">كرة سلة</SelectItem>\n                <SelectItem value=\"marathon\">ماراثون</SelectItem>\n                <SelectItem value=\"family\">عائلي</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          <div>\n            <Label>التاريخ</Label>\n            <Input\n              type=\"date\"\n              value={formData.eventDate}\n              onChange={(e) => setFormData({ ...formData, eventDate: e.target.value })}\n            />\n          </div>\n          <Button type=\"submit\" className=\"w-full\" disabled={mutation.isPending}>\n            {mutation.isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"إضافة\"}\n          </Button>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction AddTournamentForm({ onSuccess }: { onSuccess: () => void }) {\n  const { toast } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [imagePreview, setImagePreview] = useState<string | null>(null);\n  const [isUploading, setIsUploading] = useState(false);\n  \n  const [formData, setFormData] = useState({\n    name: \"\",\n    description: \"\",\n    sport: \"football\",\n    type: \"groups\",\n    tournamentStructure: \"team\", // team, individual\n    startDate: \"\",\n    endDate: \"\",\n    maxTeams: \"8\",\n    numberOfGroups: \"2\",\n    numberOfVenues: \"1\",\n    excludedDays: [] as string[],\n    venues: \"\",\n    imageUrl: \"\",\n    phoneNumber: \"\",\n    address: \"\",\n    policy: \"public\",\n    pointsForWin: \"3\",\n    pointsForDraw: \"1\",\n    pointsForLoss: \"0\",\n    numberOfRounds: \"1\",\n    halfDuration: \"45\",\n    breakBetweenHalves: \"15\",\n    isOpenForRegistration: true,\n    dailyStartTime: \"16:00\",\n    matchesPerDayPerVenue: \"3\",\n  });\n\n  const groupCountOptions = [2, 3, 4, 5, 6, 8, 10, 12, 16];\n  const daysOfWeek = [\n    { value: \"friday\", label: \"الجمعة\" },\n    { value: \"saturday\", label: \"السبت\" },\n    { value: \"sunday\", label: \"الأحد\" },\n    { value: \"monday\", label: \"الاثنين\" },\n    { value: \"tuesday\", label: \"الثلاثاء\" },\n    { value: \"wednesday\", label: \"الأربعاء\" },\n    { value: \"thursday\", label: \"الخميس\" },\n  ];\n\n  const toggleExcludedDay = (day: string) => {\n    setFormData(prev => ({\n      ...prev,\n      excludedDays: prev.excludedDays.includes(day)\n        ? prev.excludedDays.filter(d => d !== day)\n        : [...prev.excludedDays, day]\n    }));\n  };\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    const reader = new FileReader();\n    reader.onload = (e) => {\n      setImagePreview(e.target?.result as string);\n    };\n    reader.readAsDataURL(file);\n\n    setIsUploading(true);\n    const uploadFormData = new FormData();\n    uploadFormData.append(\"file\", file);\n\n    try {\n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: uploadFormData,\n      });\n      const data = await response.json();\n      if (data.url) {\n        setFormData((prev) => ({ ...prev, imageUrl: data.url }));\n        toast({ title: \"تم رفع الصورة بنجاح\" });\n      }\n    } catch {\n      toast({ title: \"فشل رفع الصورة\", variant: \"destructive\" });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", \"/api/tournaments\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تمت الإضافة\", description: \"تم إضافة البطولة بنجاح\" });\n      onSuccess();\n      setFormData({\n        name: \"\",\n        description: \"\",\n        sport: \"football\",\n        type: \"groups\",\n        tournamentStructure: \"team\",\n        startDate: \"\",\n        endDate: \"\",\n        maxTeams: \"8\",\n        numberOfGroups: \"2\",\n        numberOfVenues: \"1\",\n        excludedDays: [],\n        venues: \"\",\n        imageUrl: \"\",\n        phoneNumber: \"\",\n        address: \"\",\n        policy: \"public\",\n        pointsForWin: \"3\",\n        pointsForDraw: \"1\",\n        pointsForLoss: \"0\",\n        numberOfRounds: \"1\",\n        halfDuration: \"45\",\n        breakBetweenHalves: \"15\",\n        isOpenForRegistration: true,\n        dailyStartTime: \"16:00\",\n        matchesPerDayPerVenue: \"3\",\n      });\n      setImagePreview(null);\n    },\n    onError: () => {\n      toast({ title: \"فشلت الإضافة\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    const submitData: any = {\n      name: formData.name,\n      description: formData.description || undefined,\n      sport: formData.sport,\n      type: formData.type,\n      tournamentStructure: formData.tournamentStructure,\n      maxTeams: parseInt(formData.maxTeams) || 8,\n      numberOfGroups: parseInt(formData.numberOfGroups) || 2,\n      numberOfVenues: parseInt(formData.numberOfVenues) || 1,\n      excludedDays: formData.excludedDays.length > 0 ? formData.excludedDays : undefined,\n      status: \"registration\",\n      imageUrl: formData.imageUrl || undefined,\n      phoneNumber: formData.phoneNumber || undefined,\n      address: formData.address || undefined,\n      policy: formData.policy,\n      pointsForWin: parseInt(formData.pointsForWin) || 3,\n      pointsForDraw: parseInt(formData.pointsForDraw) || 1,\n      pointsForLoss: parseInt(formData.pointsForLoss) || 0,\n      numberOfRounds: parseInt(formData.numberOfRounds) || 1,\n      halfDuration: parseInt(formData.halfDuration) || 45,\n      breakBetweenHalves: parseInt(formData.breakBetweenHalves) || 15,\n      isOpenForRegistration: formData.isOpenForRegistration,\n      hasGroupStage: formData.type === \"groups\" || formData.type === \"groups_knockout\",\n      scheduleConfig: JSON.stringify({\n        dailyStartTime: formData.dailyStartTime,\n        matchesPerDayPerVenue: parseInt(formData.matchesPerDayPerVenue) || 3\n      }),\n    };\n    \n    if (formData.startDate) {\n      submitData.startDate = new Date(formData.startDate).toISOString();\n    }\n    if (formData.endDate) {\n      submitData.endDate = new Date(formData.endDate).toISOString();\n    }\n    if (formData.venues) {\n      submitData.venues = formData.venues.split(\"،\").map((v: string) => v.trim()).filter((v: string) => v);\n    }\n    \n    mutation.mutate(submitData);\n  };\n\n  return (\n    <form onSubmit={handleSubmit} className=\"space-y-4 max-h-[70vh] overflow-y-auto px-1\">\n      {/* صورة الدوري */}\n      <div>\n        <Label className=\"flex items-center gap-2 mb-2\">\n          <ImageIcon className=\"h-4 w-4\" />\n          صورة الدوري\n        </Label>\n        <div \n          className=\"border-2 border-dashed rounded-lg p-4 text-center cursor-pointer hover:border-primary transition-colors\"\n          onClick={() => fileInputRef.current?.click()}\n        >\n          {imagePreview ? (\n            <div className=\"relative\">\n              <img src={imagePreview} alt=\"معاينة\" className=\"w-full h-32 object-cover rounded-md\" />\n              {isUploading && (\n                <div className=\"absolute inset-0 bg-black/50 flex items-center justify-center rounded-md\">\n                  <Loader2 className=\"h-6 w-6 animate-spin text-white\" />\n                </div>\n              )}\n            </div>\n          ) : (\n            <div className=\"py-4\">\n              <Upload className=\"h-8 w-8 mx-auto text-muted-foreground mb-2\" />\n              <p className=\"text-sm text-muted-foreground\">اضغط لرفع صورة</p>\n            </div>\n          )}\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\"image/*\"\n            className=\"hidden\"\n            onChange={handleImageUpload}\n            data-testid=\"input-tournament-image\"\n          />\n        </div>\n      </div>\n\n      {/* اسم البطولة */}\n      <div>\n        <Label>اسم البطولة</Label>\n        <Input\n          value={formData.name}\n          onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n          placeholder=\"دوري كرة القدم 2025\"\n          required\n          data-testid=\"input-tournament-name\"\n        />\n      </div>\n\n      {/* معلومات الاتصال */}\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <Label className=\"flex items-center gap-2\">\n            <Phone className=\"h-4 w-4\" />\n            رقم الهاتف\n          </Label>\n          <Input\n            value={formData.phoneNumber}\n            onChange={(e) => setFormData({ ...formData, phoneNumber: e.target.value })}\n            placeholder=\"05xxxxxxxx\"\n            data-testid=\"input-phone-number\"\n          />\n        </div>\n        <div>\n          <Label>السياسة</Label>\n          <Select\n            value={formData.policy}\n            onValueChange={(value) => setFormData({ ...formData, policy: value })}\n          >\n            <SelectTrigger data-testid=\"select-policy\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"public\">عام</SelectItem>\n              <SelectItem value=\"private\">خاص</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n      </div>\n\n      {/* العنوان */}\n      <div>\n        <Label className=\"flex items-center gap-2\">\n          <MapPin className=\"h-4 w-4\" />\n          العنوان\n        </Label>\n        <Input\n          value={formData.address}\n          onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n          placeholder=\"مدينة/حي/شارع\"\n          data-testid=\"input-address\"\n        />\n      </div>\n\n      {/* الوصف */}\n      <div>\n        <Label>الوصف</Label>\n        <Textarea\n          value={formData.description}\n          onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n          placeholder=\"وصف البطولة وشروط المشاركة\"\n          data-testid=\"input-tournament-description\"\n        />\n      </div>\n\n      {/* نوع الدوري - فردي/فرقي */}\n      <div>\n        <Label className=\"text-base font-semibold mb-3 block\">نوع الدوري</Label>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div\n            onClick={() => setFormData({ ...formData, tournamentStructure: \"individual\" })}\n            className={`cursor-pointer rounded-xl p-4 border-2 transition-all ${\n              formData.tournamentStructure === \"individual\"\n                ? \"border-amber-500 bg-amber-50 dark:bg-amber-950/30\"\n                : \"border-border hover:border-amber-300\"\n            }`}\n            data-testid=\"card-structure-individual\"\n          >\n            <div className=\"flex flex-col items-center text-center gap-2\">\n              <div className={`w-12 h-12 rounded-full flex items-center justify-center ${\n                formData.tournamentStructure === \"individual\" \n                  ? \"bg-amber-500 text-white\" \n                  : \"bg-amber-100 dark:bg-amber-900/30 text-amber-600\"\n              }`}>\n                <UserIcon className=\"h-6 w-6\" />\n              </div>\n              <span className=\"font-bold\">فردي</span>\n              <span className=\"text-xs text-muted-foreground\">مسابقة فردية</span>\n            </div>\n          </div>\n          <div\n            onClick={() => setFormData({ ...formData, tournamentStructure: \"team\" })}\n            className={`cursor-pointer rounded-xl p-4 border-2 transition-all ${\n              formData.tournamentStructure === \"team\"\n                ? \"border-cyan-500 bg-cyan-50 dark:bg-cyan-950/30\"\n                : \"border-border hover:border-cyan-300\"\n            }`}\n            data-testid=\"card-structure-team\"\n          >\n            <div className=\"flex flex-col items-center text-center gap-2\">\n              <div className={`w-12 h-12 rounded-full flex items-center justify-center ${\n                formData.tournamentStructure === \"team\" \n                  ? \"bg-cyan-500 text-white\" \n                  : \"bg-cyan-100 dark:bg-cyan-900/30 text-cyan-600\"\n              }`}>\n                <Users className=\"h-6 w-6\" />\n              </div>\n              <span className=\"font-bold\">فرقي</span>\n              <span className=\"text-xs text-muted-foreground\">مسابقة بين الفرق</span>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* الرياضة ونوع البطولة */}\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <Label>الرياضة</Label>\n          <Select\n            value={formData.sport}\n            onValueChange={(value) => setFormData({ ...formData, sport: value })}\n          >\n            <SelectTrigger data-testid=\"select-sport\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"football\">كرة القدم</SelectItem>\n              <SelectItem value=\"basketball\">كرة السلة</SelectItem>\n              <SelectItem value=\"volleyball\">الكرة الطائرة</SelectItem>\n              <SelectItem value=\"tennis\">التنس</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n        <div>\n          <Label>نوع البطولة</Label>\n          <Select\n            value={formData.type}\n            onValueChange={(value) => setFormData({ ...formData, type: value })}\n          >\n            <SelectTrigger data-testid=\"select-type\">\n              <SelectValue />\n            </SelectTrigger>\n            <SelectContent>\n              <SelectItem value=\"round_robin\">دوري كامل</SelectItem>\n              <SelectItem value=\"knockout\">خروج مغلوب</SelectItem>\n              <SelectItem value=\"groups\">مجموعات</SelectItem>\n              <SelectItem value=\"groups_knockout\">مجموعات + خروج مغلوب</SelectItem>\n            </SelectContent>\n          </Select>\n        </div>\n      </div>\n\n      {/* عدد الفرق والمجموعات */}\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <Label>عدد المتنافسين</Label>\n          <Input\n            type=\"number\"\n            value={formData.maxTeams}\n            onChange={(e) => setFormData({ ...formData, maxTeams: e.target.value })}\n            min=\"4\"\n            max=\"128\"\n            data-testid=\"input-max-teams\"\n          />\n        </div>\n        <div>\n          <Label>عدد الملاعب</Label>\n          <Input\n            type=\"number\"\n            value={formData.numberOfVenues}\n            onChange={(e) => setFormData({ ...formData, numberOfVenues: e.target.value })}\n            min=\"1\"\n            max=\"20\"\n            data-testid=\"input-number-of-venues\"\n          />\n        </div>\n      </div>\n\n      {/* إعدادات الجدولة */}\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <Label className=\"flex items-center gap-2\">\n            <Clock className=\"h-4 w-4\" />\n            توقيت البداية اليومي\n          </Label>\n          <Input\n            type=\"time\"\n            value={formData.dailyStartTime}\n            onChange={(e) => setFormData({ ...formData, dailyStartTime: e.target.value })}\n            data-testid=\"input-daily-start-time\"\n          />\n        </div>\n        <div>\n          <Label>عدد المباريات/ملعب/يوم</Label>\n          <Input\n            type=\"number\"\n            value={formData.matchesPerDayPerVenue}\n            onChange={(e) => setFormData({ ...formData, matchesPerDayPerVenue: e.target.value })}\n            min=\"1\"\n            max=\"10\"\n            data-testid=\"input-matches-per-venue\"\n          />\n        </div>\n      </div>\n\n      {/* عدد المجموعات - اختيار بصري */}\n      {(formData.type === \"groups\" || formData.type === \"groups_knockout\") && (\n        <div>\n          <Label className=\"text-base font-semibold mb-3 block\">عدد المجموعات</Label>\n          <div className=\"flex flex-wrap gap-2\">\n            {groupCountOptions.map((num) => (\n              <button\n                key={num}\n                type=\"button\"\n                onClick={() => setFormData({ ...formData, numberOfGroups: num.toString() })}\n                className={`w-12 h-12 rounded-lg font-bold transition-all ${\n                  formData.numberOfGroups === num.toString()\n                    ? \"bg-primary text-primary-foreground\"\n                    : \"bg-muted hover:bg-muted/80\"\n                }`}\n                data-testid={`button-group-count-${num}`}\n              >\n                {num}\n              </button>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* الأيام المستثناة */}\n      <div>\n        <Label className=\"text-base font-semibold mb-3 block\">الأيام المستثناة</Label>\n        <p className=\"text-sm text-muted-foreground mb-2\">حدد الأيام التي لا تُقام فيها المباريات</p>\n        <div className=\"flex flex-wrap gap-2\">\n          {daysOfWeek.map((day) => (\n            <button\n              key={day.value}\n              type=\"button\"\n              onClick={() => toggleExcludedDay(day.value)}\n              className={`px-4 py-2 rounded-lg font-medium transition-all ${\n                formData.excludedDays.includes(day.value)\n                  ? \"bg-destructive text-destructive-foreground\"\n                  : \"bg-muted hover:bg-muted/80\"\n              }`}\n              data-testid={`button-day-${day.value}`}\n            >\n              {day.label}\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* نظام النقاط */}\n      <div className=\"bg-muted/50 rounded-lg p-4\">\n        <Label className=\"text-base font-semibold mb-3 block\">نظام النقاط</Label>\n        <div className=\"grid grid-cols-3 gap-4\">\n          <div>\n            <Label className=\"text-sm\">نقاط الفوز</Label>\n            <Input\n              type=\"number\"\n              value={formData.pointsForWin}\n              onChange={(e) => setFormData({ ...formData, pointsForWin: e.target.value })}\n              min=\"0\"\n              max=\"10\"\n              data-testid=\"input-points-win\"\n            />\n          </div>\n          <div>\n            <Label className=\"text-sm\">نقاط التعادل</Label>\n            <Input\n              type=\"number\"\n              value={formData.pointsForDraw}\n              onChange={(e) => setFormData({ ...formData, pointsForDraw: e.target.value })}\n              min=\"0\"\n              max=\"10\"\n              data-testid=\"input-points-draw\"\n            />\n          </div>\n          <div>\n            <Label className=\"text-sm\">نقاط الخسارة</Label>\n            <Input\n              type=\"number\"\n              value={formData.pointsForLoss}\n              onChange={(e) => setFormData({ ...formData, pointsForLoss: e.target.value })}\n              min=\"0\"\n              max=\"10\"\n              data-testid=\"input-points-loss\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* مدة المباراة */}\n      <div className=\"bg-muted/50 rounded-lg p-4\">\n        <Label className=\"text-base font-semibold mb-3 block\">مدة المباراة</Label>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <Label className=\"text-sm\">مدة الشوط (دقيقة)</Label>\n            <Input\n              type=\"number\"\n              value={formData.halfDuration}\n              onChange={(e) => setFormData({ ...formData, halfDuration: e.target.value })}\n              min=\"5\"\n              max=\"90\"\n              data-testid=\"input-half-duration\"\n            />\n          </div>\n          <div>\n            <Label className=\"text-sm\">الفترة بين الشوطين (دقيقة)</Label>\n            <Input\n              type=\"number\"\n              value={formData.breakBetweenHalves}\n              onChange={(e) => setFormData({ ...formData, breakBetweenHalves: e.target.value })}\n              min=\"0\"\n              max=\"30\"\n              data-testid=\"input-break-between-halves\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* عدد الجولات */}\n      <div>\n        <Label>عدد الجولات</Label>\n        <Input\n          type=\"number\"\n          value={formData.numberOfRounds}\n          onChange={(e) => setFormData({ ...formData, numberOfRounds: e.target.value })}\n          min=\"1\"\n          max=\"10\"\n          data-testid=\"input-number-of-rounds\"\n        />\n      </div>\n\n      {/* التواريخ */}\n      <div className=\"grid grid-cols-2 gap-4\">\n        <div>\n          <Label>تاريخ البداية</Label>\n          <Input\n            type=\"date\"\n            value={formData.startDate}\n            onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\n            data-testid=\"input-start-date\"\n          />\n        </div>\n        <div>\n          <Label>تاريخ النهاية</Label>\n          <Input\n            type=\"date\"\n            value={formData.endDate}\n            onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}\n            data-testid=\"input-end-date\"\n          />\n        </div>\n      </div>\n\n      {/* الملاعب */}\n      <div>\n        <Label>الملاعب (مفصولة بفواصل)</Label>\n        <Input\n          value={formData.venues}\n          onChange={(e) => setFormData({ ...formData, venues: e.target.value })}\n          placeholder=\"ملعب الشركة، صالة الألعاب\"\n          data-testid=\"input-venues\"\n        />\n      </div>\n\n      {/* مفتوح للتسجيل */}\n      <div className=\"flex items-center justify-between bg-muted/50 rounded-lg p-4\">\n        <div>\n          <Label className=\"text-base font-semibold\">مفتوح للتسجيل</Label>\n          <p className=\"text-sm text-muted-foreground\">السماح للفرق بالتسجيل في البطولة</p>\n        </div>\n        <Switch\n          checked={formData.isOpenForRegistration}\n          onCheckedChange={(checked) => setFormData({ ...formData, isOpenForRegistration: checked })}\n          data-testid=\"switch-open-registration\"\n        />\n      </div>\n\n      <Button type=\"submit\" className=\"w-full\" disabled={mutation.isPending || isUploading} data-testid=\"button-submit-tournament\">\n        {mutation.isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"إضافة البطولة\"}\n      </Button>\n    </form>\n  );\n}\n\nfunction InlineScoreEditor({\n  match,\n  onSave,\n  isPending,\n}: {\n  match: MatchWithTeams;\n  onSave: (data: { homeScore: number | null; awayScore: number | null; status: string }) => void;\n  isPending: boolean;\n}) {\n  const [isEditing, setIsEditing] = useState(false);\n  const [homeScore, setHomeScore] = useState<number>(match.homeScore ?? 0);\n  const [awayScore, setAwayScore] = useState<number>(match.awayScore ?? 0);\n  const homeInputRef = useRef<HTMLInputElement>(null);\n\n  useEffect(() => {\n    setHomeScore(match.homeScore ?? 0);\n    setAwayScore(match.awayScore ?? 0);\n  }, [match.homeScore, match.awayScore]);\n\n  useEffect(() => {\n    if (isEditing && homeInputRef.current) {\n      homeInputRef.current.focus();\n      homeInputRef.current.select();\n    }\n  }, [isEditing]);\n\n  const handleSave = () => {\n    const parsedHome = Number(homeScore);\n    const parsedAway = Number(awayScore);\n    \n    if (isNaN(parsedHome) || isNaN(parsedAway) || parsedHome < 0 || parsedAway < 0) {\n      return;\n    }\n    \n    onSave({\n      homeScore: parsedHome,\n      awayScore: parsedAway,\n      status: \"completed\",\n    });\n    setIsEditing(false);\n  };\n\n  const handleCancel = () => {\n    setIsEditing(false);\n    setHomeScore(match.homeScore ?? 0);\n    setAwayScore(match.awayScore ?? 0);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\") {\n      handleSave();\n    } else if (e.key === \"Escape\") {\n      handleCancel();\n    }\n  };\n\n  const handleScoreChange = (value: string, setter: (val: number) => void) => {\n    const num = parseInt(value, 10);\n    if (!isNaN(num) && num >= 0) {\n      setter(num);\n    } else if (value === \"\") {\n      setter(0);\n    }\n  };\n\n  if (isEditing) {\n    return (\n      <div className=\"flex items-center gap-2 bg-muted/50 rounded-lg p-2\">\n        <Input\n          ref={homeInputRef}\n          type=\"number\"\n          min=\"0\"\n          value={homeScore}\n          onChange={(e) => handleScoreChange(e.target.value, setHomeScore)}\n          onKeyDown={handleKeyDown}\n          className=\"w-14 text-center font-bold text-lg h-10\"\n          data-testid={`input-inline-home-score-${match.id}`}\n        />\n        <span className=\"font-bold text-lg text-muted-foreground\">-</span>\n        <Input\n          type=\"number\"\n          min=\"0\"\n          value={awayScore}\n          onChange={(e) => handleScoreChange(e.target.value, setAwayScore)}\n          onKeyDown={handleKeyDown}\n          className=\"w-14 text-center font-bold text-lg h-10\"\n          data-testid={`input-inline-away-score-${match.id}`}\n        />\n        <Button \n          size=\"icon\" \n          onClick={handleSave} \n          disabled={isPending}\n          data-testid={`button-inline-save-${match.id}`}\n        >\n          {isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : <Pencil className=\"h-4 w-4\" />}\n        </Button>\n        <Button \n          size=\"icon\" \n          variant=\"ghost\"\n          onClick={handleCancel}\n          data-testid={`button-inline-cancel-${match.id}`}\n        >\n          <X className=\"h-4 w-4\" />\n        </Button>\n      </div>\n    );\n  }\n\n  return (\n    <button\n      onClick={() => setIsEditing(true)}\n      className=\"flex items-center gap-2 bg-muted/30 hover:bg-muted/50 rounded-lg px-3 py-2 transition-colors group cursor-pointer\"\n      data-testid={`button-inline-edit-${match.id}`}\n    >\n      <span className=\"text-2xl font-bold\">{match.homeScore ?? 0}</span>\n      <span className=\"font-bold text-muted-foreground\">-</span>\n      <span className=\"text-2xl font-bold\">{match.awayScore ?? 0}</span>\n      <Pencil className=\"h-3 w-3 opacity-0 group-hover:opacity-50 transition-opacity mr-1\" />\n    </button>\n  );\n}\n\nfunction EditMatchDialog({ \n  match, \n  onSave, \n  isPending \n}: { \n  match: MatchWithTeams; \n  onSave: (data: any) => void; \n  isPending: boolean;\n}) {\n  const [open, setOpen] = useState(false);\n  const [activeTab, setActiveTab] = useState(\"result\");\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  \n  const [formData, setFormData] = useState({\n    homeScore: match.homeScore?.toString() || \"\",\n    awayScore: match.awayScore?.toString() || \"\",\n    status: match.status || \"scheduled\",\n  });\n\n  const [goalForm, setGoalForm] = useState({\n    teamId: \"\",\n    playerId: \"\",\n    eventType: \"goal\",\n    minute: \"\",\n  });\n\n  const [cardForm, setCardForm] = useState({\n    teamId: \"\",\n    playerId: \"\",\n    eventType: \"yellow_card\",\n    minute: \"\",\n    notes: \"\",\n  });\n\n  // Fetch players for both teams\n  const { data: homePlayers = [] } = useQuery<Player[]>({\n    queryKey: [\"/api/teams\", match.homeTeamId, \"players\"],\n    queryFn: async () => {\n      if (!match.homeTeamId) return [];\n      const res = await fetch(`/api/teams/${match.homeTeamId}/players`);\n      if (!res.ok) return [];\n      return res.json();\n    },\n    enabled: open && !!match.homeTeamId,\n  });\n\n  const { data: awayPlayers = [] } = useQuery<Player[]>({\n    queryKey: [\"/api/teams\", match.awayTeamId, \"players\"],\n    queryFn: async () => {\n      if (!match.awayTeamId) return [];\n      const res = await fetch(`/api/teams/${match.awayTeamId}/players`);\n      if (!res.ok) return [];\n      return res.json();\n    },\n    enabled: open && !!match.awayTeamId,\n  });\n\n  // Fetch match events\n  const { data: matchEvents = [], refetch: refetchEvents } = useQuery<MatchEvent[]>({\n    queryKey: [\"/api/matches\", match.id, \"events\"],\n    queryFn: async () => {\n      const res = await fetch(`/api/matches/${match.id}/events`);\n      if (!res.ok) return [];\n      return res.json();\n    },\n    enabled: open,\n  });\n\n  const addEventMutation = useMutation({\n    mutationFn: async (data: any) => {\n      return await apiRequest(\"POST\", `/api/matches/${match.id}/events`, data);\n    },\n    onSuccess: (_, variables) => {\n      toast({ title: \"تم إضافة الحدث بنجاح\" });\n      refetchEvents();\n      // Reset the appropriate form based on event type\n      if (variables.eventType === \"goal\" || variables.eventType === \"own_goal\") {\n        setGoalForm({ teamId: \"\", playerId: \"\", eventType: \"goal\", minute: \"\" });\n      } else {\n        setCardForm({ teamId: \"\", playerId: \"\", eventType: \"yellow_card\", minute: \"\", notes: \"\" });\n      }\n    },\n    onError: () => {\n      toast({ title: \"فشل إضافة الحدث\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteEventMutation = useMutation({\n    mutationFn: async (eventId: string) => {\n      return await apiRequest(\"DELETE\", `/api/match-events/${eventId}`, {});\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حذف الحدث\" });\n      refetchEvents();\n    },\n    onError: () => {\n      toast({ title: \"فشل حذف الحدث\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    onSave({\n      homeScore: formData.homeScore ? parseInt(formData.homeScore) : null,\n      awayScore: formData.awayScore ? parseInt(formData.awayScore) : null,\n      status: formData.status,\n    });\n    setOpen(false);\n  };\n\n  const handleAddGoal = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!goalForm.teamId || !goalForm.minute) {\n      toast({ title: \"يرجى تعبئة جميع الحقول المطلوبة\", variant: \"destructive\" });\n      return;\n    }\n    addEventMutation.mutate({\n      teamId: goalForm.teamId,\n      playerId: goalForm.playerId || null,\n      eventType: goalForm.eventType,\n      minute: parseInt(goalForm.minute),\n      notes: null,\n    });\n  };\n\n  const handleAddCard = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!cardForm.teamId || !cardForm.minute) {\n      toast({ title: \"يرجى تعبئة جميع الحقول المطلوبة\", variant: \"destructive\" });\n      return;\n    }\n    addEventMutation.mutate({\n      teamId: cardForm.teamId,\n      playerId: cardForm.playerId || null,\n      eventType: cardForm.eventType,\n      minute: parseInt(cardForm.minute),\n      notes: cardForm.notes || null,\n    });\n  };\n\n  const allPlayers = [...homePlayers, ...awayPlayers];\n  const getPlayerName = (playerId: string | null) => {\n    if (!playerId) return \"غير محدد\";\n    const player = allPlayers.find(p => p.id === playerId);\n    return player?.name || \"غير معروف\";\n  };\n\n  const getTeamName = (teamId: string) => {\n    if (teamId === match.homeTeamId) return match.homeTeam?.name || \"الفريق المضيف\";\n    if (teamId === match.awayTeamId) return match.awayTeam?.name || \"الفريق الضيف\";\n    return \"غير معروف\";\n  };\n\n  const eventTypeLabels: Record<string, string> = {\n    goal: \"هدف\",\n    own_goal: \"هدف بالخطأ\",\n    yellow_card: \"بطاقة صفراء\",\n    red_card: \"بطاقة حمراء\",\n    substitution_in: \"دخول بديل\",\n    substitution_out: \"خروج لاعب\",\n    assist: \"تمريرة حاسمة\",\n  };\n\n  const eventTypeIcons: Record<string, JSX.Element> = {\n    goal: <Goal className=\"h-4 w-4 text-emerald-500\" />,\n    own_goal: <Goal className=\"h-4 w-4 text-red-500\" />,\n    yellow_card: <div className=\"w-3 h-4 bg-yellow-400 rounded-sm\" />,\n    red_card: <div className=\"w-3 h-4 bg-red-500 rounded-sm\" />,\n    substitution_in: <UserIcon className=\"h-4 w-4 text-emerald-500\" />,\n    substitution_out: <UserIcon className=\"h-4 w-4 text-red-500\" />,\n    assist: <Target className=\"h-4 w-4 text-blue-500\" />,\n  };\n\n  const goalTeamPlayers = goalForm.teamId === match.homeTeamId ? homePlayers : \n                          goalForm.teamId === match.awayTeamId ? awayPlayers : [];\n  const cardTeamPlayers = cardForm.teamId === match.homeTeamId ? homePlayers : \n                          cardForm.teamId === match.awayTeamId ? awayPlayers : [];\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button size=\"icon\" variant=\"outline\" data-testid={`button-edit-match-${match.id}`}>\n          <Pencil className=\"h-4 w-4\" />\n        </Button>\n      </DialogTrigger>\n      <DialogContent className=\"max-w-2xl max-h-[90vh] overflow-y-auto\" dir=\"rtl\">\n        <DialogHeader>\n          <DialogTitle className=\"flex items-center gap-2\">\n            <Trophy className=\"h-5 w-5\" />\n            إدارة المباراة: {match.homeTeam?.name} vs {match.awayTeam?.name}\n          </DialogTitle>\n        </DialogHeader>\n        \n        <DialogTabs value={activeTab} onValueChange={setActiveTab} className=\"w-full\">\n          <DialogTabsList className=\"grid w-full grid-cols-3\">\n            <DialogTabsTrigger value=\"result\" data-testid=\"tab-match-result\">\n              <Trophy className=\"h-4 w-4 ml-1\" />\n              النتيجة\n            </DialogTabsTrigger>\n            <DialogTabsTrigger value=\"goals\" data-testid=\"tab-match-goals\">\n              <Goal className=\"h-4 w-4 ml-1\" />\n              الأهداف\n            </DialogTabsTrigger>\n            <DialogTabsTrigger value=\"cards\" data-testid=\"tab-match-cards\">\n              <AlertTriangle className=\"h-4 w-4 ml-1\" />\n              البطاقات\n            </DialogTabsTrigger>\n          </DialogTabsList>\n\n          <DialogTabsContent value=\"result\" className=\"mt-4\">\n            <form onSubmit={handleSubmit} className=\"space-y-6\">\n              <div className=\"flex items-center justify-center gap-4 p-4 bg-muted rounded-lg\">\n                <div className=\"text-center\">\n                  <p className=\"font-bold mb-2\">{match.homeTeam?.name || \"فريق 1\"}</p>\n                  <Input\n                    type=\"number\"\n                    min=\"0\"\n                    className=\"w-20 text-center text-2xl font-bold\"\n                    value={formData.homeScore}\n                    onChange={(e) => setFormData({ ...formData, homeScore: e.target.value })}\n                    data-testid=\"input-home-score\"\n                  />\n                </div>\n                <span className=\"text-2xl font-bold text-muted-foreground\">:</span>\n                <div className=\"text-center\">\n                  <p className=\"font-bold mb-2\">{match.awayTeam?.name || \"فريق 2\"}</p>\n                  <Input\n                    type=\"number\"\n                    min=\"0\"\n                    className=\"w-20 text-center text-2xl font-bold\"\n                    value={formData.awayScore}\n                    onChange={(e) => setFormData({ ...formData, awayScore: e.target.value })}\n                    data-testid=\"input-away-score\"\n                  />\n                </div>\n              </div>\n\n              <div>\n                <Label>حالة المباراة</Label>\n                <Select\n                  value={formData.status}\n                  onValueChange={(value) => setFormData({ ...formData, status: value })}\n                >\n                  <SelectTrigger data-testid=\"select-match-status\">\n                    <SelectValue />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"scheduled\">مقررة</SelectItem>\n                    <SelectItem value=\"live\">مباشر</SelectItem>\n                    <SelectItem value=\"completed\">انتهت</SelectItem>\n                    <SelectItem value=\"postponed\">مؤجلة</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <Button type=\"submit\" className=\"w-full\" disabled={isPending} data-testid=\"button-save-match\">\n                {isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"حفظ النتيجة\"}\n              </Button>\n            </form>\n          </DialogTabsContent>\n\n          <DialogTabsContent value=\"goals\" className=\"mt-4 space-y-4\">\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base flex items-center gap-2\">\n                  <Plus className=\"h-4 w-4\" />\n                  إضافة هدف\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleAddGoal} className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label>الفريق</Label>\n                      <Select\n                        value={goalForm.teamId}\n                        onValueChange={(value) => setGoalForm({ ...goalForm, teamId: value, playerId: \"\" })}\n                      >\n                        <SelectTrigger data-testid=\"select-goal-team\">\n                          <SelectValue placeholder=\"اختر الفريق\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value={match.homeTeamId || \"\"}>{match.homeTeam?.name}</SelectItem>\n                          <SelectItem value={match.awayTeamId || \"\"}>{match.awayTeam?.name}</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div>\n                      <Label>نوع الهدف</Label>\n                      <Select\n                        value={goalForm.eventType}\n                        onValueChange={(value) => setGoalForm({ ...goalForm, eventType: value })}\n                      >\n                        <SelectTrigger data-testid=\"select-goal-type\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"goal\">هدف عادي</SelectItem>\n                          <SelectItem value=\"own_goal\">هدف بالخطأ</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label>اللاعب</Label>\n                      <Select\n                        value={goalForm.playerId}\n                        onValueChange={(value) => setGoalForm({ ...goalForm, playerId: value })}\n                        disabled={!goalForm.teamId}\n                      >\n                        <SelectTrigger data-testid=\"select-goal-player\">\n                          <SelectValue placeholder=\"اختر اللاعب\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {goalTeamPlayers.map((player) => (\n                            <SelectItem key={player.id} value={player.id}>\n                              {player.number ? `#${player.number} ` : \"\"}{player.name}\n                            </SelectItem>\n                          ))}\n                          {goalTeamPlayers.length === 0 && (\n                            <SelectItem value=\"\" disabled>لا يوجد لاعبين مسجلين</SelectItem>\n                          )}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div>\n                      <Label>الدقيقة</Label>\n                      <div className=\"flex items-center gap-2\">\n                        <Clock className=\"h-4 w-4 text-muted-foreground\" />\n                        <Input\n                          type=\"number\"\n                          min=\"1\"\n                          max=\"120\"\n                          value={goalForm.minute}\n                          onChange={(e) => setGoalForm({ ...goalForm, minute: e.target.value })}\n                          placeholder=\"45\"\n                          data-testid=\"input-goal-minute\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n                  <Button \n                    type=\"submit\" \n                    className=\"w-full\" \n                    disabled={addEventMutation.isPending}\n                    data-testid=\"button-add-goal\"\n                  >\n                    {addEventMutation.isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"إضافة الهدف\"}\n                  </Button>\n                </form>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base\">الأهداف المسجلة</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {matchEvents.filter(e => e.eventType === \"goal\" || e.eventType === \"own_goal\").length === 0 ? (\n                  <p className=\"text-center text-muted-foreground py-4\">لا توجد أهداف مسجلة</p>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {matchEvents\n                      .filter(e => e.eventType === \"goal\" || e.eventType === \"own_goal\")\n                      .sort((a, b) => a.minute - b.minute)\n                      .map((event) => (\n                        <div \n                          key={event.id} \n                          className=\"flex items-center justify-between p-3 bg-muted rounded-lg\"\n                          data-testid={`event-goal-${event.id}`}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            {eventTypeIcons[event.eventType]}\n                            <div>\n                              <p className=\"font-medium\">{getPlayerName(event.playerId)}</p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {getTeamName(event.teamId)} - {eventTypeLabels[event.eventType]}\n                              </p>\n                            </div>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <Badge variant=\"outline\">{event.minute}'</Badge>\n                            <Button\n                              size=\"icon\"\n                              variant=\"ghost\"\n                              className=\"h-8 w-8 text-destructive\"\n                              onClick={() => deleteEventMutation.mutate(event.id)}\n                              disabled={deleteEventMutation.isPending}\n                              data-testid={`button-delete-event-${event.id}`}\n                            >\n                              <X className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </div>\n                      ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </DialogTabsContent>\n\n          <DialogTabsContent value=\"cards\" className=\"mt-4 space-y-4\">\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base flex items-center gap-2\">\n                  <Plus className=\"h-4 w-4\" />\n                  إضافة بطاقة\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                <form onSubmit={handleAddCard} className=\"space-y-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label>الفريق</Label>\n                      <Select\n                        value={cardForm.teamId}\n                        onValueChange={(value) => setCardForm({ ...cardForm, teamId: value, playerId: \"\" })}\n                      >\n                        <SelectTrigger data-testid=\"select-card-team\">\n                          <SelectValue placeholder=\"اختر الفريق\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value={match.homeTeamId || \"\"}>{match.homeTeam?.name}</SelectItem>\n                          <SelectItem value={match.awayTeamId || \"\"}>{match.awayTeam?.name}</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div>\n                      <Label>نوع البطاقة</Label>\n                      <Select\n                        value={cardForm.eventType}\n                        onValueChange={(value) => setCardForm({ ...cardForm, eventType: value })}\n                      >\n                        <SelectTrigger data-testid=\"select-card-type\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"yellow_card\">بطاقة صفراء</SelectItem>\n                          <SelectItem value=\"red_card\">بطاقة حمراء</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div>\n                      <Label>اللاعب</Label>\n                      <Select\n                        value={cardForm.playerId}\n                        onValueChange={(value) => setCardForm({ ...cardForm, playerId: value })}\n                        disabled={!cardForm.teamId}\n                      >\n                        <SelectTrigger data-testid=\"select-card-player\">\n                          <SelectValue placeholder=\"اختر اللاعب\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {cardTeamPlayers.map((player) => (\n                            <SelectItem key={player.id} value={player.id}>\n                              {player.number ? `#${player.number} ` : \"\"}{player.name}\n                            </SelectItem>\n                          ))}\n                          {cardTeamPlayers.length === 0 && (\n                            <SelectItem value=\"\" disabled>لا يوجد لاعبين مسجلين</SelectItem>\n                          )}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div>\n                      <Label>الدقيقة</Label>\n                      <div className=\"flex items-center gap-2\">\n                        <Clock className=\"h-4 w-4 text-muted-foreground\" />\n                        <Input\n                          type=\"number\"\n                          min=\"1\"\n                          max=\"120\"\n                          value={cardForm.minute}\n                          onChange={(e) => setCardForm({ ...cardForm, minute: e.target.value })}\n                          placeholder=\"45\"\n                          data-testid=\"input-card-minute\"\n                        />\n                      </div>\n                    </div>\n                  </div>\n                  <div>\n                    <Label>ملاحظات (اختياري)</Label>\n                    <Input\n                      value={cardForm.notes}\n                      onChange={(e) => setCardForm({ ...cardForm, notes: e.target.value })}\n                      placeholder=\"سبب البطاقة...\"\n                      data-testid=\"input-card-notes\"\n                    />\n                  </div>\n                  <Button \n                    type=\"submit\" \n                    className=\"w-full\" \n                    disabled={addEventMutation.isPending}\n                    data-testid=\"button-add-card\"\n                  >\n                    {addEventMutation.isPending ? <Loader2 className=\"h-4 w-4 animate-spin\" /> : \"إضافة البطاقة\"}\n                  </Button>\n                </form>\n              </CardContent>\n            </Card>\n\n            <Card>\n              <CardHeader className=\"pb-3\">\n                <CardTitle className=\"text-base\">البطاقات المسجلة</CardTitle>\n              </CardHeader>\n              <CardContent>\n                {matchEvents.filter(e => e.eventType === \"yellow_card\" || e.eventType === \"red_card\").length === 0 ? (\n                  <p className=\"text-center text-muted-foreground py-4\">لا توجد بطاقات مسجلة</p>\n                ) : (\n                  <div className=\"space-y-2\">\n                    {matchEvents\n                      .filter(e => e.eventType === \"yellow_card\" || e.eventType === \"red_card\")\n                      .sort((a, b) => a.minute - b.minute)\n                      .map((event) => (\n                        <div \n                          key={event.id} \n                          className=\"flex items-center justify-between p-3 bg-muted rounded-lg\"\n                          data-testid={`event-card-${event.id}`}\n                        >\n                          <div className=\"flex items-center gap-3\">\n                            {eventTypeIcons[event.eventType]}\n                            <div>\n                              <p className=\"font-medium\">{getPlayerName(event.playerId)}</p>\n                              <p className=\"text-xs text-muted-foreground\">\n                                {getTeamName(event.teamId)} - {eventTypeLabels[event.eventType]}\n                              </p>\n                              {event.notes && (\n                                <p className=\"text-xs text-muted-foreground italic\">{event.notes}</p>\n                              )}\n                            </div>\n                          </div>\n                          <div className=\"flex items-center gap-2\">\n                            <Badge variant=\"outline\">{event.minute}'</Badge>\n                            <Button\n                              size=\"icon\"\n                              variant=\"ghost\"\n                              className=\"h-8 w-8 text-destructive\"\n                              onClick={() => deleteEventMutation.mutate(event.id)}\n                              disabled={deleteEventMutation.isPending}\n                              data-testid={`button-delete-card-${event.id}`}\n                            >\n                              <X className=\"h-4 w-4\" />\n                            </Button>\n                          </div>\n                        </div>\n                      ))}\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </DialogTabsContent>\n        </DialogTabs>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":115376,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"server/auth.ts":{"content":"import passport from \"passport\";\nimport { Strategy as LocalStrategy } from \"passport-local\";\nimport bcrypt from \"bcrypt\";\nimport { storage } from \"./storage\";\nimport type { User } from \"@shared/schema\";\nimport type { Express } from \"express\";\nimport session from \"express-session\";\nimport createMemoryStore from \"memorystore\";\n\nconst MemoryStore = createMemoryStore(session);\n\nexport function setupAuth(app: Express) {\n  // Session configuration\n  app.use(\n    session({\n      secret: process.env.SESSION_SECRET || \"abraj-sports-committee-secret-2025\",\n      resave: false,\n      saveUninitialized: false,\n      store: new MemoryStore({\n        checkPeriod: 86400000, // 24 hours\n      }),\n      cookie: {\n        maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\n        httpOnly: true,\n        secure: process.env.NODE_ENV === \"production\",\n      },\n    })\n  );\n\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  // Local strategy for username/password login\n  passport.use(\n    new LocalStrategy(\n      {\n        usernameField: \"username\",\n        passwordField: \"password\",\n      },\n      async (username, password, done) => {\n        try {\n          const user = await storage.getUserByUsername(username);\n          \n          if (!user) {\n            return done(null, false, { message: \"اسم المستخدم أو كلمة المرور غير صحيحة\" });\n          }\n\n          if (!user.isActive) {\n            return done(null, false, { message: \"الحساب غير مفعل. يرجى التواصل مع الإدارة\" });\n          }\n\n          const isValidPassword = await bcrypt.compare(password, user.password);\n          \n          if (!isValidPassword) {\n            return done(null, false, { message: \"اسم المستخدم أو كلمة المرور غير صحيحة\" });\n          }\n\n          return done(null, user);\n        } catch (error) {\n          return done(error);\n        }\n      }\n    )\n  );\n\n  // Serialize user to store in session\n  passport.serializeUser((user: any, done) => {\n    done(null, user.id);\n  });\n\n  // Deserialize user from session\n  passport.deserializeUser(async (id: string, done) => {\n    try {\n      const user = await storage.getUserById(id);\n      done(null, user);\n    } catch (error) {\n      done(error);\n    }\n  });\n}\n\n// Middleware to check if user is authenticated\nexport function isAuthenticated(req: any, res: any, next: any) {\n  if (req.isAuthenticated()) {\n    return next();\n  }\n  res.status(401).json({ message: \"يجب تسجيل الدخول للوصول إلى هذه الصفحة\" });\n}\n\n// Middleware to check if user is admin\nexport function isAdmin(req: any, res: any, next: any) {\n  if (req.isAuthenticated() && (req.user.role === \"admin\" || req.user.role === \"committee_member\")) {\n    return next();\n  }\n  res.status(403).json({ message: \"غير مصرح لك بالوصول إلى هذه الصفحة\" });\n}\n\n// Helper function to hash passwords\nexport async function hashPassword(password: string): Promise<string> {\n  const saltRounds = 10;\n  return await bcrypt.hash(password, saltRounds);\n}\n","path":null,"size_bytes":3095,"size_tokens":null},"client/src/components/notifications-dropdown.tsx":{"content":"import { Bell, Check, CheckCheck, Loader2 } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { Notification } from \"@shared/schema\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\n\nexport function NotificationsDropdown() {\n  const { isAuthenticated } = useAuth();\n  const queryClient = useQueryClient();\n\n  const { data: notifications = [], isLoading } = useQuery<Notification[]>({\n    queryKey: [\"/api/notifications\"],\n    enabled: isAuthenticated,\n    refetchInterval: 30000,\n  });\n\n  const { data: unreadData } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread-count\"],\n    enabled: isAuthenticated,\n    refetchInterval: 30000,\n  });\n\n  const markReadMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"POST\", `/api/notifications/${id}/read`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread-count\"] });\n    },\n  });\n\n  const markAllReadMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", \"/api/notifications/read-all\", {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread-count\"] });\n    },\n  });\n\n  const unreadCount = unreadData?.count || 0;\n\n  if (!isAuthenticated) {\n    return null;\n  }\n\n  const getNotificationIcon = (type: string) => {\n    switch (type) {\n      case \"success\":\n        return \"bg-success\";\n      case \"warning\":\n        return \"bg-gold\";\n      case \"event\":\n        return \"bg-primary\";\n      case \"registration\":\n        return \"bg-victory\";\n      default:\n        return \"bg-muted\";\n    }\n  };\n\n  return (\n    <Popover>\n      <PopoverTrigger asChild>\n        <Button variant=\"ghost\" size=\"icon\" className=\"relative\" data-testid=\"button-notifications\">\n          <Bell className=\"h-5 w-5\" />\n          {unreadCount > 0 && (\n            <Badge \n              className=\"absolute -top-1 -right-1 h-5 w-5 p-0 flex items-center justify-center text-xs\"\n            >\n              {unreadCount > 9 ? \"9+\" : unreadCount}\n            </Badge>\n          )}\n        </Button>\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80 p-0\" align=\"end\">\n        <div className=\"flex items-center justify-between p-4 border-b\">\n          <h4 className=\"font-medium\">الإشعارات</h4>\n          {unreadCount > 0 && (\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={() => markAllReadMutation.mutate()}\n              disabled={markAllReadMutation.isPending}\n              data-testid=\"button-mark-all-read\"\n            >\n              <CheckCheck className=\"h-4 w-4 ml-1\" />\n              قراءة الكل\n            </Button>\n          )}\n        </div>\n        <ScrollArea className=\"h-[300px]\">\n          {isLoading ? (\n            <div className=\"flex items-center justify-center py-8\">\n              <Loader2 className=\"h-6 w-6 animate-spin\" />\n            </div>\n          ) : notifications.length === 0 ? (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <Bell className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n              <p className=\"text-sm\">لا توجد إشعارات</p>\n            </div>\n          ) : (\n            <div className=\"divide-y\">\n              {notifications.map((notification) => (\n                <div\n                  key={notification.id}\n                  className={`p-4 hover:bg-muted/50 transition-colors cursor-pointer ${\n                    !notification.isRead ? \"bg-muted/30\" : \"\"\n                  }`}\n                  onClick={() => !notification.isRead && markReadMutation.mutate(notification.id)}\n                  data-testid={`notification-${notification.id}`}\n                >\n                  <div className=\"flex items-start gap-3\">\n                    <div className={`w-2 h-2 rounded-full mt-2 ${getNotificationIcon(notification.type)}`} />\n                    <div className=\"flex-1 min-w-0\">\n                      <p className=\"font-medium text-sm\">{notification.title}</p>\n                      <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                        {notification.message}\n                      </p>\n                      <p className=\"text-xs text-muted-foreground mt-1\">\n                        {new Date(notification.createdAt).toLocaleDateString('ar-SA')}\n                      </p>\n                    </div>\n                    {!notification.isRead && (\n                      <div className=\"w-2 h-2 rounded-full bg-primary flex-shrink-0\" />\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </ScrollArea>\n      </PopoverContent>\n    </Popover>\n  );\n}\n","path":null,"size_bytes":5274,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\nexport const pool = new Pool({ connectionString: process.env.DATABASE_URL });\nexport const db = drizzle({ client: pool, schema });\n","path":null,"size_bytes":483,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, timestamp, integer, boolean } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\nimport { relations } from \"drizzle-orm\";\n\n// Events Schema\nexport const events = pgTable(\"events\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  description: text(\"description\").notNull(),\n  category: text(\"category\").notNull(), // football, basketball, family, marathon, etc.\n  date: timestamp(\"date\").notNull(),\n  location: text(\"location\").notNull(),\n  maxParticipants: integer(\"max_participants\"),\n  currentParticipants: integer(\"current_participants\").default(0),\n  imageUrl: text(\"image_url\").notNull(),\n  status: text(\"status\").notNull().default(\"upcoming\"), // upcoming, ongoing, completed\n  requirements: text(\"requirements\"),\n});\n\nexport const insertEventSchema = createInsertSchema(events).omit({ id: true });\nexport type InsertEvent = z.infer<typeof insertEventSchema>;\nexport type Event = typeof events.$inferSelect;\n\n// News Schema\nexport const news = pgTable(\"news\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  date: timestamp(\"date\").notNull().defaultNow(),\n  category: text(\"category\").notNull(), // announcement, result, achievement\n});\n\nexport const insertNewsSchema = createInsertSchema(news).omit({ id: true });\nexport type InsertNews = z.infer<typeof insertNewsSchema>;\nexport type News = typeof news.$inferSelect;\n\n// Results/Achievements Schema\nexport const results = pgTable(\"results\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  eventId: varchar(\"event_id\").references(() => events.id),\n  tournamentName: text(\"tournament_name\").notNull(),\n  winner: text(\"winner\").notNull(),\n  runnerUp: text(\"runner_up\"),\n  thirdPlace: text(\"third_place\"),\n  date: timestamp(\"date\").notNull(),\n  category: text(\"category\").notNull(),\n});\n\nexport const insertResultSchema = createInsertSchema(results).omit({ id: true });\nexport type InsertResult = z.infer<typeof insertResultSchema>;\nexport type Result = typeof results.$inferSelect;\n\n// Featured Athletes Schema\nexport const athletes = pgTable(\"athletes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  position: text(\"position\").notNull(),\n  department: text(\"department\").notNull(),\n  achievements: text(\"achievements\").notNull(),\n  sport: text(\"sport\").notNull(),\n  imageUrl: text(\"image_url\"),\n});\n\nexport const insertAthleteSchema = createInsertSchema(athletes).omit({ id: true });\nexport type InsertAthlete = z.infer<typeof insertAthleteSchema>;\nexport type Athlete = typeof athletes.$inferSelect;\n\n// Gallery Schema\nexport const gallery = pgTable(\"gallery\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  title: text(\"title\").notNull(),\n  category: text(\"category\").notNull(), // football, family, marathon, basketball, etc.\n  imageUrl: text(\"image_url\").notNull(),\n  eventDate: timestamp(\"event_date\").notNull(),\n  description: text(\"description\"),\n});\n\nexport const insertGallerySchema = createInsertSchema(gallery).omit({ id: true });\nexport type InsertGallery = z.infer<typeof insertGallerySchema>;\nexport type Gallery = typeof gallery.$inferSelect;\n\n// Users Schema\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: varchar(\"username\", { length: 100 }).notNull().unique(),\n  password: text(\"password\").notNull(),\n  fullName: text(\"full_name\").notNull(),\n  email: varchar(\"email\", { length: 255 }).notNull().unique(),\n  employeeId: varchar(\"employee_id\", { length: 50 }).notNull().unique(),\n  department: text(\"department\").notNull(),\n  position: text(\"position\").notNull(),\n  phoneNumber: varchar(\"phone_number\", { length: 20 }),\n  \n  // Account type (نوع الحساب)\n  accountType: text(\"account_type\").notNull().default(\"standard\"), // committee, player, standard\n  committeeTitle: text(\"committee_title\"), // المسمى في اللجنة (للأعضاء فقط)\n  \n  // Images (الصور)\n  profileImageUrl: text(\"profile_image_url\"), // صورة شخصية\n  employeeCardImageUrl: text(\"employee_card_image_url\"), // صورة بطاقة العمل\n  nationalIdImageUrl: text(\"national_id_image_url\"), // صورة الهوية\n  \n  // Player-specific fields (حقول اللاعب) - stored as JSON\n  playerInfo: text(\"player_info\"), // JSON: { number, position, level, dateOfBirth, healthStatus, primaryJersey, etc. }\n  \n  // Shift schedule information\n  shiftPattern: text(\"shift_pattern\").notNull().default(\"2weeks_on_2weeks_off\"), // 2weeks_on_2weeks_off, normal, flexible\n  currentShiftStatus: text(\"current_shift_status\").default(\"available\"), // available, on_shift, off_shift\n  workStartDate: timestamp(\"work_start_date\"), // تاريخ بداية العمل\n  workEndDate: timestamp(\"work_end_date\"), // تاريخ نهاية العمل\n  nextShiftStart: timestamp(\"next_shift_start\"),\n  nextShiftEnd: timestamp(\"next_shift_end\"),\n  \n  // User role and status\n  role: text(\"role\").notNull().default(\"employee\"), // employee, admin, committee_member\n  isActive: boolean(\"is_active\").notNull().default(true),\n  \n  // Metadata\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({ \n  id: true, \n  createdAt: true, \n  updatedAt: true \n});\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\n// Event Registrations Schema\nexport const eventRegistrations = pgTable(\"event_registrations\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  eventId: varchar(\"event_id\").notNull().references(() => events.id, { onDelete: \"cascade\" }),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  registrationDate: timestamp(\"registration_date\").notNull().defaultNow(),\n  status: text(\"status\").notNull().default(\"confirmed\"), // confirmed, waitlist, cancelled, attended\n  notes: text(\"notes\"),\n  teamName: text(\"team_name\"), // For team sports\n  emergencyContact: text(\"emergency_contact\"),\n  emergencyPhone: varchar(\"emergency_phone\", { length: 20 }),\n});\n\nexport const insertEventRegistrationSchema = createInsertSchema(eventRegistrations).omit({ \n  id: true, \n  registrationDate: true \n});\nexport type InsertEventRegistration = z.infer<typeof insertEventRegistrationSchema>;\nexport type EventRegistration = typeof eventRegistrations.$inferSelect;\n\n// Relations\nexport const usersRelations = relations(users, ({ many }) => ({\n  eventRegistrations: many(eventRegistrations),\n}));\n\nexport const eventsRelations = relations(events, ({ many }) => ({\n  registrations: many(eventRegistrations),\n  results: many(results),\n}));\n\nexport const eventRegistrationsRelations = relations(eventRegistrations, ({ one }) => ({\n  event: one(events, {\n    fields: [eventRegistrations.eventId],\n    references: [events.id],\n  }),\n  user: one(users, {\n    fields: [eventRegistrations.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const resultsRelations = relations(results, ({ one }) => ({\n  event: one(events, {\n    fields: [results.eventId],\n    references: [events.id],\n  }),\n}));\n\n// Notifications Schema\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  type: text(\"type\").notNull().default(\"info\"), // info, success, warning, event, registration\n  relatedEventId: varchar(\"related_event_id\").references(() => events.id, { onDelete: \"set null\" }),\n  isRead: boolean(\"is_read\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({ \n  id: true, \n  createdAt: true \n});\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type Notification = typeof notifications.$inferSelect;\n\n// Forum Posts Schema\nexport const forumPosts = pgTable(\"forum_posts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  content: text(\"content\").notNull(),\n  imageUrl: text(\"image_url\"),\n  category: text(\"category\").notNull().default(\"general\"), // general, football, basketball, marathon, family\n  relatedEventId: varchar(\"related_event_id\").references(() => events.id, { onDelete: \"set null\" }),\n  likesCount: integer(\"likes_count\").notNull().default(0),\n  commentsCount: integer(\"comments_count\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const insertForumPostSchema = createInsertSchema(forumPosts).omit({ \n  id: true, \n  likesCount: true,\n  commentsCount: true,\n  createdAt: true, \n  updatedAt: true \n});\nexport type InsertForumPost = z.infer<typeof insertForumPostSchema>;\nexport type ForumPost = typeof forumPosts.$inferSelect;\n\n// Forum Comments Schema\nexport const forumComments = pgTable(\"forum_comments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  postId: varchar(\"post_id\").notNull().references(() => forumPosts.id, { onDelete: \"cascade\" }),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  content: text(\"content\").notNull(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertForumCommentSchema = createInsertSchema(forumComments).omit({ \n  id: true, \n  createdAt: true \n});\nexport type InsertForumComment = z.infer<typeof insertForumCommentSchema>;\nexport type ForumComment = typeof forumComments.$inferSelect;\n\n// Forum Likes Schema\nexport const forumLikes = pgTable(\"forum_likes\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  postId: varchar(\"post_id\").notNull().references(() => forumPosts.id, { onDelete: \"cascade\" }),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertForumLikeSchema = createInsertSchema(forumLikes).omit({ \n  id: true, \n  createdAt: true \n});\nexport type InsertForumLike = z.infer<typeof insertForumLikeSchema>;\nexport type ForumLike = typeof forumLikes.$inferSelect;\n\n// Forum Relations\nexport const forumPostsRelations = relations(forumPosts, ({ one, many }) => ({\n  user: one(users, {\n    fields: [forumPosts.userId],\n    references: [users.id],\n  }),\n  event: one(events, {\n    fields: [forumPosts.relatedEventId],\n    references: [events.id],\n  }),\n  comments: many(forumComments),\n  likes: many(forumLikes),\n}));\n\nexport const forumCommentsRelations = relations(forumComments, ({ one }) => ({\n  post: one(forumPosts, {\n    fields: [forumComments.postId],\n    references: [forumPosts.id],\n  }),\n  user: one(users, {\n    fields: [forumComments.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const forumLikesRelations = relations(forumLikes, ({ one }) => ({\n  post: one(forumPosts, {\n    fields: [forumLikes.postId],\n    references: [forumPosts.id],\n  }),\n  user: one(users, {\n    fields: [forumLikes.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const notificationsRelations = relations(notifications, ({ one }) => ({\n  user: one(users, {\n    fields: [notifications.userId],\n    references: [users.id],\n  }),\n  event: one(events, {\n    fields: [notifications.relatedEventId],\n    references: [events.id],\n  }),\n}));\n\n// ========== LEAGUE GENERATOR SCHEMAS ==========\n\n// Tournaments/Leagues Schema\nexport const tournaments = pgTable(\"tournaments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  sport: text(\"sport\").notNull(), // football, basketball, volleyball, etc.\n  type: text(\"type\").notNull(), // round_robin, knockout, groups\n  status: text(\"status\").notNull().default(\"registration\"), // registration, ongoing, completed\n  \n  // Tournament settings\n  maxTeams: integer(\"max_teams\").notNull().default(8),\n  minPlayersPerTeam: integer(\"min_players_per_team\").notNull().default(5),\n  maxPlayersPerTeam: integer(\"max_players_per_team\").notNull().default(15),\n  hasSecondLeg: boolean(\"has_second_leg\").notNull().default(true), // ذهاب وإياب\n  \n  // Venue settings\n  venues: text(\"venues\").array(), // قائمة الملاعب\n  \n  // Multi-phase settings (groups → knockout)\n  hasGroupStage: boolean(\"has_group_stage\").notNull().default(false),\n  numberOfGroups: integer(\"number_of_groups\").default(2),\n  teamsAdvancingPerGroup: integer(\"teams_advancing_per_group\").default(2),\n  \n  // Stage tracking for groups → knockout tournaments\n  currentStage: text(\"current_stage\").default(\"registration\"), // registration, group_stage, knockout_stage, completed\n  groupStageComplete: boolean(\"group_stage_complete\").notNull().default(false),\n  knockoutBracket: text(\"knockout_bracket\"), // JSON structure for bracket\n  \n  // Dates\n  registrationStart: timestamp(\"registration_start\"),\n  registrationEnd: timestamp(\"registration_end\"),\n  startDate: timestamp(\"start_date\"),\n  endDate: timestamp(\"end_date\"),\n  \n  // Media\n  imageUrl: text(\"image_url\"),\n  trophyImageUrl: text(\"trophy_image_url\"), // صورة الكأس للعرض في شجرة خروج المغلوب\n  \n  // Theme customization - ثيم البطولة\n  themeConfig: text(\"theme_config\"), // JSON: { primaryColor, secondaryColor, useUnifiedImage }\n  heroImageUrl: text(\"hero_image_url\"), // صورة البانر الرئيسية\n  standingsImageUrl: text(\"standings_image_url\"), // صورة صفحة الترتيب\n  matchesImageUrl: text(\"matches_image_url\"), // صورة صفحة المباريات\n  teamsImageUrl: text(\"teams_image_url\"), // صورة صفحة الفرق\n  scorersImageUrl: text(\"scorers_image_url\"), // صورة صفحة الهدافين\n  \n  // Contact info (from myleague.vn form)\n  phoneNumber: varchar(\"phone_number\", { length: 20 }),\n  address: text(\"address\"),\n  policy: text(\"policy\").notNull().default(\"public\"), // public, private\n  \n  // Points system\n  pointsForWin: integer(\"points_for_win\").notNull().default(3),\n  pointsForDraw: integer(\"points_for_draw\").notNull().default(1),\n  pointsForLoss: integer(\"points_for_loss\").notNull().default(0),\n  \n  // Round settings\n  numberOfRounds: integer(\"number_of_rounds\").default(1),\n  \n  // Match duration settings - إعدادات مدة المباراة\n  halfDuration: integer(\"half_duration\").notNull().default(45), // مدة الشوط بالدقائق\n  breakBetweenHalves: integer(\"break_between_halves\").notNull().default(15), // الفترة بين الشوطين بالدقائق\n  \n  // Registration\n  isOpenForRegistration: boolean(\"is_open_for_registration\").notNull().default(true),\n  \n  // Third place match - مباراة تحديد المركز الثالث\n  hasThirdPlaceMatch: boolean(\"has_third_place_match\").notNull().default(false),\n  \n  // Schedule configuration - JSON: { matchesPerDay, dailyStartTime, dailyEndTime }\n  scheduleConfig: text(\"schedule_config\"),\n  \n  // Tournament structure\n  tournamentStructure: text(\"tournament_structure\").default(\"team\"), // team, individual\n  numberOfVenues: integer(\"number_of_venues\").default(1),\n  excludedDays: text(\"excluded_days\").array(), // [\"friday\", \"saturday\"]\n  \n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const insertTournamentSchema = createInsertSchema(tournaments).omit({ \n  id: true, \n  createdAt: true, \n  updatedAt: true \n});\nexport type InsertTournament = z.infer<typeof insertTournamentSchema>;\nexport type Tournament = typeof tournaments.$inferSelect;\n\n// Teams Schema\nexport const teams = pgTable(\"teams\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tournamentId: varchar(\"tournament_id\").references(() => tournaments.id, { onDelete: \"cascade\" }),\n  name: text(\"name\").notNull(),\n  logoUrl: text(\"logo_url\"),\n  captainId: varchar(\"captain_id\").references(() => users.id),\n  groupNumber: integer(\"group_number\"), // For group stage tournaments\n  \n  // Team level and info (from myleague.vn)\n  level: text(\"level\"), // beginner, intermediate, advanced, professional\n  averageAge: text(\"average_age\"), // 18-25, 25-30, 30-35, 35+\n  representativeName: text(\"representative_name\"), // الممثل\n  description: text(\"description\"), // مقدمة الفريق\n  \n  // Jersey/Kit colors\n  primaryJersey: text(\"primary_jersey\"), // قميص 1 (اللون أو رابط الصورة)\n  secondaryJersey: text(\"secondary_jersey\"), // قميص 2\n  thirdJersey: text(\"third_jersey\"), // قميص 3\n  \n  // Contact info\n  contactPhone: varchar(\"contact_phone\", { length: 20 }),\n  contactEmail: varchar(\"contact_email\", { length: 255 }),\n  activationZone: text(\"activation_zone\"), // منطقة التفعيل\n  activationPeriod: text(\"activation_period\"), // الفترة الزمنية للتفعيل\n  \n  // Stats (computed/cached)\n  played: integer(\"played\").notNull().default(0),\n  won: integer(\"won\").notNull().default(0),\n  drawn: integer(\"drawn\").notNull().default(0),\n  lost: integer(\"lost\").notNull().default(0),\n  goalsFor: integer(\"goals_for\").notNull().default(0),\n  goalsAgainst: integer(\"goals_against\").notNull().default(0),\n  goalDifference: integer(\"goal_difference\").notNull().default(0),\n  points: integer(\"points\").notNull().default(0),\n  \n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertTeamSchema = createInsertSchema(teams).omit({ \n  id: true, \n  played: true,\n  won: true,\n  drawn: true,\n  lost: true,\n  goalsFor: true,\n  goalsAgainst: true,\n  goalDifference: true,\n  points: true,\n  createdAt: true \n});\nexport type InsertTeam = z.infer<typeof insertTeamSchema>;\nexport type Team = typeof teams.$inferSelect;\n\n// Players Schema\nexport const players = pgTable(\"players\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  teamId: varchar(\"team_id\").references(() => teams.id, { onDelete: \"cascade\" }),\n  userId: varchar(\"user_id\").references(() => users.id), // Optional link to user account\n  name: text(\"name\").notNull(),\n  number: integer(\"number\"),\n  position: text(\"position\"), // goalkeeper, defender, midfielder, forward\n  photoUrl: text(\"photo_url\"),\n  \n  // Player info (from myleague.vn)\n  level: text(\"level\"), // beginner, intermediate, advanced, professional\n  averageAge: text(\"average_age\"), // 18-25, 25-30, 30-35, 35+\n  dateOfBirth: timestamp(\"date_of_birth\"),\n  healthStatus: text(\"health_status\").default(\"fit\"), // fit, injured, recovering\n  healthNotes: text(\"health_notes\"),\n  email: varchar(\"email\", { length: 255 }),\n  phone: varchar(\"phone\", { length: 20 }),\n  representativeName: text(\"representative_name\"), // الممثل\n  activationZone: text(\"activation_zone\"), // منطقة التفعيل\n  activationPeriod: text(\"activation_period\"), // الفترة الزمنية للتفعيل\n  \n  // Jersey/Kit for player\n  primaryJersey: text(\"primary_jersey\"), // قميص 1\n  secondaryJersey: text(\"secondary_jersey\"), // قميص 2\n  thirdJersey: text(\"third_jersey\"), // قميص 3\n  \n  // Stats\n  goals: integer(\"goals\").notNull().default(0),\n  assists: integer(\"assists\").notNull().default(0),\n  yellowCards: integer(\"yellow_cards\").notNull().default(0),\n  redCards: integer(\"red_cards\").notNull().default(0),\n  matchesPlayed: integer(\"matches_played\").notNull().default(0),\n  \n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertPlayerSchema = createInsertSchema(players).omit({ \n  id: true,\n  goals: true,\n  assists: true,\n  yellowCards: true,\n  redCards: true,\n  matchesPlayed: true,\n  createdAt: true \n});\nexport type InsertPlayer = z.infer<typeof insertPlayerSchema>;\nexport type Player = typeof players.$inferSelect;\n\n// Referees Schema\nexport const referees = pgTable(\"referees\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tournamentId: varchar(\"tournament_id\").references(() => tournaments.id, { onDelete: \"cascade\" }),\n  name: text(\"name\").notNull(),\n  phone: varchar(\"phone\", { length: 20 }),\n  email: varchar(\"email\", { length: 255 }),\n  level: text(\"level\"), // beginner, intermediate, advanced, fifa\n  specialization: text(\"specialization\"), // main, assistant, var\n  photoUrl: text(\"photo_url\"),\n  notes: text(\"notes\"),\n  matchesRefereed: integer(\"matches_refereed\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertRefereeSchema = createInsertSchema(referees).omit({ \n  id: true,\n  matchesRefereed: true,\n  createdAt: true \n});\nexport type InsertReferee = z.infer<typeof insertRefereeSchema>;\nexport type Referee = typeof referees.$inferSelect;\n\n// Matches Schema\nexport const matches = pgTable(\"matches\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  tournamentId: varchar(\"tournament_id\").notNull().references(() => tournaments.id, { onDelete: \"cascade\" }),\n  homeTeamId: varchar(\"home_team_id\").references(() => teams.id), // Nullable for placeholder matches\n  awayTeamId: varchar(\"away_team_id\").references(() => teams.id), // Nullable for placeholder matches\n  \n  // Match info\n  round: integer(\"round\").notNull(), // الجولة\n  leg: integer(\"leg\").default(1), // 1 = ذهاب، 2 = إياب\n  groupNumber: integer(\"group_number\"), // For group stage\n  stage: text(\"stage\").default(\"group\"), // group, round_of_16, quarter_final, semi_final, third_place, final\n  \n  // Knockout bracket positioning\n  bracketPosition: integer(\"bracket_position\"), // Position in knockout bracket (1, 2, 3... for ordering)\n  nextMatchId: varchar(\"next_match_id\"), // Winner advances to this match\n  \n  // Schedule\n  matchDate: timestamp(\"match_date\"),\n  venue: text(\"venue\"),\n  \n  // Result\n  homeScore: integer(\"home_score\"),\n  awayScore: integer(\"away_score\"),\n  status: text(\"status\").notNull().default(\"scheduled\"), // scheduled, live, completed, postponed\n  \n  // Extra time for knockout\n  homeExtraTimeScore: integer(\"home_extra_time_score\"),\n  awayExtraTimeScore: integer(\"away_extra_time_score\"),\n  homePenaltyScore: integer(\"home_penalty_score\"),\n  awayPenaltyScore: integer(\"away_penalty_score\"),\n  \n  // Match details\n  referee: text(\"referee\"),\n  attendance: integer(\"attendance\"),\n  notes: text(\"notes\"),\n  \n  // Video/Stream\n  streamUrl: text(\"stream_url\"),\n  highlightsUrl: text(\"highlights_url\"),\n  \n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const insertMatchSchema = createInsertSchema(matches).omit({ \n  id: true, \n  createdAt: true, \n  updatedAt: true \n});\nexport type InsertMatch = z.infer<typeof insertMatchSchema>;\nexport type Match = typeof matches.$inferSelect;\n\n// Match Events (Goals, Cards, Substitutions)\nexport const matchEvents = pgTable(\"match_events\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  matchId: varchar(\"match_id\").notNull().references(() => matches.id, { onDelete: \"cascade\" }),\n  teamId: varchar(\"team_id\").notNull().references(() => teams.id),\n  playerId: varchar(\"player_id\").references(() => players.id),\n  \n  eventType: text(\"event_type\").notNull(), // goal, own_goal, assist, yellow_card, red_card, substitution_in, substitution_out\n  minute: integer(\"minute\").notNull(),\n  extraMinute: integer(\"extra_minute\"), // وقت بدل الضائع\n  \n  // For substitutions\n  relatedPlayerId: varchar(\"related_player_id\").references(() => players.id),\n  \n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertMatchEventSchema = createInsertSchema(matchEvents).omit({ \n  id: true, \n  createdAt: true \n});\nexport type InsertMatchEvent = z.infer<typeof insertMatchEventSchema>;\nexport type MatchEvent = typeof matchEvents.$inferSelect;\n\n// Match Lineups\nexport const matchLineups = pgTable(\"match_lineups\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  matchId: varchar(\"match_id\").notNull().references(() => matches.id, { onDelete: \"cascade\" }),\n  teamId: varchar(\"team_id\").notNull().references(() => teams.id),\n  playerId: varchar(\"player_id\").notNull().references(() => players.id),\n  \n  isStarter: boolean(\"is_starter\").notNull().default(true),\n  position: text(\"position\"), // التشكيل\n  positionNumber: integer(\"position_number\"), // 1-11 للأساسيين\n  \n  // Performance evaluation\n  rating: integer(\"rating\"), // 1-10\n  minutesPlayed: integer(\"minutes_played\"),\n  \n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertMatchLineupSchema = createInsertSchema(matchLineups).omit({ \n  id: true, \n  createdAt: true \n});\nexport type InsertMatchLineup = z.infer<typeof insertMatchLineupSchema>;\nexport type MatchLineup = typeof matchLineups.$inferSelect;\n\n// Match Comments (Fan interaction)\nexport const matchComments = pgTable(\"match_comments\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  matchId: varchar(\"match_id\").notNull().references(() => matches.id, { onDelete: \"cascade\" }),\n  userId: varchar(\"user_id\").notNull().references(() => users.id, { onDelete: \"cascade\" }),\n  content: text(\"content\").notNull(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertMatchCommentSchema = createInsertSchema(matchComments).omit({ \n  id: true, \n  createdAt: true \n});\nexport type InsertMatchComment = z.infer<typeof insertMatchCommentSchema>;\nexport type MatchComment = typeof matchComments.$inferSelect;\n\n// Team Evaluations\nexport const teamEvaluations = pgTable(\"team_evaluations\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  teamId: varchar(\"team_id\").notNull().references(() => teams.id, { onDelete: \"cascade\" }),\n  matchId: varchar(\"match_id\").notNull().references(() => matches.id, { onDelete: \"cascade\" }),\n  evaluatorId: varchar(\"evaluator_id\").references(() => users.id),\n  \n  // Evaluation scores (1-10)\n  attackRating: integer(\"attack_rating\"),\n  defenseRating: integer(\"defense_rating\"),\n  teamworkRating: integer(\"teamwork_rating\"),\n  disciplineRating: integer(\"discipline_rating\"),\n  overallRating: integer(\"overall_rating\"),\n  \n  notes: text(\"notes\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const insertTeamEvaluationSchema = createInsertSchema(teamEvaluations).omit({ \n  id: true, \n  createdAt: true \n});\nexport type InsertTeamEvaluation = z.infer<typeof insertTeamEvaluationSchema>;\nexport type TeamEvaluation = typeof teamEvaluations.$inferSelect;\n\n// League Generator Relations\nexport const tournamentsRelations = relations(tournaments, ({ many }) => ({\n  teams: many(teams),\n  matches: many(matches),\n}));\n\nexport const teamsRelations = relations(teams, ({ one, many }) => ({\n  tournament: one(tournaments, {\n    fields: [teams.tournamentId],\n    references: [tournaments.id],\n  }),\n  captain: one(users, {\n    fields: [teams.captainId],\n    references: [users.id],\n  }),\n  players: many(players),\n  homeMatches: many(matches),\n  evaluations: many(teamEvaluations),\n}));\n\nexport const playersRelations = relations(players, ({ one }) => ({\n  team: one(teams, {\n    fields: [players.teamId],\n    references: [teams.id],\n  }),\n  user: one(users, {\n    fields: [players.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const matchesRelations = relations(matches, ({ one, many }) => ({\n  tournament: one(tournaments, {\n    fields: [matches.tournamentId],\n    references: [tournaments.id],\n  }),\n  homeTeam: one(teams, {\n    fields: [matches.homeTeamId],\n    references: [teams.id],\n  }),\n  awayTeam: one(teams, {\n    fields: [matches.awayTeamId],\n    references: [teams.id],\n  }),\n  events: many(matchEvents),\n  lineups: many(matchLineups),\n  comments: many(matchComments),\n  evaluations: many(teamEvaluations),\n}));\n\nexport const matchEventsRelations = relations(matchEvents, ({ one }) => ({\n  match: one(matches, {\n    fields: [matchEvents.matchId],\n    references: [matches.id],\n  }),\n  team: one(teams, {\n    fields: [matchEvents.teamId],\n    references: [teams.id],\n  }),\n  player: one(players, {\n    fields: [matchEvents.playerId],\n    references: [players.id],\n  }),\n}));\n\nexport const matchLineupsRelations = relations(matchLineups, ({ one }) => ({\n  match: one(matches, {\n    fields: [matchLineups.matchId],\n    references: [matches.id],\n  }),\n  team: one(teams, {\n    fields: [matchLineups.teamId],\n    references: [teams.id],\n  }),\n  player: one(players, {\n    fields: [matchLineups.playerId],\n    references: [players.id],\n  }),\n}));\n\nexport const matchCommentsRelations = relations(matchComments, ({ one }) => ({\n  match: one(matches, {\n    fields: [matchComments.matchId],\n    references: [matches.id],\n  }),\n  user: one(users, {\n    fields: [matchComments.userId],\n    references: [users.id],\n  }),\n}));\n\nexport const teamEvaluationsRelations = relations(teamEvaluations, ({ one }) => ({\n  team: one(teams, {\n    fields: [teamEvaluations.teamId],\n    references: [teams.id],\n  }),\n  match: one(matches, {\n    fields: [teamEvaluations.matchId],\n    references: [matches.id],\n  }),\n  evaluator: one(users, {\n    fields: [teamEvaluations.evaluatorId],\n    references: [users.id],\n  }),\n}));\n\n// Extended types for league with details\nexport interface MatchWithTeams extends Match {\n  homeTeam: Team;\n  awayTeam: Team;\n}\n\nexport interface PlayerWithTeam extends Player {\n  team: Team;\n}\n\nexport interface MatchCommentWithUser extends MatchComment {\n  user: {\n    id: string;\n    fullName: string;\n  };\n}\n\n// Site Settings Schema\nexport const siteSettings = pgTable(\"site_settings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  key: varchar(\"key\", { length: 100 }).notNull().unique(),\n  value: text(\"value\"),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const insertSiteSettingSchema = createInsertSchema(siteSettings).omit({ id: true, updatedAt: true });\nexport type InsertSiteSetting = z.infer<typeof insertSiteSettingSchema>;\nexport type SiteSetting = typeof siteSettings.$inferSelect;\n\n// Stats Schema (for homepage statistics)\nexport interface Stats {\n  totalEvents: number;\n  totalParticipants: number;\n  totalAchievements: number;\n  activeSports: number;\n}\n\n// Extended types for forum with user info\nexport interface ForumPostWithUser extends ForumPost {\n  user: {\n    id: string;\n    fullName: string;\n    department: string;\n  };\n  isLiked?: boolean;\n}\n","path":null,"size_bytes":30909,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/contexts/AuthContext.tsx":{"content":"import { createContext, useContext, useState, useEffect } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { User } from \"@shared/schema\";\n\ninterface AuthContextType {\n  user: Omit<User, \"password\"> | null;\n  isLoading: boolean;\n  login: (username: string, password: string) => Promise<void>;\n  register: (userData: any) => Promise<void>;\n  logout: () => Promise<void>;\n  isAuthenticated: boolean;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\n  const queryClient = useQueryClient();\n\n  const { data: user, isLoading } = useQuery<Omit<User, \"password\"> | null>({\n    queryKey: [\"/api/auth/me\"],\n    retry: false,\n    staleTime: Infinity,\n  });\n\n  const loginMutation = useMutation({\n    mutationFn: async ({ username, password }: { username: string; password: string }) => {\n      return await apiRequest(\"POST\", \"/api/auth/login\", { username, password });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n    },\n  });\n\n  const registerMutation = useMutation({\n    mutationFn: async (userData: any) => {\n      return await apiRequest(\"POST\", \"/api/auth/register\", userData);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/auth/me\"] });\n    },\n  });\n\n  const logoutMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", \"/api/auth/logout\", {});\n    },\n    onSuccess: () => {\n      queryClient.setQueryData([\"/api/auth/me\"], null);\n      queryClient.clear();\n    },\n  });\n\n  const login = async (username: string, password: string) => {\n    await loginMutation.mutateAsync({ username, password });\n  };\n\n  const register = async (userData: any) => {\n    await registerMutation.mutateAsync(userData);\n  };\n\n  const logout = async () => {\n    await logoutMutation.mutateAsync();\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        user: user || null,\n        isLoading,\n        login,\n        register,\n        logout,\n        isAuthenticated: !!user,\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error(\"useAuth must be used within an AuthProvider\");\n  }\n  return context;\n}\n","path":null,"size_bytes":2463,"size_tokens":null},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { setupAuth, isAuthenticated, isAdmin, hashPassword } from \"./auth\";\nimport passport from \"passport\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport fs from \"fs\";\n\n// Configure multer for file uploads\nconst uploadDir = path.join(process.cwd(), \"uploads\");\nif (!fs.existsSync(uploadDir)) {\n  fs.mkdirSync(uploadDir, { recursive: true });\n}\n\nconst multerStorage = multer.diskStorage({\n  destination: (_req, _file, cb) => {\n    cb(null, uploadDir);\n  },\n  filename: (_req, file, cb) => {\n    const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\n    cb(null, uniqueSuffix + path.extname(file.originalname));\n  },\n});\n\nconst upload = multer({\n  storage: multerStorage,\n  limits: { fileSize: 5 * 1024 * 1024 }, // 5MB limit\n  fileFilter: (_req, file, cb) => {\n    const allowedTypes = /jpeg|jpg|png|gif|webp/;\n    const extname = allowedTypes.test(path.extname(file.originalname).toLowerCase());\n    const mimetype = allowedTypes.test(file.mimetype);\n    if (extname && mimetype) {\n      return cb(null, true);\n    }\n    cb(new Error(\"Only image files are allowed\"));\n  },\n});\nimport { \n  insertUserSchema, \n  insertEventRegistrationSchema,\n  insertTournamentSchema,\n  insertTeamSchema,\n  insertPlayerSchema,\n  insertMatchSchema,\n  insertMatchEventSchema,\n  insertMatchLineupSchema,\n  insertMatchCommentSchema,\n  insertTeamEvaluationSchema\n} from \"@shared/schema\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // Setup authentication\n  setupAuth(app);\n\n  // Auth endpoints\n  const registerUpload = upload.fields([\n    { name: 'profileImage', maxCount: 1 },\n    { name: 'employeeCardImage', maxCount: 1 },\n    { name: 'nationalIdImage', maxCount: 1 }\n  ]);\n\n  app.post(\"/api/auth/register\", registerUpload, async (req, res) => {\n    try {\n      const { username, password, email, employeeId, accountType } = req.body;\n\n      // Check if username already exists\n      const existingUser = await storage.getUserByUsername(username);\n      if (existingUser) {\n        return res.status(400).json({ message: \"اسم المستخدم موجود بالفعل\" });\n      }\n\n      // Check if email already exists\n      const existingEmail = await storage.getUserByEmail(email);\n      if (existingEmail) {\n        return res.status(400).json({ message: \"البريد الإلكتروني مسجل بالفعل\" });\n      }\n\n      // Check if employee ID already exists\n      const existingEmployeeId = await storage.getUserByEmployeeId(employeeId);\n      if (existingEmployeeId) {\n        return res.status(400).json({ message: \"رقم الموظف مسجل بالفعل\" });\n      }\n\n      // Hash password\n      const hashedPassword = await hashPassword(password);\n\n      // Handle uploaded files\n      const files = req.files as { [fieldname: string]: Express.Multer.File[] } | undefined;\n      const profileImageUrl = files?.profileImage?.[0] ? `/uploads/${files.profileImage[0].filename}` : undefined;\n      const employeeCardImageUrl = files?.employeeCardImage?.[0] ? `/uploads/${files.employeeCardImage[0].filename}` : undefined;\n      const nationalIdImageUrl = files?.nationalIdImage?.[0] ? `/uploads/${files.nationalIdImage[0].filename}` : undefined;\n\n      // Determine role based on account type\n      let role = \"employee\";\n      if (accountType === \"committee\") {\n        role = \"committee_member\";\n      }\n\n      // Parse dates if provided\n      const workStartDate = req.body.workStartDate ? new Date(req.body.workStartDate) : undefined;\n      const workEndDate = req.body.workEndDate ? new Date(req.body.workEndDate) : undefined;\n\n      // Parse playerInfo if provided (it comes as JSON string from form)\n      const playerInfo = req.body.playerInfo ? req.body.playerInfo : undefined;\n\n      // Build user data object explicitly to avoid Zod issues with form data\n      const userDataRaw = {\n        username: req.body.username,\n        password: hashedPassword,\n        fullName: req.body.fullName,\n        email: req.body.email,\n        employeeId: req.body.employeeId,\n        department: req.body.department,\n        position: req.body.position,\n        phoneNumber: req.body.phoneNumber || undefined,\n        shiftPattern: req.body.shiftPattern || \"2weeks_on_2weeks_off\",\n        role,\n        accountType: req.body.accountType || \"standard\",\n        committeeTitle: req.body.committeeTitle || undefined,\n        profileImageUrl,\n        employeeCardImageUrl,\n        nationalIdImageUrl,\n        playerInfo,\n        workStartDate,\n        workEndDate,\n      };\n\n      // Create user data\n      const userData = insertUserSchema.parse(userDataRaw);\n\n      const user = await storage.createUser(userData);\n\n      // Log the user in automatically\n      req.login(user, (err) => {\n        if (err) {\n          return res.status(500).json({ message: \"فشل تسجيل الدخول التلقائي\" });\n        }\n        const { password: _, ...userWithoutPassword } = user;\n        res.status(201).json(userWithoutPassword);\n      });\n    } catch (error: any) {\n      console.error(\"Registration error:\", error);\n      res.status(500).json({ message: \"فشل إنشاء الحساب\" });\n    }\n  });\n\n  app.post(\"/api/auth/login\", (req, res, next) => {\n    passport.authenticate(\"local\", (err: any, user: any, info: any) => {\n      if (err) {\n        return res.status(500).json({ message: \"خطأ في تسجيل الدخول\" });\n      }\n      if (!user) {\n        return res.status(401).json({ message: info?.message || \"فشل تسجيل الدخول\" });\n      }\n      req.login(user, (err) => {\n        if (err) {\n          return res.status(500).json({ message: \"خطأ في تسجيل الدخول\" });\n        }\n        const { password: _, ...userWithoutPassword } = user;\n        return res.json(userWithoutPassword);\n      });\n    })(req, res, next);\n  });\n\n  app.post(\"/api/auth/logout\", (req, res) => {\n    req.logout((err) => {\n      if (err) {\n        return res.status(500).json({ message: \"فشل تسجيل الخروج\" });\n      }\n      res.json({ message: \"تم تسجيل الخروج بنجاح\" });\n    });\n  });\n\n  app.get(\"/api/auth/me\", isAuthenticated, async (req, res) => {\n    const user = req.user as any;\n    const { password: _, ...userWithoutPassword } = user;\n    res.json(userWithoutPassword);\n  });\n\n  // Events endpoints\n  app.get(\"/api/events\", async (_req, res) => {\n    try {\n      const events = await storage.getAllEvents();\n      res.json(events);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch events\" });\n    }\n  });\n\n  app.get(\"/api/events/:id\", async (req, res) => {\n    try {\n      const event = await storage.getEventById(req.params.id);\n      if (!event) {\n        return res.status(404).json({ error: \"Event not found\" });\n      }\n      res.json(event);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch event\" });\n    }\n  });\n\n  app.post(\"/api/events\", isAdmin, async (req, res) => {\n    try {\n      const event = await storage.createEvent(req.body);\n      res.status(201).json(event);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create event\" });\n    }\n  });\n\n  // Event Registrations endpoints\n  app.get(\"/api/events/:eventId/registrations\", isAuthenticated, async (req, res) => {\n    try {\n      const registrations = await storage.getEventRegistrations(req.params.eventId);\n      res.json(registrations);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch registrations\" });\n    }\n  });\n\n  app.get(\"/api/my-registrations\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const registrations = await storage.getUserRegistrations(user.id);\n      res.json(registrations);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch user registrations\" });\n    }\n  });\n\n  app.post(\"/api/events/:eventId/register\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const eventId = req.params.eventId;\n\n      // Check if event exists\n      const event = await storage.getEventById(eventId);\n      if (!event) {\n        return res.status(404).json({ message: \"الفعالية غير موجودة\" });\n      }\n\n      // Check if user already registered\n      const existingRegistration = await storage.getRegistration(eventId, user.id);\n      if (existingRegistration) {\n        return res.status(400).json({ message: \"أنت مسجل بالفعل في هذه الفعالية\" });\n      }\n\n      // Check if event is full\n      if (event.maxParticipants && (event.currentParticipants || 0) >= event.maxParticipants) {\n        return res.status(400).json({ message: \"الفعالية ممتلئة\" });\n      }\n\n      // Check shift availability for 2weeks_on_2weeks_off pattern\n      if (user.shiftPattern === \"2weeks_on_2weeks_off\") {\n        const eventDate = new Date(event.date);\n        const referenceDate = new Date(\"2025-01-01\"); // Reference start date\n        const daysDiff = Math.floor((eventDate.getTime() - referenceDate.getTime()) / (1000 * 60 * 60 * 24));\n        const cycleDay = daysDiff % 28; // 28-day cycle (14 on + 14 off)\n        const isOnShift = cycleDay < 14;\n        \n        if (isOnShift) {\n          return res.status(400).json({ \n            message: \"لا يمكنك التسجيل في هذه الفعالية لأنك ستكون في فترة العمل\",\n            shiftConflict: true\n          });\n        }\n      }\n\n      // Create registration\n      const registrationData = insertEventRegistrationSchema.parse({\n        eventId,\n        userId: user.id,\n        status: \"confirmed\",\n        ...req.body,\n      });\n\n      const registration = await storage.createEventRegistration(registrationData);\n      res.status(201).json(registration);\n    } catch (error: any) {\n      console.error(\"Registration error:\", error);\n      res.status(500).json({ message: \"فشل التسجيل في الفعالية\" });\n    }\n  });\n\n  app.delete(\"/api/registrations/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const registrationId = req.params.id;\n\n      // Get registration to verify ownership\n      const [registration] = await storage.getEventRegistrations(registrationId);\n      if (!registration) {\n        return res.status(404).json({ message: \"التسجيل غير موجود\" });\n      }\n\n      // Check if user owns this registration or is admin\n      if (registration.userId !== user.id && user.role !== \"admin\") {\n        return res.status(403).json({ message: \"غير مصرح لك بإلغاء هذا التسجيل\" });\n      }\n\n      const success = await storage.deleteEventRegistration(registrationId);\n      if (!success) {\n        return res.status(404).json({ message: \"فشل إلغاء التسجيل\" });\n      }\n\n      res.json({ message: \"تم إلغاء التسجيل بنجاح\" });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to cancel registration\" });\n    }\n  });\n\n  // News endpoints\n  app.get(\"/api/news\", async (_req, res) => {\n    try {\n      const news = await storage.getAllNews();\n      res.json(news);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch news\" });\n    }\n  });\n\n  app.post(\"/api/news\", isAdmin, async (req, res) => {\n    try {\n      const news = await storage.createNews(req.body);\n      res.status(201).json(news);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create news\" });\n    }\n  });\n\n  // Results endpoints\n  app.get(\"/api/results\", async (_req, res) => {\n    try {\n      const results = await storage.getAllResults();\n      res.json(results);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch results\" });\n    }\n  });\n\n  app.post(\"/api/results\", isAdmin, async (req, res) => {\n    try {\n      const result = await storage.createResult(req.body);\n      res.status(201).json(result);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create result\" });\n    }\n  });\n\n  // Athletes endpoints\n  app.get(\"/api/athletes\", async (_req, res) => {\n    try {\n      const athletes = await storage.getAllAthletes();\n      res.json(athletes);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch athletes\" });\n    }\n  });\n\n  app.post(\"/api/athletes\", isAdmin, async (req, res) => {\n    try {\n      const athlete = await storage.createAthlete(req.body);\n      res.status(201).json(athlete);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create athlete\" });\n    }\n  });\n\n  // Gallery endpoints\n  app.get(\"/api/gallery\", async (req, res) => {\n    try {\n      const { category } = req.query;\n      const gallery = category \n        ? await storage.getGalleryByCategory(category as string)\n        : await storage.getAllGallery();\n      res.json(gallery);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch gallery\" });\n    }\n  });\n\n  app.post(\"/api/gallery\", isAdmin, async (req, res) => {\n    try {\n      const galleryItem = await storage.createGalleryItem(req.body);\n      res.status(201).json(galleryItem);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create gallery item\" });\n    }\n  });\n\n  // Stats endpoint\n  app.get(\"/api/stats\", async (_req, res) => {\n    try {\n      const stats = await storage.getStats();\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch stats\" });\n    }\n  });\n\n  // Site Settings endpoints\n  app.get(\"/api/settings/:key\", async (req, res) => {\n    try {\n      const value = await storage.getSetting(req.params.key);\n      res.json({ key: req.params.key, value });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch setting\" });\n    }\n  });\n\n  app.post(\"/api/settings/:key\", isAdmin, async (req, res) => {\n    try {\n      const { value } = req.body;\n      const setting = await storage.setSetting(req.params.key, value);\n      res.json(setting);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update setting\" });\n    }\n  });\n\n  // Seed teams and players\n  app.post(\"/api/seed/teams-players\", isAdmin, async (_req, res) => {\n    try {\n      const result = await storage.seedTeamsAndPlayers();\n      res.json({ \n        success: true, \n        message: `تم إنشاء ${result.teamsCreated} فريق و ${result.playersCreated} لاعب`,\n        ...result \n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to seed teams and players\" });\n    }\n  });\n\n  // User management endpoints (admin only)\n  app.get(\"/api/users\", isAdmin, async (_req, res) => {\n    try {\n      const allUsers = await storage.getAllUsers();\n      // Remove passwords from response\n      const safeUsers = allUsers.map(({ password, ...user }) => user);\n      res.json(safeUsers);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch users\" });\n    }\n  });\n\n  app.patch(\"/api/users/:id/role\", isAdmin, async (req, res) => {\n    try {\n      const { role } = req.body;\n      if (![\"employee\", \"admin\", \"committee_member\"].includes(role)) {\n        return res.status(400).json({ error: \"Invalid role\" });\n      }\n      \n      const updatedUser = await storage.updateUser(req.params.id, { role });\n      if (!updatedUser) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n      \n      const { password, ...safeUser } = updatedUser;\n      res.json(safeUser);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update user role\" });\n    }\n  });\n\n  app.patch(\"/api/users/:id/status\", isAdmin, async (req, res) => {\n    try {\n      const { isActive } = req.body;\n      const updatedUser = await storage.updateUser(req.params.id, { isActive });\n      if (!updatedUser) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n      \n      const { password, ...safeUser } = updatedUser;\n      res.json(safeUser);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update user status\" });\n    }\n  });\n\n  // Get linkable users for player association (excludes users already linked to a player)\n  app.get(\"/api/users/linkable\", isAuthenticated, async (_req, res) => {\n    try {\n      const users = await storage.getAllUsers();\n      const allPlayers = await storage.getAllPlayers();\n      \n      // Get set of userIds that are already linked to players\n      const linkedUserIds = new Set(\n        allPlayers\n          .filter(p => p.userId != null)\n          .map(p => p.userId as string)\n      );\n      \n      // Filter out already linked users and return minimal fields\n      const linkableUsers = users\n        .filter(u => !linkedUserIds.has(u.id))\n        .map(u => ({\n          id: u.id,\n          fullName: u.fullName,\n          employeeId: u.employeeId\n        }));\n      res.json(linkableUsers);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch users\" });\n    }\n  });\n\n  // Notifications endpoints\n  app.get(\"/api/notifications\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const notifications = await storage.getUserNotifications(user.id);\n      res.json(notifications);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch notifications\" });\n    }\n  });\n\n  app.get(\"/api/notifications/unread-count\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const count = await storage.getUnreadNotificationsCount(user.id);\n      res.json({ count });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch unread count\" });\n    }\n  });\n\n  app.post(\"/api/notifications/:id/read\", isAuthenticated, async (req, res) => {\n    try {\n      await storage.markNotificationAsRead(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to mark notification as read\" });\n    }\n  });\n\n  app.post(\"/api/notifications/read-all\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      await storage.markAllNotificationsAsRead(user.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to mark all notifications as read\" });\n    }\n  });\n\n  // Forum endpoints\n  app.get(\"/api/forum/posts\", async (req, res) => {\n    try {\n      const { category } = req.query;\n      const posts = await storage.getAllPosts(category as string | undefined);\n      res.json(posts);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch posts\" });\n    }\n  });\n\n  app.get(\"/api/forum/posts/:id\", async (req, res) => {\n    try {\n      const post = await storage.getPostById(req.params.id);\n      if (!post) {\n        return res.status(404).json({ error: \"Post not found\" });\n      }\n      res.json(post);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch post\" });\n    }\n  });\n\n  app.post(\"/api/forum/posts\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const post = await storage.createPost({\n        ...req.body,\n        userId: user.id,\n      });\n      res.status(201).json(post);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create post\" });\n    }\n  });\n\n  app.delete(\"/api/forum/posts/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const success = await storage.deletePost(req.params.id, user.id);\n      if (!success) {\n        return res.status(403).json({ error: \"Cannot delete this post\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete post\" });\n    }\n  });\n\n  app.get(\"/api/forum/posts/:postId/comments\", async (req, res) => {\n    try {\n      const comments = await storage.getPostComments(req.params.postId);\n      res.json(comments);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch comments\" });\n    }\n  });\n\n  app.post(\"/api/forum/posts/:postId/comments\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const comment = await storage.createComment({\n        postId: req.params.postId,\n        userId: user.id,\n        content: req.body.content,\n      });\n      \n      // Create notification for post owner\n      const post = await storage.getPostById(req.params.postId);\n      if (post && post.userId !== user.id) {\n        await storage.createNotification({\n          userId: post.userId,\n          title: \"تعليق جديد\",\n          message: `علّق ${user.fullName} على منشورك`,\n          type: \"info\",\n          isRead: false,\n        });\n      }\n      \n      res.status(201).json(comment);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create comment\" });\n    }\n  });\n\n  app.delete(\"/api/forum/comments/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const success = await storage.deleteComment(req.params.id, user.id);\n      if (!success) {\n        return res.status(403).json({ error: \"Cannot delete this comment\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete comment\" });\n    }\n  });\n\n  app.post(\"/api/forum/posts/:postId/like\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const liked = await storage.toggleLike(req.params.postId, user.id);\n      \n      // Create notification for post owner if liked\n      if (liked) {\n        const post = await storage.getPostById(req.params.postId);\n        if (post && post.userId !== user.id) {\n          await storage.createNotification({\n            userId: post.userId,\n            title: \"إعجاب جديد\",\n            message: `أعجب ${user.fullName} بمنشورك`,\n            type: \"info\",\n            isRead: false,\n          });\n        }\n      }\n      \n      res.json({ liked });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to toggle like\" });\n    }\n  });\n\n  app.get(\"/api/forum/posts/:postId/liked\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const liked = await storage.isPostLikedByUser(req.params.postId, user.id);\n      res.json({ liked });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to check like status\" });\n    }\n  });\n\n  // ========== LEAGUE GENERATOR ENDPOINTS ==========\n\n  // Tournaments\n  app.get(\"/api/tournaments\", async (_req, res) => {\n    try {\n      const tournamentsList = await storage.getAllTournaments();\n      res.json(tournamentsList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch tournaments\" });\n    }\n  });\n\n  app.get(\"/api/tournaments/:id\", async (req, res) => {\n    try {\n      const tournament = await storage.getTournamentById(req.params.id);\n      if (!tournament) {\n        return res.status(404).json({ error: \"Tournament not found\" });\n      }\n      res.json(tournament);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch tournament\" });\n    }\n  });\n\n  app.post(\"/api/tournaments\", isAdmin, async (req, res) => {\n    try {\n      const body = { ...req.body };\n      \n      // Convert date strings to Date objects\n      if (body.startDate && typeof body.startDate === 'string') {\n        body.startDate = new Date(body.startDate);\n      }\n      if (body.endDate && typeof body.endDate === 'string') {\n        body.endDate = new Date(body.endDate);\n      }\n      if (body.registrationStart && typeof body.registrationStart === 'string') {\n        body.registrationStart = new Date(body.registrationStart);\n      }\n      if (body.registrationEnd && typeof body.registrationEnd === 'string') {\n        body.registrationEnd = new Date(body.registrationEnd);\n      }\n      \n      const tournamentData = insertTournamentSchema.parse(body);\n      const tournament = await storage.createTournament(tournamentData);\n      res.status(201).json(tournament);\n    } catch (error: any) {\n      console.error(\"Tournament creation error:\", error);\n      res.status(500).json({ error: error.message || \"Failed to create tournament\" });\n    }\n  });\n\n  app.patch(\"/api/tournaments/:id\", isAdmin, async (req, res) => {\n    try {\n      const body = { ...req.body };\n      \n      // Convert date strings to Date objects\n      if (body.startDate && typeof body.startDate === 'string') {\n        body.startDate = new Date(body.startDate);\n      }\n      if (body.endDate && typeof body.endDate === 'string') {\n        body.endDate = new Date(body.endDate);\n      }\n      if (body.registrationStart && typeof body.registrationStart === 'string') {\n        body.registrationStart = new Date(body.registrationStart);\n      }\n      if (body.registrationEnd && typeof body.registrationEnd === 'string') {\n        body.registrationEnd = new Date(body.registrationEnd);\n      }\n      \n      const tournament = await storage.updateTournament(req.params.id, body);\n      if (!tournament) {\n        return res.status(404).json({ error: \"Tournament not found\" });\n      }\n      res.json(tournament);\n    } catch (error: any) {\n      console.error(\"Tournament update error:\", error);\n      res.status(500).json({ error: error.message || \"Failed to update tournament\" });\n    }\n  });\n\n  app.delete(\"/api/tournaments/:id\", isAdmin, async (req, res) => {\n    try {\n      await storage.deleteTournament(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete tournament\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:id/generate-matches\", isAdmin, async (req, res) => {\n    try {\n      const { matchesPerDay, dailyStartTime } = req.body;\n      const options = { \n        matchesPerDay: matchesPerDay ? parseInt(matchesPerDay) : undefined,\n        dailyStartTime: dailyStartTime || undefined\n      };\n      \n      // Check tournament type to decide which generator to use\n      const tournament = await storage.getTournamentById(req.params.id);\n      if (!tournament) {\n        return res.status(404).json({ error: \"Tournament not found\" });\n      }\n      \n      let generatedMatches;\n      if (tournament.hasGroupStage || tournament.type === 'groups' || tournament.type === 'groups_knockout') {\n        // For group-stage tournaments, generate matches within each group\n        generatedMatches = await storage.generateGroupStageMatches(req.params.id, options);\n      } else {\n        // For round-robin or knockout, generate league matches\n        generatedMatches = await storage.generateLeagueMatches(req.params.id, options);\n      }\n      \n      await storage.updateTournament(req.params.id, { status: \"ongoing\" });\n      res.json({ matches: generatedMatches, count: generatedMatches.length });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"Failed to generate matches\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:id/generate-knockout\", isAdmin, async (req, res) => {\n    try {\n      const generatedMatches = await storage.generateKnockoutMatchesFromGroups(req.params.id);\n      res.json({ matches: generatedMatches, count: generatedMatches.length });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"Failed to generate knockout matches\" });\n    }\n  });\n\n  // ========== GROUP STAGE MANAGEMENT ==========\n  \n  app.post(\"/api/tournaments/:id/assign-groups\", isAdmin, async (req, res) => {\n    try {\n      const { assignments } = req.body;\n      const updatedTeams = await storage.assignTeamsToGroups(req.params.id, assignments);\n      res.json({ teams: updatedTeams, message: \"تم توزيع الفرق على المجموعات بنجاح\" });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"فشل في توزيع الفرق على المجموعات\" });\n    }\n  });\n\n  // Random Draw - Shuffle teams into groups randomly\n  app.post(\"/api/tournaments/:id/random-draw\", isAdmin, async (req, res) => {\n    try {\n      const { numberOfGroups } = req.body;\n      const tournamentId = req.params.id;\n      \n      // Get tournament and teams\n      const tournament = await storage.getTournamentById(tournamentId);\n      if (!tournament) {\n        return res.status(404).json({ error: \"البطولة غير موجودة\" });\n      }\n      \n      const teams = await storage.getTeamsByTournament(tournamentId);\n      if (!teams || teams.length === 0) {\n        return res.status(400).json({ error: \"لا توجد فرق مسجلة في البطولة\" });\n      }\n      \n      const numGroups = numberOfGroups || tournament.numberOfGroups || 2;\n      \n      if (teams.length < numGroups) {\n        return res.status(400).json({ error: \"عدد الفرق أقل من عدد المجموعات\" });\n      }\n      \n      // Shuffle teams randomly using Fisher-Yates algorithm\n      const shuffledTeams = [...teams];\n      for (let i = shuffledTeams.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [shuffledTeams[i], shuffledTeams[j]] = [shuffledTeams[j], shuffledTeams[i]];\n      }\n      \n      // Distribute teams to groups evenly\n      const assignments: { teamId: string; groupNumber: number }[] = [];\n      shuffledTeams.forEach((team, index) => {\n        const groupNumber = (index % numGroups) + 1;\n        assignments.push({ teamId: team.id, groupNumber });\n      });\n      \n      // Apply the assignments\n      const updatedTeams = await storage.assignTeamsToGroups(tournamentId, assignments);\n      \n      res.json({ \n        teams: updatedTeams, \n        numberOfGroups: numGroups,\n        message: `تم إجراء القرعة بنجاح وتوزيع ${teams.length} فريق على ${numGroups} مجموعات` \n      });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"فشل في إجراء القرعة العشوائية\" });\n    }\n  });\n\n  app.get(\"/api/tournaments/:id/group-standings\", async (req, res) => {\n    try {\n      const groupedStandings = await storage.getGroupStandings(req.params.id);\n      \n      // Group number to Arabic letter mapping\n      const groupNameMap: Record<number, string> = {\n        1: \"المجموعة أ\",\n        2: \"المجموعة ب\",\n        3: \"المجموعة ج\",\n        4: \"المجموعة د\",\n        5: \"المجموعة هـ\",\n        6: \"المجموعة و\",\n        7: \"المجموعة ز\",\n        8: \"المجموعة ح\",\n      };\n      \n      // Flatten the grouped standings into the format expected by the frontend\n      const flattenedStandings = groupedStandings.flatMap(group => \n        group.teams.map(team => ({\n          teamId: team.id,\n          teamName: team.name,\n          groupName: groupNameMap[group.groupNumber] || `المجموعة ${group.groupNumber}`,\n          played: team.played ?? 0,\n          won: team.won ?? 0,\n          drawn: team.drawn ?? 0,\n          lost: team.lost ?? 0,\n          goalsFor: team.goalsFor ?? 0,\n          goalsAgainst: team.goalsAgainst ?? 0,\n          goalDifference: team.goalDifference ?? 0,\n          points: team.points ?? 0,\n        }))\n      );\n      \n      res.json(flattenedStandings);\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"فشل في جلب ترتيب المجموعات\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:id/generate-group-matches\", isAdmin, async (req, res) => {\n    try {\n      const { matchesPerDay, dailyStartTime } = req.body;\n      const options = { \n        matchesPerDay: matchesPerDay ? parseInt(matchesPerDay) : undefined,\n        dailyStartTime: dailyStartTime || undefined\n      };\n      const generatedMatches = await storage.generateGroupStageMatches(req.params.id, options);\n      await storage.updateTournament(req.params.id, { status: \"ongoing\", currentStage: \"group_stage\" });\n      res.json({ matches: generatedMatches, count: generatedMatches.length, message: \"تم إنشاء مباريات المجموعات بنجاح\" });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"فشل في إنشاء مباريات المجموعات\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:id/complete-group-stage\", isAdmin, async (req, res) => {\n    try {\n      const result = await storage.completeGroupStage(req.params.id);\n      res.json({ \n        tournament: result.tournament, \n        qualifiedTeams: result.qualifiedTeams,\n        message: \"تم إنهاء مرحلة المجموعات بنجاح\" \n      });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"فشل في إنهاء مرحلة المجموعات\" });\n    }\n  });\n\n  // Teams\n  app.get(\"/api/teams\", async (_req, res) => {\n    try {\n      const teamsList = await storage.getAllTeams();\n      res.json(teamsList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch teams\" });\n    }\n  });\n\n  app.post(\"/api/teams\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const teamData = insertTeamSchema.parse({\n        ...req.body,\n        captainId: req.body.captainId || user.id,\n      });\n      const team = await storage.createTeam(teamData);\n      res.status(201).json(team);\n    } catch (error: any) {\n      console.error(\"Team creation error:\", error);\n      res.status(500).json({ error: error.message || \"Failed to create team\" });\n    }\n  });\n\n  app.get(\"/api/tournaments/:tournamentId/teams\", async (req, res) => {\n    try {\n      const teamsList = await storage.getTeamsByTournament(req.params.tournamentId);\n      res.json(teamsList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch teams\" });\n    }\n  });\n\n  app.get(\"/api/teams/:id\", async (req, res) => {\n    try {\n      const team = await storage.getTeamById(req.params.id);\n      if (!team) {\n        return res.status(404).json({ error: \"Team not found\" });\n      }\n      res.json(team);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch team\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:tournamentId/teams\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const teamData = insertTeamSchema.parse({\n        ...req.body,\n        tournamentId: req.params.tournamentId,\n        captainId: req.body.captainId || user.id,\n      });\n      const team = await storage.createTeam(teamData);\n      res.status(201).json(team);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create team\" });\n    }\n  });\n\n  app.patch(\"/api/teams/:id\", isAuthenticated, async (req, res) => {\n    try {\n      // Get existing team to check if groupNumber is changing\n      const existingTeam = await storage.getTeamById(req.params.id);\n      const team = await storage.updateTeam(req.params.id, req.body);\n      if (!team) {\n        return res.status(404).json({ error: \"Team not found\" });\n      }\n      \n      // If groupNumber changed, regenerate group stage matches\n      if (existingTeam && req.body.groupNumber !== undefined && \n          existingTeam.groupNumber !== req.body.groupNumber && team.tournamentId) {\n        try {\n          await storage.generateGroupStageMatches(team.tournamentId);\n        } catch (e) {\n          // Ignore if tournament doesn't have group stage\n          console.log(\"Could not regenerate group matches:\", e);\n        }\n      }\n      \n      res.json(team);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update team\" });\n    }\n  });\n\n  app.delete(\"/api/teams/:id\", isAdmin, async (req, res) => {\n    try {\n      await storage.deleteTeam(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete team\" });\n    }\n  });\n\n  // Players\n  app.get(\"/api/players\", async (_req, res) => {\n    try {\n      const playersList = await storage.getAllPlayers();\n      res.json(playersList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch players\" });\n    }\n  });\n\n  // Get players with user and team details\n  app.get(\"/api/players/with-details\", async (_req, res) => {\n    try {\n      const playersList = await storage.getAllPlayers();\n      const allUsers = await storage.getAllUsers();\n      const allTeams = await storage.getAllTeams();\n      \n      const playersWithDetails = playersList.map(player => {\n        const user = player.userId ? allUsers.find(u => u.id === player.userId) : null;\n        const team = player.teamId ? allTeams.find(t => t.id === player.teamId) : null;\n        \n        return {\n          ...player,\n          user: user ? { fullName: user.fullName, employeeId: user.employeeId } : null,\n          team: team ? { name: team.name, logoUrl: team.logoUrl } : null,\n        };\n      });\n      \n      res.json(playersWithDetails);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch players with details\" });\n    }\n  });\n\n  app.post(\"/api/players\", isAuthenticated, async (req, res) => {\n    try {\n      const playerData = insertPlayerSchema.parse(req.body);\n      const player = await storage.createPlayer(playerData);\n      res.status(201).json(player);\n    } catch (error: any) {\n      console.error(\"Player creation error:\", error);\n      res.status(500).json({ error: error.message || \"Failed to create player\" });\n    }\n  });\n\n  app.get(\"/api/teams/:teamId/players\", async (req, res) => {\n    try {\n      const playersList = await storage.getPlayersByTeam(req.params.teamId);\n      res.json(playersList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch players\" });\n    }\n  });\n\n  app.get(\"/api/players/:id\", async (req, res) => {\n    try {\n      const player = await storage.getPlayerById(req.params.id);\n      if (!player) {\n        return res.status(404).json({ error: \"Player not found\" });\n      }\n      res.json(player);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch player\" });\n    }\n  });\n\n  app.post(\"/api/teams/:teamId/players\", isAuthenticated, async (req, res) => {\n    try {\n      const playerData = insertPlayerSchema.parse({\n        ...req.body,\n        teamId: req.params.teamId,\n      });\n      const player = await storage.createPlayer(playerData);\n      res.status(201).json(player);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create player\" });\n    }\n  });\n\n  app.patch(\"/api/players/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const player = await storage.updatePlayer(req.params.id, req.body);\n      if (!player) {\n        return res.status(404).json({ error: \"Player not found\" });\n      }\n      res.json(player);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update player\" });\n    }\n  });\n\n  app.delete(\"/api/players/:id\", isAuthenticated, async (req, res) => {\n    try {\n      await storage.deletePlayer(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete player\" });\n    }\n  });\n\n  app.get(\"/api/tournaments/:tournamentId/top-scorers\", async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 10;\n      const topScorers = await storage.getTopScorers(req.params.tournamentId, limit);\n      res.json(topScorers);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch top scorers\" });\n    }\n  });\n\n  // Referees\n  app.get(\"/api/referees\", async (_req, res) => {\n    try {\n      const refereesList = await storage.getAllReferees();\n      res.json(refereesList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch referees\" });\n    }\n  });\n\n  app.get(\"/api/tournaments/:tournamentId/referees\", async (req, res) => {\n    try {\n      const refereesList = await storage.getRefereesByTournament(req.params.tournamentId);\n      res.json(refereesList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch referees\" });\n    }\n  });\n\n  app.get(\"/api/referees/:id\", async (req, res) => {\n    try {\n      const referee = await storage.getRefereeById(req.params.id);\n      if (!referee) {\n        return res.status(404).json({ error: \"Referee not found\" });\n      }\n      res.json(referee);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch referee\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:tournamentId/referees\", isAdmin, async (req, res) => {\n    try {\n      const referee = await storage.createReferee({\n        ...req.body,\n        tournamentId: req.params.tournamentId,\n      });\n      res.status(201).json(referee);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create referee\" });\n    }\n  });\n\n  app.patch(\"/api/referees/:id\", isAdmin, async (req, res) => {\n    try {\n      const referee = await storage.updateReferee(req.params.id, req.body);\n      if (!referee) {\n        return res.status(404).json({ error: \"Referee not found\" });\n      }\n      res.json(referee);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update referee\" });\n    }\n  });\n\n  app.delete(\"/api/referees/:id\", isAdmin, async (req, res) => {\n    try {\n      await storage.deleteReferee(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete referee\" });\n    }\n  });\n\n  // Matches\n  app.get(\"/api/tournaments/:tournamentId/matches\", async (req, res) => {\n    try {\n      const matchesList = await storage.getMatchesByTournament(req.params.tournamentId);\n      res.json(matchesList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch matches\" });\n    }\n  });\n\n  app.get(\"/api/matches/:id\", async (req, res) => {\n    try {\n      const match = await storage.getMatchById(req.params.id);\n      if (!match) {\n        return res.status(404).json({ error: \"Match not found\" });\n      }\n      res.json(match);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch match\" });\n    }\n  });\n\n  app.post(\"/api/tournaments/:tournamentId/matches\", isAdmin, async (req, res) => {\n    try {\n      const matchData = insertMatchSchema.parse({\n        ...req.body,\n        tournamentId: req.params.tournamentId,\n      });\n      \n      // Validate that group stage matches are between teams in the same group\n      // Only validate if both teams have been assigned to groups (groupNumber > 0)\n      if (matchData.stage === 'group' && matchData.homeTeamId && matchData.awayTeamId) {\n        const homeTeam = await storage.getTeamById(matchData.homeTeamId);\n        const awayTeam = await storage.getTeamById(matchData.awayTeamId);\n        \n        if (homeTeam && awayTeam) {\n          const homeGroup = homeTeam.groupNumber;\n          const awayGroup = awayTeam.groupNumber;\n          \n          // Only validate if BOTH teams have valid group assignments (not null/undefined/0)\n          if (homeGroup && homeGroup > 0 && awayGroup && awayGroup > 0 && homeGroup !== awayGroup) {\n            return res.status(400).json({ \n              error: \"لا يمكن إنشاء مباراة بين فريقين من مجموعتين مختلفتين في مرحلة المجموعات\"\n            });\n          }\n        }\n      }\n      \n      // Prevent duplicate matches between same teams in same stage\n      if (matchData.homeTeamId && matchData.awayTeamId && matchData.stage) {\n        const existingMatches = await storage.getMatchesByTournament(req.params.tournamentId);\n        const isDuplicate = existingMatches.some(m => \n          m.stage === matchData.stage && (\n            (m.homeTeamId === matchData.homeTeamId && m.awayTeamId === matchData.awayTeamId) ||\n            (m.homeTeamId === matchData.awayTeamId && m.awayTeamId === matchData.homeTeamId)\n          )\n        );\n        if (isDuplicate) {\n          return res.status(400).json({ \n            error: \"يوجد مباراة مسجلة مسبقاً بين هذين الفريقين في نفس المرحلة\"\n          });\n        }\n      }\n      \n      const match = await storage.createMatch(matchData);\n      res.status(201).json(match);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create match\" });\n    }\n  });\n\n  app.patch(\"/api/matches/:id\", isAdmin, async (req, res) => {\n    try {\n      const updates = { ...req.body };\n      // Convert matchDate string to Date if provided\n      if (updates.matchDate && typeof updates.matchDate === 'string') {\n        updates.matchDate = new Date(updates.matchDate);\n      }\n      const match = await storage.updateMatch(req.params.id, updates);\n      if (!match) {\n        return res.status(404).json({ error: \"Match not found\" });\n      }\n      res.json(match);\n    } catch (error) {\n      console.error(\"Match update error:\", error);\n      res.status(500).json({ error: \"Failed to update match\" });\n    }\n  });\n\n  app.delete(\"/api/matches/:id\", isAdmin, async (req, res) => {\n    try {\n      await storage.deleteMatch(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete match\" });\n    }\n  });\n\n  // Match Events\n  app.get(\"/api/matches/:matchId/events\", async (req, res) => {\n    try {\n      const eventsList = await storage.getMatchEvents(req.params.matchId);\n      res.json(eventsList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch match events\" });\n    }\n  });\n\n  app.post(\"/api/matches/:matchId/events\", isAdmin, async (req, res) => {\n    try {\n      const eventData = insertMatchEventSchema.parse({\n        ...req.body,\n        matchId: req.params.matchId,\n      });\n      const event = await storage.createMatchEvent(eventData);\n      res.status(201).json(event);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create match event\" });\n    }\n  });\n\n  app.delete(\"/api/match-events/:id\", isAdmin, async (req, res) => {\n    try {\n      await storage.deleteMatchEvent(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete match event\" });\n    }\n  });\n\n  // Match Lineups\n  app.get(\"/api/matches/:matchId/lineups\", async (req, res) => {\n    try {\n      const teamId = req.query.teamId as string | undefined;\n      const lineupsList = await storage.getMatchLineups(req.params.matchId, teamId);\n      res.json(lineupsList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch match lineups\" });\n    }\n  });\n\n  app.post(\"/api/matches/:matchId/lineups\", isAuthenticated, async (req, res) => {\n    try {\n      const lineupData = insertMatchLineupSchema.parse({\n        ...req.body,\n        matchId: req.params.matchId,\n      });\n      const lineup = await storage.createMatchLineup(lineupData);\n      res.status(201).json(lineup);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create lineup\" });\n    }\n  });\n\n  app.patch(\"/api/lineups/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const lineup = await storage.updateMatchLineup(req.params.id, req.body);\n      if (!lineup) {\n        return res.status(404).json({ error: \"Lineup not found\" });\n      }\n      res.json(lineup);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update lineup\" });\n    }\n  });\n\n  app.delete(\"/api/lineups/:id\", isAuthenticated, async (req, res) => {\n    try {\n      await storage.deleteMatchLineup(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete lineup\" });\n    }\n  });\n\n  // Match Comments\n  app.get(\"/api/matches/:matchId/comments\", async (req, res) => {\n    try {\n      const commentsList = await storage.getMatchComments(req.params.matchId);\n      res.json(commentsList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch match comments\" });\n    }\n  });\n\n  app.post(\"/api/matches/:matchId/comments\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const commentData = insertMatchCommentSchema.parse({\n        ...req.body,\n        matchId: req.params.matchId,\n        userId: user.id,\n      });\n      const comment = await storage.createMatchComment(commentData);\n      res.status(201).json(comment);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create comment\" });\n    }\n  });\n\n  app.delete(\"/api/match-comments/:id\", isAuthenticated, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const success = await storage.deleteMatchComment(req.params.id, user.id);\n      if (!success) {\n        return res.status(403).json({ error: \"Cannot delete this comment\" });\n      }\n      res.json({ success: true });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to delete comment\" });\n    }\n  });\n\n  // Team Evaluations\n  app.get(\"/api/teams/:teamId/evaluations\", async (req, res) => {\n    try {\n      const evaluations = await storage.getTeamEvaluations(req.params.teamId);\n      res.json(evaluations);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch evaluations\" });\n    }\n  });\n\n  app.post(\"/api/teams/:teamId/evaluations\", isAdmin, async (req, res) => {\n    try {\n      const user = req.user as any;\n      const evaluationData = insertTeamEvaluationSchema.parse({\n        ...req.body,\n        teamId: req.params.teamId,\n        evaluatorId: user.id,\n      });\n      const evaluation = await storage.createTeamEvaluation(evaluationData);\n      res.status(201).json(evaluation);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to create evaluation\" });\n    }\n  });\n\n  // Standings recalculation endpoint\n  app.post(\"/api/tournaments/:tournamentId/recalculate-standings\", isAdmin, async (req, res) => {\n    try {\n      await storage.updateTeamStandings(req.params.tournamentId);\n      const teamsList = await storage.getTeamsByTournament(req.params.tournamentId);\n      res.json(teamsList);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to recalculate standings\" });\n    }\n  });\n\n  // ========== FILE UPLOAD ENDPOINT ==========\n  app.post(\"/api/upload\", isAuthenticated, upload.single(\"image\"), (req, res) => {\n    try {\n      if (!req.file) {\n        return res.status(400).json({ error: \"No file uploaded\" });\n      }\n      const fileUrl = `/uploads/${req.file.filename}`;\n      res.json({ \n        success: true, \n        url: fileUrl,\n        filename: req.file.filename,\n        originalName: req.file.originalname,\n        size: req.file.size\n      });\n    } catch (error: any) {\n      res.status(500).json({ error: error.message || \"Failed to upload file\" });\n    }\n  });\n\n  // Serve uploaded files statically\n  app.use(\"/uploads\", (await import(\"express\")).default.static(uploadDir));\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","path":null,"size_bytes":50994,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n\n  /* Automatic computation of border around primary / danger buttons */\n  --opaque-button-border-intensity: -8; /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n\n  --background: 0 0% 98%;\n\n  --foreground: 220 15% 20%;\n\n  --border: 220 10% 88%;\n\n  --card: 0 0% 100%;\n\n  --card-foreground: 220 15% 20%;\n\n  --card-border: 220 8% 90%;\n\n  --sidebar: 220 5% 94%;\n\n  --sidebar-foreground: 220 15% 22%;\n\n  --sidebar-border: 220 6% 87%;\n\n  --sidebar-primary: 187 100% 35%;\n\n  --sidebar-primary-foreground: 187 100% 98%;\n\n  --sidebar-accent: 187 20% 88%;\n\n  --sidebar-accent-foreground: 187 30% 25%;\n\n  --sidebar-ring: 187 100% 35%;\n\n  --popover: 0 0% 100%;\n\n  --popover-foreground: 220 15% 22%;\n\n  --popover-border: 187 15% 85%;\n\n  --primary: 187 100% 35%;\n\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 220 8% 86%;\n\n  --secondary-foreground: 220 15% 25%;\n\n  --muted: 220 10% 90%;\n\n  --muted-foreground: 220 12% 45%;\n\n  --accent: 220 12% 88%;\n\n  --accent-foreground: 220 15% 28%;\n\n  --destructive: 0 75% 42%;\n\n  --destructive-foreground: 0 75% 98%;\n\n  /* Sports theme colors */\n  --victory: 25 95% 55%;\n  --victory-foreground: 25 95% 98%;\n\n  --success: 145 70% 45%;\n  --success-foreground: 145 70% 98%;\n\n  --gold: 45 90% 55%;\n  --gold-foreground: 45 90% 15%;\n\n  --input: 187 15% 72%;\n  --ring: 187 100% 35%;\n  --chart-1: 187 100% 35%;\n  --chart-2: 25 95% 48%;\n  --chart-3: 145 70% 40%;\n  --chart-4: 45 90% 50%;\n  --chart-5: 280 70% 45%;\n\n  --font-sans: 'IBM Plex Sans Arabic', 'Open Sans', sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: 'Rubik', monospace;\n  --radius: .5rem; /* 8px */\n  --shadow-2xs: 0px 1px 2px 0px hsl(220 15% 20% / 0.04);\n  --shadow-xs: 0px 1px 3px 0px hsl(220 15% 20% / 0.08);\n  --shadow-sm: 0px 2px 4px -1px hsl(220 15% 20% / 0.06), 0px 1px 2px -1px hsl(220 15% 20% / 0.04);\n  --shadow: 0px 4px 6px -1px hsl(220 15% 20% / 0.08), 0px 2px 4px -2px hsl(220 15% 20% / 0.06);\n  --shadow-md: 0px 6px 12px -2px hsl(220 15% 20% / 0.10), 0px 3px 6px -3px hsl(220 15% 20% / 0.08);\n  --shadow-lg: 0px 10px 20px -4px hsl(220 15% 20% / 0.12), 0px 4px 8px -4px hsl(220 15% 20% / 0.08);\n  --shadow-xl: 0px 20px 30px -6px hsl(220 15% 20% / 0.14), 0px 8px 12px -6px hsl(220 15% 20% / 0.10);\n  --shadow-2xl: 0px 25px 50px -12px hsl(220 15% 20% / 0.20);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n\n  --opaque-button-border-intensity: 9;  /* In terms of percentages */\n\n  /* Backgrounds applied on top of other backgrounds when hovered/active */\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n\n  --background: 220 15% 8%;\n\n  --foreground: 0 0% 95%;\n\n  --border: 220 12% 18%;\n\n  --card: 220 15% 12%;\n\n  --card-foreground: 0 0% 95%;\n\n  --card-border: 220 12% 16%;\n\n  --sidebar: 220 15% 12%;\n\n  --sidebar-foreground: 0 0% 94%;\n\n  --sidebar-border: 220 12% 20%;\n\n  --sidebar-primary: 187 100% 40%;\n\n  --sidebar-primary-foreground: 0 0% 100%;\n\n  --sidebar-accent: 187 20% 18%;\n\n  --sidebar-accent-foreground: 0 0% 92%;\n\n  --sidebar-ring: 187 100% 45%;\n\n  --popover: 220 15% 14%;\n\n  --popover-foreground: 0 0% 94%;\n\n  --popover-border: 187 20% 22%;\n\n  --primary: 187 100% 40%;\n\n  --primary-foreground: 0 0% 100%;\n\n  --secondary: 220 10% 20%;\n\n  --secondary-foreground: 0 0% 92%;\n\n  --muted: 220 12% 16%;\n\n  --muted-foreground: 220 8% 65%;\n\n  --accent: 220 12% 18%;\n\n  --accent-foreground: 0 0% 90%;\n\n  --destructive: 0 75% 42%;\n\n  --destructive-foreground: 0 75% 98%;\n\n  /* Sports theme colors - dark mode */\n  --victory: 25 95% 60%;\n  --victory-foreground: 25 95% 98%;\n\n  --success: 145 70% 50%;\n  --success-foreground: 145 70% 98%;\n\n  --gold: 45 90% 60%;\n  --gold-foreground: 45 90% 10%;\n\n  --input: 187 15% 35%;\n  --ring: 187 100% 45%;\n  --chart-1: 187 100% 45%;\n  --chart-2: 25 95% 65%;\n  --chart-3: 145 70% 55%;\n  --chart-4: 45 90% 60%;\n  --chart-5: 280 70% 60%;\n\n  --shadow-2xs: 0px 1px 2px 0px hsl(0 0% 0% / 0.20);\n  --shadow-xs: 0px 1px 3px 0px hsl(0 0% 0% / 0.30);\n  --shadow-sm: 0px 2px 4px -1px hsl(0 0% 0% / 0.25), 0px 1px 2px -1px hsl(0 0% 0% / 0.20);\n  --shadow: 0px 4px 6px -1px hsl(0 0% 0% / 0.35), 0px 2px 4px -2px hsl(0 0% 0% / 0.25);\n  --shadow-md: 0px 6px 12px -2px hsl(0 0% 0% / 0.40), 0px 3px 6px -3px hsl(0 0% 0% / 0.30);\n  --shadow-lg: 0px 10px 20px -4px hsl(0 0% 0% / 0.45), 0px 4px 8px -4px hsl(0 0% 0% / 0.35);\n  --shadow-xl: 0px 20px 30px -6px hsl(0 0% 0% / 0.50), 0px 8px 12px -6px hsl(0 0% 0% / 0.40);\n  --shadow-2xl: 0px 25px 50px -12px hsl(0 0% 0% / 0.60);\n\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n\n  /* RTL support utilities */\n  .rtl-mirror {\n    transform: scaleX(-1);\n  }\n\n  /* Marquee animation for news ticker */\n  @keyframes marquee {\n    from {\n      transform: translateX(0);\n    }\n    to {\n      transform: translateX(-50%);\n    }\n  }\n\n  .animate-marquee {\n    animation: marquee 30s linear infinite;\n  }\n\n  .animate-marquee:hover {\n    animation-play-state: paused;\n  }\n}\n","path":null,"size_bytes":10662,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { ThemeProvider } from \"@/components/theme-provider\";\nimport { AuthProvider } from \"@/contexts/AuthContext\";\nimport { Header } from \"@/components/header\";\nimport { Footer } from \"@/components/footer\";\nimport Home from \"@/pages/home\";\nimport Events from \"@/pages/events\";\nimport Gallery from \"@/pages/gallery\";\nimport Results from \"@/pages/results\";\nimport About from \"@/pages/about\";\nimport Login from \"@/pages/login\";\nimport Register from \"@/pages/register\";\nimport MyEvents from \"@/pages/my-events\";\nimport Admin from \"@/pages/admin\";\nimport Profile from \"@/pages/profile\";\nimport Forum from \"@/pages/forum\";\nimport Leagues from \"@/pages/leagues\";\nimport LeagueDetail from \"@/pages/league-detail\";\nimport MatchDetail from \"@/pages/match-detail\";\nimport TeamWizard from \"@/pages/team-wizard\";\nimport Bracket from \"@/pages/bracket\";\nimport TournamentEdit from \"@/pages/tournament-edit\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/events\" component={Events} />\n      <Route path=\"/gallery\" component={Gallery} />\n      <Route path=\"/results\" component={Results} />\n      <Route path=\"/about\" component={About} />\n      <Route path=\"/login\" component={Login} />\n      <Route path=\"/register\" component={Register} />\n      <Route path=\"/my-events\" component={MyEvents} />\n      <Route path=\"/admin\" component={Admin} />\n      <Route path=\"/admin/tournaments/:id/edit\" component={TournamentEdit} />\n      <Route path=\"/profile\" component={Profile} />\n      <Route path=\"/forum\" component={Forum} />\n      <Route path=\"/leagues\" component={Leagues} />\n      <Route path=\"/leagues/:id\" component={LeagueDetail} />\n      <Route path=\"/matches/:id\" component={MatchDetail} />\n      <Route path=\"/team-wizard\" component={TeamWizard} />\n      <Route path=\"/bracket\" component={Bracket} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <AuthProvider>\n        <ThemeProvider defaultTheme=\"light\">\n          <TooltipProvider>\n            <div className=\"flex flex-col min-h-screen\">\n              <Header />\n              <main className=\"flex-1\">\n                <Router />\n              </main>\n              <Footer />\n            </div>\n            <Toaster />\n          </TooltipProvider>\n        </ThemeProvider>\n      </AuthProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":2750,"size_tokens":null},"client/src/components/footer.tsx":{"content":"import { Trophy, Mail, Phone, MapPin, Facebook, Twitter, Instagram } from \"lucide-react\";\nimport { Link } from \"wouter\";\n\nexport function Footer() {\n  return (\n    <footer className=\"border-t bg-card mt-20\">\n      <div className=\"container mx-auto px-4 md:px-6 py-12\">\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-12\">\n          {/* About Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"flex items-center justify-center w-10 h-10 rounded-md bg-primary text-primary-foreground\">\n                <Trophy className=\"h-6 w-6\" />\n              </div>\n              <div>\n                <h3 className=\"font-display font-bold text-lg\">اللجنة الرياضية</h3>\n                <p className=\"text-sm text-muted-foreground\">شركة أبراج لخدمات الطاقة</p>\n              </div>\n            </div>\n            <p className=\"text-sm text-muted-foreground leading-relaxed\">\n              نسعى لتعزيز الصحة وروح الفريق من خلال تنظيم الأنشطة الرياضية والترفيهية للموظفين وأسرهم.\n            </p>\n            <div className=\"flex gap-2\">\n              <a\n                href=\"#\"\n                className=\"flex items-center justify-center w-9 h-9 rounded-md hover-elevate active-elevate-2 bg-secondary text-secondary-foreground\"\n                data-testid=\"link-facebook\"\n              >\n                <Facebook className=\"h-4 w-4\" />\n              </a>\n              <a\n                href=\"#\"\n                className=\"flex items-center justify-center w-9 h-9 rounded-md hover-elevate active-elevate-2 bg-secondary text-secondary-foreground\"\n                data-testid=\"link-twitter\"\n              >\n                <Twitter className=\"h-4 w-4\" />\n              </a>\n              <a\n                href=\"#\"\n                className=\"flex items-center justify-center w-9 h-9 rounded-md hover-elevate active-elevate-2 bg-secondary text-secondary-foreground\"\n                data-testid=\"link-instagram\"\n              >\n                <Instagram className=\"h-4 w-4\" />\n              </a>\n            </div>\n          </div>\n\n          {/* Quick Links */}\n          <div className=\"space-y-4\">\n            <h3 className=\"font-display font-bold text-lg\">روابط سريعة</h3>\n            <ul className=\"space-y-3\">\n              <li>\n                <Link href=\"/\" data-testid=\"footer-link-home\">\n                  <span className=\"text-sm text-muted-foreground hover:text-foreground cursor-pointer transition-colors\">\n                    الصفحة الرئيسية\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/events\" data-testid=\"footer-link-events\">\n                  <span className=\"text-sm text-muted-foreground hover:text-foreground cursor-pointer transition-colors\">\n                    الفعاليات القادمة\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/gallery\" data-testid=\"footer-link-gallery\">\n                  <span className=\"text-sm text-muted-foreground hover:text-foreground cursor-pointer transition-colors\">\n                    معرض الصور\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/results\" data-testid=\"footer-link-results\">\n                  <span className=\"text-sm text-muted-foreground hover:text-foreground cursor-pointer transition-colors\">\n                    النتائج والإنجازات\n                  </span>\n                </Link>\n              </li>\n              <li>\n                <Link href=\"/about\" data-testid=\"footer-link-about\">\n                  <span className=\"text-sm text-muted-foreground hover:text-foreground cursor-pointer transition-colors\">\n                    من نحن\n                  </span>\n                </Link>\n              </li>\n            </ul>\n          </div>\n\n          {/* Contact Info */}\n          <div className=\"space-y-4\">\n            <h3 className=\"font-display font-bold text-lg\">تواصل معنا</h3>\n            <ul className=\"space-y-3\">\n              <li className=\"flex items-start gap-3\">\n                <Phone className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                <div>\n                  <p className=\"text-sm font-medium\">الهاتف</p>\n                  <p className=\"text-sm text-muted-foreground\" dir=\"ltr\">+966 XX XXX XXXX</p>\n                </div>\n              </li>\n              <li className=\"flex items-start gap-3\">\n                <Mail className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                <div>\n                  <p className=\"text-sm font-medium\">البريد الإلكتروني</p>\n                  <p className=\"text-sm text-muted-foreground\" dir=\"ltr\">sports@abrajenergy.com</p>\n                </div>\n              </li>\n              <li className=\"flex items-start gap-3\">\n                <MapPin className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                <div>\n                  <p className=\"text-sm font-medium\">العنوان</p>\n                  <p className=\"text-sm text-muted-foreground\">المملكة العربية السعودية</p>\n                </div>\n              </li>\n            </ul>\n          </div>\n        </div>\n\n        {/* Copyright */}\n        <div className=\"border-t mt-12 pt-8 text-center\">\n          <p className=\"text-sm text-muted-foreground\">\n            © {new Date().getFullYear()} اللجنة الرياضية - شركة أبراج لخدمات الطاقة. جميع الحقوق محفوظة.\n          </p>\n        </div>\n      </div>\n    </footer>\n  );\n}\n","path":null,"size_bytes":5830,"size_tokens":null},"client/src/pages/home.tsx":{"content":"import { Trophy, Users, Calendar, Award, TrendingUp, Heart, Target, Zap } from \"lucide-react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Link } from \"wouter\";\nimport { useEffect, useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport defaultHeroImage from \"@assets/WhatsApp_Image_2025-12-14_at_1.09.59_AM_1765663609189.jpg\";\n\nexport default function Home() {\n  const [stats, setStats] = useState({\n    events: 0,\n    participants: 0,\n    achievements: 0,\n    sports: 0,\n  });\n\n  const { data: heroSetting } = useQuery<{ key: string; value: string | null }>({\n    queryKey: ['/api/settings/hero_image'],\n  });\n\n  const heroImage = heroSetting?.value || defaultHeroImage;\n\n  useEffect(() => {\n    // Animate counters\n    const targetStats = {\n      events: 150,\n      participants: 2500,\n      achievements: 85,\n      sports: 12,\n    };\n\n    const duration = 2000;\n    const steps = 60;\n    const interval = duration / steps;\n\n    let currentStep = 0;\n    const timer = setInterval(() => {\n      currentStep++;\n      const progress = currentStep / steps;\n      \n      setStats({\n        events: Math.floor(targetStats.events * progress),\n        participants: Math.floor(targetStats.participants * progress),\n        achievements: Math.floor(targetStats.achievements * progress),\n        sports: Math.floor(targetStats.sports * progress),\n      });\n\n      if (currentStep >= steps) {\n        setStats(targetStats);\n        clearInterval(timer);\n      }\n    }, interval);\n\n    return () => clearInterval(timer);\n  }, []);\n\n  const services = [\n    {\n      icon: Trophy,\n      title: \"البطولات الداخلية\",\n      description: \"تنظيم بطولات دورية في مختلف الألعاب الرياضية للموظفين\",\n    },\n    {\n      icon: Users,\n      title: \"الأيام العائلية\",\n      description: \"فعاليات ترفيهية شاملة للموظفين وأسرهم\",\n    },\n    {\n      icon: Heart,\n      title: \"برامج اللياقة\",\n      description: \"تحديات وبرامج لتعزيز الصحة واللياقة البدنية\",\n    },\n    {\n      icon: Target,\n      title: \"المرافق الرياضية\",\n      description: \"توفير وصيانة المنشآت والمعدات الرياضية\",\n    },\n  ];\n\n  const newsItems = [\n    \"🏆 فريق الهندسة يتوج بطلاً لدوري كرة القدم الداخلي\",\n    \"🎉 التسجيل مفتوح الآن لبطولة كرة السلة السنوية\",\n    \"🏃 ماراثون الشركة القادم - 15 مارس 2025\",\n    \"⚽ نتائج مباريات الأسبوع متاحة الآن في قسم النتائج\",\n  ];\n\n  return (\n    <div className=\"min-h-screen\">\n      {/* Hero Section */}\n      <section className=\"relative h-[600px] flex items-center justify-center overflow-hidden\">\n        <div className=\"absolute inset-0 z-0\">\n          <img\n            src={heroImage}\n            alt=\"اللجنة الرياضية\"\n            className=\"w-full h-full object-cover\"\n          />\n          <div className=\"absolute inset-0 bg-gradient-to-t from-background via-background/60 to-transparent\" />\n        </div>\n        \n        <div className=\"relative z-10 container mx-auto px-4 md:px-6 text-center space-y-6\">\n          <Badge className=\"text-base px-4 py-2 bg-primary/90 backdrop-blur-sm\" data-testid=\"badge-hero\">\n            اللجنة الرياضية - شركة أبراج لخدمات الطاقة\n          </Badge>\n          <h1 className=\"text-5xl md:text-7xl font-display font-bold text-foreground drop-shadow-lg\">\n            معاً نبني مجتمعاً رياضياً متميزاً\n          </h1>\n          <p className=\"text-xl md:text-2xl text-foreground/90 max-w-3xl mx-auto leading-relaxed drop-shadow\">\n            تعزيز الصحة وروح الفريق من خلال الأنشطة الرياضية والترفيهية\n          </p>\n          <div className=\"flex flex-wrap gap-4 justify-center pt-4\">\n            <Link href=\"/events\">\n              <Button size=\"lg\" className=\"text-lg px-8\" data-testid=\"button-view-events\">\n                <Calendar className=\"ml-2 h-5 w-5\" />\n                استعرض الفعاليات\n              </Button>\n            </Link>\n            <Link href=\"/about\">\n              <Button size=\"lg\" variant=\"outline\" className=\"text-lg px-8 backdrop-blur-sm bg-background/80\" data-testid=\"button-about\">\n                <TrendingUp className=\"ml-2 h-5 w-5\" />\n                تعرف علينا\n              </Button>\n            </Link>\n          </div>\n        </div>\n      </section>\n\n      {/* Stats Section */}\n      <section className=\"py-20 bg-card\">\n        <div className=\"container mx-auto px-4 md:px-6\">\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8\">\n            <Card className=\"text-center hover-elevate transition-all\">\n              <CardContent className=\"p-8 space-y-3\">\n                <Calendar className=\"h-12 w-12 mx-auto text-primary\" />\n                <div className=\"text-4xl md:text-5xl font-display font-bold text-primary\" data-testid=\"stat-events\">\n                  {stats.events}+\n                </div>\n                <p className=\"text-sm md:text-base text-muted-foreground font-medium\">فعالية منظمة</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"text-center hover-elevate transition-all\">\n              <CardContent className=\"p-8 space-y-3\">\n                <Users className=\"h-12 w-12 mx-auto text-victory\" />\n                <div className=\"text-4xl md:text-5xl font-display font-bold text-victory\" data-testid=\"stat-participants\">\n                  {stats.participants}+\n                </div>\n                <p className=\"text-sm md:text-base text-muted-foreground font-medium\">مشارك نشط</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"text-center hover-elevate transition-all\">\n              <CardContent className=\"p-8 space-y-3\">\n                <Award className=\"h-12 w-12 mx-auto text-gold\" />\n                <div className=\"text-4xl md:text-5xl font-display font-bold text-gold\" data-testid=\"stat-achievements\">\n                  {stats.achievements}+\n                </div>\n                <p className=\"text-sm md:text-base text-muted-foreground font-medium\">إنجاز محقق</p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"text-center hover-elevate transition-all\">\n              <CardContent className=\"p-8 space-y-3\">\n                <Trophy className=\"h-12 w-12 mx-auto text-success\" />\n                <div className=\"text-4xl md:text-5xl font-display font-bold text-success\" data-testid=\"stat-sports\">\n                  {stats.sports}+\n                </div>\n                <p className=\"text-sm md:text-base text-muted-foreground font-medium\">رياضة متنوعة</p>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* Services Section */}\n      <section className=\"py-20\">\n        <div className=\"container mx-auto px-4 md:px-6\">\n          <div className=\"text-center space-y-4 mb-16\">\n            <Badge variant=\"outline\" className=\"text-base px-4 py-2\" data-testid=\"badge-services\">\n              خدماتنا\n            </Badge>\n            <h2 className=\"text-4xl md:text-5xl font-display font-bold\">\n              ماذا نقدم لموظفينا\n            </h2>\n            <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto\">\n              مجموعة متنوعة من الأنشطة والخدمات الرياضية لتعزيز الصحة والتفاعل\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {services.map((service, index) => (\n              <Card key={index} className=\"hover-elevate active-elevate-2 transition-all cursor-pointer group\" data-testid={`card-service-${index}`}>\n                <CardContent className=\"p-8 space-y-4 text-center\">\n                  <div className=\"w-16 h-16 mx-auto rounded-md bg-primary/10 flex items-center justify-center group-hover:bg-primary/20 transition-colors\">\n                    <service.icon className=\"h-8 w-8 text-primary\" />\n                  </div>\n                  <h3 className=\"text-xl font-display font-bold\">{service.title}</h3>\n                  <p className=\"text-muted-foreground leading-relaxed\">{service.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* News Ticker */}\n      <section className=\"py-8 bg-primary text-primary-foreground overflow-hidden\">\n        <div className=\"flex items-center gap-8\">\n          <div className=\"flex-shrink-0 px-6 flex items-center gap-2 font-bold text-lg\">\n            <Zap className=\"h-5 w-5\" />\n            آخر الأخبار\n          </div>\n          <div className=\"flex gap-12 animate-marquee\">\n            {[...newsItems, ...newsItems].map((news, index) => (\n              <div key={index} className=\"flex-shrink-0 text-lg font-medium\">\n                {news}\n              </div>\n            ))}\n          </div>\n        </div>\n      </section>\n\n      {/* Vision & Mission */}\n      <section className=\"py-20 bg-card\">\n        <div className=\"container mx-auto px-4 md:px-6\">\n          <div className=\"grid md:grid-cols-2 gap-12\">\n            <Card className=\"border-2 border-primary/20\">\n              <CardContent className=\"p-8 md:p-12 space-y-6\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-14 h-14 rounded-md bg-primary text-primary-foreground flex items-center justify-center\">\n                    <Target className=\"h-8 w-8\" />\n                  </div>\n                  <h3 className=\"text-3xl font-display font-bold\">رؤيتنا</h3>\n                </div>\n                <p className=\"text-lg text-muted-foreground leading-relaxed\">\n                  أن نكون المنصة الرياضية الأولى التي تجمع موظفي الشركة وأسرهم في بيئة رياضية محفزة وممتعة، نساهم من خلالها في بناء مجتمع صحي ومتماسك يعزز روح الانتماء والولاء للشركة.\n                </p>\n              </CardContent>\n            </Card>\n\n            <Card className=\"border-2 border-victory/20\">\n              <CardContent className=\"p-8 md:p-12 space-y-6\">\n                <div className=\"flex items-center gap-4\">\n                  <div className=\"w-14 h-14 rounded-md bg-victory text-victory-foreground flex items-center justify-center\">\n                    <Heart className=\"h-8 w-8\" />\n                  </div>\n                  <h3 className=\"text-3xl font-display font-bold\">رسالتنا</h3>\n                </div>\n                <p className=\"text-lg text-muted-foreground leading-relaxed\">\n                  تنظيم فعاليات رياضية وترفيهية متنوعة على مدار العام، توفير المرافق الرياضية المناسبة، وتشجيع المشاركة الفعالة من جميع الموظفين بما يعزز الصحة البدنية والنفسية ويقوي روح الفريق.\n                </p>\n              </CardContent>\n            </Card>\n          </div>\n        </div>\n      </section>\n\n      {/* CTA Section */}\n      <section className=\"py-20\">\n        <div className=\"container mx-auto px-4 md:px-6\">\n          <Card className=\"bg-gradient-to-l from-primary via-primary to-victory text-primary-foreground border-0\">\n            <CardContent className=\"p-12 md:p-16 text-center space-y-6\">\n              <h2 className=\"text-4xl md:text-5xl font-display font-bold\">\n                انضم لمجتمعنا الرياضي\n              </h2>\n              <p className=\"text-xl md:text-2xl max-w-2xl mx-auto leading-relaxed opacity-95\">\n                ابدأ رحلتك الرياضية معنا واستمتع بفعاليات متنوعة طوال العام\n              </p>\n              <div className=\"pt-4\">\n                <Link href=\"/events\">\n                  <Button size=\"lg\" variant=\"outline\" className=\"text-lg px-8 bg-background text-foreground hover:bg-background/90 border-2\" data-testid=\"button-cta-events\">\n                    <Calendar className=\"ml-2 h-5 w-5\" />\n                    اكتشف الفعاليات القادمة\n                  </Button>\n                </Link>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </section>\n    </div>\n  );\n}\n","path":null,"size_bytes":12848,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/pages/events.tsx":{"content":"import { Calendar, MapPin, Users, Clock, Trophy, Heart, Footprints, Dumbbell, CheckCircle, Loader2, AlertTriangle } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useEffect, useState, useMemo } from \"react\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { Event, EventRegistration } from \"@shared/schema\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport footballImage from \"@assets/generated_images/Football_tournament_event_d6ff718f.png\";\nimport familyImage from \"@assets/generated_images/Family_sports_day_fb7dc0d7.png\";\nimport marathonImage from \"@assets/generated_images/Marathon_running_event_b03a4441.png\";\nimport basketballImage from \"@assets/generated_images/Basketball_tournament_action_c6044c35.png\";\n\ninterface CountdownProps {\n  targetDate: Date;\n}\n\nfunction Countdown({ targetDate }: CountdownProps) {\n  const [timeLeft, setTimeLeft] = useState({\n    days: 0,\n    hours: 0,\n    minutes: 0,\n    seconds: 0,\n  });\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      const now = new Date().getTime();\n      const distance = targetDate.getTime() - now;\n\n      if (distance < 0) {\n        clearInterval(timer);\n        return;\n      }\n\n      setTimeLeft({\n        days: Math.floor(distance / (1000 * 60 * 60 * 24)),\n        hours: Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)),\n        minutes: Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60)),\n        seconds: Math.floor((distance % (1000 * 60)) / 1000),\n      });\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [targetDate]);\n\n  return (\n    <div className=\"flex gap-3 justify-center\" dir=\"ltr\">\n      <div className=\"text-center\">\n        <div className=\"w-14 h-14 md:w-16 md:h-16 rounded-md bg-primary text-primary-foreground flex items-center justify-center font-mono text-xl md:text-2xl font-bold\">\n          {timeLeft.days}\n        </div>\n        <div className=\"text-xs mt-1 text-muted-foreground\" dir=\"rtl\">يوم</div>\n      </div>\n      <div className=\"text-center\">\n        <div className=\"w-14 h-14 md:w-16 md:h-16 rounded-md bg-primary text-primary-foreground flex items-center justify-center font-mono text-xl md:text-2xl font-bold\">\n          {timeLeft.hours}\n        </div>\n        <div className=\"text-xs mt-1 text-muted-foreground\" dir=\"rtl\">ساعة</div>\n      </div>\n      <div className=\"text-center\">\n        <div className=\"w-14 h-14 md:w-16 md:h-16 rounded-md bg-primary text-primary-foreground flex items-center justify-center font-mono text-xl md:text-2xl font-bold\">\n          {timeLeft.minutes}\n        </div>\n        <div className=\"text-xs mt-1 text-muted-foreground\" dir=\"rtl\">دقيقة</div>\n      </div>\n      <div className=\"text-center\">\n        <div className=\"w-14 h-14 md:w-16 md:h-16 rounded-md bg-primary text-primary-foreground flex items-center justify-center font-mono text-xl md:text-2xl font-bold\">\n          {timeLeft.seconds}\n        </div>\n        <div className=\"text-xs mt-1 text-muted-foreground\" dir=\"rtl\">ثانية</div>\n      </div>\n    </div>\n  );\n}\n\nconst categoryImages: Record<string, string> = {\n  football: footballImage,\n  family: familyImage,\n  marathon: marathonImage,\n  basketball: basketballImage,\n};\n\nconst categoryIcons: Record<string, typeof Trophy> = {\n  football: Trophy,\n  family: Heart,\n  marathon: Footprints,\n  basketball: Dumbbell,\n};\n\nconst categoryLabels: Record<string, string> = {\n  football: \"كرة قدم\",\n  family: \"عائلي\",\n  marathon: \"جري\",\n  basketball: \"كرة سلة\",\n};\n\nfunction checkShiftConflict(eventDate: Date, shiftPattern: string): boolean {\n  if (shiftPattern !== \"2weeks_on_2weeks_off\") return false;\n  \n  const referenceDate = new Date(\"2025-01-01\");\n  const daysDiff = Math.floor((eventDate.getTime() - referenceDate.getTime()) / (1000 * 60 * 60 * 24));\n  const cycleDay = daysDiff % 28;\n  // First 14 days (cycleDay < 14) = on shift (can register)\n  // Last 14 days (cycleDay >= 14) = off shift (conflict - cannot register)\n  return cycleDay >= 14;\n}\n\nexport default function Events() {\n  const { isAuthenticated, user } = useAuth();\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const queryClient = useQueryClient();\n\n  const { data: events = [], isLoading: eventsLoading } = useQuery<Event[]>({\n    queryKey: [\"/api/events\"],\n  });\n\n  const { data: myRegistrations = [] } = useQuery<EventRegistration[]>({\n    queryKey: [\"/api/my-registrations\"],\n    enabled: isAuthenticated,\n  });\n\n  const registerMutation = useMutation({\n    mutationFn: async (eventId: string) => {\n      return await apiRequest(\"POST\", `/api/events/${eventId}/register`, {});\n    },\n    onSuccess: () => {\n      toast({\n        title: \"تم التسجيل بنجاح\",\n        description: \"تم تسجيلك في الفعالية بنجاح\",\n      });\n      queryClient.invalidateQueries({ queryKey: [\"/api/my-registrations\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/events\"] });\n    },\n    onError: (error: any) => {\n      toast({\n        title: \"فشل التسجيل\",\n        description: error.message || \"حدث خطأ أثناء التسجيل\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const isRegistered = (eventId: string) => {\n    return myRegistrations.some((reg) => reg.eventId === eventId);\n  };\n\n  const handleRegister = (eventId: string) => {\n    if (!isAuthenticated) {\n      toast({\n        title: \"يجب تسجيل الدخول\",\n        description: \"يرجى تسجيل الدخول أولاً للتسجيل في الفعالية\",\n        variant: \"destructive\",\n      });\n      navigate(\"/login\");\n      return;\n    }\n    registerMutation.mutate(eventId);\n  };\n\n  const getCategoryBadgeColor = (category: string) => {\n    const colors: Record<string, string> = {\n      football: \"bg-primary text-primary-foreground\",\n      family: \"bg-victory text-victory-foreground\",\n      marathon: \"bg-success text-success-foreground\",\n      basketball: \"bg-gold text-gold-foreground\",\n    };\n    return colors[category] || \"bg-secondary text-secondary-foreground\";\n  };\n\n  if (eventsLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen py-12\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        {/* Header */}\n        <div className=\"text-center space-y-4 mb-16\">\n          <Badge variant=\"outline\" className=\"text-base px-4 py-2\" data-testid=\"badge-events\">\n            الفعاليات القادمة\n          </Badge>\n          <h1 className=\"text-4xl md:text-6xl font-display font-bold\">\n            انضم إلى فعالياتنا الرياضية\n          </h1>\n          <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto\">\n            تصفح جميع الأنشطة والفعاليات المقبلة وسجل مشاركتك الآن\n          </p>\n        </div>\n\n        {/* Events Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n          {events.map((event) => {\n            const Icon = categoryIcons[event.category] || Trophy;\n            const image = categoryImages[event.category] || footballImage;\n            const registered = isRegistered(event.id);\n            const eventDate = new Date(event.date);\n            const isFull = event.maxParticipants && event.currentParticipants && \n                          event.currentParticipants >= event.maxParticipants;\n            const hasShiftConflict = user && checkShiftConflict(eventDate, user.shiftPattern);\n\n            return (\n              <Card key={event.id} className=\"overflow-hidden hover-elevate active-elevate-2 transition-all group\" data-testid={`card-event-${event.id}`}>\n                <div className=\"relative h-64 overflow-hidden\">\n                  <img\n                    src={image}\n                    alt={event.title}\n                    className=\"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500\"\n                  />\n                  <div className=\"absolute top-4 right-4\">\n                    <Badge className={getCategoryBadgeColor(event.category)}>\n                      <Icon className=\"h-4 w-4 ml-1\" />\n                      {categoryLabels[event.category] || event.category}\n                    </Badge>\n                  </div>\n                  {registered && (\n                    <div className=\"absolute top-4 left-4\">\n                      <Badge className=\"bg-success text-success-foreground\">\n                        <CheckCircle className=\"h-4 w-4 ml-1\" />\n                        مسجل\n                      </Badge>\n                    </div>\n                  )}\n                  <div className=\"absolute inset-0 bg-gradient-to-t from-background to-transparent opacity-60\" />\n                </div>\n\n                <CardHeader className=\"space-y-3\">\n                  <CardTitle className=\"text-2xl md:text-3xl font-display\">{event.title}</CardTitle>\n                  <p className=\"text-muted-foreground leading-relaxed\">{event.description}</p>\n                </CardHeader>\n\n                <CardContent className=\"space-y-6\">\n                  {/* Event Details */}\n                  <div className=\"space-y-3\">\n                    <div className=\"flex items-start gap-3\">\n                      <Calendar className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                      <div>\n                        <p className=\"font-medium\">التاريخ والوقت</p>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {eventDate.toLocaleDateString('ar-SA', { \n                            weekday: 'long', \n                            year: 'numeric', \n                            month: 'long', \n                            day: 'numeric' \n                          })}\n                        </p>\n                        <p className=\"text-sm text-muted-foreground\" dir=\"ltr\">\n                          {eventDate.toLocaleTimeString('ar-SA', { \n                            hour: '2-digit', \n                            minute: '2-digit' \n                          })}\n                        </p>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-start gap-3\">\n                      <MapPin className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                      <div>\n                        <p className=\"font-medium\">المكان</p>\n                        <p className=\"text-sm text-muted-foreground\">{event.location}</p>\n                      </div>\n                    </div>\n\n                    <div className=\"flex items-start gap-3\">\n                      <Users className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                      <div className=\"flex-1\">\n                        <div className=\"flex justify-between items-center mb-2\">\n                          <p className=\"font-medium\">المشاركون</p>\n                          <p className=\"text-sm text-muted-foreground\" data-testid={`participants-${event.id}`}>\n                            {event.currentParticipants || 0} / {event.maxParticipants || \"∞\"}\n                          </p>\n                        </div>\n                        {event.maxParticipants && (\n                          <div className=\"w-full bg-secondary rounded-full h-2\">\n                            <div\n                              className=\"bg-primary h-2 rounded-full transition-all\"\n                              style={{ width: `${((event.currentParticipants || 0) / event.maxParticipants) * 100}%` }}\n                            />\n                          </div>\n                        )}\n                      </div>\n                    </div>\n\n                    {event.requirements && (\n                      <div className=\"flex items-start gap-3\">\n                        <Clock className=\"h-5 w-5 text-primary mt-0.5 flex-shrink-0\" />\n                        <div>\n                          <p className=\"font-medium\">شروط المشاركة</p>\n                          <p className=\"text-sm text-muted-foreground\">{event.requirements}</p>\n                        </div>\n                      </div>\n                    )}\n                  </div>\n\n                  {/* Countdown */}\n                  <div className=\"border-t pt-6\">\n                    <p className=\"text-center text-sm text-muted-foreground mb-4\">يبدأ خلال</p>\n                    <Countdown targetDate={eventDate} />\n                  </div>\n\n                  {/* Shift Conflict Warning */}\n                  {hasShiftConflict && !registered && (\n                    <Alert className=\"bg-gold/10 border-gold/30\">\n                      <AlertTriangle className=\"h-4 w-4 text-gold\" />\n                      <AlertDescription className=\"text-sm\">\n                        تحذير: هذه الفعالية تقع في فترة إجازتك. لا يمكنك التسجيل أثناء الإجازة.\n                      </AlertDescription>\n                    </Alert>\n                  )}\n\n                  {/* CTA Button */}\n                  {registered ? (\n                    <Button className=\"w-full\" size=\"lg\" variant=\"secondary\" disabled data-testid={`button-registered-${event.id}`}>\n                      <CheckCircle className=\"ml-2 h-5 w-5\" />\n                      أنت مسجل في هذه الفعالية\n                    </Button>\n                  ) : isFull ? (\n                    <Button className=\"w-full\" size=\"lg\" variant=\"secondary\" disabled data-testid={`button-full-${event.id}`}>\n                      الفعالية ممتلئة\n                    </Button>\n                  ) : (\n                    <Button \n                      className=\"w-full\" \n                      size=\"lg\" \n                      onClick={() => handleRegister(event.id)}\n                      disabled={registerMutation.isPending}\n                      data-testid={`button-register-${event.id}`}\n                    >\n                      {registerMutation.isPending ? (\n                        <Loader2 className=\"ml-2 h-5 w-5 animate-spin\" />\n                      ) : (\n                        <Trophy className=\"ml-2 h-5 w-5\" />\n                      )}\n                      سجل الآن\n                    </Button>\n                  )}\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n\n        {events.length === 0 && (\n          <Card className=\"mt-8 p-12 text-center\">\n            <Trophy className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-xl font-bold mb-2\">لا توجد فعاليات حالياً</h3>\n            <p className=\"text-muted-foreground\">ترقبوا الفعاليات القادمة قريباً</p>\n          </Card>\n        )}\n\n        {/* Info Card */}\n        <Card className=\"mt-12 bg-muted/50 border-2 border-dashed\">\n          <CardContent className=\"p-8 text-center space-y-4\">\n            <Trophy className=\"h-12 w-12 mx-auto text-primary\" />\n            <h3 className=\"text-2xl font-display font-bold\">لم تجد الفعالية المناسبة؟</h3>\n            <p className=\"text-muted-foreground max-w-2xl mx-auto\">\n              نرحب بجميع الاقتراحات والأفكار الجديدة للفعاليات الرياضية. تواصل معنا وشاركنا أفكارك!\n            </p>\n            <Button variant=\"outline\" size=\"lg\" data-testid=\"button-contact\">\n              تواصل معنا\n            </Button>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":16143,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/theme-toggle.tsx":{"content":"import { Moon, Sun } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useTheme } from \"@/components/theme-provider\";\n\nexport function ThemeToggle() {\n  const { theme, setTheme } = useTheme();\n\n  return (\n    <Button\n      variant=\"ghost\"\n      size=\"icon\"\n      onClick={() => setTheme(theme === \"light\" ? \"dark\" : \"light\")}\n      data-testid=\"button-theme-toggle\"\n      className=\"rounded-md\"\n    >\n      <Sun className=\"h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0\" />\n      <Moon className=\"absolute h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100\" />\n      <span className=\"sr-only\">تبديل الوضع</span>\n    </Button>\n  );\n}\n","path":null,"size_bytes":715,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"server/storage.ts":{"content":"import { \n  type Event, \n  type InsertEvent,\n  type News,\n  type InsertNews,\n  type Result,\n  type InsertResult,\n  type Athlete,\n  type InsertAthlete,\n  type Gallery,\n  type InsertGallery,\n  type Stats,\n  type User,\n  type InsertUser,\n  type EventRegistration,\n  type InsertEventRegistration,\n  type Notification,\n  type InsertNotification,\n  type ForumPost,\n  type InsertForumPost,\n  type ForumComment,\n  type InsertForumComment,\n  type ForumLike,\n  type InsertForumLike,\n  type ForumPostWithUser,\n  type Tournament,\n  type InsertTournament,\n  type Team,\n  type InsertTeam,\n  type Player,\n  type InsertPlayer,\n  type Match,\n  type InsertMatch,\n  type MatchEvent,\n  type InsertMatchEvent,\n  type MatchLineup,\n  type InsertMatchLineup,\n  type MatchComment,\n  type InsertMatchComment,\n  type TeamEvaluation,\n  type InsertTeamEvaluation,\n  type Referee,\n  type InsertReferee,\n  type MatchWithTeams,\n  type PlayerWithTeam,\n  type MatchCommentWithUser,\n  type SiteSetting,\n  events,\n  news,\n  results,\n  athletes,\n  gallery,\n  users,\n  eventRegistrations,\n  notifications,\n  forumPosts,\n  forumComments,\n  forumLikes,\n  tournaments,\n  teams,\n  players,\n  matches,\n  matchEvents,\n  matchLineups,\n  matchComments,\n  teamEvaluations,\n  referees,\n  siteSettings\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, sql, and, asc } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // Events\n  getAllEvents(): Promise<Event[]>;\n  getEventById(id: string): Promise<Event | undefined>;\n  createEvent(event: InsertEvent): Promise<Event>;\n  \n  // News\n  getAllNews(): Promise<News[]>;\n  createNews(newsItem: InsertNews): Promise<News>;\n  \n  // Results\n  getAllResults(): Promise<Result[]>;\n  createResult(result: InsertResult): Promise<Result>;\n  \n  // Athletes\n  getAllAthletes(): Promise<Athlete[]>;\n  createAthlete(athlete: InsertAthlete): Promise<Athlete>;\n  \n  // Gallery\n  getAllGallery(): Promise<Gallery[]>;\n  getGalleryByCategory(category: string): Promise<Gallery[]>;\n  createGalleryItem(item: InsertGallery): Promise<Gallery>;\n  \n  // Stats\n  getStats(): Promise<Stats>;\n  \n  // Users\n  getAllUsers(): Promise<User[]>;\n  getUserById(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  getUserByEmployeeId(employeeId: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: string, updates: Partial<User>): Promise<User | undefined>;\n  \n  // Event Registrations\n  getEventRegistrations(eventId: string): Promise<EventRegistration[]>;\n  getUserRegistrations(userId: string): Promise<EventRegistration[]>;\n  getRegistration(eventId: string, userId: string): Promise<EventRegistration | undefined>;\n  createEventRegistration(registration: InsertEventRegistration): Promise<EventRegistration>;\n  updateEventRegistration(id: string, updates: Partial<EventRegistration>): Promise<EventRegistration | undefined>;\n  deleteEventRegistration(id: string): Promise<boolean>;\n  \n  // Notifications\n  getUserNotifications(userId: string): Promise<Notification[]>;\n  getUnreadNotificationsCount(userId: string): Promise<number>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationAsRead(id: string): Promise<boolean>;\n  markAllNotificationsAsRead(userId: string): Promise<boolean>;\n  \n  // Forum Posts\n  getAllPosts(category?: string): Promise<ForumPostWithUser[]>;\n  getPostById(id: string): Promise<ForumPostWithUser | undefined>;\n  createPost(post: InsertForumPost): Promise<ForumPost>;\n  deletePost(id: string, userId: string): Promise<boolean>;\n  \n  // Forum Comments\n  getPostComments(postId: string): Promise<(ForumComment & { user: { fullName: string; department: string } })[]>;\n  createComment(comment: InsertForumComment): Promise<ForumComment>;\n  deleteComment(id: string, userId: string): Promise<boolean>;\n  \n  // Forum Likes\n  toggleLike(postId: string, userId: string): Promise<boolean>;\n  isPostLikedByUser(postId: string, userId: string): Promise<boolean>;\n  \n  // ========== LEAGUE GENERATOR ==========\n  \n  // Tournaments\n  getAllTournaments(): Promise<Tournament[]>;\n  getTournamentById(id: string): Promise<Tournament | undefined>;\n  createTournament(tournament: InsertTournament): Promise<Tournament>;\n  updateTournament(id: string, updates: Partial<Tournament>): Promise<Tournament | undefined>;\n  deleteTournament(id: string): Promise<boolean>;\n  \n  // Teams\n  getAllTeams(): Promise<Team[]>;\n  getTeamsByTournament(tournamentId: string): Promise<Team[]>;\n  getTeamById(id: string): Promise<Team | undefined>;\n  createTeam(team: InsertTeam): Promise<Team>;\n  updateTeam(id: string, updates: Partial<Team>): Promise<Team | undefined>;\n  deleteTeam(id: string): Promise<boolean>;\n  \n  // Players\n  getAllPlayers(): Promise<Player[]>;\n  getPlayersByTeam(teamId: string): Promise<Player[]>;\n  getPlayerById(id: string): Promise<Player | undefined>;\n  createPlayer(player: InsertPlayer): Promise<Player>;\n  updatePlayer(id: string, updates: Partial<Player>): Promise<Player | undefined>;\n  deletePlayer(id: string): Promise<boolean>;\n  getTopScorers(tournamentId: string, limit?: number): Promise<PlayerWithTeam[]>;\n  \n  // Referees\n  getAllReferees(): Promise<Referee[]>;\n  getRefereesByTournament(tournamentId: string): Promise<Referee[]>;\n  getRefereeById(id: string): Promise<Referee | undefined>;\n  createReferee(referee: InsertReferee): Promise<Referee>;\n  updateReferee(id: string, updates: Partial<Referee>): Promise<Referee | undefined>;\n  deleteReferee(id: string): Promise<boolean>;\n  \n  // Matches\n  getMatchesByTournament(tournamentId: string): Promise<MatchWithTeams[]>;\n  getMatchById(id: string): Promise<MatchWithTeams | undefined>;\n  createMatch(match: InsertMatch): Promise<Match>;\n  updateMatch(id: string, updates: Partial<Match>): Promise<Match | undefined>;\n  deleteMatch(id: string): Promise<boolean>;\n  generateLeagueMatches(tournamentId: string, options?: { matchesPerDay?: number; dailyStartTime?: string }): Promise<Match[]>;\n  generateKnockoutMatchesFromGroups(tournamentId: string): Promise<Match[]>;\n  \n  // Group Stage Management\n  assignTeamsToGroups(tournamentId: string, assignments?: { teamId: string; groupNumber: number }[]): Promise<Team[]>;\n  getGroupStandings(tournamentId: string): Promise<{ groupNumber: number; teams: Team[] }[]>;\n  generateGroupStageMatches(tournamentId: string, options?: { matchesPerDay?: number; dailyStartTime?: string }): Promise<Match[]>;\n  completeGroupStage(tournamentId: string): Promise<{ tournament: Tournament; qualifiedTeams: Team[] }>;\n  \n  // Match Events\n  getMatchEvents(matchId: string): Promise<MatchEvent[]>;\n  createMatchEvent(event: InsertMatchEvent): Promise<MatchEvent>;\n  deleteMatchEvent(id: string): Promise<boolean>;\n  \n  // Match Lineups\n  getMatchLineups(matchId: string, teamId?: string): Promise<MatchLineup[]>;\n  createMatchLineup(lineup: InsertMatchLineup): Promise<MatchLineup>;\n  updateMatchLineup(id: string, updates: Partial<MatchLineup>): Promise<MatchLineup | undefined>;\n  deleteMatchLineup(id: string): Promise<boolean>;\n  \n  // Match Comments\n  getMatchComments(matchId: string): Promise<MatchCommentWithUser[]>;\n  createMatchComment(comment: InsertMatchComment): Promise<MatchComment>;\n  deleteMatchComment(id: string, userId: string): Promise<boolean>;\n  \n  // Team Evaluations\n  getTeamEvaluations(teamId: string): Promise<TeamEvaluation[]>;\n  createTeamEvaluation(evaluation: InsertTeamEvaluation): Promise<TeamEvaluation>;\n  \n  // Standings\n  updateTeamStandings(tournamentId: string): Promise<void>;\n  \n  // Site Settings\n  getSetting(key: string): Promise<string | null>;\n  setSetting(key: string, value: string): Promise<SiteSetting>;\n  \n  // Initialization\n  initializeSampleData(): Promise<void>;\n  seedTeamsAndPlayers(): Promise<{ teamsCreated: number; playersCreated: number }>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  // Events\n  async getAllEvents(): Promise<Event[]> {\n    return await db.select().from(events).orderBy(events.date);\n  }\n\n  async getEventById(id: string): Promise<Event | undefined> {\n    const [event] = await db.select().from(events).where(eq(events.id, id));\n    return event;\n  }\n\n  async createEvent(insertEvent: InsertEvent): Promise<Event> {\n    const [event] = await db.insert(events).values(insertEvent).returning();\n    return event;\n  }\n\n  // News\n  async getAllNews(): Promise<News[]> {\n    return await db.select().from(news).orderBy(desc(news.date));\n  }\n\n  async createNews(insertNews: InsertNews): Promise<News> {\n    const [newsItem] = await db.insert(news).values(insertNews).returning();\n    return newsItem;\n  }\n\n  // Results\n  async getAllResults(): Promise<Result[]> {\n    return await db.select().from(results).orderBy(desc(results.date));\n  }\n\n  async createResult(insertResult: InsertResult): Promise<Result> {\n    const [result] = await db.insert(results).values(insertResult).returning();\n    return result;\n  }\n\n  // Athletes\n  async getAllAthletes(): Promise<Athlete[]> {\n    return await db.select().from(athletes);\n  }\n\n  async createAthlete(insertAthlete: InsertAthlete): Promise<Athlete> {\n    const [athlete] = await db.insert(athletes).values(insertAthlete).returning();\n    return athlete;\n  }\n\n  // Gallery\n  async getAllGallery(): Promise<Gallery[]> {\n    return await db.select().from(gallery).orderBy(desc(gallery.eventDate));\n  }\n\n  async getGalleryByCategory(category: string): Promise<Gallery[]> {\n    return await db.select().from(gallery)\n      .where(eq(gallery.category, category))\n      .orderBy(desc(gallery.eventDate));\n  }\n\n  async createGalleryItem(insertGallery: InsertGallery): Promise<Gallery> {\n    const [galleryItem] = await db.insert(gallery).values(insertGallery).returning();\n    return galleryItem;\n  }\n\n  // Stats\n  async getStats(): Promise<Stats> {\n    const [eventsCount] = await db.select({ count: sql<number>`count(*)` }).from(events);\n    const [participantsSum] = await db.select({ \n      sum: sql<number>`coalesce(sum(${events.currentParticipants}), 0)` \n    }).from(events);\n    const [achievementsCount] = await db.select({ count: sql<number>`count(*)` }).from(results);\n    const [sportsCount] = await db.select({ \n      count: sql<number>`count(distinct ${events.category})` \n    }).from(events);\n\n    return {\n      totalEvents: Number(eventsCount.count),\n      totalParticipants: Number(participantsSum.sum),\n      totalAchievements: Number(achievementsCount.count),\n      activeSports: Number(sportsCount.count),\n    };\n  }\n\n  // Users\n  async getAllUsers(): Promise<User[]> {\n    return await db.select().from(users).orderBy(desc(users.createdAt));\n  }\n\n  async getUserById(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.username, username));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async getUserByEmployeeId(employeeId: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.employeeId, employeeId));\n    return user;\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const [user] = await db.insert(users).values(insertUser).returning();\n    return user;\n  }\n\n  async updateUser(id: string, updates: Partial<User>): Promise<User | undefined> {\n    const [user] = await db\n      .update(users)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(users.id, id))\n      .returning();\n    return user;\n  }\n\n  // Event Registrations\n  async getEventRegistrations(eventId: string): Promise<EventRegistration[]> {\n    return await db\n      .select()\n      .from(eventRegistrations)\n      .where(eq(eventRegistrations.eventId, eventId))\n      .orderBy(desc(eventRegistrations.registrationDate));\n  }\n\n  async getUserRegistrations(userId: string): Promise<EventRegistration[]> {\n    return await db\n      .select()\n      .from(eventRegistrations)\n      .where(eq(eventRegistrations.userId, userId))\n      .orderBy(desc(eventRegistrations.registrationDate));\n  }\n\n  async getRegistration(eventId: string, userId: string): Promise<EventRegistration | undefined> {\n    const [registration] = await db\n      .select()\n      .from(eventRegistrations)\n      .where(\n        and(\n          eq(eventRegistrations.eventId, eventId),\n          eq(eventRegistrations.userId, userId)\n        )\n      );\n    return registration;\n  }\n\n  async createEventRegistration(insertRegistration: InsertEventRegistration): Promise<EventRegistration> {\n    const [registration] = await db\n      .insert(eventRegistrations)\n      .values(insertRegistration)\n      .returning();\n    \n    // Update event participant count\n    await db\n      .update(events)\n      .set({ \n        currentParticipants: sql`${events.currentParticipants} + 1` \n      })\n      .where(eq(events.id, insertRegistration.eventId));\n    \n    return registration;\n  }\n\n  async updateEventRegistration(id: string, updates: Partial<EventRegistration>): Promise<EventRegistration | undefined> {\n    const [registration] = await db\n      .update(eventRegistrations)\n      .set(updates)\n      .where(eq(eventRegistrations.id, id))\n      .returning();\n    return registration;\n  }\n\n  async deleteEventRegistration(id: string): Promise<boolean> {\n    const [registration] = await db\n      .select()\n      .from(eventRegistrations)\n      .where(eq(eventRegistrations.id, id));\n    \n    if (!registration) return false;\n    \n    // Decrease event participant count\n    await db\n      .update(events)\n      .set({ \n        currentParticipants: sql`greatest(0, ${events.currentParticipants} - 1)` \n      })\n      .where(eq(events.id, registration.eventId));\n    \n    await db.delete(eventRegistrations).where(eq(eventRegistrations.id, id));\n    return true;\n  }\n\n  // Notifications\n  async getUserNotifications(userId: string): Promise<Notification[]> {\n    return await db\n      .select()\n      .from(notifications)\n      .where(eq(notifications.userId, userId))\n      .orderBy(desc(notifications.createdAt))\n      .limit(50);\n  }\n\n  async getUnreadNotificationsCount(userId: string): Promise<number> {\n    const [result] = await db\n      .select({ count: sql<number>`count(*)` })\n      .from(notifications)\n      .where(and(eq(notifications.userId, userId), eq(notifications.isRead, false)));\n    return Number(result.count);\n  }\n\n  async createNotification(insertNotification: InsertNotification): Promise<Notification> {\n    const [notification] = await db\n      .insert(notifications)\n      .values(insertNotification)\n      .returning();\n    return notification;\n  }\n\n  async markNotificationAsRead(id: string): Promise<boolean> {\n    const result = await db\n      .update(notifications)\n      .set({ isRead: true })\n      .where(eq(notifications.id, id));\n    return true;\n  }\n\n  async markAllNotificationsAsRead(userId: string): Promise<boolean> {\n    await db\n      .update(notifications)\n      .set({ isRead: true })\n      .where(eq(notifications.userId, userId));\n    return true;\n  }\n\n  // Forum Posts\n  async getAllPosts(category?: string): Promise<ForumPostWithUser[]> {\n    const postsData = category\n      ? await db\n          .select()\n          .from(forumPosts)\n          .where(eq(forumPosts.category, category))\n          .orderBy(desc(forumPosts.createdAt))\n      : await db.select().from(forumPosts).orderBy(desc(forumPosts.createdAt));\n\n    const postsWithUsers: ForumPostWithUser[] = [];\n    for (const post of postsData) {\n      const [user] = await db.select({\n        id: users.id,\n        fullName: users.fullName,\n        department: users.department,\n      }).from(users).where(eq(users.id, post.userId));\n      \n      if (user) {\n        postsWithUsers.push({ ...post, user });\n      }\n    }\n    return postsWithUsers;\n  }\n\n  async getPostById(id: string): Promise<ForumPostWithUser | undefined> {\n    const [post] = await db.select().from(forumPosts).where(eq(forumPosts.id, id));\n    if (!post) return undefined;\n\n    const [user] = await db.select({\n      id: users.id,\n      fullName: users.fullName,\n      department: users.department,\n    }).from(users).where(eq(users.id, post.userId));\n\n    if (!user) return undefined;\n    return { ...post, user };\n  }\n\n  async createPost(insertPost: InsertForumPost): Promise<ForumPost> {\n    const [post] = await db.insert(forumPosts).values(insertPost).returning();\n    return post;\n  }\n\n  async deletePost(id: string, userId: string): Promise<boolean> {\n    const [post] = await db.select().from(forumPosts).where(eq(forumPosts.id, id));\n    if (!post || post.userId !== userId) return false;\n    await db.delete(forumPosts).where(eq(forumPosts.id, id));\n    return true;\n  }\n\n  // Forum Comments\n  async getPostComments(postId: string): Promise<(ForumComment & { user: { fullName: string; department: string } })[]> {\n    const commentsData = await db\n      .select()\n      .from(forumComments)\n      .where(eq(forumComments.postId, postId))\n      .orderBy(forumComments.createdAt);\n\n    const commentsWithUsers: (ForumComment & { user: { fullName: string; department: string } })[] = [];\n    for (const comment of commentsData) {\n      const [user] = await db.select({\n        fullName: users.fullName,\n        department: users.department,\n      }).from(users).where(eq(users.id, comment.userId));\n      \n      if (user) {\n        commentsWithUsers.push({ ...comment, user });\n      }\n    }\n    return commentsWithUsers;\n  }\n\n  async createComment(insertComment: InsertForumComment): Promise<ForumComment> {\n    const [comment] = await db.insert(forumComments).values(insertComment).returning();\n    \n    // Update post comment count\n    await db\n      .update(forumPosts)\n      .set({ commentsCount: sql`${forumPosts.commentsCount} + 1` })\n      .where(eq(forumPosts.id, insertComment.postId));\n    \n    return comment;\n  }\n\n  async deleteComment(id: string, userId: string): Promise<boolean> {\n    const [comment] = await db.select().from(forumComments).where(eq(forumComments.id, id));\n    if (!comment || comment.userId !== userId) return false;\n    \n    await db.delete(forumComments).where(eq(forumComments.id, id));\n    \n    // Update post comment count\n    await db\n      .update(forumPosts)\n      .set({ commentsCount: sql`greatest(0, ${forumPosts.commentsCount} - 1)` })\n      .where(eq(forumPosts.id, comment.postId));\n    \n    return true;\n  }\n\n  // Forum Likes\n  async toggleLike(postId: string, userId: string): Promise<boolean> {\n    const [existingLike] = await db\n      .select()\n      .from(forumLikes)\n      .where(and(eq(forumLikes.postId, postId), eq(forumLikes.userId, userId)));\n\n    if (existingLike) {\n      await db.delete(forumLikes).where(eq(forumLikes.id, existingLike.id));\n      await db\n        .update(forumPosts)\n        .set({ likesCount: sql`greatest(0, ${forumPosts.likesCount} - 1)` })\n        .where(eq(forumPosts.id, postId));\n      return false; // unliked\n    } else {\n      await db.insert(forumLikes).values({ postId, userId });\n      await db\n        .update(forumPosts)\n        .set({ likesCount: sql`${forumPosts.likesCount} + 1` })\n        .where(eq(forumPosts.id, postId));\n      return true; // liked\n    }\n  }\n\n  async isPostLikedByUser(postId: string, userId: string): Promise<boolean> {\n    const [like] = await db\n      .select()\n      .from(forumLikes)\n      .where(and(eq(forumLikes.postId, postId), eq(forumLikes.userId, userId)));\n    return !!like;\n  }\n\n  // Initialize sample data\n  async initializeSampleData(): Promise<void> {\n    // Check if we already have data\n    const existingEvents = await db.select().from(events).limit(1);\n    if (existingEvents.length > 0) {\n      console.log(\"Sample data already exists, skipping initialization\");\n      return;\n    }\n\n    console.log(\"Initializing sample data...\");\n\n    // Sample Users (for testing)\n    const bcrypt = await import(\"bcrypt\");\n    const hashedPassword = await bcrypt.hash(\"password123\", 10);\n    \n    await db.insert(users).values([\n      {\n        username: \"ahmed.ali\",\n        password: hashedPassword,\n        fullName: \"أحمد علي الشمري\",\n        email: \"ahmed.ali@abraj.com\",\n        employeeId: \"EMP001\",\n        department: \"قسم الهندسة\",\n        position: \"مهندس كهرباء\",\n        phoneNumber: \"0501234567\",\n        shiftPattern: \"2weeks_on_2weeks_off\",\n        role: \"employee\",\n      },\n      {\n        username: \"admin\",\n        password: hashedPassword,\n        fullName: \"مدير اللجنة الرياضية\",\n        email: \"admin@abraj.com\",\n        employeeId: \"ADM001\",\n        department: \"اللجنة الرياضية\",\n        position: \"مدير اللجنة\",\n        phoneNumber: \"0507654321\",\n        shiftPattern: \"normal\",\n        role: \"admin\",\n      },\n    ]);\n\n    // Sample Events\n    await db.insert(events).values([\n      {\n        title: \"بطولة كرة القدم السنوية\",\n        description: \"بطولة كرة القدم السنوية للشركة - 16 فريق يتنافسون على كأس البطولة\",\n        category: \"football\",\n        date: new Date(2025, 2, 15, 16, 0),\n        location: \"ملعب الشركة الرئيسي\",\n        maxParticipants: 160,\n        currentParticipants: 128,\n        imageUrl: \"/assets/football.png\",\n        status: \"upcoming\",\n        requirements: \"جميع الموظفين مرحب بهم - يجب التسجيل ضمن فريق\",\n      },\n      {\n        title: \"اليوم الرياضي العائلي\",\n        description: \"يوم مليء بالأنشطة الترفيهية للموظفين وعائلاتهم مع مسابقات وجوائز\",\n        category: \"family\",\n        date: new Date(2025, 2, 22, 10, 0),\n        location: \"حديقة الواحة الترفيهية\",\n        maxParticipants: 500,\n        currentParticipants: 342,\n        imageUrl: \"/assets/family.png\",\n        status: \"upcoming\",\n        requirements: \"مفتوح لجميع الموظفين وعائلاتهم - التسجيل المسبق مطلوب\",\n      },\n      {\n        title: \"ماراثون أبراج الخيري\",\n        description: \"ماراثون 10 كم للموظفين بهدف خيري - كل المشاركة تذهب للجمعيات الخيرية\",\n        category: \"marathon\",\n        date: new Date(2025, 3, 5, 6, 0),\n        location: \"كورنيش المدينة\",\n        maxParticipants: 300,\n        currentParticipants: 245,\n        imageUrl: \"/assets/marathon.png\",\n        status: \"upcoming\",\n        requirements: \"مستوى لياقة متوسط - فحص طبي مطلوب\",\n      },\n      {\n        title: \"دوري كرة السلة الداخلي\",\n        description: \"دوري كرة السلة بنظام المجموعات - 8 فرق يتنافسون\",\n        category: \"basketball\",\n        date: new Date(2025, 3, 20, 18, 0),\n        location: \"الصالة الرياضية المغطاة\",\n        maxParticipants: 80,\n        currentParticipants: 64,\n        imageUrl: \"/assets/basketball.png\",\n        status: \"upcoming\",\n        requirements: \"التسجيل مفتوح حتى نفاد الأماكن\",\n      },\n    ]);\n\n    // Sample News\n    await db.insert(news).values([\n      {\n        title: \"فريق الهندسة يتوج بطلاً لدوري كرة القدم الداخلي\",\n        content: \"في مباراة نهائية مثيرة، تمكن فريق قسم الهندسة من التتويج بلقب بطولة كرة القدم الداخلية بعد فوزه على فريق المالية بنتيجة 3-2\",\n        date: new Date(),\n        category: \"result\",\n      },\n      {\n        title: \"التسجيل مفتوح الآن لبطولة كرة السلة السنوية\",\n        content: \"يسر اللجنة الرياضية أن تعلن عن فتح باب التسجيل لبطولة كرة السلة السنوية. آخر موعد للتسجيل 10 مارس 2025\",\n        date: new Date(),\n        category: \"announcement\",\n      },\n    ]);\n\n    // Sample Results\n    await db.insert(results).values([\n      {\n        eventId: null,\n        tournamentName: \"بطولة كرة القدم السنوية 2024\",\n        winner: \"فريق الهندسة\",\n        runnerUp: \"فريق المالية\",\n        thirdPlace: \"فريق التشغيل\",\n        date: new Date(2024, 11, 15),\n        category: \"football\",\n      },\n      {\n        eventId: null,\n        tournamentName: \"دوري كرة السلة الداخلي 2024\",\n        winner: \"فريق تقنية المعلومات\",\n        runnerUp: \"فريق الموارد البشرية\",\n        thirdPlace: \"فريق المشتريات\",\n        date: new Date(2024, 10, 20),\n        category: \"basketball\",\n      },\n    ]);\n\n    // Sample Athletes\n    await db.insert(athletes).values([\n      {\n        name: \"عبدالله الشمري\",\n        position: \"مهندس كهرباء\",\n        department: \"قسم الهندسة\",\n        achievements: \"هداف بطولة كرة القدم 2024 (18 هدف)\",\n        sport: \"كرة قدم\",\n        imageUrl: null,\n      },\n      {\n        name: \"سارة القحطاني\",\n        position: \"محلل أعمال\",\n        department: \"قسم تقنية المعلومات\",\n        achievements: \"أفضل لاعبة في دوري كرة السلة النسائي\",\n        sport: \"كرة سلة\",\n        imageUrl: null,\n      },\n    ]);\n\n    // Sample Gallery\n    await db.insert(gallery).values([\n      {\n        title: \"نهائي بطولة كرة القدم 2024\",\n        category: \"football\",\n        imageUrl: \"/assets/football.png\",\n        eventDate: new Date(2024, 11, 15),\n        description: \"لحظات التتويج من نهائي بطولة كرة القدم السنوية\",\n      },\n      {\n        title: \"اليوم العائلي الترفيهي\",\n        category: \"family\",\n        imageUrl: \"/assets/family.png\",\n        eventDate: new Date(2024, 10, 10),\n        description: \"أجواء مليئة بالمرح والسعادة مع العائلات\",\n      },\n    ]);\n\n    console.log(\"Sample data initialized successfully!\");\n  }\n\n  // Seed sample teams and players\n  async seedTeamsAndPlayers(): Promise<{ teamsCreated: number; playersCreated: number }> {\n    console.log(\"Seeding teams and players...\");\n\n    // Sample Teams\n    const sampleTeams = [\n      {\n        name: \"فريق الهندسة\",\n        level: \"advanced\",\n        averageAge: \"25-30\",\n        representativeName: \"محمد الشمري\",\n        contactPhone: \"0501234567\",\n        contactEmail: \"engineering.team@abraj.com\",\n        description: \"فريق قسم الهندسة - بطل الموسم السابق\",\n        primaryJersey: \"أزرق\",\n        secondaryJersey: \"أبيض\",\n      },\n      {\n        name: \"فريق المالية\",\n        level: \"intermediate\",\n        averageAge: \"30-35\",\n        representativeName: \"خالد العتيبي\",\n        contactPhone: \"0502345678\",\n        contactEmail: \"finance.team@abraj.com\",\n        description: \"فريق قسم المالية والمحاسبة\",\n        primaryJersey: \"أخضر\",\n        secondaryJersey: \"أسود\",\n      },\n      {\n        name: \"فريق التشغيل\",\n        level: \"advanced\",\n        averageAge: \"25-30\",\n        representativeName: \"سعود الحربي\",\n        contactPhone: \"0503456789\",\n        contactEmail: \"operations.team@abraj.com\",\n        description: \"فريق قسم التشغيل والصيانة\",\n        primaryJersey: \"أحمر\",\n        secondaryJersey: \"أبيض\",\n      },\n      {\n        name: \"فريق تقنية المعلومات\",\n        level: \"professional\",\n        averageAge: \"25-30\",\n        representativeName: \"فهد القحطاني\",\n        contactPhone: \"0504567890\",\n        contactEmail: \"it.team@abraj.com\",\n        description: \"فريق قسم تقنية المعلومات\",\n        primaryJersey: \"أسود\",\n        secondaryJersey: \"برتقالي\",\n      },\n      {\n        name: \"فريق الموارد البشرية\",\n        level: \"beginner\",\n        averageAge: \"30-35\",\n        representativeName: \"عبدالرحمن السبيعي\",\n        contactPhone: \"0505678901\",\n        contactEmail: \"hr.team@abraj.com\",\n        description: \"فريق قسم الموارد البشرية\",\n        primaryJersey: \"بنفسجي\",\n        secondaryJersey: \"رمادي\",\n      },\n      {\n        name: \"فريق المشتريات\",\n        level: \"intermediate\",\n        averageAge: \"25-30\",\n        representativeName: \"ناصر الدوسري\",\n        contactPhone: \"0506789012\",\n        contactEmail: \"procurement.team@abraj.com\",\n        description: \"فريق قسم المشتريات واللوجستيات\",\n        primaryJersey: \"ذهبي\",\n        secondaryJersey: \"كحلي\",\n      },\n    ];\n\n    const createdTeams = await db.insert(teams).values(sampleTeams).returning();\n\n    // Sample Players for each team\n    const playerPositions = [\"goalkeeper\", \"defender\", \"midfielder\", \"forward\"];\n    const playerLevels = [\"beginner\", \"intermediate\", \"advanced\", \"professional\"];\n    const arabicNames = [\n      \"عبدالله الشمري\", \"محمد القحطاني\", \"أحمد العتيبي\", \"خالد الحربي\",\n      \"سعد السبيعي\", \"فهد الدوسري\", \"ناصر المطيري\", \"سلطان الغامدي\",\n      \"عمر الزهراني\", \"يوسف البيشي\", \"إبراهيم العسيري\", \"حسن الشهري\",\n      \"علي القرني\", \"صالح الأسمري\", \"ماجد الرشيدي\", \"بندر العنزي\",\n      \"تركي السهلي\", \"راشد الوادعي\", \"مشاري الجهني\", \"عادل الخالدي\",\n      \"هاني المالكي\", \"زياد الحازمي\", \"رامي الثقفي\", \"باسم الزيلعي\",\n    ];\n\n    const allPlayers: any[] = [];\n    let playerIndex = 0;\n\n    for (const team of createdTeams) {\n      // Create 4 players per team\n      for (let i = 0; i < 4; i++) {\n        if (playerIndex >= arabicNames.length) break;\n        \n        allPlayers.push({\n          teamId: team.id,\n          name: arabicNames[playerIndex],\n          number: (i + 1) * 10 + Math.floor(Math.random() * 9),\n          position: playerPositions[i % 4],\n          level: playerLevels[Math.floor(Math.random() * 4)],\n          averageAge: [\"18-25\", \"25-30\", \"30-35\"][Math.floor(Math.random() * 3)],\n          phone: `050${Math.floor(1000000 + Math.random() * 9000000)}`,\n          email: `${arabicNames[playerIndex].split(\" \")[0].toLowerCase()}@abraj.com`,\n          healthStatus: \"fit\",\n        });\n        playerIndex++;\n      }\n    }\n\n    await db.insert(players).values(allPlayers);\n\n    console.log(`Seeded ${createdTeams.length} teams and ${allPlayers.length} players!`);\n    return { teamsCreated: createdTeams.length, playersCreated: allPlayers.length };\n  }\n\n  // ========== LEAGUE GENERATOR IMPLEMENTATIONS ==========\n\n  // Tournaments\n  async getAllTournaments(): Promise<Tournament[]> {\n    return await db.select().from(tournaments).orderBy(desc(tournaments.createdAt));\n  }\n\n  async getTournamentById(id: string): Promise<Tournament | undefined> {\n    const [tournament] = await db.select().from(tournaments).where(eq(tournaments.id, id));\n    return tournament;\n  }\n\n  async createTournament(insertTournament: InsertTournament): Promise<Tournament> {\n    const [tournament] = await db.insert(tournaments).values(insertTournament).returning();\n    return tournament;\n  }\n\n  async updateTournament(id: string, updates: Partial<Tournament>): Promise<Tournament | undefined> {\n    const [tournament] = await db\n      .update(tournaments)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(tournaments.id, id))\n      .returning();\n    return tournament;\n  }\n\n  async deleteTournament(id: string): Promise<boolean> {\n    await db.delete(tournaments).where(eq(tournaments.id, id));\n    return true;\n  }\n\n  // Teams\n  async getAllTeams(): Promise<Team[]> {\n    return await db.select().from(teams).orderBy(desc(teams.createdAt));\n  }\n\n  async getTeamsByTournament(tournamentId: string): Promise<Team[]> {\n    return await db\n      .select()\n      .from(teams)\n      .where(eq(teams.tournamentId, tournamentId))\n      .orderBy(desc(teams.points), desc(teams.goalDifference), desc(teams.goalsFor));\n  }\n\n  async getTeamById(id: string): Promise<Team | undefined> {\n    const [team] = await db.select().from(teams).where(eq(teams.id, id));\n    return team;\n  }\n\n  async createTeam(insertTeam: InsertTeam): Promise<Team> {\n    const [team] = await db.insert(teams).values(insertTeam).returning();\n    return team;\n  }\n\n  async updateTeam(id: string, updates: Partial<Team>): Promise<Team | undefined> {\n    const [team] = await db.update(teams).set(updates).where(eq(teams.id, id)).returning();\n    return team;\n  }\n\n  async deleteTeam(id: string): Promise<boolean> {\n    await db.delete(teams).where(eq(teams.id, id));\n    return true;\n  }\n\n  // Players\n  async getAllPlayers(): Promise<Player[]> {\n    return await db.select().from(players).orderBy(desc(players.createdAt));\n  }\n\n  async getPlayersByTeam(teamId: string): Promise<Player[]> {\n    return await db\n      .select()\n      .from(players)\n      .where(eq(players.teamId, teamId))\n      .orderBy(players.number);\n  }\n\n  async getPlayerById(id: string): Promise<Player | undefined> {\n    const [player] = await db.select().from(players).where(eq(players.id, id));\n    return player;\n  }\n\n  async createPlayer(insertPlayer: InsertPlayer): Promise<Player> {\n    const [player] = await db.insert(players).values(insertPlayer).returning();\n    return player;\n  }\n\n  async updatePlayer(id: string, updates: Partial<Player>): Promise<Player | undefined> {\n    const [player] = await db.update(players).set(updates).where(eq(players.id, id)).returning();\n    return player;\n  }\n\n  async deletePlayer(id: string): Promise<boolean> {\n    await db.delete(players).where(eq(players.id, id));\n    return true;\n  }\n\n  async getTopScorers(tournamentId: string, limit: number = 10): Promise<PlayerWithTeam[]> {\n    const tournamentTeams = await db\n      .select()\n      .from(teams)\n      .where(eq(teams.tournamentId, tournamentId));\n    \n    const teamIds = tournamentTeams.map(t => t.id);\n    if (teamIds.length === 0) return [];\n\n    const allPlayers = await db\n      .select()\n      .from(players)\n      .orderBy(desc(players.goals));\n\n    const scorers: PlayerWithTeam[] = [];\n    for (const player of allPlayers) {\n      if (player.teamId && teamIds.includes(player.teamId) && player.goals > 0) {\n        const team = tournamentTeams.find(t => t.id === player.teamId);\n        if (team) {\n          scorers.push({ ...player, team });\n          if (scorers.length >= limit) break;\n        }\n      }\n    }\n    return scorers;\n  }\n\n  // Referees\n  async getAllReferees(): Promise<Referee[]> {\n    return await db.select().from(referees).orderBy(desc(referees.createdAt));\n  }\n\n  async getRefereesByTournament(tournamentId: string): Promise<Referee[]> {\n    return await db.select().from(referees).where(eq(referees.tournamentId, tournamentId));\n  }\n\n  async getRefereeById(id: string): Promise<Referee | undefined> {\n    const [referee] = await db.select().from(referees).where(eq(referees.id, id));\n    return referee;\n  }\n\n  async createReferee(insertReferee: InsertReferee): Promise<Referee> {\n    const [referee] = await db.insert(referees).values(insertReferee).returning();\n    return referee;\n  }\n\n  async updateReferee(id: string, updates: Partial<Referee>): Promise<Referee | undefined> {\n    const [referee] = await db.update(referees).set(updates).where(eq(referees.id, id)).returning();\n    return referee;\n  }\n\n  async deleteReferee(id: string): Promise<boolean> {\n    await db.delete(referees).where(eq(referees.id, id));\n    return true;\n  }\n\n  // Matches\n  async getMatchesByTournament(tournamentId: string): Promise<MatchWithTeams[]> {\n    const matchesList = await db\n      .select()\n      .from(matches)\n      .where(eq(matches.tournamentId, tournamentId))\n      .orderBy(asc(matches.round), asc(matches.matchDate));\n\n    const matchesWithTeams: MatchWithTeams[] = [];\n    for (const match of matchesList) {\n      const [homeTeam] = await db.select().from(teams).where(eq(teams.id, match.homeTeamId));\n      const [awayTeam] = await db.select().from(teams).where(eq(teams.id, match.awayTeamId));\n      if (homeTeam && awayTeam) {\n        matchesWithTeams.push({ ...match, homeTeam, awayTeam });\n      }\n    }\n    return matchesWithTeams;\n  }\n\n  async getMatchById(id: string): Promise<MatchWithTeams | undefined> {\n    const [match] = await db.select().from(matches).where(eq(matches.id, id));\n    if (!match) return undefined;\n\n    const [homeTeam] = await db.select().from(teams).where(eq(teams.id, match.homeTeamId));\n    const [awayTeam] = await db.select().from(teams).where(eq(teams.id, match.awayTeamId));\n    if (!homeTeam || !awayTeam) return undefined;\n\n    return { ...match, homeTeam, awayTeam };\n  }\n\n  async createMatch(insertMatch: InsertMatch): Promise<Match> {\n    const [match] = await db.insert(matches).values(insertMatch).returning();\n    return match;\n  }\n\n  async updateMatch(id: string, updates: Partial<Match>): Promise<Match | undefined> {\n    const [match] = await db\n      .update(matches)\n      .set({ ...updates, updatedAt: new Date() })\n      .where(eq(matches.id, id))\n      .returning();\n    \n    // If score is updated, recalculate standings\n    if (updates.homeScore !== undefined || updates.awayScore !== undefined) {\n      const fullMatch = await this.getMatchById(id);\n      if (fullMatch) {\n        await this.updateTeamStandings(fullMatch.tournamentId);\n      }\n    }\n    \n    return match;\n  }\n\n  async deleteMatch(id: string): Promise<boolean> {\n    await db.delete(matches).where(eq(matches.id, id));\n    return true;\n  }\n\n  async generateLeagueMatches(tournamentId: string, options?: { \n    matchesPerDay?: number;\n    dailyStartTime?: string; \n  }): Promise<Match[]> {\n    const tournament = await this.getTournamentById(tournamentId);\n    if (!tournament) throw new Error(\"Tournament not found\");\n\n    const tournamentTeams = await this.getTeamsByTournament(tournamentId);\n    if (tournamentTeams.length < 2) throw new Error(\"Not enough teams\");\n\n    // Delete existing matches\n    await db.delete(matches).where(eq(matches.tournamentId, tournamentId));\n\n    // Parse schedule config from tournament or options\n    let scheduleConfig: Record<string, any> = { matchesPerDay: 2, dailyStartTime: \"16:00\" };\n    if (tournament.scheduleConfig) {\n      try {\n        const parsed = JSON.parse(tournament.scheduleConfig);\n        // Merge all fields first, then normalize field names\n        scheduleConfig = { ...scheduleConfig, ...parsed };\n        // Support both matchesPerDay and matchesPerDayPerVenue (legacy compatibility)\n        if (parsed.matchesPerDayPerVenue && !parsed.matchesPerDay) {\n          scheduleConfig.matchesPerDay = parsed.matchesPerDayPerVenue;\n        }\n      } catch (e) {}\n    }\n    if (options?.matchesPerDay) scheduleConfig.matchesPerDay = options.matchesPerDay;\n    if (options?.dailyStartTime) scheduleConfig.dailyStartTime = options.dailyStartTime;\n\n    const generatedMatches: Match[] = [];\n    const teamsList = [...tournamentTeams];\n\n    // Add ghost team if odd number\n    if (teamsList.length % 2 !== 0) {\n      teamsList.push({ id: 'ghost', name: 'BYE' } as Team);\n    }\n\n    const numTeams = teamsList.length;\n    const numRounds = numTeams - 1;\n    const matchesPerRound = numTeams / 2;\n\n    // Calculate dates using tournament start/end dates\n    const startDate = tournament.startDate ? new Date(tournament.startDate) : new Date();\n    const endDate = tournament.endDate ? new Date(tournament.endDate) : null;\n\n    // Generate all match pairs first\n    const allMatchPairs: { homeTeam: typeof teamsList[0]; awayTeam: typeof teamsList[0]; round: number; leg: number }[] = [];\n\n    // Round-robin algorithm\n    for (let round = 0; round < numRounds; round++) {\n      for (let matchNum = 0; matchNum < matchesPerRound; matchNum++) {\n        const home = (round + matchNum) % (numTeams - 1);\n        let away = (numTeams - 1 - matchNum + round) % (numTeams - 1);\n        \n        if (matchNum === 0) {\n          away = numTeams - 1;\n        }\n\n        const homeTeam = teamsList[home];\n        const awayTeam = teamsList[away];\n\n        // Skip ghost matches\n        if (homeTeam.id === 'ghost' || awayTeam.id === 'ghost') continue;\n\n        allMatchPairs.push({ homeTeam, awayTeam, round: round + 1, leg: 1 });\n\n        // Second leg (إياب) if enabled\n        if (tournament.hasSecondLeg) {\n          allMatchPairs.push({ \n            homeTeam: awayTeam, \n            awayTeam: homeTeam, \n            round: numRounds + round + 1, \n            leg: 2 \n          });\n        }\n      }\n    }\n\n    // Distribute matches across dates with venue-based time slots\n    const { matchesPerDay, dailyStartTime } = scheduleConfig;\n    const [startHour, startMinute] = dailyStartTime.split(':').map(Number);\n    \n    // Calculate match duration from tournament settings\n    const halfDuration = tournament.halfDuration || 45;\n    const breakBetweenHalves = tournament.breakBetweenHalves || 15;\n    const matchDurationMinutes = (halfDuration * 2) + breakBetweenHalves + 15; // Add 15 min buffer\n    \n    // Get venues configuration\n    const venuesList = tournament.venues && tournament.venues.length > 0 \n      ? tournament.venues \n      : ['الملعب الرئيسي'];\n    const numberOfVenues = venuesList.length;\n    \n    // Calculate time slots per venue\n    const timeSlotsPerVenue = Math.ceil(matchesPerDay / numberOfVenues);\n    \n    let currentDate = new Date(startDate);\n    let matchesScheduledToday = 0;\n    let currentVenueIndex = 0;\n    let currentTimeSlotInVenue = 0;\n\n    for (const matchPair of allMatchPairs) {\n      // Calculate match time based on venue and time slot\n      const matchDate = new Date(currentDate);\n      const totalMinutesOffset = currentTimeSlotInVenue * matchDurationMinutes;\n      const slotHour = startHour + Math.floor(totalMinutesOffset / 60);\n      const slotMinute = startMinute + (totalMinutesOffset % 60);\n      matchDate.setHours(slotHour, slotMinute, 0, 0);\n\n      const [match] = await db.insert(matches).values({\n        tournamentId,\n        homeTeamId: matchPair.homeTeam.id,\n        awayTeamId: matchPair.awayTeam.id,\n        round: matchPair.round,\n        leg: matchPair.leg,\n        stage: tournament.hasGroupStage ? 'group' : 'league',\n        groupNumber: matchPair.homeTeam.groupNumber,\n        matchDate,\n        venue: venuesList[currentVenueIndex],\n        status: 'scheduled',\n      }).returning();\n      generatedMatches.push(match);\n\n      matchesScheduledToday++;\n      \n      // Move to next venue for the same time slot, or next time slot\n      currentVenueIndex++;\n      if (currentVenueIndex >= numberOfVenues) {\n        currentVenueIndex = 0;\n        currentTimeSlotInVenue++;\n      }\n\n      // Move to next day if needed\n      if (matchesScheduledToday >= matchesPerDay) {\n        currentDate.setDate(currentDate.getDate() + 1);\n        matchesScheduledToday = 0;\n        currentVenueIndex = 0;\n        currentTimeSlotInVenue = 0;\n\n        // Check if we exceeded end date\n        if (endDate && currentDate > endDate) {\n          // Reset to start and continue (wrap around)\n          currentDate = new Date(startDate);\n        }\n      }\n    }\n\n    return generatedMatches;\n  }\n\n  async generateKnockoutMatchesFromGroups(tournamentId: string): Promise<Match[]> {\n    const tournament = await this.getTournamentById(tournamentId);\n    if (!tournament) throw new Error(\"Tournament not found\");\n    if (!tournament.hasGroupStage) throw new Error(\"Tournament doesn't have group stage\");\n\n    const tournamentTeams = await this.getTeamsByTournament(tournamentId);\n    \n    // Group teams by groupNumber and sort by points\n    const groupedTeams: Record<number, Team[]> = {};\n    for (const team of tournamentTeams) {\n      const groupNum = team.groupNumber || 0;\n      if (groupNum > 0) {\n        if (!groupedTeams[groupNum]) groupedTeams[groupNum] = [];\n        groupedTeams[groupNum].push(team);\n      }\n    }\n\n    // Sort each group by points, goal difference, goals for\n    for (const groupNum in groupedTeams) {\n      groupedTeams[groupNum].sort((a, b) => {\n        if (b.points !== a.points) return b.points - a.points;\n        if (b.goalDifference !== a.goalDifference) return b.goalDifference - a.goalDifference;\n        return b.goalsFor - a.goalsFor;\n      });\n    }\n\n    // Get qualified teams (top 2 from each group)\n    const qualifiedTeams: { team: Team; position: number; groupNumber: number }[] = [];\n    const groups = Object.keys(groupedTeams).map(Number).sort((a, b) => a - b);\n    \n    for (const groupNum of groups) {\n      const groupTeams = groupedTeams[groupNum];\n      if (groupTeams.length >= 2) {\n        qualifiedTeams.push({ team: groupTeams[0], position: 1, groupNumber: groupNum });\n        qualifiedTeams.push({ team: groupTeams[1], position: 2, groupNumber: groupNum });\n      }\n    }\n\n    if (qualifiedTeams.length < 2) {\n      throw new Error(\"Not enough qualified teams for knockout stage\");\n    }\n\n    // Delete existing knockout matches\n    await db.delete(matches)\n      .where(\n        and(\n          eq(matches.tournamentId, tournamentId),\n          sql`${matches.stage} != 'group' AND ${matches.stage} != 'league'`\n        )\n      );\n\n    const generatedMatches: Match[] = [];\n    const numQualified = qualifiedTeams.length;\n\n    // Determine the stage based on number of teams\n    let stage: string;\n    if (numQualified >= 16) stage = 'round_of_16';\n    else if (numQualified >= 8) stage = 'quarter_final';\n    else if (numQualified >= 4) stage = 'semi_final';\n    else stage = 'final';\n\n    // Generate matchups: 1st of group A vs 2nd of group B, etc.\n    const matchups: { home: Team; away: Team }[] = [];\n    \n    if (groups.length >= 2) {\n      // Cross-group matching: 1st of group plays 2nd of another group\n      for (let i = 0; i < groups.length; i += 2) {\n        const groupA = groups[i];\n        const groupB = groups[i + 1] || groups[i];\n        \n        const firstA = qualifiedTeams.find(t => t.groupNumber === groupA && t.position === 1);\n        const secondB = qualifiedTeams.find(t => t.groupNumber === groupB && t.position === 2);\n        const firstB = qualifiedTeams.find(t => t.groupNumber === groupB && t.position === 1);\n        const secondA = qualifiedTeams.find(t => t.groupNumber === groupA && t.position === 2);\n        \n        if (firstA && secondB) {\n          matchups.push({ home: firstA.team, away: secondB.team });\n        }\n        if (firstB && secondA && groupA !== groupB) {\n          matchups.push({ home: firstB.team, away: secondA.team });\n        }\n      }\n    } else {\n      // Single group: just match 1st vs 2nd\n      const first = qualifiedTeams.find(t => t.position === 1);\n      const second = qualifiedTeams.find(t => t.position === 2);\n      if (first && second) {\n        matchups.push({ home: first.team, away: second.team });\n      }\n    }\n\n    // Create matches\n    const baseDate = new Date();\n    baseDate.setDate(baseDate.getDate() + 7); // Start a week from now\n\n    for (let i = 0; i < matchups.length; i++) {\n      const matchup = matchups[i];\n      const matchDate = new Date(baseDate);\n      matchDate.setDate(matchDate.getDate() + Math.floor(i / 2) * 2);\n\n      const [match] = await db.insert(matches).values({\n        tournamentId,\n        homeTeamId: matchup.home.id,\n        awayTeamId: matchup.away.id,\n        round: i + 1,\n        leg: 1,\n        stage,\n        matchDate,\n        venue: tournament.venues && tournament.venues.length > 0 \n          ? tournament.venues[i % tournament.venues.length] \n          : null,\n        status: 'scheduled',\n      }).returning();\n      \n      generatedMatches.push(match);\n    }\n\n    // If this is semi-final stage, create final and optionally third place match placeholders\n    if (stage === 'semi_final') {\n      const finalDate = new Date(baseDate);\n      finalDate.setDate(finalDate.getDate() + 7); // A week after semi-finals\n      \n      // Create final placeholder\n      const [finalMatch] = await db.insert(matches).values({\n        tournamentId,\n        homeTeamId: null,\n        awayTeamId: null,\n        round: 1,\n        leg: 1,\n        stage: 'final',\n        matchDate: finalDate,\n        venue: tournament.venues && tournament.venues.length > 0 \n          ? tournament.venues[0] \n          : null,\n        status: 'scheduled',\n      }).returning();\n      \n      generatedMatches.push(finalMatch);\n      \n      // Create third place match placeholder if enabled\n      if (tournament.hasThirdPlaceMatch) {\n        const thirdPlaceDate = new Date(finalDate);\n        thirdPlaceDate.setHours(thirdPlaceDate.getHours() - 2); // Before the final\n        \n        const [thirdPlaceMatch] = await db.insert(matches).values({\n          tournamentId,\n          homeTeamId: null,\n          awayTeamId: null,\n          round: 1,\n          leg: 1,\n          stage: 'third_place',\n          matchDate: thirdPlaceDate,\n          venue: tournament.venues && tournament.venues.length > 0 \n            ? tournament.venues[0] \n            : null,\n          status: 'scheduled',\n        }).returning();\n        \n        generatedMatches.push(thirdPlaceMatch);\n      }\n    }\n\n    return generatedMatches;\n  }\n\n  // ========== GROUP STAGE MANAGEMENT ==========\n  \n  async assignTeamsToGroups(tournamentId: string, assignments?: { teamId: string; groupNumber: number }[]): Promise<Team[]> {\n    const tournament = await this.getTournamentById(tournamentId);\n    if (!tournament) throw new Error(\"Tournament not found\");\n    \n    const tournamentTeams = await this.getTeamsByTournament(tournamentId);\n    if (tournamentTeams.length === 0) throw new Error(\"No teams in tournament\");\n    \n    const numberOfGroups = tournament.numberOfGroups || 2;\n    \n    if (assignments && assignments.length > 0) {\n      // Manual assignment\n      for (const assignment of assignments) {\n        await db.update(teams)\n          .set({ groupNumber: assignment.groupNumber })\n          .where(eq(teams.id, assignment.teamId));\n      }\n    } else {\n      // Auto-distribute teams evenly across groups\n      const shuffled = [...tournamentTeams].sort(() => Math.random() - 0.5);\n      for (let i = 0; i < shuffled.length; i++) {\n        const groupNumber = (i % numberOfGroups) + 1;\n        await db.update(teams)\n          .set({ groupNumber })\n          .where(eq(teams.id, shuffled[i].id));\n      }\n    }\n    \n    // Update tournament stage\n    await db.update(tournaments)\n      .set({ currentStage: 'group_stage' })\n      .where(eq(tournaments.id, tournamentId));\n    \n    return await this.getTeamsByTournament(tournamentId);\n  }\n  \n  async getGroupStandings(tournamentId: string): Promise<{ groupNumber: number; teams: Team[] }[]> {\n    const tournamentTeams = await this.getTeamsByTournament(tournamentId);\n    \n    // Group teams by groupNumber\n    const groupedTeams: Record<number, Team[]> = {};\n    for (const team of tournamentTeams) {\n      const groupNum = team.groupNumber || 0;\n      if (groupNum > 0) {\n        if (!groupedTeams[groupNum]) groupedTeams[groupNum] = [];\n        groupedTeams[groupNum].push(team);\n      }\n    }\n    \n    // Sort each group by points, goal difference, goals for\n    const result: { groupNumber: number; teams: Team[] }[] = [];\n    const groups = Object.keys(groupedTeams).map(Number).sort((a, b) => a - b);\n    \n    for (const groupNum of groups) {\n      const sortedTeams = groupedTeams[groupNum].sort((a, b) => {\n        if (b.points !== a.points) return b.points - a.points;\n        if (b.goalDifference !== a.goalDifference) return b.goalDifference - a.goalDifference;\n        return b.goalsFor - a.goalsFor;\n      });\n      result.push({ groupNumber: groupNum, teams: sortedTeams });\n    }\n    \n    return result;\n  }\n  \n  async generateGroupStageMatches(tournamentId: string, options?: { matchesPerDay?: number; dailyStartTime?: string }): Promise<Match[]> {\n    const tournament = await this.getTournamentById(tournamentId);\n    if (!tournament) throw new Error(\"Tournament not found\");\n    // Check if tournament has group stage (either by flag or type)\n    const isGroupTournament = tournament.hasGroupStage || tournament.type === 'groups' || tournament.type === 'groups_knockout';\n    if (!isGroupTournament) throw new Error(\"Tournament doesn't have group stage\");\n    \n    const tournamentTeams = await this.getTeamsByTournament(tournamentId);\n    \n    // Group teams by groupNumber\n    const groupedTeams: Record<number, Team[]> = {};\n    for (const team of tournamentTeams) {\n      const groupNum = team.groupNumber || 0;\n      if (groupNum > 0) {\n        if (!groupedTeams[groupNum]) groupedTeams[groupNum] = [];\n        groupedTeams[groupNum].push(team);\n      }\n    }\n    \n    // Delete existing group stage matches\n    await db.delete(matches)\n      .where(\n        and(\n          eq(matches.tournamentId, tournamentId),\n          eq(matches.stage, 'group')\n        )\n      );\n    \n    const generatedMatches: Match[] = [];\n    // For group stage tournaments (groups or groups_knockout), ALWAYS use single-leg round-robin\n    // regardless of hasSecondLeg setting - group stage should be one match per pairing\n    const isGroupStageTournament = tournament.type === 'groups' || tournament.type === 'groups_knockout';\n    const hasSecondLeg = isGroupStageTournament ? false : (tournament.hasSecondLeg ?? false);\n    \n    // Parse schedule config from tournament or options (same as generateLeagueMatches)\n    let scheduleConfig: Record<string, any> = { matchesPerDay: 4, dailyStartTime: \"16:00\" };\n    if (tournament.scheduleConfig) {\n      try {\n        const parsed = JSON.parse(tournament.scheduleConfig);\n        // Merge all fields first, then normalize field names\n        scheduleConfig = { ...scheduleConfig, ...parsed };\n        // Support both matchesPerDay and matchesPerDayPerVenue (legacy compatibility)\n        if (parsed.matchesPerDayPerVenue && !parsed.matchesPerDay) {\n          scheduleConfig.matchesPerDay = parsed.matchesPerDayPerVenue;\n        }\n      } catch (e) {}\n    }\n    if (options?.matchesPerDay) scheduleConfig.matchesPerDay = options.matchesPerDay;\n    if (options?.dailyStartTime) scheduleConfig.dailyStartTime = options.dailyStartTime;\n    \n    const matchesPerDay = scheduleConfig.matchesPerDay;\n    const dailyStartTime = scheduleConfig.dailyStartTime;\n    \n    // Parse start time\n    const [startHour, startMinute] = dailyStartTime.split(':').map(Number);\n    \n    // Calculate match duration from tournament settings\n    const halfDuration = tournament.halfDuration || 45;\n    const breakBetweenHalves = tournament.breakBetweenHalves || 15;\n    const matchDurationMinutes = (halfDuration * 2) + breakBetweenHalves + 15; // Add 15 min buffer\n    \n    // Get venues configuration\n    const venuesList = tournament.venues && tournament.venues.length > 0 \n      ? tournament.venues \n      : ['الملعب الرئيسي'];\n    const numberOfVenues = venuesList.length;\n    \n    // Schedule settings\n    let startDate = tournament.startDate ? new Date(tournament.startDate) : new Date();\n    const endDate = tournament.endDate ? new Date(tournament.endDate) : null;\n    let currentDate = new Date(startDate);\n    let matchesScheduledToday = 0;\n    let currentVenueIndex = 0;\n    let currentTimeSlotInVenue = 0;\n    \n    // Generate round-robin matches for each group using proper round-robin scheduling\n    // For n teams: n-1 rounds, each round has n/2 matches (n must be even, add dummy if odd)\n    const allMatchPairs: { home: Team; away: Team; round: number; leg: number; groupNum: number }[] = [];\n    const groups = Object.keys(groupedTeams).map(Number).sort((a, b) => a - b);\n    \n    for (const groupNum of groups) {\n      const groupTeams = [...groupedTeams[groupNum]];\n      if (groupTeams.length < 2) continue;\n      \n      // Round-robin algorithm - generates proper rounds where each team plays once per round\n      // For 4 teams: 3 rounds with 2 matches each = 6 total matches\n      const n = groupTeams.length;\n      const numRounds = n - 1; // For n teams, we need n-1 rounds\n      \n      // If odd number of teams, add a \"bye\" placeholder\n      const teamsForScheduling = [...groupTeams];\n      if (n % 2 !== 0) {\n        teamsForScheduling.push(null as any); // Bye team\n      }\n      \n      const scheduleSize = teamsForScheduling.length;\n      const halfSize = scheduleSize / 2;\n      \n      // Generate each round\n      for (let round = 1; round <= numRounds; round++) {\n        // Create pairings for this round\n        const homeTeamsThisRound = teamsForScheduling.slice(0, halfSize);\n        const awayTeamsThisRound = teamsForScheduling.slice(halfSize).reverse();\n        \n        for (let i = 0; i < halfSize; i++) {\n          const home = homeTeamsThisRound[i];\n          const away = awayTeamsThisRound[i];\n          \n          // Skip if either is a bye (null)\n          if (home && away) {\n            allMatchPairs.push({ \n              home, \n              away, \n              round, \n              leg: 1,\n              groupNum \n            });\n            \n            if (hasSecondLeg) {\n              allMatchPairs.push({ \n                home: away, \n                away: home, \n                round: round + numRounds, \n                leg: 2,\n                groupNum \n              });\n            }\n          }\n        }\n        \n        // Rotate teams for next round (keep first team fixed)\n        const fixed = teamsForScheduling[0];\n        const toRotate = teamsForScheduling.slice(1);\n        const last = toRotate.pop()!;\n        toRotate.unshift(last);\n        teamsForScheduling.splice(0, scheduleSize, fixed, ...toRotate);\n      }\n    }\n    \n    // Sort matches by round first (so all round 1 matches are scheduled together, then round 2, etc.)\n    allMatchPairs.sort((a, b) => a.round - b.round);\n    \n    // Create matches with venue-based time slots\n    for (const matchPair of allMatchPairs) {\n      // Calculate match time based on venue and time slot\n      const matchDate = new Date(currentDate);\n      const totalMinutesOffset = currentTimeSlotInVenue * matchDurationMinutes;\n      const slotHour = startHour + Math.floor(totalMinutesOffset / 60);\n      const slotMinute = startMinute + (totalMinutesOffset % 60);\n      matchDate.setHours(slotHour, slotMinute, 0, 0);\n      \n      const [match] = await db.insert(matches).values({\n        tournamentId,\n        homeTeamId: matchPair.home.id,\n        awayTeamId: matchPair.away.id,\n        round: matchPair.round,\n        leg: matchPair.leg,\n        stage: 'group',\n        groupNumber: matchPair.groupNum,\n        matchDate,\n        venue: venuesList[currentVenueIndex],\n        status: 'scheduled',\n      }).returning();\n      \n      generatedMatches.push(match);\n      matchesScheduledToday++;\n      \n      // Move to next venue for the same time slot, or next time slot\n      currentVenueIndex++;\n      if (currentVenueIndex >= numberOfVenues) {\n        currentVenueIndex = 0;\n        currentTimeSlotInVenue++;\n      }\n      \n      // Move to next day if needed\n      if (matchesScheduledToday >= matchesPerDay) {\n        currentDate.setDate(currentDate.getDate() + 1);\n        matchesScheduledToday = 0;\n        currentVenueIndex = 0;\n        currentTimeSlotInVenue = 0;\n        \n        // Check if we exceeded end date\n        if (endDate && currentDate > endDate) {\n          currentDate = new Date(startDate);\n        }\n      }\n    }\n    \n    return generatedMatches;\n  }\n  \n  async completeGroupStage(tournamentId: string): Promise<{ tournament: Tournament; qualifiedTeams: Team[] }> {\n    const tournament = await this.getTournamentById(tournamentId);\n    if (!tournament) throw new Error(\"Tournament not found\");\n    if (!tournament.hasGroupStage) throw new Error(\"Tournament doesn't have group stage\");\n    \n    // Get group standings\n    const standings = await this.getGroupStandings(tournamentId);\n    const teamsAdvancing = tournament.teamsAdvancingPerGroup || 2;\n    \n    // Get qualified teams from each group\n    const qualifiedTeams: Team[] = [];\n    for (const group of standings) {\n      const advancing = group.teams.slice(0, teamsAdvancing);\n      qualifiedTeams.push(...advancing);\n    }\n    \n    // Update tournament to mark group stage as complete\n    const [updatedTournament] = await db.update(tournaments)\n      .set({ \n        groupStageComplete: true,\n        currentStage: 'knockout_stage'\n      })\n      .where(eq(tournaments.id, tournamentId))\n      .returning();\n    \n    return { tournament: updatedTournament, qualifiedTeams };\n  }\n\n  // Match Events\n  async getMatchEvents(matchId: string): Promise<MatchEvent[]> {\n    return await db\n      .select()\n      .from(matchEvents)\n      .where(eq(matchEvents.matchId, matchId))\n      .orderBy(asc(matchEvents.minute));\n  }\n\n  async createMatchEvent(insertEvent: InsertMatchEvent): Promise<MatchEvent> {\n    const [event] = await db.insert(matchEvents).values(insertEvent).returning();\n    \n    // Update player stats if it's a goal or card\n    if (insertEvent.playerId) {\n      if (insertEvent.eventType === 'goal') {\n        await db.update(players)\n          .set({ goals: sql`${players.goals} + 1` })\n          .where(eq(players.id, insertEvent.playerId));\n      } else if (insertEvent.eventType === 'assist') {\n        await db.update(players)\n          .set({ assists: sql`${players.assists} + 1` })\n          .where(eq(players.id, insertEvent.playerId));\n      } else if (insertEvent.eventType === 'yellow_card') {\n        await db.update(players)\n          .set({ yellowCards: sql`${players.yellowCards} + 1` })\n          .where(eq(players.id, insertEvent.playerId));\n      } else if (insertEvent.eventType === 'red_card') {\n        await db.update(players)\n          .set({ redCards: sql`${players.redCards} + 1` })\n          .where(eq(players.id, insertEvent.playerId));\n      }\n    }\n\n    return event;\n  }\n\n  async deleteMatchEvent(id: string): Promise<boolean> {\n    await db.delete(matchEvents).where(eq(matchEvents.id, id));\n    return true;\n  }\n\n  // Match Lineups\n  async getMatchLineups(matchId: string, teamId?: string): Promise<MatchLineup[]> {\n    if (teamId) {\n      return await db\n        .select()\n        .from(matchLineups)\n        .where(and(eq(matchLineups.matchId, matchId), eq(matchLineups.teamId, teamId)))\n        .orderBy(matchLineups.positionNumber);\n    }\n    return await db\n      .select()\n      .from(matchLineups)\n      .where(eq(matchLineups.matchId, matchId))\n      .orderBy(matchLineups.teamId, matchLineups.positionNumber);\n  }\n\n  async createMatchLineup(insertLineup: InsertMatchLineup): Promise<MatchLineup> {\n    const [lineup] = await db.insert(matchLineups).values(insertLineup).returning();\n    return lineup;\n  }\n\n  async updateMatchLineup(id: string, updates: Partial<MatchLineup>): Promise<MatchLineup | undefined> {\n    const [lineup] = await db.update(matchLineups).set(updates).where(eq(matchLineups.id, id)).returning();\n    return lineup;\n  }\n\n  async deleteMatchLineup(id: string): Promise<boolean> {\n    await db.delete(matchLineups).where(eq(matchLineups.id, id));\n    return true;\n  }\n\n  // Match Comments\n  async getMatchComments(matchId: string): Promise<MatchCommentWithUser[]> {\n    const comments = await db\n      .select()\n      .from(matchComments)\n      .where(eq(matchComments.matchId, matchId))\n      .orderBy(desc(matchComments.createdAt));\n\n    const commentsWithUsers: MatchCommentWithUser[] = [];\n    for (const comment of comments) {\n      const [user] = await db.select({\n        id: users.id,\n        fullName: users.fullName,\n      }).from(users).where(eq(users.id, comment.userId));\n      \n      if (user) {\n        commentsWithUsers.push({ ...comment, user });\n      }\n    }\n    return commentsWithUsers;\n  }\n\n  async createMatchComment(insertComment: InsertMatchComment): Promise<MatchComment> {\n    const [comment] = await db.insert(matchComments).values(insertComment).returning();\n    return comment;\n  }\n\n  async deleteMatchComment(id: string, userId: string): Promise<boolean> {\n    const [comment] = await db.select().from(matchComments).where(eq(matchComments.id, id));\n    if (!comment || comment.userId !== userId) return false;\n    await db.delete(matchComments).where(eq(matchComments.id, id));\n    return true;\n  }\n\n  // Team Evaluations\n  async getTeamEvaluations(teamId: string): Promise<TeamEvaluation[]> {\n    return await db\n      .select()\n      .from(teamEvaluations)\n      .where(eq(teamEvaluations.teamId, teamId))\n      .orderBy(desc(teamEvaluations.createdAt));\n  }\n\n  async createTeamEvaluation(insertEvaluation: InsertTeamEvaluation): Promise<TeamEvaluation> {\n    const [evaluation] = await db.insert(teamEvaluations).values(insertEvaluation).returning();\n    return evaluation;\n  }\n\n  // Update Team Standings\n  async updateTeamStandings(tournamentId: string): Promise<void> {\n    const tournamentTeams = await this.getTeamsByTournament(tournamentId);\n    const matchesList = await db\n      .select()\n      .from(matches)\n      .where(and(eq(matches.tournamentId, tournamentId), eq(matches.status, 'completed')));\n\n    for (const team of tournamentTeams) {\n      let played = 0, won = 0, drawn = 0, lost = 0, goalsFor = 0, goalsAgainst = 0;\n\n      for (const match of matchesList) {\n        if (match.homeScore === null || match.awayScore === null) continue;\n\n        if (match.homeTeamId === team.id) {\n          played++;\n          goalsFor += match.homeScore;\n          goalsAgainst += match.awayScore;\n          if (match.homeScore > match.awayScore) won++;\n          else if (match.homeScore === match.awayScore) drawn++;\n          else lost++;\n        } else if (match.awayTeamId === team.id) {\n          played++;\n          goalsFor += match.awayScore;\n          goalsAgainst += match.homeScore;\n          if (match.awayScore > match.homeScore) won++;\n          else if (match.awayScore === match.homeScore) drawn++;\n          else lost++;\n        }\n      }\n\n      const goalDifference = goalsFor - goalsAgainst;\n      const points = (won * 3) + drawn;\n\n      await db.update(teams).set({\n        played, won, drawn, lost, goalsFor, goalsAgainst, goalDifference, points\n      }).where(eq(teams.id, team.id));\n    }\n  }\n\n  // Site Settings\n  async getSetting(key: string): Promise<string | null> {\n    const [setting] = await db.select().from(siteSettings).where(eq(siteSettings.key, key));\n    return setting?.value ?? null;\n  }\n\n  async setSetting(key: string, value: string): Promise<SiteSetting> {\n    const existing = await db.select().from(siteSettings).where(eq(siteSettings.key, key));\n    \n    if (existing.length > 0) {\n      const [updated] = await db.update(siteSettings)\n        .set({ value, updatedAt: new Date() })\n        .where(eq(siteSettings.key, key))\n        .returning();\n      return updated;\n    } else {\n      const [created] = await db.insert(siteSettings)\n        .values({ key, value })\n        .returning();\n      return created;\n    }\n  }\n}\n\nexport const storage = new DatabaseStorage();\n","path":null,"size_bytes":67607,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/pages/forum.tsx":{"content":"import { useState } from \"react\";\nimport { \n  MessageSquare, Heart, Send, User, Calendar, \n  Loader2, Filter, Plus, Trash2 \n} from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Input } from \"@/components/ui/input\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { ForumPostWithUser, ForumComment } from \"@shared/schema\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/components/ui/dialog\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\n\nconst categoryLabels: Record<string, string> = {\n  general: \"عام\",\n  football: \"كرة قدم\",\n  basketball: \"كرة سلة\",\n  marathon: \"جري\",\n  family: \"عائلي\",\n};\n\nexport default function Forum() {\n  const { user, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  const queryClient = useQueryClient();\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"all\");\n  const [expandedPost, setExpandedPost] = useState<string | null>(null);\n\n  const { data: posts = [], isLoading } = useQuery<ForumPostWithUser[]>({\n    queryKey: [\"/api/forum/posts\"],\n  });\n\n  const filteredPosts = selectedCategory === \"all\" \n    ? posts \n    : posts.filter(p => p.category === selectedCategory);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen py-12\">\n      <div className=\"container mx-auto px-4 md:px-6 max-w-4xl\">\n        {/* Header */}\n        <div className=\"text-center space-y-4 mb-8\">\n          <Badge variant=\"outline\" className=\"text-base px-4 py-2\" data-testid=\"badge-forum\">\n            المنتدى التفاعلي\n          </Badge>\n          <h1 className=\"text-4xl md:text-5xl font-display font-bold\">\n            تواصل مع زملائك\n          </h1>\n          <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n            شارك أفكارك وتجاربك الرياضية مع الجميع\n          </p>\n        </div>\n\n        {/* Actions Bar */}\n        <div className=\"flex flex-col sm:flex-row gap-4 items-center justify-between mb-8\">\n          <div className=\"flex items-center gap-2\">\n            <Filter className=\"h-5 w-5 text-muted-foreground\" />\n            <Select value={selectedCategory} onValueChange={setSelectedCategory}>\n              <SelectTrigger className=\"w-[180px]\" data-testid=\"select-category\">\n                <SelectValue placeholder=\"جميع الفئات\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">جميع الفئات</SelectItem>\n                {Object.entries(categoryLabels).map(([key, label]) => (\n                  <SelectItem key={key} value={key}>{label}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n          \n          {isAuthenticated ? (\n            <CreatePostDialog />\n          ) : (\n            <Button onClick={() => navigate(\"/login\")} data-testid=\"button-login-to-post\">\n              <Plus className=\"h-4 w-4 ml-2\" />\n              سجل دخولك للمشاركة\n            </Button>\n          )}\n        </div>\n\n        {/* Posts */}\n        <div className=\"space-y-6\">\n          {filteredPosts.length === 0 ? (\n            <Card className=\"text-center p-12\">\n              <MessageSquare className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n              <h3 className=\"text-xl font-bold mb-2\">لا توجد منشورات بعد</h3>\n              <p className=\"text-muted-foreground\">\n                كن أول من يشارك في المنتدى!\n              </p>\n            </Card>\n          ) : (\n            filteredPosts.map((post) => (\n              <PostCard \n                key={post.id} \n                post={post} \n                isExpanded={expandedPost === post.id}\n                onToggleExpand={() => setExpandedPost(expandedPost === post.id ? null : post.id)}\n              />\n            ))\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction PostCard({ \n  post, \n  isExpanded, \n  onToggleExpand \n}: { \n  post: ForumPostWithUser; \n  isExpanded: boolean;\n  onToggleExpand: () => void;\n}) {\n  const { user, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [isLiked, setIsLiked] = useState(false);\n  const [likesCount, setLikesCount] = useState(post.likesCount);\n\n  const likeMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/forum/posts/${post.id}/like`, {});\n    },\n    onSuccess: (data: any) => {\n      setIsLiked(data.liked);\n      setLikesCount(prev => data.liked ? prev + 1 : prev - 1);\n      queryClient.invalidateQueries({ queryKey: [\"/api/forum/posts\"] });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"DELETE\", `/api/forum/posts/${post.id}`, {});\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حذف المنشور\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/forum/posts\"] });\n    },\n  });\n\n  const handleLike = () => {\n    if (!isAuthenticated) {\n      toast({\n        title: \"يجب تسجيل الدخول\",\n        description: \"سجل دخولك للإعجاب بالمنشورات\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    likeMutation.mutate();\n  };\n\n  return (\n    <Card className=\"hover-elevate transition-all\" data-testid={`post-${post.id}`}>\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-start justify-between gap-4\">\n          <div className=\"flex items-center gap-3\">\n            <Avatar>\n              <AvatarFallback>{post.user.fullName.charAt(0)}</AvatarFallback>\n            </Avatar>\n            <div>\n              <p className=\"font-medium\">{post.user.fullName}</p>\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <span>{post.user.department}</span>\n                <span>·</span>\n                <span>{new Date(post.createdAt).toLocaleDateString('ar-SA')}</span>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Badge variant=\"outline\">{categoryLabels[post.category] || post.category}</Badge>\n            {user?.id === post.userId && (\n              <Button\n                size=\"icon\"\n                variant=\"ghost\"\n                onClick={() => deleteMutation.mutate()}\n                disabled={deleteMutation.isPending}\n                data-testid={`delete-post-${post.id}`}\n              >\n                <Trash2 className=\"h-4 w-4 text-destructive\" />\n              </Button>\n            )}\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"space-y-4\">\n        <p className=\"whitespace-pre-wrap leading-relaxed\">{post.content}</p>\n        \n        {post.imageUrl && (\n          <img \n            src={post.imageUrl} \n            alt=\"\" \n            className=\"rounded-lg max-h-96 w-full object-cover\"\n          />\n        )}\n\n        <div className=\"flex items-center gap-4 pt-4 border-t\">\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={handleLike}\n            disabled={likeMutation.isPending}\n            className={isLiked ? \"text-destructive\" : \"\"}\n            data-testid={`like-post-${post.id}`}\n          >\n            <Heart className={`h-4 w-4 ml-1 ${isLiked ? \"fill-current\" : \"\"}`} />\n            {likesCount}\n          </Button>\n          <Button\n            variant=\"ghost\"\n            size=\"sm\"\n            onClick={onToggleExpand}\n            data-testid={`comments-post-${post.id}`}\n          >\n            <MessageSquare className=\"h-4 w-4 ml-1\" />\n            {post.commentsCount} تعليق\n          </Button>\n        </div>\n\n        {isExpanded && <CommentsSection postId={post.id} />}\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction CommentsSection({ postId }: { postId: string }) {\n  const { user, isAuthenticated } = useAuth();\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n  const [newComment, setNewComment] = useState(\"\");\n\n  const { data: comments = [], isLoading } = useQuery<(ForumComment & { user: { fullName: string; department: string } })[]>({\n    queryKey: [\"/api/forum/posts\", postId, \"comments\"],\n  });\n\n  const commentMutation = useMutation({\n    mutationFn: async (content: string) => {\n      return await apiRequest(\"POST\", `/api/forum/posts/${postId}/comments`, { content });\n    },\n    onSuccess: () => {\n      setNewComment(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/forum/posts\", postId, \"comments\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/forum/posts\"] });\n    },\n    onError: () => {\n      toast({\n        title: \"فشل إضافة التعليق\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const deleteCommentMutation = useMutation({\n    mutationFn: async (commentId: string) => {\n      return await apiRequest(\"DELETE\", `/api/forum/comments/${commentId}`, {});\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حذف التعليق\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/forum/posts\", postId, \"comments\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/forum/posts\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل حذف التعليق\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newComment.trim()) return;\n    commentMutation.mutate(newComment);\n  };\n\n  return (\n    <div className=\"mt-4 pt-4 border-t space-y-4\">\n      {isLoading ? (\n        <div className=\"text-center py-4\">\n          <Loader2 className=\"h-6 w-6 animate-spin mx-auto\" />\n        </div>\n      ) : comments.length === 0 ? (\n        <p className=\"text-center text-muted-foreground py-4\">لا توجد تعليقات بعد</p>\n      ) : (\n        <div className=\"space-y-3\">\n          {comments.map((comment) => (\n            <div key={comment.id} className=\"flex gap-3 bg-muted/50 rounded-lg p-3\">\n              <Avatar className=\"h-8 w-8\">\n                <AvatarFallback className=\"text-xs\">{comment.user.fullName.charAt(0)}</AvatarFallback>\n              </Avatar>\n              <div className=\"flex-1\">\n                <div className=\"flex items-center justify-between gap-2 mb-1\">\n                  <div className=\"flex items-center gap-2\">\n                    <p className=\"text-sm font-medium\">{comment.user.fullName}</p>\n                    <span className=\"text-xs text-muted-foreground\">\n                      {new Date(comment.createdAt).toLocaleDateString('ar-SA')}\n                    </span>\n                  </div>\n                  {user?.id === comment.userId && (\n                    <Button\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      className=\"h-6 w-6\"\n                      onClick={() => deleteCommentMutation.mutate(comment.id)}\n                      disabled={deleteCommentMutation.isPending}\n                      data-testid={`delete-comment-${comment.id}`}\n                    >\n                      <Trash2 className=\"h-3 w-3 text-destructive\" />\n                    </Button>\n                  )}\n                </div>\n                <p className=\"text-sm\">{comment.content}</p>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      {isAuthenticated ? (\n        <form onSubmit={handleSubmit} className=\"flex gap-2\">\n          <Input\n            value={newComment}\n            onChange={(e) => setNewComment(e.target.value)}\n            placeholder=\"اكتب تعليقاً...\"\n            className=\"flex-1\"\n            data-testid=\"input-new-comment\"\n          />\n          <Button \n            type=\"submit\" \n            size=\"icon\"\n            disabled={commentMutation.isPending || !newComment.trim()}\n            data-testid=\"button-submit-comment\"\n          >\n            {commentMutation.isPending ? (\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\n            ) : (\n              <Send className=\"h-4 w-4\" />\n            )}\n          </Button>\n        </form>\n      ) : (\n        <p className=\"text-center text-sm text-muted-foreground\">\n          سجل دخولك لإضافة تعليق\n        </p>\n      )}\n    </div>\n  );\n}\n\nfunction CreatePostDialog() {\n  const [open, setOpen] = useState(false);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const [content, setContent] = useState(\"\");\n  const [category, setCategory] = useState(\"general\");\n\n  const mutation = useMutation({\n    mutationFn: async (data: { content: string; category: string }) => {\n      return await apiRequest(\"POST\", \"/api/forum/posts\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم نشر المنشور بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/forum/posts\"] });\n      setOpen(false);\n      setContent(\"\");\n      setCategory(\"general\");\n    },\n    onError: () => {\n      toast({ title: \"فشل نشر المنشور\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!content.trim()) return;\n    mutation.mutate({ content, category });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={setOpen}>\n      <DialogTrigger asChild>\n        <Button data-testid=\"button-create-post\">\n          <Plus className=\"h-4 w-4 ml-2\" />\n          منشور جديد\n        </Button>\n      </DialogTrigger>\n      <DialogContent>\n        <DialogHeader>\n          <DialogTitle>إنشاء منشور جديد</DialogTitle>\n        </DialogHeader>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <Select value={category} onValueChange={setCategory}>\n              <SelectTrigger data-testid=\"select-post-category\">\n                <SelectValue placeholder=\"اختر الفئة\" />\n              </SelectTrigger>\n              <SelectContent>\n                {Object.entries(categoryLabels).map(([key, label]) => (\n                  <SelectItem key={key} value={key}>{label}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n          <div>\n            <Textarea\n              value={content}\n              onChange={(e) => setContent(e.target.value)}\n              placeholder=\"شارك أفكارك...\"\n              className=\"min-h-[120px]\"\n              data-testid=\"textarea-post-content\"\n            />\n          </div>\n          <Button \n            type=\"submit\" \n            className=\"w-full\" \n            disabled={mutation.isPending || !content.trim()}\n          >\n            {mutation.isPending ? (\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\n            ) : (\n              \"نشر\"\n            )}\n          </Button>\n        </form>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","path":null,"size_bytes":15664,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/pages/about.tsx":{"content":"import { Target, Heart, Users, Trophy, TrendingUp, Award, Zap, Star } from \"lucide-react\";\nimport { Card, CardContent } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\n\nexport default function About() {\n  const values = [\n    {\n      icon: Heart,\n      title: \"الصحة والعافية\",\n      description: \"نؤمن بأهمية الصحة البدنية والنفسية لجميع موظفينا وأسرهم\",\n    },\n    {\n      icon: Users,\n      title: \"روح الفريق\",\n      description: \"نعزز التعاون والترابط بين الموظفين من خلال الرياضة\",\n    },\n    {\n      icon: Trophy,\n      title: \"التميز الرياضي\",\n      description: \"نشجع على المنافسة الشريفة والسعي للتميز في جميع الأنشطة\",\n    },\n    {\n      icon: Star,\n      title: \"الشمولية\",\n      description: \"نوفر فرصاً متساوية للجميع بغض النظر عن المستوى أو الخبرة\",\n    },\n  ];\n\n  const objectives = [\n    {\n      icon: TrendingUp,\n      title: \"تعزيز اللياقة البدنية\",\n      description: \"تشجيع الموظفين على ممارسة الرياضة بانتظام من خلال برامج وفعاليات متنوعة\",\n    },\n    {\n      icon: Users,\n      title: \"بناء العلاقات\",\n      description: \"خلق فرص للتواصل والتفاعل بين الموظفين من مختلف الأقسام والمستويات\",\n    },\n    {\n      icon: Award,\n      title: \"اكتشاف المواهب\",\n      description: \"توفير منصة لإبراز المواهب الرياضية ودعم الرياضيين الموهوبين\",\n    },\n    {\n      icon: Heart,\n      title: \"تحسين جودة الحياة\",\n      description: \"المساهمة في تحسين الصحة النفسية والتوازن بين العمل والحياة\",\n    },\n    {\n      icon: Zap,\n      title: \"رفع الروح المعنوية\",\n      description: \"زيادة الحماس والطاقة الإيجابية في بيئة العمل\",\n    },\n    {\n      icon: Trophy,\n      title: \"تعزيز الانتماء\",\n      description: \"تقوية الولاء للشركة من خلال الأنشطة الممتعة والمجزية\",\n    },\n  ];\n\n  const achievements = [\n    { number: \"150+\", label: \"فعالية سنوياً\" },\n    { number: \"2500+\", label: \"مشارك نشط\" },\n    { number: \"12\", label: \"رياضة متنوعة\" },\n    { number: \"85+\", label: \"بطولة منظمة\" },\n  ];\n\n  return (\n    <div className=\"min-h-screen py-12\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        {/* Header */}\n        <div className=\"text-center space-y-4 mb-16\">\n          <Badge variant=\"outline\" className=\"text-base px-4 py-2\" data-testid=\"badge-about\">\n            من نحن\n          </Badge>\n          <h1 className=\"text-4xl md:text-6xl font-display font-bold\">\n            اللجنة الرياضية\n          </h1>\n          <p className=\"text-lg md:text-xl text-muted-foreground max-w-2xl mx-auto\">\n            شركة أبراج لخدمات الطاقة\n          </p>\n        </div>\n\n        {/* Introduction */}\n        <Card className=\"mb-20\">\n          <CardContent className=\"p-12 md:p-16 space-y-6\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold text-center mb-8\">\n              نبذة عن اللجنة\n            </h2>\n            <p className=\"text-lg text-muted-foreground leading-relaxed text-center max-w-4xl mx-auto\">\n              اللجنة الرياضية بشركة أبراج لخدمات الطاقة هي منظمة داخلية تهدف إلى تعزيز الصحة البدنية والنفسية للموظفين وأسرهم من خلال تنظيم وإدارة الأنشطة الرياضية والترفيهية المتنوعة. نؤمن بأن الموظف الصحي والسعيد هو أساس نجاح المؤسسة، ولذلك نسعى جاهدين لتوفير بيئة رياضية محفزة وداعمة تشجع على المشاركة الفعالة والتفاعل الإيجابي.\n            </p>\n          </CardContent>\n        </Card>\n\n        {/* Vision & Mission */}\n        <div className=\"grid md:grid-cols-2 gap-8 mb-20\">\n          <Card className=\"bg-gradient-to-br from-primary/10 to-primary/5 border-2 border-primary/20\">\n            <CardContent className=\"p-12 space-y-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-16 h-16 rounded-xl bg-primary text-primary-foreground flex items-center justify-center\">\n                  <Target className=\"h-9 w-9\" />\n                </div>\n                <h3 className=\"text-3xl font-display font-bold\">رؤيتنا</h3>\n              </div>\n              <p className=\"text-lg text-muted-foreground leading-relaxed\">\n                أن نكون المنصة الرياضية الأولى التي تجمع موظفي الشركة وأسرهم في بيئة رياضية محفزة وممتعة، نساهم من خلالها في بناء مجتمع صحي ومتماسك يعزز روح الانتماء والولاء للشركة.\n              </p>\n            </CardContent>\n          </Card>\n\n          <Card className=\"bg-gradient-to-br from-victory/10 to-victory/5 border-2 border-victory/20\">\n            <CardContent className=\"p-12 space-y-6\">\n              <div className=\"flex items-center gap-4\">\n                <div className=\"w-16 h-16 rounded-xl bg-victory text-victory-foreground flex items-center justify-center\">\n                  <Heart className=\"h-9 w-9\" />\n                </div>\n                <h3 className=\"text-3xl font-display font-bold\">رسالتنا</h3>\n              </div>\n              <p className=\"text-lg text-muted-foreground leading-relaxed\">\n                تنظيم فعاليات رياضية وترفيهية متنوعة على مدار العام، توفير المرافق الرياضية المناسبة، وتشجيع المشاركة الفعالة من جميع الموظفين بما يعزز الصحة البدنية والنفسية ويقوي روح الفريق.\n              </p>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Values */}\n        <section className=\"mb-20\">\n          <div className=\"text-center space-y-4 mb-12\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold\">قيمنا</h2>\n            <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n              المبادئ التي توجه عملنا وأنشطتنا\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\n            {values.map((value, index) => (\n              <Card key={index} className=\"text-center hover-elevate active-elevate-2 transition-all\" data-testid={`value-${index}`}>\n                <CardContent className=\"p-8 space-y-4\">\n                  <div className=\"w-16 h-16 mx-auto rounded-xl bg-primary/10 flex items-center justify-center\">\n                    <value.icon className=\"h-8 w-8 text-primary\" />\n                  </div>\n                  <h3 className=\"text-xl font-display font-bold\">{value.title}</h3>\n                  <p className=\"text-muted-foreground leading-relaxed\">{value.description}</p>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Objectives */}\n        <section className=\"mb-20\">\n          <div className=\"text-center space-y-4 mb-12\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold\">أهدافنا</h2>\n            <p className=\"text-lg text-muted-foreground max-w-2xl mx-auto\">\n              ما نسعى لتحقيقه من خلال أنشطتنا وبرامجنا\n            </p>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {objectives.map((objective, index) => (\n              <Card key={index} className=\"hover-elevate transition-all\" data-testid={`objective-${index}`}>\n                <CardContent className=\"p-8 space-y-4\">\n                  <div className=\"flex items-start gap-4\">\n                    <div className=\"w-12 h-12 flex-shrink-0 rounded-md bg-success/10 flex items-center justify-center\">\n                      <objective.icon className=\"h-6 w-6 text-success\" />\n                    </div>\n                    <div>\n                      <h3 className=\"text-lg font-display font-bold mb-2\">{objective.title}</h3>\n                      <p className=\"text-sm text-muted-foreground leading-relaxed\">\n                        {objective.description}\n                      </p>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        </section>\n\n        {/* Achievements Stats */}\n        <Card className=\"bg-gradient-to-l from-primary via-victory to-success text-primary-foreground border-0\">\n          <CardContent className=\"p-12 md:p-16\">\n            <h2 className=\"text-3xl md:text-4xl font-display font-bold text-center mb-12\">\n              إنجازاتنا بالأرقام\n            </h2>\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-8\">\n              {achievements.map((achievement, index) => (\n                <div key={index} className=\"text-center space-y-2\" data-testid={`achievement-${index}`}>\n                  <div className=\"text-5xl md:text-6xl font-display font-bold\">\n                    {achievement.number}\n                  </div>\n                  <div className=\"text-lg md:text-xl opacity-95\">\n                    {achievement.label}\n                  </div>\n                </div>\n              ))}\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9937,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/pages/profile.tsx":{"content":"import { User, Mail, Phone, Building, Briefcase, Calendar, Clock, Loader2, CheckCircle, XCircle } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useLocation } from \"wouter\";\nimport { useMemo } from \"react\";\n\nconst shiftLabels: Record<string, string> = {\n  \"2weeks_on_2weeks_off\": \"2 أسبوع عمل / 2 أسبوع إجازة\",\n  normal: \"دوام عادي\",\n  flexible: \"دوام مرن\",\n};\n\nconst roleLabels: Record<string, string> = {\n  employee: \"موظف\",\n  admin: \"مدير\",\n  committee_member: \"عضو لجنة\",\n};\n\nfunction calculateShiftStatus(shiftPattern: string): { isOnShift: boolean; daysRemaining: number; nextChange: Date } {\n  const today = new Date();\n  const referenceDate = new Date(\"2025-01-01\");\n  const daysDiff = Math.floor((today.getTime() - referenceDate.getTime()) / (1000 * 60 * 60 * 24));\n  \n  if (shiftPattern === \"2weeks_on_2weeks_off\") {\n    const cycleDay = daysDiff % 28;\n    const isOnShift = cycleDay < 14;\n    const daysRemaining = isOnShift ? 14 - cycleDay : 28 - cycleDay;\n    const nextChange = new Date(today);\n    nextChange.setDate(nextChange.getDate() + daysRemaining);\n    return { isOnShift, daysRemaining, nextChange };\n  }\n  \n  return { isOnShift: false, daysRemaining: 0, nextChange: today };\n}\n\nfunction generateShiftCalendar(shiftPattern: string): { date: Date; isOnShift: boolean }[] {\n  const days: { date: Date; isOnShift: boolean }[] = [];\n  const today = new Date();\n  const referenceDate = new Date(\"2025-01-01\");\n  \n  for (let i = 0; i < 28; i++) {\n    const date = new Date(today);\n    date.setDate(date.getDate() + i);\n    \n    if (shiftPattern === \"2weeks_on_2weeks_off\") {\n      const daysDiff = Math.floor((date.getTime() - referenceDate.getTime()) / (1000 * 60 * 60 * 24));\n      const cycleDay = daysDiff % 28;\n      const isOnShift = cycleDay < 14;\n      days.push({ date, isOnShift });\n    } else {\n      days.push({ date, isOnShift: shiftPattern === \"normal\" });\n    }\n  }\n  \n  return days;\n}\n\nexport default function Profile() {\n  const { user, isAuthenticated, isLoading } = useAuth();\n  const [, navigate] = useLocation();\n\n  const shiftStatus = useMemo(() => {\n    if (!user) return null;\n    return calculateShiftStatus(user.shiftPattern);\n  }, [user]);\n\n  const shiftCalendar = useMemo(() => {\n    if (!user) return [];\n    return generateShiftCalendar(user.shiftPattern);\n  }, [user]);\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated || !user) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full text-center p-8\">\n          <User className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n          <h2 className=\"text-2xl font-bold mb-4\">يجب تسجيل الدخول</h2>\n          <p className=\"text-muted-foreground mb-6\">\n            يرجى تسجيل الدخول لعرض ملفك الشخصي\n          </p>\n          <Button onClick={() => navigate(\"/login\")} data-testid=\"button-login\">\n            تسجيل الدخول\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen py-12\">\n      <div className=\"container mx-auto px-4 md:px-6 max-w-4xl\">\n        {/* Header */}\n        <div className=\"text-center space-y-4 mb-12\">\n          <div className=\"w-24 h-24 mx-auto rounded-full bg-primary/10 flex items-center justify-center\">\n            <User className=\"w-12 h-12 text-primary\" />\n          </div>\n          <h1 className=\"text-3xl md:text-4xl font-display font-bold\">\n            {user.fullName}\n          </h1>\n          <div className=\"flex justify-center gap-2 flex-wrap\">\n            <Badge variant=\"outline\">{user.department}</Badge>\n            <Badge>{roleLabels[user.role] || user.role}</Badge>\n          </div>\n        </div>\n\n        {/* Profile Details */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <Card data-testid=\"card-personal-info\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <User className=\"h-5 w-5\" />\n                المعلومات الشخصية\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <User className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">الاسم الكامل</p>\n                  <p className=\"font-medium\">{user.fullName}</p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <Mail className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">البريد الإلكتروني</p>\n                  <p className=\"font-medium\">{user.email}</p>\n                </div>\n              </div>\n              {user.phoneNumber && (\n                <div className=\"flex items-center gap-3\">\n                  <Phone className=\"h-5 w-5 text-muted-foreground\" />\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">رقم الجوال</p>\n                    <p className=\"font-medium\" dir=\"ltr\">{user.phoneNumber}</p>\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-work-info\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Briefcase className=\"h-5 w-5\" />\n                معلومات العمل\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex items-center gap-3\">\n                <Building className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">القسم</p>\n                  <p className=\"font-medium\">{user.department}</p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <Briefcase className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">المنصب</p>\n                  <p className=\"font-medium\">{user.position}</p>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-3\">\n                <Calendar className=\"h-5 w-5 text-muted-foreground\" />\n                <div>\n                  <p className=\"text-sm text-muted-foreground\">رقم الموظف</p>\n                  <p className=\"font-medium\">{user.employeeId}</p>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n\n          <Card className=\"md:col-span-2\" data-testid=\"card-shift-info\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Clock className=\"h-5 w-5\" />\n                جدول الدوام\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                <div className=\"bg-muted/50 rounded-lg p-4 text-center\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">نظام الدوام</p>\n                  <p className=\"font-medium\">{shiftLabels[user.shiftPattern] || user.shiftPattern}</p>\n                </div>\n                <div className=\"bg-muted/50 rounded-lg p-4 text-center\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">الحالة الحالية</p>\n                  {user.shiftPattern === \"2weeks_on_2weeks_off\" && shiftStatus ? (\n                    <Badge className={shiftStatus.isOnShift ? \"bg-gold\" : \"bg-success\"}>\n                      {shiftStatus.isOnShift ? \"في الدوام\" : \"في الإجازة\"}\n                    </Badge>\n                  ) : (\n                    <Badge className=\"bg-success\">متاح</Badge>\n                  )}\n                </div>\n                <div className=\"bg-muted/50 rounded-lg p-4 text-center\">\n                  <p className=\"text-sm text-muted-foreground mb-1\">\n                    {shiftStatus?.isOnShift ? \"تبقى للإجازة\" : \"تبقى للدوام\"}\n                  </p>\n                  <p className=\"font-medium\">\n                    {user.shiftPattern === \"2weeks_on_2weeks_off\" && shiftStatus \n                      ? `${shiftStatus.daysRemaining} يوم`\n                      : \"-\"\n                    }\n                  </p>\n                </div>\n              </div>\n\n              {/* Shift Calendar */}\n              {user.shiftPattern === \"2weeks_on_2weeks_off\" && (\n                <div>\n                  <h4 className=\"font-medium mb-3\">جدول الأسابيع القادمة</h4>\n                  <div className=\"grid grid-cols-7 gap-1 text-center text-sm\">\n                    {[\"أحد\", \"إثن\", \"ثلا\", \"أرب\", \"خمي\", \"جمع\", \"سبت\"].map((day) => (\n                      <div key={day} className=\"font-medium text-muted-foreground p-2\">\n                        {day}\n                      </div>\n                    ))}\n                    {shiftCalendar.map((day, index) => (\n                      <div\n                        key={index}\n                        className={`p-2 rounded text-xs ${\n                          day.isOnShift \n                            ? \"bg-gold/20 text-gold-foreground border border-gold/30\" \n                            : \"bg-success/20 text-success-foreground border border-success/30\"\n                        }`}\n                        title={day.isOnShift ? \"في الدوام\" : \"إجازة\"}\n                      >\n                        {day.date.getDate()}\n                      </div>\n                    ))}\n                  </div>\n                  <div className=\"flex items-center justify-center gap-6 mt-4 text-sm\">\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 rounded bg-gold/20 border border-gold/30\" />\n                      <span>في الدوام</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <div className=\"w-4 h-4 rounded bg-success/20 border border-success/30\" />\n                      <span>إجازة</span>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Actions */}\n        <div className=\"mt-8 flex justify-center gap-4\">\n          <Button onClick={() => navigate(\"/my-events\")} data-testid=\"button-my-events\">\n            فعالياتي\n          </Button>\n          <Button variant=\"outline\" onClick={() => navigate(\"/events\")} data-testid=\"button-browse-events\">\n            تصفح الفعاليات\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":11369,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/pages/match-detail.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRoute, Link } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { \n  ArrowRight,\n  Calendar,\n  MapPin,\n  Users,\n  MessageSquare,\n  Play,\n  User,\n  Send,\n  Clock,\n  Target,\n  AlertTriangle,\n  Video,\n  Share2\n} from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { MatchWithTeams, MatchEvent, MatchLineup, MatchCommentWithUser, Player } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst matchStatusLabels: Record<string, string> = {\n  scheduled: \"قادمة\",\n  live: \"مباشر\",\n  completed: \"انتهت\",\n  postponed: \"مؤجلة\",\n};\n\nconst eventTypeLabels: Record<string, string> = {\n  goal: \"هدف\",\n  own_goal: \"هدف عكسي\",\n  assist: \"تمريرة حاسمة\",\n  yellow_card: \"بطاقة صفراء\",\n  red_card: \"بطاقة حمراء\",\n  substitution_in: \"دخول بديل\",\n  substitution_out: \"خروج لاعب\",\n};\n\nconst eventTypeIcons: Record<string, string> = {\n  goal: \"⚽\",\n  own_goal: \"🔴\",\n  assist: \"👟\",\n  yellow_card: \"🟨\",\n  red_card: \"🟥\",\n  substitution_in: \"🔼\",\n  substitution_out: \"🔽\",\n};\n\nexport default function MatchDetail() {\n  const [, params] = useRoute(\"/matches/:id\");\n  const matchId = params?.id;\n  const { toast } = useToast();\n  const { isAuthenticated, user } = useAuth();\n  const [comment, setComment] = useState(\"\");\n\n  const { data: match, isLoading } = useQuery<MatchWithTeams>({\n    queryKey: [\"/api/matches\", matchId],\n    enabled: !!matchId,\n    refetchInterval: (data) => data?.status === \"live\" ? 10000 : false,\n  });\n\n  const { data: events } = useQuery<MatchEvent[]>({\n    queryKey: [\"/api/matches\", matchId, \"events\"],\n    enabled: !!matchId,\n  });\n\n  const { data: lineups } = useQuery<MatchLineup[]>({\n    queryKey: [\"/api/matches\", matchId, \"lineups\"],\n    enabled: !!matchId,\n  });\n\n  const { data: comments, refetch: refetchComments } = useQuery<MatchCommentWithUser[]>({\n    queryKey: [\"/api/matches\", matchId, \"comments\"],\n    enabled: !!matchId,\n  });\n\n  const { data: homePlayers } = useQuery<Player[]>({\n    queryKey: [\"/api/teams\", match?.homeTeamId, \"players\"],\n    enabled: !!match?.homeTeamId,\n  });\n\n  const { data: awayPlayers } = useQuery<Player[]>({\n    queryKey: [\"/api/teams\", match?.awayTeamId, \"players\"],\n    enabled: !!match?.awayTeamId,\n  });\n\n  const addCommentMutation = useMutation({\n    mutationFn: async (content: string) => {\n      const response = await apiRequest(\"POST\", `/api/matches/${matchId}/comments`, { content });\n      return response.json();\n    },\n    onSuccess: () => {\n      refetchComments();\n      setComment(\"\");\n      toast({ title: \"تم إضافة تعليقك\" });\n    },\n    onError: () => {\n      toast({ title: \"فشل إضافة التعليق\", variant: \"destructive\" });\n    },\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!match) {\n    return (\n      <div className=\"min-h-screen flex flex-col items-center justify-center gap-4\" dir=\"rtl\">\n        <Calendar className=\"h-16 w-16 text-muted-foreground\" />\n        <h2 className=\"text-xl font-medium\">المباراة غير موجودة</h2>\n        <Link href=\"/leagues\">\n          <Button>\n            <ArrowRight className=\"ml-2 h-4 w-4\" />\n            العودة للبطولات\n          </Button>\n        </Link>\n      </div>\n    );\n  }\n\n  const homeEvents = events?.filter(e => e.teamId === match.homeTeamId) || [];\n  const awayEvents = events?.filter(e => e.teamId === match.awayTeamId) || [];\n\n  const homeLineup = lineups?.filter(l => l.teamId === match.homeTeamId) || [];\n  const awayLineup = lineups?.filter(l => l.teamId === match.awayTeamId) || [];\n\n  return (\n    <div className=\"min-h-screen bg-background\" dir=\"rtl\">\n      <div className={`relative py-12 ${\n        match.status === \"live\" \n          ? \"bg-gradient-to-br from-red-600 via-red-500 to-red-700\" \n          : \"bg-gradient-to-br from-primary via-primary/90 to-primary/80\"\n      } text-white`}>\n        <div className=\"absolute inset-0 bg-black/30\" />\n        <div className=\"relative container mx-auto px-4\">\n          <Link href={`/leagues/${match.tournamentId}`}>\n            <Button variant=\"ghost\" className=\"text-white/80 hover:text-white mb-4\" data-testid=\"button-back\">\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n              العودة للبطولة\n            </Button>\n          </Link>\n\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n          >\n            <div className=\"flex items-center justify-center gap-4 mb-6\">\n              <Badge className={\n                match.status === \"live\" ? \"bg-white text-red-600 animate-pulse\" :\n                match.status === \"completed\" ? \"bg-gray-500\" : \"bg-blue-500\"\n              }>\n                {match.status === \"live\" && <Play className=\"h-3 w-3 ml-1\" />}\n                {matchStatusLabels[match.status]}\n              </Badge>\n              <div className=\"text-sm opacity-80\">\n                الجولة {match.round} {match.leg === 2 && \"- إياب\"}\n              </div>\n            </div>\n\n            <div className=\"flex items-center justify-center gap-4 md:gap-12\">\n              <div className=\"flex-1 text-center\">\n                <div className=\"w-20 h-20 md:w-28 md:h-28 mx-auto bg-white/10 rounded-full flex items-center justify-center mb-3\">\n                  <Users className=\"h-10 w-10 md:h-14 md:w-14\" />\n                </div>\n                <h2 className=\"text-xl md:text-2xl font-bold\">{match.homeTeam?.name}</h2>\n              </div>\n\n              <div className=\"text-center px-4 md:px-8\">\n                {match.status === \"completed\" || match.status === \"live\" ? (\n                  <div className=\"text-5xl md:text-7xl font-bold flex items-center gap-3 md:gap-6\">\n                    <span>{match.homeScore ?? 0}</span>\n                    <span className=\"text-3xl opacity-50\">-</span>\n                    <span>{match.awayScore ?? 0}</span>\n                  </div>\n                ) : (\n                  <div className=\"text-4xl font-bold opacity-50\">VS</div>\n                )}\n                {match.matchDate && (\n                  <div className=\"mt-4 flex items-center justify-center gap-2 text-sm opacity-80\">\n                    <Clock className=\"h-4 w-4\" />\n                    {format(new Date(match.matchDate), \"EEEE dd/MM/yyyy - HH:mm\", { locale: ar })}\n                  </div>\n                )}\n              </div>\n\n              <div className=\"flex-1 text-center\">\n                <div className=\"w-20 h-20 md:w-28 md:h-28 mx-auto bg-white/10 rounded-full flex items-center justify-center mb-3\">\n                  <Users className=\"h-10 w-10 md:h-14 md:w-14\" />\n                </div>\n                <h2 className=\"text-xl md:text-2xl font-bold\">{match.awayTeam?.name}</h2>\n              </div>\n            </div>\n\n            {match.venue && (\n              <div className=\"text-center mt-6 flex items-center justify-center gap-2 opacity-80\">\n                <MapPin className=\"h-4 w-4\" />\n                {match.venue}\n              </div>\n            )}\n\n            <div className=\"flex items-center justify-center gap-4 mt-6\">\n              {match.streamUrl && (\n                <a href={match.streamUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                  <Button variant=\"secondary\" size=\"sm\">\n                    <Video className=\"h-4 w-4 ml-2\" />\n                    بث مباشر\n                  </Button>\n                </a>\n              )}\n              {match.highlightsUrl && (\n                <a href={match.highlightsUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                  <Button variant=\"secondary\" size=\"sm\">\n                    <Play className=\"h-4 w-4 ml-2\" />\n                    ملخص المباراة\n                  </Button>\n                </a>\n              )}\n            </div>\n          </motion.div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 py-8\">\n        <Tabs defaultValue=\"events\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full max-w-md mx-auto grid-cols-3\">\n            <TabsTrigger value=\"events\" data-testid=\"tab-events\">الأحداث</TabsTrigger>\n            <TabsTrigger value=\"lineup\" data-testid=\"tab-lineup\">التشكيلات</TabsTrigger>\n            <TabsTrigger value=\"comments\" data-testid=\"tab-comments\">التعليقات</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"events\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Target className=\"h-5 w-5 text-primary\" />\n                  أحداث المباراة\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {events && events.length > 0 ? (\n                  <div className=\"space-y-3\">\n                    {events\n                      .sort((a, b) => a.minute - b.minute)\n                      .map((event) => {\n                        const isHome = event.teamId === match.homeTeamId;\n                        const players = isHome ? homePlayers : awayPlayers;\n                        const player = players?.find(p => p.id === event.playerId);\n                        \n                        return (\n                          <motion.div\n                            key={event.id}\n                            initial={{ opacity: 0, x: isHome ? -20 : 20 }}\n                            animate={{ opacity: 1, x: 0 }}\n                            className={`flex items-center gap-4 p-3 rounded-lg bg-muted/50 ${\n                              isHome ? \"flex-row\" : \"flex-row-reverse\"\n                            }`}\n                          >\n                            <div className=\"text-2xl\">{eventTypeIcons[event.eventType]}</div>\n                            <div className={isHome ? \"text-right\" : \"text-left\"}>\n                              <div className=\"font-medium\">{player?.name || \"لاعب غير محدد\"}</div>\n                              <div className=\"text-sm text-muted-foreground\">\n                                {eventTypeLabels[event.eventType]} - الدقيقة {event.minute}'\n                                {event.extraMinute && `+${event.extraMinute}`}\n                              </div>\n                            </div>\n                            <Badge variant=\"outline\" className=\"mr-auto ml-0\">\n                              {event.minute}'\n                            </Badge>\n                          </motion.div>\n                        );\n                      })}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Target className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>لا توجد أحداث مسجلة</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"lineup\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Users className=\"h-5 w-5\" />\n                    {match.homeTeam?.name}\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {homeLineup.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {homeLineup.map((lineup) => {\n                        const player = homePlayers?.find(p => p.id === lineup.playerId);\n                        return (\n                          <div key={lineup.id} className=\"flex items-center gap-3 p-2 rounded bg-muted/50\">\n                            <Badge variant=\"outline\">{player?.number}</Badge>\n                            <span>{player?.name}</span>\n                            {!lineup.isStarter && (\n                              <Badge variant=\"secondary\" className=\"text-xs\">بديل</Badge>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  ) : homePlayers && homePlayers.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {homePlayers.map((player) => (\n                        <div key={player.id} className=\"flex items-center gap-3 p-2 rounded bg-muted/50\">\n                          <Badge variant=\"outline\">{player.number}</Badge>\n                          <span>{player.name}</span>\n                          <Badge variant=\"secondary\" className=\"text-xs\">{player.position}</Badge>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-center text-muted-foreground py-4\">لم يتم تحديد التشكيلة</p>\n                  )}\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Users className=\"h-5 w-5\" />\n                    {match.awayTeam?.name}\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {awayLineup.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {awayLineup.map((lineup) => {\n                        const player = awayPlayers?.find(p => p.id === lineup.playerId);\n                        return (\n                          <div key={lineup.id} className=\"flex items-center gap-3 p-2 rounded bg-muted/50\">\n                            <Badge variant=\"outline\">{player?.number}</Badge>\n                            <span>{player?.name}</span>\n                            {!lineup.isStarter && (\n                              <Badge variant=\"secondary\" className=\"text-xs\">بديل</Badge>\n                            )}\n                          </div>\n                        );\n                      })}\n                    </div>\n                  ) : awayPlayers && awayPlayers.length > 0 ? (\n                    <div className=\"space-y-2\">\n                      {awayPlayers.map((player) => (\n                        <div key={player.id} className=\"flex items-center gap-3 p-2 rounded bg-muted/50\">\n                          <Badge variant=\"outline\">{player.number}</Badge>\n                          <span>{player.name}</span>\n                          <Badge variant=\"secondary\" className=\"text-xs\">{player.position}</Badge>\n                        </div>\n                      ))}\n                    </div>\n                  ) : (\n                    <p className=\"text-center text-muted-foreground py-4\">لم يتم تحديد التشكيلة</p>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"comments\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <MessageSquare className=\"h-5 w-5 text-primary\" />\n                  تعليقات الجمهور\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-6\">\n                {isAuthenticated && (\n                  <div className=\"flex gap-3\">\n                    <Avatar>\n                      <AvatarFallback>{user?.fullName?.charAt(0)}</AvatarFallback>\n                    </Avatar>\n                    <div className=\"flex-1 space-y-2\">\n                      <Textarea\n                        value={comment}\n                        onChange={(e) => setComment(e.target.value)}\n                        placeholder=\"شاركنا رأيك...\"\n                        className=\"min-h-[80px]\"\n                        data-testid=\"input-comment\"\n                      />\n                      <Button\n                        onClick={() => addCommentMutation.mutate(comment)}\n                        disabled={!comment.trim() || addCommentMutation.isPending}\n                        data-testid=\"button-submit-comment\"\n                      >\n                        <Send className=\"h-4 w-4 ml-2\" />\n                        إرسال\n                      </Button>\n                    </div>\n                  </div>\n                )}\n\n                {!isAuthenticated && (\n                  <div className=\"text-center py-4 text-muted-foreground bg-muted/50 rounded-lg\">\n                    <Link href=\"/login\">\n                      <Button variant=\"link\">سجل دخولك</Button>\n                    </Link>\n                    للمشاركة في التعليقات\n                  </div>\n                )}\n\n                <div className=\"space-y-4\">\n                  {comments?.map((c) => (\n                    <motion.div\n                      key={c.id}\n                      initial={{ opacity: 0, y: 10 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      className=\"flex gap-3\"\n                    >\n                      <Avatar>\n                        <AvatarFallback>{c.user?.fullName?.charAt(0)}</AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1 bg-muted/50 rounded-lg p-3\">\n                        <div className=\"flex items-center gap-2 mb-1\">\n                          <span className=\"font-medium\">{c.user?.fullName}</span>\n                          <span className=\"text-xs text-muted-foreground\">\n                            {format(new Date(c.createdAt), \"dd/MM/yyyy - HH:mm\", { locale: ar })}\n                          </span>\n                        </div>\n                        <p className=\"text-sm\">{c.content}</p>\n                      </div>\n                    </motion.div>\n                  ))}\n\n                  {(!comments || comments.length === 0) && (\n                    <div className=\"text-center py-8 text-muted-foreground\">\n                      <MessageSquare className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                      <p>لا توجد تعليقات بعد - كن أول المعلقين!</p>\n                    </div>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":19179,"size_tokens":null},"client/src/pages/leagues.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { motion } from \"framer-motion\";\nimport { \n  Trophy, \n  Calendar, \n  Users, \n  MapPin, \n  ChevronLeft,\n  Flame,\n  Target,\n  Award\n} from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport type { Tournament } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst sportLabels: Record<string, string> = {\n  football: \"كرة القدم\",\n  basketball: \"كرة السلة\",\n  volleyball: \"الكرة الطائرة\",\n  tennis: \"التنس\",\n};\n\nconst typeLabels: Record<string, string> = {\n  round_robin: \"دوري كامل\",\n  knockout: \"خروج مغلوب\",\n  groups: \"مجموعات\",\n  groups_knockout: \"مجموعات + خروج مغلوب\",\n};\n\nconst statusLabels: Record<string, string> = {\n  registration: \"التسجيل مفتوح\",\n  ongoing: \"جارية\",\n  completed: \"منتهية\",\n};\n\nconst statusColors: Record<string, string> = {\n  registration: \"bg-emerald-500 text-white\",\n  ongoing: \"bg-orange-500 text-white\",\n  completed: \"bg-gray-500 text-white\",\n};\n\nconst sportIcons: Record<string, string> = {\n  football: \"⚽\",\n  basketball: \"🏀\",\n  volleyball: \"🏐\",\n  tennis: \"🎾\",\n};\n\nexport default function Leagues() {\n  const [activeTab, setActiveTab] = useState<string>(\"all\");\n\n  const { data: tournaments, isLoading } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n  });\n\n  const filteredTournaments = tournaments?.filter(t => {\n    if (activeTab === \"all\") return true;\n    return t.status === activeTab;\n  });\n\n  return (\n    <div className=\"min-h-screen bg-background\" dir=\"rtl\">\n      <div className=\"relative bg-gradient-to-br from-primary via-primary/90 to-primary/80 text-white py-20\">\n        <div className=\"absolute inset-0 bg-black/30\" />\n        <div className=\"relative container mx-auto px-4\">\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5 }}\n            className=\"text-center\"\n          >\n            <Trophy className=\"w-16 h-16 mx-auto mb-4\" />\n            <h1 className=\"text-4xl md:text-5xl font-bold mb-4\">البطولات والدوريات</h1>\n            <p className=\"text-xl opacity-90 max-w-2xl mx-auto\">\n              استعرض جميع البطولات والدوريات الرياضية - سجّل فريقك وتنافس على البطولة\n            </p>\n          </motion.div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 py-12\">\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"mb-8\">\n          <TabsList className=\"grid w-full max-w-md mx-auto grid-cols-4\">\n            <TabsTrigger value=\"all\" data-testid=\"tab-all\">الكل</TabsTrigger>\n            <TabsTrigger value=\"registration\" data-testid=\"tab-registration\">التسجيل</TabsTrigger>\n            <TabsTrigger value=\"ongoing\" data-testid=\"tab-ongoing\">جارية</TabsTrigger>\n            <TabsTrigger value=\"completed\" data-testid=\"tab-completed\">منتهية</TabsTrigger>\n          </TabsList>\n        </Tabs>\n\n        {isLoading ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"animate-pulse\">\n                <CardHeader className=\"h-40 bg-muted\" />\n                <CardContent className=\"space-y-3 pt-4\">\n                  <div className=\"h-6 bg-muted rounded w-3/4\" />\n                  <div className=\"h-4 bg-muted rounded w-1/2\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : filteredTournaments && filteredTournaments.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredTournaments.map((tournament, index) => (\n              <motion.div\n                key={tournament.id}\n                initial={{ opacity: 0, y: 20 }}\n                animate={{ opacity: 1, y: 0 }}\n                transition={{ delay: index * 0.1 }}\n              >\n                <Card className=\"overflow-hidden hover-elevate group\" data-testid={`card-tournament-${tournament.id}`}>\n                  <div className=\"relative h-48 bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center\">\n                    <span className=\"text-8xl opacity-30\">\n                      {sportIcons[tournament.sport] || \"🏆\"}\n                    </span>\n                    <div className=\"absolute top-4 right-4\">\n                      <Badge className={statusColors[tournament.status]}>\n                        {statusLabels[tournament.status]}\n                      </Badge>\n                    </div>\n                    {tournament.status === \"ongoing\" && (\n                      <div className=\"absolute top-4 left-4\">\n                        <Badge className=\"bg-red-500 text-white animate-pulse\">\n                          <Flame className=\"h-3 w-3 ml-1\" />\n                          مباشر\n                        </Badge>\n                      </div>\n                    )}\n                  </div>\n\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-xl flex items-center gap-2\">\n                      <Trophy className=\"h-5 w-5 text-gold\" />\n                      {tournament.name}\n                    </CardTitle>\n                    <p className=\"text-sm text-muted-foreground line-clamp-2\">\n                      {tournament.description}\n                    </p>\n                  </CardHeader>\n\n                  <CardContent className=\"space-y-4\">\n                    <div className=\"grid grid-cols-2 gap-3 text-sm\">\n                      <div className=\"flex items-center gap-2 text-muted-foreground\">\n                        <Target className=\"h-4 w-4\" />\n                        <span>{sportLabels[tournament.sport] || tournament.sport}</span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-muted-foreground\">\n                        <Award className=\"h-4 w-4\" />\n                        <span>{typeLabels[tournament.type] || tournament.type}</span>\n                      </div>\n                      <div className=\"flex items-center gap-2 text-muted-foreground\">\n                        <Users className=\"h-4 w-4\" />\n                        <span>{tournament.maxTeams} فريق</span>\n                      </div>\n                      {tournament.startDate && (\n                        <div className=\"flex items-center gap-2 text-muted-foreground\">\n                          <Calendar className=\"h-4 w-4\" />\n                          <span>{format(new Date(tournament.startDate), \"dd/MM/yyyy\", { locale: ar })}</span>\n                        </div>\n                      )}\n                    </div>\n\n                    {tournament.venues && tournament.venues.length > 0 && (\n                      <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                        <MapPin className=\"h-4 w-4\" />\n                        <span>{tournament.venues.join(\"، \")}</span>\n                      </div>\n                    )}\n\n                    <Link href={`/leagues/${tournament.id}`}>\n                      <Button className=\"w-full group-hover:bg-primary\" data-testid={`button-view-tournament-${tournament.id}`}>\n                        عرض البطولة\n                        <ChevronLeft className=\"h-4 w-4 mr-2\" />\n                      </Button>\n                    </Link>\n                  </CardContent>\n                </Card>\n              </motion.div>\n            ))}\n          </div>\n        ) : (\n          <motion.div\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            className=\"text-center py-16\"\n          >\n            <Trophy className=\"h-20 w-20 mx-auto text-muted-foreground/30 mb-4\" />\n            <h3 className=\"text-xl font-medium text-muted-foreground mb-2\">\n              لا توجد بطولات حالياً\n            </h3>\n            <p className=\"text-muted-foreground\">\n              {activeTab === \"registration\" && \"لا توجد بطولات مفتوحة للتسجيل حالياً\"}\n              {activeTab === \"ongoing\" && \"لا توجد بطولات جارية حالياً\"}\n              {activeTab === \"completed\" && \"لا توجد بطولات منتهية\"}\n              {activeTab === \"all\" && \"ترقب إعلان البطولات القادمة قريباً\"}\n            </p>\n          </motion.div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":8895,"size_tokens":null},"client/src/pages/league-detail.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRoute, Link } from \"wouter\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { \n  Trophy, \n  Calendar, \n  Users, \n  MapPin,\n  ArrowRight,\n  Target,\n  Award,\n  ChevronLeft,\n  Plus,\n  Clock,\n  Play,\n  CheckCircle2,\n  User,\n  Swords,\n  Shield,\n  BarChart3\n} from \"lucide-react\";\nimport { TeamBox, getTeamColor, isLightColor } from \"@/components/TeamBox\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Tournament, Team, MatchWithTeams, PlayerWithTeam } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\nimport KnockoutBracket from \"@/components/KnockoutBracket\";\n\nconst sportLabels: Record<string, string> = {\n  football: \"كرة القدم\",\n  basketball: \"كرة السلة\",\n  volleyball: \"الكرة الطائرة\",\n  tennis: \"التنس\",\n};\n\nconst typeLabels: Record<string, string> = {\n  round_robin: \"دوري كامل (ذهاب وإياب)\",\n  knockout: \"خروج مغلوب\",\n  groups: \"مجموعات\",\n  groups_knockout: \"مجموعات + خروج مغلوب\",\n};\n\nconst statusLabels: Record<string, string> = {\n  registration: \"التسجيل مفتوح\",\n  ongoing: \"جارية\",\n  completed: \"منتهية\",\n};\n\nconst matchStatusLabels: Record<string, string> = {\n  scheduled: \"قادمة\",\n  live: \"مباشر\",\n  completed: \"انتهت\",\n  postponed: \"مؤجلة\",\n};\n\nconst matchStatusColors: Record<string, string> = {\n  scheduled: \"bg-blue-500/10 text-blue-500\",\n  live: \"bg-red-500 text-white animate-pulse\",\n  completed: \"bg-gray-500/10 text-gray-500\",\n  postponed: \"bg-yellow-500/10 text-yellow-500\",\n};\n\nconst groupLabels: Record<number, string> = {\n  1: \"المجموعة أ\",\n  2: \"المجموعة ب\",\n  3: \"المجموعة ج\",\n  4: \"المجموعة د\",\n  5: \"المجموعة هـ\",\n  6: \"المجموعة و\",\n  7: \"المجموعة ز\",\n  8: \"المجموعة ح\",\n};\n\ninterface GroupStandingsData {\n  groupNumber: number;\n  teams: Team[];\n}\n\nfunction GroupStandings({ standings, matches, isLoading }: { standings: GroupStandingsData[]; matches?: MatchWithTeams[]; isLoading?: boolean }) {\n  if (isLoading) {\n    return (\n      <div className=\"text-center py-12 text-muted-foreground\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4\" />\n        <p>جاري تحميل ترتيب المجموعات...</p>\n      </div>\n    );\n  }\n\n  if (!standings || standings.length === 0) {\n    return (\n      <div className=\"text-center py-12 text-muted-foreground\">\n        <Users className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n        <p>لم يتم تقسيم الفرق إلى مجموعات بعد</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n      {standings.map(({ groupNumber, teams: groupTeams }) => {\n        if (!groupTeams || groupTeams.length === 0) {\n          return null;\n        }\n        \n        const groupMatches = matches?.filter(m => \n          m.stage === \"group\" && \n          groupTeams.some(t => t.id === m.homeTeamId || t.id === m.awayTeamId)\n        ) || [];\n        \n        return (\n          <Card key={groupNumber} data-testid={`group-${groupNumber}`}>\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"flex items-center gap-2 text-lg\">\n                <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center\">\n                  <span className=\"text-primary font-bold text-sm\">{groupNumber}</span>\n                </div>\n                {groupLabels[groupNumber] || `المجموعة ${groupNumber}`}\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"pt-0\">\n              <div className=\"overflow-x-auto\">\n                <Table>\n                  <TableHeader>\n                    <TableRow className=\"text-xs bg-muted/50\">\n                      <TableHead className=\"text-center w-10 px-1\">#</TableHead>\n                      <TableHead className=\"text-right px-2\">الفريق</TableHead>\n                      <TableHead className=\"text-center px-1 w-10\">لعب</TableHead>\n                      <TableHead className=\"text-center px-1 w-10\">ف</TableHead>\n                      <TableHead className=\"text-center px-1 w-10\">ت</TableHead>\n                      <TableHead className=\"text-center px-1 w-10\">خ</TableHead>\n                      <TableHead className=\"text-center px-1 w-10\">له</TableHead>\n                      <TableHead className=\"text-center px-1 w-10\">عليه</TableHead>\n                      <TableHead className=\"text-center px-1 w-10\">فارق</TableHead>\n                      <TableHead className=\"text-center px-2 w-12 font-bold bg-primary/5\">نقاط</TableHead>\n                    </TableRow>\n                  </TableHeader>\n                  <TableBody>\n                    {groupTeams.map((team, index) => {\n                      const isQualified = index < 2;\n                      return (\n                        <TableRow \n                          key={team.id} \n                          className={isQualified ? \"bg-emerald-500/5\" : \"\"}\n                          data-testid={`row-group-team-${team.id}`}\n                        >\n                          <TableCell className=\"font-bold px-1 text-sm text-center\">\n                            {index === 0 && <Trophy className=\"h-4 w-4 text-yellow-500 mx-auto\" />}\n                            {index > 0 && index + 1}\n                          </TableCell>\n                          <TableCell className=\"font-medium px-2 text-sm\">{team.name}</TableCell>\n                          <TableCell className=\"text-center px-1 text-sm\">{team.played}</TableCell>\n                          <TableCell className=\"text-center px-1 text-sm text-emerald-600 dark:text-emerald-400 font-medium\">{team.won}</TableCell>\n                          <TableCell className=\"text-center px-1 text-sm text-muted-foreground\">{team.drawn}</TableCell>\n                          <TableCell className=\"text-center px-1 text-sm text-red-600 dark:text-red-400\">{team.lost}</TableCell>\n                          <TableCell className=\"text-center px-1 text-sm\">{team.goalsFor}</TableCell>\n                          <TableCell className=\"text-center px-1 text-sm\">{team.goalsAgainst}</TableCell>\n                          <TableCell className=\"text-center px-1 text-sm\">\n                            <span className={team.goalDifference > 0 ? \"text-emerald-600 dark:text-emerald-400\" : team.goalDifference < 0 ? \"text-red-600 dark:text-red-400\" : \"\"}>\n                              {team.goalDifference > 0 ? \"+\" : \"\"}{team.goalDifference}\n                            </span>\n                          </TableCell>\n                          <TableCell className=\"text-center px-2 font-bold text-lg bg-primary/5\">{team.points}</TableCell>\n                        </TableRow>\n                      );\n                    })}\n                  </TableBody>\n                </Table>\n              </div>\n              \n              <div className=\"mt-4 flex items-center gap-4 text-xs text-muted-foreground\">\n                <div className=\"flex items-center gap-1\">\n                  <div className=\"w-3 h-3 rounded bg-emerald-500/20\" />\n                  <span>يتأهل للأدوار الإقصائية</span>\n                </div>\n              </div>\n\n              {groupMatches.length > 0 && (\n                <div className=\"mt-4 pt-4 border-t\">\n                  <h4 className=\"text-sm font-medium mb-3 flex items-center gap-2\">\n                    <Calendar className=\"h-4 w-4\" />\n                    مباريات المجموعة\n                  </h4>\n                  <div className=\"space-y-2\">\n                    {groupMatches.slice(0, 4).map((match) => (\n                      <GroupMatchCard key={match.id} match={match} />\n                    ))}\n                    {groupMatches.length > 4 && (\n                      <p className=\"text-xs text-muted-foreground text-center\">\n                        +{groupMatches.length - 4} مباريات أخرى\n                      </p>\n                    )}\n                  </div>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n        );\n      })}\n    </div>\n  );\n}\n\nfunction GroupMatchCard({ match }: { match: MatchWithTeams }) {\n  const isCompleted = match.status === \"completed\";\n  const homeWon = isCompleted && (match.homeScore ?? 0) > (match.awayScore ?? 0);\n  const awayWon = isCompleted && (match.awayScore ?? 0) > (match.homeScore ?? 0);\n\n  return (\n    <Link href={`/matches/${match.id}`}>\n      <motion.div \n        whileHover={{ x: -2 }}\n        className=\"flex items-center justify-between p-2 bg-muted/30 rounded-lg text-sm cursor-pointer hover-elevate\"\n        data-testid={`group-match-${match.id}`}\n      >\n        <div className=\"flex items-center gap-2 flex-1\">\n          <span className={`font-medium ${homeWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}`}>\n            {match.homeTeam?.name}\n          </span>\n        </div>\n        \n        <div className=\"flex items-center gap-2 px-3\">\n          {isCompleted ? (\n            <>\n              <span className={`font-bold min-w-[20px] text-center ${homeWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}`}>\n                {match.homeScore}\n              </span>\n              <span className=\"text-muted-foreground\">-</span>\n              <span className={`font-bold min-w-[20px] text-center ${awayWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}`}>\n                {match.awayScore}\n              </span>\n            </>\n          ) : (\n            <Badge variant=\"outline\" className=\"text-xs\">\n              {matchStatusLabels[match.status]}\n            </Badge>\n          )}\n        </div>\n        \n        <div className=\"flex items-center gap-2 flex-1 justify-end\">\n          <span className={`font-medium ${awayWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}`}>\n            {match.awayTeam?.name}\n          </span>\n        </div>\n      </motion.div>\n    </Link>\n  );\n}\n\nexport default function LeagueDetail() {\n  const [, params] = useRoute(\"/leagues/:id\");\n  const tournamentId = params?.id;\n  const { toast } = useToast();\n  const { isAuthenticated, user } = useAuth();\n  const [isRegisterOpen, setIsRegisterOpen] = useState(false);\n  const [teamName, setTeamName] = useState(\"\");\n\n  const { data: tournament, isLoading: tournamentLoading } = useQuery<Tournament>({\n    queryKey: [\"/api/tournaments\", tournamentId],\n    enabled: !!tournamentId,\n  });\n\n  const { data: teams } = useQuery<Team[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"teams\"],\n    enabled: !!tournamentId,\n  });\n\n  const { data: matches } = useQuery<MatchWithTeams[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"matches\"],\n    enabled: !!tournamentId,\n  });\n\n  const { data: topScorers } = useQuery<PlayerWithTeam[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"top-scorers\"],\n    enabled: !!tournamentId,\n  });\n\n  const { data: groupStandings = [], isLoading: standingsLoading } = useQuery<GroupStandingsData[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"group-standings\"],\n    enabled: !!tournamentId && tournament?.hasGroupStage === true,\n  });\n\n  const registerTeamMutation = useMutation({\n    mutationFn: async (name: string) => {\n      const response = await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/teams`, { name });\n      return response.json();\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n      setIsRegisterOpen(false);\n      setTeamName(\"\");\n      toast({\n        title: \"تم التسجيل بنجاح!\",\n        description: \"تم تسجيل فريقك في البطولة\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"فشل التسجيل\",\n        description: \"حدث خطأ أثناء التسجيل\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (tournamentLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <div className=\"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full\" />\n      </div>\n    );\n  }\n\n  if (!tournament) {\n    return (\n      <div className=\"min-h-screen flex flex-col items-center justify-center gap-4\" dir=\"rtl\">\n        <Trophy className=\"h-16 w-16 text-muted-foreground\" />\n        <h2 className=\"text-xl font-medium\">البطولة غير موجودة</h2>\n        <Link href=\"/leagues\">\n          <Button>\n            <ArrowRight className=\"ml-2 h-4 w-4\" />\n            العودة للبطولات\n          </Button>\n        </Link>\n      </div>\n    );\n  }\n\n  const sortedTeams = [...(teams || [])].sort((a, b) => {\n    if (b.points !== a.points) return b.points - a.points;\n    if (b.goalDifference !== a.goalDifference) return b.goalDifference - a.goalDifference;\n    return b.goalsFor - a.goalsFor;\n  });\n\n  const upcomingMatches = matches?.filter(m => m.status === \"scheduled\" || m.status === \"live\") || [];\n  const completedMatches = matches?.filter(m => m.status === \"completed\") || [];\n\n  const themeConfig = (() => {\n    if (!tournament.themeConfig) return { primaryColor: null, secondaryColor: null };\n    try {\n      const parsed = JSON.parse(tournament.themeConfig);\n      return {\n        primaryColor: parsed.primaryColor || null,\n        secondaryColor: parsed.secondaryColor || null,\n      };\n    } catch {\n      return { primaryColor: null, secondaryColor: null };\n    }\n  })();\n  \n  const heroImage = tournament.heroImageUrl || tournament.imageUrl;\n  const hasCustomTheme = themeConfig.primaryColor && themeConfig.secondaryColor;\n  \n  const heroStyle = hasCustomTheme \n    ? { background: `linear-gradient(135deg, ${themeConfig.primaryColor}, ${themeConfig.secondaryColor})` }\n    : {};\n\n  return (\n    <div className=\"min-h-screen bg-background\" dir=\"rtl\">\n      <div \n        className={`relative text-white py-16 ${!hasCustomTheme ? 'bg-gradient-to-br from-primary via-primary/90 to-primary/80' : ''}`}\n        style={heroStyle}\n      >\n        {heroImage && (\n          <div \n            className=\"absolute inset-0 bg-cover bg-center\" \n            style={{ backgroundImage: `url(${heroImage})` }}\n          />\n        )}\n        <div className=\"absolute inset-0 bg-black/40\" />\n        <div className=\"relative container mx-auto px-4\">\n          <Link href=\"/leagues\">\n            <Button variant=\"ghost\" className=\"text-white/80 hover:text-white mb-4\" data-testid=\"button-back\">\n              <ArrowRight className=\"ml-2 h-4 w-4\" />\n              العودة للبطولات\n            </Button>\n          </Link>\n          \n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-6\"\n          >\n            <div>\n              <div className=\"flex items-center gap-3 mb-2\">\n                <Trophy className=\"h-10 w-10\" />\n                <Badge className={\n                  tournament.status === \"registration\" ? \"bg-emerald-500\" :\n                  tournament.status === \"ongoing\" ? \"bg-orange-500\" : \"bg-gray-500\"\n                }>\n                  {statusLabels[tournament.status]}\n                </Badge>\n              </div>\n              <h1 className=\"text-3xl md:text-4xl font-bold mb-2\">{tournament.name}</h1>\n              <p className=\"text-lg opacity-90 max-w-2xl\">{tournament.description}</p>\n            </div>\n\n            {tournament.status === \"registration\" && isAuthenticated && (\n              <Dialog open={isRegisterOpen} onOpenChange={setIsRegisterOpen}>\n                <DialogTrigger asChild>\n                  <Button size=\"lg\" className=\"bg-white text-primary hover:bg-white/90\" data-testid=\"button-register-team\">\n                    <Plus className=\"ml-2 h-5 w-5\" />\n                    سجّل فريقك\n                  </Button>\n                </DialogTrigger>\n                <DialogContent dir=\"rtl\">\n                  <DialogHeader>\n                    <DialogTitle>تسجيل فريق جديد</DialogTitle>\n                  </DialogHeader>\n                  <div className=\"space-y-4 py-4\">\n                    <div className=\"space-y-2\">\n                      <Label htmlFor=\"teamName\">اسم الفريق</Label>\n                      <Input\n                        id=\"teamName\"\n                        value={teamName}\n                        onChange={(e) => setTeamName(e.target.value)}\n                        placeholder=\"أدخل اسم الفريق\"\n                        data-testid=\"input-team-name\"\n                      />\n                    </div>\n                    <Button \n                      className=\"w-full\" \n                      onClick={() => registerTeamMutation.mutate(teamName)}\n                      disabled={!teamName.trim() || registerTeamMutation.isPending}\n                      data-testid=\"button-submit-team\"\n                    >\n                      {registerTeamMutation.isPending ? \"جاري التسجيل...\" : \"تسجيل الفريق\"}\n                    </Button>\n                  </div>\n                </DialogContent>\n              </Dialog>\n            )}\n          </motion.div>\n\n          <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mt-8\">\n            <div className=\"bg-white/10 backdrop-blur rounded-lg p-4 text-center\">\n              <Target className=\"h-6 w-6 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold\">{sportLabels[tournament.sport]}</div>\n              <div className=\"text-sm opacity-80\">الرياضة</div>\n            </div>\n            <div className=\"bg-white/10 backdrop-blur rounded-lg p-4 text-center\">\n              <Award className=\"h-6 w-6 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold\">{typeLabels[tournament.type]?.split(\" \")[0]}</div>\n              <div className=\"text-sm opacity-80\">نوع البطولة</div>\n            </div>\n            <div className=\"bg-white/10 backdrop-blur rounded-lg p-4 text-center\">\n              <Users className=\"h-6 w-6 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold\">{teams?.length || 0} / {tournament.maxTeams}</div>\n              <div className=\"text-sm opacity-80\">الفرق المسجلة</div>\n            </div>\n            <div className=\"bg-white/10 backdrop-blur rounded-lg p-4 text-center\">\n              <Calendar className=\"h-6 w-6 mx-auto mb-2\" />\n              <div className=\"text-2xl font-bold\">{matches?.length || 0}</div>\n              <div className=\"text-sm opacity-80\">المباريات</div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"container mx-auto px-4 py-8\">\n        <Tabs defaultValue=\"standings\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full max-w-3xl mx-auto grid-cols-6\">\n            <TabsTrigger value=\"standings\" data-testid=\"tab-standings\">الترتيب</TabsTrigger>\n            <TabsTrigger value=\"matches\" data-testid=\"tab-matches\">المباريات</TabsTrigger>\n            <TabsTrigger value=\"knockout\" data-testid=\"tab-knockout\">\n              <Swords className=\"h-4 w-4 ml-1\" />\n              التصفيات\n            </TabsTrigger>\n            <TabsTrigger value=\"scorers\" data-testid=\"tab-scorers\">الهدافين</TabsTrigger>\n            <TabsTrigger value=\"stats\" data-testid=\"tab-stats\">\n              <BarChart3 className=\"h-4 w-4 ml-1\" />\n              إحصائيات\n            </TabsTrigger>\n            <TabsTrigger value=\"teams\" data-testid=\"tab-teams\">الفرق</TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"standings\">\n            {tournament.hasGroupStage ? (\n              <GroupStandings standings={groupStandings} matches={matches} isLoading={standingsLoading} />\n            ) : (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Trophy className=\"h-5 w-5 text-gold\" />\n                    جدول الترتيب\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {sortedTeams.length > 0 ? (\n                    <div className=\"overflow-x-auto\">\n                      <Table>\n                        <TableHeader>\n                          <TableRow>\n                            <TableHead className=\"text-right w-12\">#</TableHead>\n                            <TableHead className=\"text-right\">الفريق</TableHead>\n                            <TableHead className=\"text-center\">لعب</TableHead>\n                            <TableHead className=\"text-center\">فاز</TableHead>\n                            <TableHead className=\"text-center\">تعادل</TableHead>\n                            <TableHead className=\"text-center\">خسر</TableHead>\n                            <TableHead className=\"text-center\">له</TableHead>\n                            <TableHead className=\"text-center\">عليه</TableHead>\n                            <TableHead className=\"text-center\">الفارق</TableHead>\n                            <TableHead className=\"text-center font-bold\">النقاط</TableHead>\n                          </TableRow>\n                        </TableHeader>\n                        <TableBody>\n                          {sortedTeams.map((team, index) => (\n                            <TableRow \n                              key={team.id} \n                              className={index < 3 ? \"bg-primary/5\" : \"\"}\n                              data-testid={`row-team-${team.id}`}\n                            >\n                              <TableCell className=\"font-bold\">\n                                {index === 0 && <span className=\"text-gold\">🥇</span>}\n                                {index === 1 && <span className=\"text-gray-400\">🥈</span>}\n                                {index === 2 && <span className=\"text-amber-600\">🥉</span>}\n                                {index > 2 && index + 1}\n                              </TableCell>\n                              <TableCell className=\"font-medium\">{team.name}</TableCell>\n                              <TableCell className=\"text-center\">{team.played}</TableCell>\n                              <TableCell className=\"text-center text-emerald-500\">{team.won}</TableCell>\n                              <TableCell className=\"text-center text-gray-500\">{team.drawn}</TableCell>\n                              <TableCell className=\"text-center text-red-500\">{team.lost}</TableCell>\n                              <TableCell className=\"text-center\">{team.goalsFor}</TableCell>\n                              <TableCell className=\"text-center\">{team.goalsAgainst}</TableCell>\n                              <TableCell className=\"text-center\">\n                                <span className={team.goalDifference > 0 ? \"text-emerald-500\" : team.goalDifference < 0 ? \"text-red-500\" : \"\"}>\n                                  {team.goalDifference > 0 ? \"+\" : \"\"}{team.goalDifference}\n                                </span>\n                              </TableCell>\n                              <TableCell className=\"text-center font-bold text-lg\">{team.points}</TableCell>\n                            </TableRow>\n                          ))}\n                        </TableBody>\n                      </Table>\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-12 text-muted-foreground\">\n                      <Users className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                      <p>لم يتم تسجيل أي فرق بعد</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            )}\n          </TabsContent>\n\n          <TabsContent value=\"matches\" className=\"space-y-6\">\n            <MatchesView matches={matches || []} />\n          </TabsContent>\n\n          <TabsContent value=\"knockout\">\n            <KnockoutBracket \n              matches={matches || []} \n              tournament={tournament}\n              groupStageComplete={tournament?.currentStage !== 'group_stage'}\n            />\n          </TabsContent>\n\n          <TabsContent value=\"scorers\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <Target className=\"h-5 w-5 text-orange-500\" />\n                  قائمة الهدافين\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {topScorers && topScorers.length > 0 ? (\n                  <div className=\"overflow-x-auto\">\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"text-right w-12\">#</TableHead>\n                          <TableHead className=\"text-right\">اللاعب</TableHead>\n                          <TableHead className=\"text-right\">الفريق</TableHead>\n                          <TableHead className=\"text-center\">الأهداف</TableHead>\n                          <TableHead className=\"text-center\">التمريرات</TableHead>\n                          <TableHead className=\"text-center\">المباريات</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {topScorers.map((player, index) => (\n                          <TableRow key={player.id} data-testid={`row-scorer-${player.id}`}>\n                            <TableCell className=\"font-bold\">\n                              {index === 0 && \"🥇\"}\n                              {index === 1 && \"🥈\"}\n                              {index === 2 && \"🥉\"}\n                              {index > 2 && index + 1}\n                            </TableCell>\n                            <TableCell className=\"font-medium flex items-center gap-2\">\n                              <User className=\"h-4 w-4\" />\n                              {player.name}\n                              <Badge variant=\"outline\" className=\"text-xs\">\n                                #{player.number}\n                              </Badge>\n                            </TableCell>\n                            <TableCell>{player.team?.name}</TableCell>\n                            <TableCell className=\"text-center font-bold text-lg\">{player.goals}</TableCell>\n                            <TableCell className=\"text-center\">{player.assists}</TableCell>\n                            <TableCell className=\"text-center\">{player.matchesPlayed}</TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </div>\n                ) : (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Target className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>لا يوجد هدافون حتى الآن</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"stats\" className=\"space-y-6\">\n            <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Shield className=\"h-5 w-5 text-blue-500\" />\n                    أفضل دفاع\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {teams && teams.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {[...teams]\n                        .filter(t => t.played > 0)\n                        .sort((a, b) => {\n                          const aAvg = a.goalsAgainst / (a.played || 1);\n                          const bAvg = b.goalsAgainst / (b.played || 1);\n                          return aAvg - bAvg;\n                        })\n                        .slice(0, 5)\n                        .map((team, index) => (\n                          <div \n                            key={team.id} \n                            className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\"\n                            data-testid={`row-defense-${team.id}`}\n                          >\n                            <div className=\"flex items-center gap-3\">\n                              <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${\n                                index === 0 ? \"bg-yellow-500/20 text-yellow-600\" :\n                                index === 1 ? \"bg-gray-400/20 text-gray-600\" :\n                                index === 2 ? \"bg-amber-600/20 text-amber-700\" :\n                                \"bg-muted text-muted-foreground\"\n                              }`}>\n                                {index + 1}\n                              </div>\n                              <span className=\"font-medium\">{team.name}</span>\n                            </div>\n                            <div className=\"flex items-center gap-4\">\n                              <div className=\"text-center\">\n                                <div className=\"text-lg font-bold text-blue-500\">{team.goalsAgainst}</div>\n                                <div className=\"text-xs text-muted-foreground\">أهداف ضده</div>\n                              </div>\n                              <div className=\"text-center\">\n                                <div className=\"text-lg font-bold\">{(team.goalsAgainst / (team.played || 1)).toFixed(2)}</div>\n                                <div className=\"text-xs text-muted-foreground\">معدل/مباراة</div>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      {teams.filter(t => t.played > 0).length === 0 && (\n                        <div className=\"text-center py-8 text-muted-foreground\">\n                          <Shield className=\"h-10 w-10 mx-auto mb-2 opacity-50\" />\n                          <p>لا توجد مباريات منتهية بعد</p>\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-8 text-muted-foreground\">\n                      <Shield className=\"h-10 w-10 mx-auto mb-2 opacity-50\" />\n                      <p>لا توجد فرق مسجلة بعد</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Target className=\"h-5 w-5 text-emerald-500\" />\n                    أفضل هجوم\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  {teams && teams.length > 0 ? (\n                    <div className=\"space-y-3\">\n                      {[...teams]\n                        .filter(t => t.played > 0)\n                        .sort((a, b) => b.goalsFor - a.goalsFor)\n                        .slice(0, 5)\n                        .map((team, index) => (\n                          <div \n                            key={team.id} \n                            className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg\"\n                            data-testid={`row-attack-${team.id}`}\n                          >\n                            <div className=\"flex items-center gap-3\">\n                              <div className={`w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${\n                                index === 0 ? \"bg-yellow-500/20 text-yellow-600\" :\n                                index === 1 ? \"bg-gray-400/20 text-gray-600\" :\n                                index === 2 ? \"bg-amber-600/20 text-amber-700\" :\n                                \"bg-muted text-muted-foreground\"\n                              }`}>\n                                {index + 1}\n                              </div>\n                              <span className=\"font-medium\">{team.name}</span>\n                            </div>\n                            <div className=\"flex items-center gap-4\">\n                              <div className=\"text-center\">\n                                <div className=\"text-lg font-bold text-emerald-500\">{team.goalsFor}</div>\n                                <div className=\"text-xs text-muted-foreground\">أهداف له</div>\n                              </div>\n                              <div className=\"text-center\">\n                                <div className=\"text-lg font-bold\">{(team.goalsFor / (team.played || 1)).toFixed(2)}</div>\n                                <div className=\"text-xs text-muted-foreground\">معدل/مباراة</div>\n                              </div>\n                            </div>\n                          </div>\n                        ))}\n                      {teams.filter(t => t.played > 0).length === 0 && (\n                        <div className=\"text-center py-8 text-muted-foreground\">\n                          <Target className=\"h-10 w-10 mx-auto mb-2 opacity-50\" />\n                          <p>لا توجد مباريات منتهية بعد</p>\n                        </div>\n                      )}\n                    </div>\n                  ) : (\n                    <div className=\"text-center py-8 text-muted-foreground\">\n                      <Target className=\"h-10 w-10 mx-auto mb-2 opacity-50\" />\n                      <p>لا توجد فرق مسجلة بعد</p>\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"flex items-center gap-2\">\n                  <div className=\"flex items-center gap-1\">\n                    <div className=\"w-4 h-5 bg-yellow-500 rounded-sm\" />\n                    <div className=\"w-4 h-5 bg-red-500 rounded-sm\" />\n                  </div>\n                  سجل البطاقات\n                </CardTitle>\n              </CardHeader>\n              <CardContent>\n                {topScorers && topScorers.length > 0 ? (\n                  <div className=\"overflow-x-auto\">\n                    <Table>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"text-right\">#</TableHead>\n                          <TableHead className=\"text-right\">اللاعب</TableHead>\n                          <TableHead className=\"text-right\">الفريق</TableHead>\n                          <TableHead className=\"text-center\">\n                            <div className=\"flex items-center justify-center gap-1\">\n                              <div className=\"w-3 h-4 bg-yellow-500 rounded-sm\" />\n                              صفراء\n                            </div>\n                          </TableHead>\n                          <TableHead className=\"text-center\">\n                            <div className=\"flex items-center justify-center gap-1\">\n                              <div className=\"w-3 h-4 bg-red-500 rounded-sm\" />\n                              حمراء\n                            </div>\n                          </TableHead>\n                          <TableHead className=\"text-center\">المجموع</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {[...topScorers]\n                          .filter(p => (p.yellowCards || 0) + (p.redCards || 0) > 0)\n                          .sort((a, b) => {\n                            const aTotal = (a.redCards || 0) * 2 + (a.yellowCards || 0);\n                            const bTotal = (b.redCards || 0) * 2 + (b.yellowCards || 0);\n                            return bTotal - aTotal;\n                          })\n                          .slice(0, 10)\n                          .map((player, index) => (\n                            <TableRow key={player.id} data-testid={`row-cards-${player.id}`}>\n                              <TableCell className=\"font-bold\">{index + 1}</TableCell>\n                              <TableCell className=\"font-medium flex items-center gap-2\">\n                                <User className=\"h-4 w-4\" />\n                                {player.name}\n                                <Badge variant=\"outline\" className=\"text-xs\">#{player.number}</Badge>\n                              </TableCell>\n                              <TableCell>{player.team?.name}</TableCell>\n                              <TableCell className=\"text-center\">\n                                <Badge className=\"bg-yellow-500/20 text-yellow-600 border-0\">\n                                  {player.yellowCards || 0}\n                                </Badge>\n                              </TableCell>\n                              <TableCell className=\"text-center\">\n                                <Badge className=\"bg-red-500/20 text-red-600 border-0\">\n                                  {player.redCards || 0}\n                                </Badge>\n                              </TableCell>\n                              <TableCell className=\"text-center font-bold\">\n                                {(player.yellowCards || 0) + (player.redCards || 0)}\n                              </TableCell>\n                            </TableRow>\n                          ))}\n                      </TableBody>\n                    </Table>\n                    {topScorers.filter(p => (p.yellowCards || 0) + (p.redCards || 0) > 0).length === 0 && (\n                      <div className=\"text-center py-8 text-muted-foreground\">\n                        <div className=\"flex justify-center gap-2 mb-2\">\n                          <div className=\"w-6 h-8 bg-yellow-500/30 rounded opacity-50\" />\n                          <div className=\"w-6 h-8 bg-red-500/30 rounded opacity-50\" />\n                        </div>\n                        <p>لا توجد بطاقات مسجلة بعد</p>\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <div className=\"flex justify-center gap-2 mb-2\">\n                      <div className=\"w-6 h-8 bg-yellow-500/30 rounded opacity-50\" />\n                      <div className=\"w-6 h-8 bg-red-500/30 rounded opacity-50\" />\n                    </div>\n                    <p>لا يوجد لاعبون مسجلون بعد</p>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n\n            <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n              <Card className=\"text-center\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"text-3xl font-bold text-primary\">{matches?.filter(m => m.status === \"completed\").length || 0}</div>\n                  <div className=\"text-sm text-muted-foreground mt-1\">مباريات منتهية</div>\n                </CardContent>\n              </Card>\n              <Card className=\"text-center\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"text-3xl font-bold text-emerald-500\">\n                    {matches?.filter(m => m.status === \"completed\").reduce((sum, m) => sum + (m.homeScore || 0) + (m.awayScore || 0), 0) || 0}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground mt-1\">إجمالي الأهداف</div>\n                </CardContent>\n              </Card>\n              <Card className=\"text-center\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"text-3xl font-bold text-yellow-500\">\n                    {topScorers?.reduce((sum, p) => sum + (p.yellowCards || 0), 0) || 0}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground mt-1\">بطاقات صفراء</div>\n                </CardContent>\n              </Card>\n              <Card className=\"text-center\">\n                <CardContent className=\"pt-6\">\n                  <div className=\"text-3xl font-bold text-red-500\">\n                    {topScorers?.reduce((sum, p) => sum + (p.redCards || 0), 0) || 0}\n                  </div>\n                  <div className=\"text-sm text-muted-foreground mt-1\">بطاقات حمراء</div>\n                </CardContent>\n              </Card>\n            </div>\n          </TabsContent>\n\n          <TabsContent value=\"teams\">\n            <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n              {teams?.map((team) => (\n                <Card key={team.id} className=\"hover-elevate\" data-testid={`card-team-${team.id}`}>\n                  <CardContent className=\"p-6\">\n                    <div className=\"flex items-center gap-4\">\n                      <div className=\"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center\">\n                        <Users className=\"h-8 w-8 text-primary\" />\n                      </div>\n                      <div>\n                        <h3 className=\"font-bold text-lg\">{team.name}</h3>\n                        <p className=\"text-sm text-muted-foreground\">\n                          {team.points} نقطة\n                        </p>\n                      </div>\n                    </div>\n                    <div className=\"mt-4 grid grid-cols-3 gap-2 text-center text-sm\">\n                      <div className=\"bg-emerald-500/10 rounded p-2\">\n                        <div className=\"font-bold text-emerald-500\">{team.won}</div>\n                        <div className=\"text-xs text-muted-foreground\">فوز</div>\n                      </div>\n                      <div className=\"bg-gray-500/10 rounded p-2\">\n                        <div className=\"font-bold text-gray-500\">{team.drawn}</div>\n                        <div className=\"text-xs text-muted-foreground\">تعادل</div>\n                      </div>\n                      <div className=\"bg-red-500/10 rounded p-2\">\n                        <div className=\"font-bold text-red-500\">{team.lost}</div>\n                        <div className=\"text-xs text-muted-foreground\">خسارة</div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))}\n              {(!teams || teams.length === 0) && (\n                <div className=\"col-span-full text-center py-12 text-muted-foreground\">\n                  <Users className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                  <p>لم يتم تسجيل أي فرق بعد</p>\n                </div>\n              )}\n            </div>\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n\n// Format time range for match (e.g., \"4:10-4:45 م\")\n// Default duration: 2 halves of 20 min + 5 min break = 45 min (typical for company tournaments)\nfunction formatMatchTimeRange(matchDate: Date, durationMinutes: number = 45): string {\n  const startHour = matchDate.getHours();\n  const startMin = matchDate.getMinutes();\n  \n  // Ensure valid duration\n  const duration = typeof durationMinutes === 'number' && !isNaN(durationMinutes) && durationMinutes > 0 \n    ? durationMinutes \n    : 45;\n  \n  const endDate = new Date(matchDate.getTime() + duration * 60 * 1000);\n  const endHour = endDate.getHours();\n  const endMin = endDate.getMinutes();\n  \n  const formatTime = (h: number, m: number) => {\n    const period = h >= 12 ? \"م\" : \"ص\";\n    const hour12 = h === 0 ? 12 : h > 12 ? h - 12 : h;\n    return `${hour12}:${m.toString().padStart(2, \"0\")} ${period}`;\n  };\n  \n  return `${formatTime(startHour, startMin)} - ${formatTime(endHour, endMin)}`;\n}\n\n// Schedule Match Cell - for grid layout with multiple venues\nfunction ScheduleMatchCell({ match }: { match: MatchWithTeams }) {\n  const isCompleted = match.status === \"completed\";\n  const isLive = match.status === \"live\";\n  const homeScore = match.homeScore ?? 0;\n  const awayScore = match.awayScore ?? 0;\n  const homeWon = isCompleted && homeScore > awayScore;\n  const awayWon = isCompleted && awayScore > homeScore;\n  \n  return (\n    <Link href={`/matches/${match.id}`}>\n      <motion.div\n        whileHover={{ scale: 1.02 }}\n        className={`p-3 bg-card border rounded-xl cursor-pointer hover-elevate ${isLive ? \"ring-2 ring-red-500\" : \"\"}`}\n        data-testid={`schedule-cell-${match.id}`}\n      >\n        <div className=\"flex items-center gap-2 justify-center\">\n          {/* Home Team */}\n          <TeamBox \n            team={match.homeTeam} \n            showLogo={true}\n            isWinner={homeWon}\n            score={isCompleted || isLive ? homeScore : undefined}\n          />\n          \n          {/* VS or Score */}\n          <div className=\"px-2 flex flex-col items-center\">\n            {isLive && <Badge className=\"bg-red-500 animate-pulse text-xs mb-1\">مباشر</Badge>}\n            {!isCompleted && !isLive && (\n              <span className=\"text-lg font-bold text-muted-foreground\">VS</span>\n            )}\n            {isCompleted && (\n              <span className=\"text-xs text-muted-foreground\">انتهت</span>\n            )}\n          </div>\n          \n          {/* Away Team */}\n          <TeamBox \n            team={match.awayTeam} \n            showLogo={true}\n            isWinner={awayWon}\n            score={isCompleted || isLive ? awayScore : undefined}\n          />\n        </div>\n        \n        <div className=\"text-center mt-2 text-xs text-muted-foreground\">\n          الجولة {match.round}\n          {match.leg === 2 && \" - إياب\"}\n        </div>\n      </motion.div>\n    </Link>\n  );\n}\n\n// Schedule Match Row - single venue layout with time on left\nfunction ScheduleMatchRow({ match, showTime = true }: { match: MatchWithTeams; showTime?: boolean }) {\n  const isCompleted = match.status === \"completed\";\n  const isLive = match.status === \"live\";\n  const homeScore = match.homeScore ?? 0;\n  const awayScore = match.awayScore ?? 0;\n  const homeWon = isCompleted && homeScore > awayScore;\n  const awayWon = isCompleted && awayScore > homeScore;\n  \n  const matchDate = match.matchDate ? new Date(match.matchDate) : null;\n  const timeRange = matchDate ? formatMatchTimeRange(matchDate, 35) : \"\";\n  \n  return (\n    <Link href={`/matches/${match.id}`}>\n      <motion.div\n        whileHover={{ x: -3 }}\n        className={`flex items-center gap-4 p-3 bg-card border rounded-xl cursor-pointer hover-elevate ${isLive ? \"ring-2 ring-red-500\" : \"\"}`}\n        data-testid={`schedule-row-${match.id}`}\n      >\n        {/* Time Column */}\n        {showTime && (\n          <div className=\"min-w-[90px] text-center py-2 px-3 bg-primary/10 rounded-lg\">\n            <Clock className=\"h-4 w-4 mx-auto mb-1 text-primary\" />\n            <span className=\"text-xs font-medium text-primary\">{timeRange}</span>\n          </div>\n        )}\n        \n        {/* Match Content */}\n        <div className=\"flex-1 flex items-center justify-center gap-3\">\n          {/* Home Team */}\n          <div className=\"flex-1\">\n            <TeamBox \n              team={match.homeTeam} \n              showLogo={true}\n              isWinner={homeWon}\n              score={isCompleted || isLive ? homeScore : undefined}\n            />\n          </div>\n          \n          {/* VS or Status */}\n          <div className=\"px-3 flex flex-col items-center\">\n            {isLive && <Badge className=\"bg-red-500 animate-pulse\">مباشر</Badge>}\n            {!isCompleted && !isLive && (\n              <span className=\"text-xl font-bold text-muted-foreground bg-muted px-3 py-1 rounded-lg\">VS</span>\n            )}\n            {isCompleted && (\n              <Badge variant=\"secondary\" className=\"text-xs\">انتهت</Badge>\n            )}\n          </div>\n          \n          {/* Away Team */}\n          <div className=\"flex-1\">\n            <TeamBox \n              team={match.awayTeam} \n              showLogo={true}\n              isWinner={awayWon}\n              score={isCompleted || isLive ? awayScore : undefined}\n            />\n          </div>\n        </div>\n        \n        {/* Info Column */}\n        <div className=\"text-right min-w-[80px]\">\n          <div className=\"text-xs text-muted-foreground\">الجولة {match.round}</div>\n          {match.venue && (\n            <div className=\"text-xs text-muted-foreground flex items-center gap-1 justify-end mt-1\">\n              <MapPin className=\"h-3 w-3\" />\n              {match.venue}\n            </div>\n          )}\n        </div>\n      </motion.div>\n    </Link>\n  );\n}\n\nfunction MatchesView({ matches }: { matches: MatchWithTeams[] }) {\n  const [viewMode, setViewMode] = useState<\"status\" | \"round\" | \"day\">(\"day\");\n  \n  const upcomingMatches = matches.filter(m => m.status === \"scheduled\" || m.status === \"live\");\n  const completedMatches = matches.filter(m => m.status === \"completed\");\n  \n  // Group matches by round\n  const matchesByRound = matches.reduce((acc, match) => {\n    const round = match.round || 1;\n    if (!acc[round]) {\n      acc[round] = [];\n    }\n    acc[round].push(match);\n    return acc;\n  }, {} as Record<number, MatchWithTeams[]>);\n  \n  const roundNumbers = Object.keys(matchesByRound).map(Number).sort((a, b) => a - b);\n  \n  // Group matches by day\n  const matchesByDay = matches.reduce((acc, match) => {\n    if (!match.matchDate) {\n      const key = \"غير محدد\";\n      if (!acc[key]) acc[key] = [];\n      acc[key].push(match);\n      return acc;\n    }\n    const dateKey = format(new Date(match.matchDate), \"yyyy-MM-dd\");\n    if (!acc[dateKey]) {\n      acc[dateKey] = [];\n    }\n    acc[dateKey].push(match);\n    return acc;\n  }, {} as Record<string, MatchWithTeams[]>);\n  \n  const dayKeys = Object.keys(matchesByDay).sort((a, b) => {\n    if (a === \"غير محدد\") return 1;\n    if (b === \"غير محدد\") return -1;\n    return new Date(a).getTime() - new Date(b).getTime();\n  });\n  \n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex flex-wrap items-center justify-between gap-4 mb-4\" data-testid=\"matches-summary\">\n        <div className=\"flex items-center gap-4 text-sm text-muted-foreground\">\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded-full bg-blue-500\" />\n            <span data-testid=\"text-upcoming-count\">قادمة: {upcomingMatches.length}</span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"w-3 h-3 rounded-full bg-emerald-500\" />\n            <span data-testid=\"text-completed-count\">منتهية: {completedMatches.length}</span>\n          </div>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <Badge variant=\"outline\" className=\"text-muted-foreground\" data-testid=\"badge-total-matches\">\n            إجمالي: {matches.length} مباراة\n          </Badge>\n          <div className=\"flex border rounded-lg overflow-hidden\">\n            <Button \n              variant={viewMode === \"day\" ? \"default\" : \"ghost\"} \n              size=\"sm\"\n              onClick={() => setViewMode(\"day\")}\n              className=\"rounded-none\"\n              data-testid=\"button-view-by-day\"\n            >\n              حسب اليوم\n            </Button>\n            <Button \n              variant={viewMode === \"round\" ? \"default\" : \"ghost\"} \n              size=\"sm\"\n              onClick={() => setViewMode(\"round\")}\n              className=\"rounded-none\"\n              data-testid=\"button-view-by-round\"\n            >\n              حسب الجولة\n            </Button>\n            <Button \n              variant={viewMode === \"status\" ? \"default\" : \"ghost\"} \n              size=\"sm\"\n              onClick={() => setViewMode(\"status\")}\n              className=\"rounded-none\"\n              data-testid=\"button-view-by-status\"\n            >\n              حسب الحالة\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      {viewMode === \"day\" ? (\n        <div className=\"space-y-8\">\n          {dayKeys.map((dayKey) => {\n            const dayMatches = matchesByDay[dayKey];\n            const completedCount = dayMatches.filter(m => m.status === \"completed\").length;\n            const totalCount = dayMatches.length;\n            const formattedDate = dayKey === \"غير محدد\" \n              ? \"تاريخ غير محدد\" \n              : format(new Date(dayKey), \"EEEE d MMMM\", { locale: ar });\n            \n            // Sort matches by time\n            const sortedDayMatches = [...dayMatches].sort((a, b) => {\n              const dateA = a.matchDate ? new Date(a.matchDate).getTime() : 0;\n              const dateB = b.matchDate ? new Date(b.matchDate).getTime() : 0;\n              return dateA - dateB;\n            });\n            \n            // Group by venue\n            const venues = Array.from(new Set(sortedDayMatches.map(m => m.venue || \"الملعب الرئيسي\")));\n            \n            // Group by time slot\n            const timeSlots = sortedDayMatches.reduce((acc, match) => {\n              const timeKey = match.matchDate \n                ? format(new Date(match.matchDate), \"HH:mm\")\n                : \"00:00\";\n              if (!acc[timeKey]) acc[timeKey] = [];\n              acc[timeKey].push(match);\n              return acc;\n            }, {} as Record<string, MatchWithTeams[]>);\n            \n            const timeSlotKeys = Object.keys(timeSlots).sort();\n            \n            return (\n              <div key={dayKey} data-testid={`card-day-${dayKey}`} className=\"space-y-4\">\n                {/* Day Header - Big and Bold */}\n                <div className=\"text-center py-4 bg-gradient-to-r from-orange-500 to-orange-600 rounded-xl shadow-lg\">\n                  <h2 className=\"text-2xl md:text-3xl font-bold text-white uppercase tracking-wide\">\n                    {formattedDate}\n                  </h2>\n                  <div className=\"flex items-center justify-center gap-3 mt-2\">\n                    <Badge className=\"bg-white/20 text-white border-none\">\n                      {totalCount} مباريات\n                    </Badge>\n                    {completedCount === totalCount && totalCount > 0 && (\n                      <Badge className=\"bg-emerald-400 text-white border-none\">مكتملة</Badge>\n                    )}\n                  </div>\n                </div>\n                \n                {/* Venue Headers */}\n                {venues.length > 1 && (\n                  <div className=\"grid gap-4\" style={{ gridTemplateColumns: `80px repeat(${venues.length}, 1fr)` }}>\n                    <div></div>\n                    {venues.map((venue, idx) => (\n                      <div key={venue} className=\"text-center py-2 bg-muted/50 rounded-lg font-bold text-sm\">\n                        <MapPin className=\"h-4 w-4 mx-auto mb-1 text-muted-foreground\" />\n                        {venue}\n                      </div>\n                    ))}\n                  </div>\n                )}\n                \n                {/* Time Slots with Matches */}\n                <div className=\"space-y-3\">\n                  {timeSlotKeys.map((timeKey) => {\n                    const slotMatches = timeSlots[timeKey];\n                    const firstMatch = slotMatches[0];\n                    const matchDate = firstMatch.matchDate ? new Date(firstMatch.matchDate) : null;\n                    const timeRange = matchDate ? formatMatchTimeRange(matchDate, 35) : timeKey;\n                    \n                    if (venues.length > 1) {\n                      // Multi-venue grid layout\n                      return (\n                        <div \n                          key={timeKey} \n                          className=\"grid gap-4 items-center\"\n                          style={{ gridTemplateColumns: `80px repeat(${venues.length}, 1fr)` }}\n                        >\n                          {/* Time Column */}\n                          <div className=\"text-center py-2 bg-primary/10 rounded-lg\">\n                            <Clock className=\"h-4 w-4 mx-auto mb-1 text-primary\" />\n                            <span className=\"text-xs font-medium text-primary\">{timeRange}</span>\n                          </div>\n                          \n                          {/* Match for each venue */}\n                          {venues.map((venue) => {\n                            const venueMatch = slotMatches.find(m => (m.venue || \"الملعب الرئيسي\") === venue);\n                            if (!venueMatch) {\n                              return <div key={venue} className=\"p-4 bg-muted/20 rounded-lg text-center text-muted-foreground text-sm\">-</div>;\n                            }\n                            return (\n                              <ScheduleMatchCell key={venueMatch.id} match={venueMatch} />\n                            );\n                          })}\n                        </div>\n                      );\n                    } else {\n                      // Single venue - show all matches in row with time\n                      return (\n                        <div key={timeKey} className=\"space-y-2\">\n                          {slotMatches.map((match) => (\n                            <ScheduleMatchRow key={match.id} match={match} showTime={true} />\n                          ))}\n                        </div>\n                      );\n                    }\n                  })}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      ) : viewMode === \"round\" ? (\n        <div className=\"space-y-6\">\n          {roundNumbers.map((roundNum) => {\n            const roundMatches = matchesByRound[roundNum];\n            const completedCount = roundMatches.filter(m => m.status === \"completed\").length;\n            const totalCount = roundMatches.length;\n            \n            return (\n              <Card key={roundNum} data-testid={`card-round-${roundNum}`}>\n                <CardHeader className=\"bg-primary/5 border-b\">\n                  <CardTitle className=\"flex items-center justify-between\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\">\n                        <span className=\"text-primary font-bold\">{roundNum}</span>\n                      </div>\n                      <span>الجولة {roundNum}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {completedCount}/{totalCount} مباريات\n                      </Badge>\n                      {completedCount === totalCount && (\n                        <Badge className=\"bg-emerald-500 text-xs\">مكتملة</Badge>\n                      )}\n                    </div>\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"p-4 space-y-3\">\n                  {roundMatches\n                    .sort((a, b) => {\n                      const dateA = a.matchDate ? new Date(a.matchDate).getTime() : 0;\n                      const dateB = b.matchDate ? new Date(b.matchDate).getTime() : 0;\n                      return dateA - dateB;\n                    })\n                    .map((match) => (\n                      match.status === \"completed\" ? \n                        <CompletedMatchCard key={match.id} match={match} /> :\n                        <MatchCard key={match.id} match={match} />\n                    ))}\n                </CardContent>\n              </Card>\n            );\n          })}\n        </div>\n      ) : (\n        <div className=\"space-y-6\">\n          {upcomingMatches.length > 0 && (\n            <Card className=\"border-blue-500/20\">\n              <CardHeader className=\"bg-blue-500/5 border-b border-blue-500/10\">\n                <CardTitle className=\"flex items-center gap-2 text-blue-600 dark:text-blue-400\">\n                  <Clock className=\"h-5 w-5\" />\n                  المباريات القادمة\n                  <Badge variant=\"secondary\" className=\"mr-auto text-xs\">\n                    {upcomingMatches.length}\n                  </Badge>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-4 space-y-3\">\n                {upcomingMatches\n                  .sort((a, b) => {\n                    const dateA = a.matchDate ? new Date(a.matchDate).getTime() : 0;\n                    const dateB = b.matchDate ? new Date(b.matchDate).getTime() : 0;\n                    return dateA - dateB;\n                  })\n                  .map((match) => (\n                    <MatchCard key={match.id} match={match} />\n                  ))}\n              </CardContent>\n            </Card>\n          )}\n\n          {completedMatches.length > 0 && (\n            <Card className=\"border-emerald-500/20\">\n              <CardHeader className=\"bg-emerald-500/5 border-b border-emerald-500/10\">\n                <CardTitle className=\"flex items-center gap-2 text-emerald-600 dark:text-emerald-400\">\n                  <CheckCircle2 className=\"h-5 w-5\" />\n                  المباريات المنتهية\n                  <Badge variant=\"secondary\" className=\"mr-auto text-xs\">\n                    {completedMatches.length}\n                  </Badge>\n                </CardTitle>\n              </CardHeader>\n              <CardContent className=\"p-4 space-y-3\">\n                {completedMatches\n                  .sort((a, b) => {\n                    const dateA = a.matchDate ? new Date(a.matchDate).getTime() : 0;\n                    const dateB = b.matchDate ? new Date(b.matchDate).getTime() : 0;\n                    return dateB - dateA;\n                  })\n                  .map((match) => (\n                    <CompletedMatchCard key={match.id} match={match} />\n                  ))}\n              </CardContent>\n            </Card>\n          )}\n        </div>\n      )}\n\n      {matches.length === 0 && (\n        <div className=\"text-center py-16 text-muted-foreground\">\n          <Calendar className=\"h-16 w-16 mx-auto mb-4 opacity-30\" />\n          <h3 className=\"text-lg font-medium mb-2\">لم يتم إنشاء جدول المباريات بعد</h3>\n          <p className=\"text-sm\">سيتم عرض جدول المباريات هنا بمجرد إنشائه من لوحة التحكم</p>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction CompletedMatchCard({ match }: { match: MatchWithTeams }) {\n  const homeScore = match.homeScore ?? 0;\n  const awayScore = match.awayScore ?? 0;\n  const homeWon = homeScore > awayScore;\n  const awayWon = awayScore > homeScore;\n  const isDraw = homeScore === awayScore;\n\n  return (\n    <Link href={`/matches/${match.id}`}>\n      <motion.div\n        whileHover={{ x: -2 }}\n        className=\"bg-muted/30 border rounded-lg p-3 cursor-pointer hover-elevate\"\n        data-testid={`card-completed-match-${match.id}`}\n      >\n        <div className=\"flex items-center gap-4\">\n          <div className={`flex-1 flex items-center gap-3 justify-end ${homeWon ? \"font-bold\" : \"\"}`} data-testid={`completed-match-home-${match.id}`}>\n            <span className={homeWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}>{match.homeTeam?.name}</span>\n            {homeWon && <Trophy className=\"h-4 w-4 text-yellow-500 flex-shrink-0\" />}\n          </div>\n          \n          <div className=\"flex items-center gap-3 px-4 py-1 bg-background rounded-full border\" data-testid={`completed-match-score-${match.id}`}>\n            <span className={`text-xl font-bold min-w-[24px] text-center ${homeWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}`}>\n              {homeScore}\n            </span>\n            <span className=\"text-muted-foreground\">-</span>\n            <span className={`text-xl font-bold min-w-[24px] text-center ${awayWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}`}>\n              {awayScore}\n            </span>\n          </div>\n\n          <div className={`flex-1 flex items-center gap-3 ${awayWon ? \"font-bold\" : \"\"}`} data-testid={`completed-match-away-${match.id}`}>\n            {awayWon && <Trophy className=\"h-4 w-4 text-yellow-500 flex-shrink-0\" />}\n            <span className={awayWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"}>{match.awayTeam?.name}</span>\n          </div>\n        </div>\n        \n        <div className=\"flex items-center justify-between mt-2 text-xs text-muted-foreground\">\n          <div className=\"flex items-center gap-2\">\n            <Calendar className=\"h-3 w-3\" />\n            {match.matchDate ? format(new Date(match.matchDate), \"dd/MM/yyyy\", { locale: ar }) : \"غير محدد\"}\n          </div>\n          {isDraw && <Badge variant=\"outline\" className=\"text-xs\">تعادل</Badge>}\n          <div className=\"flex items-center gap-2\">\n            {match.venue && (\n              <>\n                <MapPin className=\"h-3 w-3\" />\n                <span>{match.venue}</span>\n              </>\n            )}\n            <span className=\"text-xs\">الجولة {match.round}</span>\n          </div>\n        </div>\n      </motion.div>\n    </Link>\n  );\n}\n\nfunction MatchCard({ match }: { match: MatchWithTeams }) {\n  const isLive = match.status === \"live\";\n  \n  return (\n    <Link href={`/matches/${match.id}`}>\n      <motion.div\n        whileHover={{ scale: 1.01 }}\n        className={`bg-card border rounded-lg p-4 cursor-pointer hover-elevate ${isLive ? \"ring-2 ring-red-500 ring-offset-2\" : \"\"}`}\n        data-testid={`card-match-${match.id}`}\n      >\n        <div className=\"flex items-center justify-between mb-3\">\n          <Badge className={matchStatusColors[match.status]}>\n            {isLive && <Play className=\"h-3 w-3 ml-1\" />}\n            {matchStatusLabels[match.status]}\n          </Badge>\n          <div className=\"text-sm text-muted-foreground flex items-center gap-2\">\n            <Calendar className=\"h-4 w-4\" />\n            {match.matchDate ? format(new Date(match.matchDate), \"EEEE dd/MM/yyyy - HH:mm\", { locale: ar }) : \"غير محدد\"}\n          </div>\n        </div>\n\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex-1 text-right\">\n            <div className=\"font-bold text-lg\">{match.homeTeam?.name}</div>\n            <div className=\"text-xs text-muted-foreground\">الفريق المضيف</div>\n          </div>\n          \n          <div className=\"px-6 py-3\">\n            {isLive ? (\n              <div className=\"text-2xl font-bold flex items-center gap-2 animate-pulse\">\n                <span className=\"text-red-500\">{match.homeScore ?? 0}</span>\n                <span className=\"text-muted-foreground\">-</span>\n                <span className=\"text-red-500\">{match.awayScore ?? 0}</span>\n              </div>\n            ) : (\n              <div className=\"text-xl font-bold text-muted-foreground bg-muted px-4 py-2 rounded-lg\">VS</div>\n            )}\n          </div>\n\n          <div className=\"flex-1 text-left\">\n            <div className=\"font-bold text-lg\">{match.awayTeam?.name}</div>\n            <div className=\"text-xs text-muted-foreground\">الفريق الضيف</div>\n          </div>\n        </div>\n\n        {match.venue && (\n          <div className=\"mt-3 text-sm text-muted-foreground flex items-center justify-center gap-2\">\n            <MapPin className=\"h-4 w-4\" />\n            {match.venue}\n          </div>\n        )}\n\n        <div className=\"mt-2 flex items-center justify-center gap-4 text-xs text-muted-foreground\">\n          <span>الجولة {match.round}</span>\n          {match.leg === 2 && <Badge variant=\"outline\" className=\"text-xs\">إياب</Badge>}\n          {match.stage === \"group\" && match.groupNumber && (\n            <Badge variant=\"outline\" className=\"text-xs\">{groupLabels[match.groupNumber]}</Badge>\n          )}\n        </div>\n      </motion.div>\n    </Link>\n  );\n}\n","path":null,"size_bytes":68968,"size_tokens":null},"client/src/pages/team-wizard.tsx":{"content":"import { useState, useCallback, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useLocation } from \"wouter\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport { \n  Users, UserPlus, Shield, Trophy, Settings, ChevronLeft, ChevronRight,\n  Save, Plus, Trash2, GripVertical, User, Phone, Mail, Calendar, Move, Upload, Loader2, ImageIcon\n} from \"lucide-react\";\nimport {\n  DndContext,\n  DragEndEvent,\n  DragStartEvent,\n  useSensor,\n  useSensors,\n  PointerSensor,\n  DragOverlay,\n} from \"@dnd-kit/core\";\nimport { useDraggable } from \"@dnd-kit/core\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Team, Player, Tournament } from \"@shared/schema\";\n\n// ========== PLAYER CREATION FORM ==========\nfunction CreatePlayerForm() {\n  const { toast } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [imageUrl, setImageUrl] = useState<string>(\"\");\n  const [isUploading, setIsUploading] = useState(false);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    level: \"\",\n    phone: \"\",\n    averageAge: \"\",\n    email: \"\",\n    representativeName: \"\",\n    activationZone: \"\",\n    activationPeriod: \"\",\n    primaryJersey: \"jersey_1\",\n    secondaryJersey: \"jersey_2\",\n    thirdJersey: \"jersey_3\",\n    position: \"midfielder\",\n    number: \"\",\n  });\n\n  const { data: teams } = useQuery<Team[]>({\n    queryKey: [\"/api/teams\"],\n  });\n\n  // Query for linkable users (users not already linked to a player)\n  const { data: linkableUsers } = useQuery<{ id: string; fullName: string; employeeId: string }[]>({\n    queryKey: [\"/api/users/linkable\"],\n  });\n\n  const [selectedTeamId, setSelectedTeamId] = useState<string>(\"\");\n  const [selectedUserId, setSelectedUserId] = useState<string>(\"\");\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setIsUploading(true);\n    const formDataUpload = new FormData();\n    formDataUpload.append(\"image\", file);\n\n    try {\n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formDataUpload,\n        credentials: \"include\",\n      });\n      const data = await response.json();\n      if (data.success) {\n        setImageUrl(data.url);\n        toast({ title: \"تم رفع الصورة بنجاح\" });\n      } else {\n        toast({ title: \"فشل رفع الصورة\", variant: \"destructive\" });\n      }\n    } catch (error) {\n      toast({ title: \"فشل رفع الصورة\", variant: \"destructive\" });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return apiRequest(\"POST\", \"/api/players\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم إنشاء اللاعب بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/players\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/users/linkable\"] });\n      setFormData({\n        name: \"\", level: \"\", phone: \"\", averageAge: \"\", email: \"\",\n        representativeName: \"\", activationZone: \"\", activationPeriod: \"\",\n        primaryJersey: \"jersey_1\", secondaryJersey: \"jersey_2\", thirdJersey: \"jersey_3\",\n        position: \"midfielder\", number: \"\",\n      });\n      setImageUrl(\"\");\n      setSelectedUserId(\"\");\n    },\n    onError: () => {\n      toast({ title: \"فشل في إنشاء اللاعب\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      ...formData,\n      teamId: selectedTeamId || undefined,\n      userId: selectedUserId || undefined,\n      number: formData.number ? parseInt(formData.number) : undefined,\n      imageUrl: imageUrl || undefined,\n    });\n  };\n\n  const jerseyOptions = [\n    { id: \"jersey_1\", label: \"قميص 1\" },\n    { id: \"jersey_2\", label: \"قميص 2\" },\n    { id: \"jersey_3\", label: \"قميص 3\" },\n    { id: \"jersey_4\", label: \"قميص 4\" },\n    { id: \"jersey_5\", label: \"قميص 5\" },\n    { id: \"jersey_6\", label: \"قميص 6\" },\n  ];\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-l from-primary/10 to-transparent rounded-t-lg\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-gray-700 to-gray-900 flex items-center justify-center\">\n            <User className=\"w-8 h-8 text-white\" />\n          </div>\n          <div>\n            <CardTitle className=\"text-xl\">إنشاء لاعب</CardTitle>\n            <CardDescription>* يرجى ملء جميع الحقول المطلوبة بالبيانات الصحيحة</CardDescription>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {/* Player Image and Basic Info */}\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            {/* Left: Image upload */}\n            <div \n              className=\"flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-lg bg-muted/30 cursor-pointer hover:bg-muted/50 transition-colors\"\n              onClick={() => fileInputRef.current?.click()}\n              data-testid=\"upload-player-image\"\n            >\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                className=\"hidden\"\n                onChange={handleImageUpload}\n              />\n              {isUploading ? (\n                <div className=\"w-32 h-32 rounded-lg bg-gradient-to-br from-gray-700 to-gray-900 flex items-center justify-center mb-4\">\n                  <Loader2 className=\"w-8 h-8 text-white animate-spin\" />\n                </div>\n              ) : imageUrl ? (\n                <img \n                  src={imageUrl} \n                  alt=\"صورة اللاعب\" \n                  className=\"w-32 h-32 rounded-lg object-cover mb-4\"\n                />\n              ) : (\n                <div className=\"w-32 h-32 rounded-lg bg-gradient-to-br from-gray-700 to-gray-900 flex items-center justify-center mb-4\">\n                  <User className=\"w-16 h-16 text-white\" />\n                </div>\n              )}\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <Upload className=\"w-4 h-4\" />\n                <span>{imageUrl ? \"تغيير الصورة\" : \"رفع صورة اللاعب\"}</span>\n              </div>\n            </div>\n\n            {/* Right: Form fields */}\n            <div className=\"space-y-4\">\n              <div>\n                <Label>* اسم اللاعب (اسم المسابقة)</Label>\n                <Input\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"اسم اللاعب\"\n                  required\n                  data-testid=\"input-player-name\"\n                />\n              </div>\n\n              <div>\n                <Label>* المستوى</Label>\n                <Select value={formData.level} onValueChange={(v) => setFormData({ ...formData, level: v })}>\n                  <SelectTrigger data-testid=\"select-player-level\">\n                    <SelectValue placeholder=\"-- ي ح. التحديد --\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"beginner\">مبتدئ</SelectItem>\n                    <SelectItem value=\"intermediate\">متوسط</SelectItem>\n                    <SelectItem value=\"advanced\">متقدم</SelectItem>\n                    <SelectItem value=\"professional\">محترف</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label>* رقم الهاتف</Label>\n                  <Input\n                    value={formData.phone}\n                    onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                    placeholder=\"رقم الهاتف\"\n                    data-testid=\"input-player-phone\"\n                  />\n                </div>\n                <div>\n                  <Label>سياسة (رقم الهاتف)</Label>\n                  <Select defaultValue=\"public\">\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"public\">عام</SelectItem>\n                      <SelectItem value=\"private\">خاص</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div>\n                <Label>العمر المتوسط</Label>\n                <Select value={formData.averageAge} onValueChange={(v) => setFormData({ ...formData, averageAge: v })}>\n                  <SelectTrigger data-testid=\"select-player-age\">\n                    <SelectValue placeholder=\"-- ي ح. التحديد --\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"18-25\">18-25</SelectItem>\n                    <SelectItem value=\"25-30\">25-30</SelectItem>\n                    <SelectItem value=\"30-35\">30-35</SelectItem>\n                    <SelectItem value=\"35+\">35+</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </div>\n\n          {/* Second row - Contact info */}\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <div>\n              <Label>الإيميل</Label>\n              <Input\n                type=\"email\"\n                value={formData.email}\n                onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                placeholder=\"example@email.com\"\n                data-testid=\"input-player-email\"\n              />\n            </div>\n            <div>\n              <Label>الممثل</Label>\n              <Input\n                value={formData.representativeName}\n                onChange={(e) => setFormData({ ...formData, representativeName: e.target.value })}\n                placeholder=\"اسم الممثل\"\n                data-testid=\"input-player-representative\"\n              />\n            </div>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <div>\n              <Label>الفترة الزمنية للتفعيل</Label>\n              <Input\n                value={formData.activationPeriod}\n                onChange={(e) => setFormData({ ...formData, activationPeriod: e.target.value })}\n                placeholder=\"مثال: T2-07:23 أو CN-18:23\"\n                data-testid=\"input-activation-period\"\n              />\n            </div>\n            <div>\n              <Label>منطقة التفعيل</Label>\n              <Input\n                value={formData.activationZone}\n                onChange={(e) => setFormData({ ...formData, activationZone: e.target.value })}\n                placeholder=\"أدخل موقع\"\n                data-testid=\"input-activation-zone\"\n              />\n            </div>\n          </div>\n\n          {/* Jerseys */}\n          <div>\n            <Label className=\"mb-3 block\">القمصان</Label>\n            <div className=\"grid grid-cols-3 gap-4\">\n              {[\"primaryJersey\", \"secondaryJersey\", \"thirdJersey\"].map((key, index) => (\n                <div key={key} className=\"text-center\">\n                  <div className=\"w-full aspect-square bg-muted rounded-lg flex items-center justify-center mb-2 relative group cursor-pointer hover:bg-muted/70 transition-colors\">\n                    <div className=\"w-16 h-20 bg-gradient-to-b from-gray-400 to-gray-500 rounded-t-full relative\">\n                      <div className=\"absolute inset-2 bg-white/20 rounded-t-full\" />\n                    </div>\n                    <Button\n                      type=\"button\"\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      className=\"absolute top-1 left-1 opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6\"\n                    >\n                      <Settings className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                  <span className=\"text-sm text-muted-foreground\">قميص {index + 1}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Position and Number */}\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <div>\n              <Label>المركز</Label>\n              <Select value={formData.position} onValueChange={(v) => setFormData({ ...formData, position: v })}>\n                <SelectTrigger data-testid=\"select-player-position\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"goalkeeper\">حارس مرمى</SelectItem>\n                  <SelectItem value=\"defender\">مدافع</SelectItem>\n                  <SelectItem value=\"midfielder\">وسط</SelectItem>\n                  <SelectItem value=\"forward\">مهاجم</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <Label>رقم القميص</Label>\n              <Input\n                type=\"number\"\n                value={formData.number}\n                onChange={(e) => setFormData({ ...formData, number: e.target.value })}\n                placeholder=\"الرقم\"\n                data-testid=\"input-player-number\"\n              />\n            </div>\n          </div>\n\n          {/* Select Team */}\n          <div>\n            <Label>الفريق (اختياري)</Label>\n            <Select value={selectedTeamId} onValueChange={setSelectedTeamId}>\n              <SelectTrigger data-testid=\"select-player-team\">\n                <SelectValue placeholder=\"اختر الفريق\" />\n              </SelectTrigger>\n              <SelectContent>\n                {teams?.map((team) => (\n                  <SelectItem key={team.id} value={team.id}>{team.name}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* Link to User Account */}\n          <div>\n            <Label>ربط بحساب موظف (اختياري)</Label>\n            <Select value={selectedUserId} onValueChange={setSelectedUserId}>\n              <SelectTrigger data-testid=\"select-player-user\">\n                <SelectValue placeholder={\n                  !linkableUsers ? \"جاري التحميل...\" : \n                  linkableUsers.length === 0 ? \"لا يوجد مستخدمين متاحين\" : \n                  \"اختر حساب الموظف\"\n                } />\n              </SelectTrigger>\n              <SelectContent>\n                {linkableUsers && linkableUsers.length > 0 ? (\n                  linkableUsers.map((user) => (\n                    <SelectItem key={user.id} value={user.id}>\n                      {user.fullName} - {user.employeeId}\n                    </SelectItem>\n                  ))\n                ) : (\n                  <div className=\"py-2 px-3 text-sm text-muted-foreground text-center\">\n                    {!linkableUsers ? \"جاري التحميل...\" : \"لا يوجد مستخدمين متاحين للربط\"}\n                  </div>\n                )}\n              </SelectContent>\n            </Select>\n          </div>\n\n          <Button \n            type=\"submit\" \n            className=\"w-full\" \n            disabled={mutation.isPending}\n            data-testid=\"button-create-player\"\n          >\n            {mutation.isPending ? \"جاري الحفظ...\" : \"حفظ\"}\n          </Button>\n        </form>\n      </CardContent>\n    </Card>\n  );\n}\n\n// ========== TEAM CREATION FORM ==========\nfunction CreateTeamForm() {\n  const { toast } = useToast();\n  const fileInputRef = useRef<HTMLInputElement>(null);\n  const [logoUrl, setLogoUrl] = useState<string>(\"\");\n  const [isUploading, setIsUploading] = useState(false);\n  const [formData, setFormData] = useState({\n    name: \"\",\n    level: \"\",\n    contactPhone: \"\",\n    averageAge: \"\",\n    contactEmail: \"\",\n    representativeName: \"\",\n    activationZone: \"\",\n    activationPeriod: \"\",\n    description: \"\",\n    primaryJersey: \"\",\n    secondaryJersey: \"\",\n    thirdJersey: \"\",\n  });\n\n  const { data: tournaments } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n  });\n\n  const [selectedTournamentId, setSelectedTournamentId] = useState<string>(\"\");\n\n  const handleLogoUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    setIsUploading(true);\n    const formDataUpload = new FormData();\n    formDataUpload.append(\"image\", file);\n\n    try {\n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formDataUpload,\n        credentials: \"include\",\n      });\n      const data = await response.json();\n      if (data.success) {\n        setLogoUrl(data.url);\n        toast({ title: \"تم رفع الشعار بنجاح\" });\n      } else {\n        toast({ title: \"فشل رفع الشعار\", variant: \"destructive\" });\n      }\n    } catch (error) {\n      toast({ title: \"فشل رفع الشعار\", variant: \"destructive\" });\n    } finally {\n      setIsUploading(false);\n    }\n  };\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return apiRequest(\"POST\", \"/api/teams\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم إنشاء الفريق بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/teams\"] });\n      setFormData({\n        name: \"\", level: \"\", contactPhone: \"\", averageAge: \"\", contactEmail: \"\",\n        representativeName: \"\", activationZone: \"\", activationPeriod: \"\", description: \"\",\n        primaryJersey: \"\", secondaryJersey: \"\", thirdJersey: \"\",\n      });\n      setLogoUrl(\"\");\n    },\n    onError: () => {\n      toast({ title: \"فشل في إنشاء الفريق\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      ...formData,\n      tournamentId: selectedTournamentId || undefined,\n      logoUrl: logoUrl || undefined,\n    });\n  };\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-l from-primary/10 to-transparent rounded-t-lg\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-16 h-16 rounded-full bg-gradient-to-br from-amber-500 to-amber-700 flex items-center justify-center text-white font-bold text-xl\">\n              FC\n            </div>\n            <div>\n              <CardTitle className=\"text-xl\">إنشاء فريق</CardTitle>\n              <CardDescription>* يرجى ملء جميع الحقول المطلوبة بالبيانات الصحيحة</CardDescription>\n            </div>\n          </div>\n          <div className=\"flex gap-2\">\n            <Button variant=\"outline\" size=\"sm\" className=\"gap-1\">\n              <UserPlus className=\"w-4 h-4\" />\n              إنشاء لاعب +\n            </Button>\n            <Button variant=\"outline\" size=\"sm\" className=\"gap-1\">\n              <Shield className=\"w-4 h-4\" />\n              إنشاء فريق +\n            </Button>\n          </div>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            {/* Left: Logo upload */}\n            <div \n              className=\"flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-lg bg-muted/30 cursor-pointer hover:bg-muted/50 transition-colors\"\n              onClick={() => fileInputRef.current?.click()}\n              data-testid=\"upload-team-logo\"\n            >\n              <input\n                ref={fileInputRef}\n                type=\"file\"\n                accept=\"image/*\"\n                className=\"hidden\"\n                onChange={handleLogoUpload}\n              />\n              {isUploading ? (\n                <div className=\"w-32 h-32 rounded-lg bg-gradient-to-br from-amber-500 to-amber-700 flex items-center justify-center mb-4\">\n                  <Loader2 className=\"w-8 h-8 text-white animate-spin\" />\n                </div>\n              ) : logoUrl ? (\n                <img \n                  src={logoUrl} \n                  alt=\"شعار الفريق\" \n                  className=\"w-32 h-32 rounded-lg object-cover mb-4\"\n                />\n              ) : (\n                <div className=\"w-32 h-32 rounded-lg bg-gradient-to-br from-amber-500 to-amber-700 flex items-center justify-center mb-4 text-white text-3xl font-bold\">\n                  FC\n                </div>\n              )}\n              <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                <Upload className=\"w-4 h-4\" />\n                <span>{logoUrl ? \"تغيير الشعار\" : \"رفع شعار الفريق\"}</span>\n              </div>\n            </div>\n\n            {/* Right: Fields */}\n            <div className=\"space-y-4\">\n              <div>\n                <Label>* اسم الفريق</Label>\n                <Input\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"اسم الفريق\"\n                  required\n                  data-testid=\"input-team-name\"\n                />\n              </div>\n\n              <div>\n                <Label>* المستوى</Label>\n                <Select value={formData.level} onValueChange={(v) => setFormData({ ...formData, level: v })}>\n                  <SelectTrigger data-testid=\"select-team-level\">\n                    <SelectValue placeholder=\"-- ي ح. التحديد --\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"beginner\">مبتدئ</SelectItem>\n                    <SelectItem value=\"intermediate\">متوسط</SelectItem>\n                    <SelectItem value=\"advanced\">متقدم</SelectItem>\n                    <SelectItem value=\"professional\">محترف</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label>* رقم الهاتف</Label>\n                  <Input\n                    value={formData.contactPhone}\n                    onChange={(e) => setFormData({ ...formData, contactPhone: e.target.value })}\n                    placeholder=\"رقم الهاتف\"\n                    data-testid=\"input-team-phone\"\n                  />\n                </div>\n                <div>\n                  <Label>سياسة (رقم الهاتف)</Label>\n                  <Select defaultValue=\"public\">\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"public\">عام</SelectItem>\n                      <SelectItem value=\"private\">خاص</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div>\n                <Label>العمر المتوسط</Label>\n                <Select value={formData.averageAge} onValueChange={(v) => setFormData({ ...formData, averageAge: v })}>\n                  <SelectTrigger data-testid=\"select-team-age\">\n                    <SelectValue placeholder=\"-- ي ح. التحديد --\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"18-25\">18-25</SelectItem>\n                    <SelectItem value=\"25-30\">25-30</SelectItem>\n                    <SelectItem value=\"30-35\">30-35</SelectItem>\n                    <SelectItem value=\"35+\">35+</SelectItem>\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </div>\n\n          {/* Contact Info */}\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <div>\n              <Label>الإيميل</Label>\n              <Input\n                type=\"email\"\n                value={formData.contactEmail}\n                onChange={(e) => setFormData({ ...formData, contactEmail: e.target.value })}\n                placeholder=\"example@email.com\"\n                data-testid=\"input-team-email\"\n              />\n            </div>\n            <div>\n              <Label>الممثل</Label>\n              <Input\n                value={formData.representativeName}\n                onChange={(e) => setFormData({ ...formData, representativeName: e.target.value })}\n                placeholder=\"اسم الممثل\"\n                data-testid=\"input-team-representative\"\n              />\n            </div>\n          </div>\n\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <div>\n              <Label>الفترة الزمنية للتفعيل</Label>\n              <Input\n                value={formData.activationPeriod}\n                onChange={(e) => setFormData({ ...formData, activationPeriod: e.target.value })}\n                placeholder=\"مثال: T2-07:23 أو CN-18:23\"\n              />\n            </div>\n            <div>\n              <Label>منطقة التفعيل</Label>\n              <Input\n                value={formData.activationZone}\n                onChange={(e) => setFormData({ ...formData, activationZone: e.target.value })}\n                placeholder=\"أدخل موقع\"\n              />\n            </div>\n          </div>\n\n          {/* Jerseys */}\n          <div>\n            <Label className=\"mb-3 block\">القمصان</Label>\n            <div className=\"grid grid-cols-3 gap-4\">\n              {[1, 2, 3].map((num) => (\n                <div key={num} className=\"text-center\">\n                  <div className=\"w-full aspect-square bg-muted rounded-lg flex items-center justify-center mb-2 relative group cursor-pointer hover:bg-muted/70 transition-colors\">\n                    <div className=\"w-16 h-20 bg-gradient-to-b from-gray-400 to-gray-500 rounded-t-full relative\">\n                      <div className=\"absolute inset-2 bg-white/20 rounded-t-full\" />\n                    </div>\n                    <Button\n                      type=\"button\"\n                      size=\"icon\"\n                      variant=\"ghost\"\n                      className=\"absolute top-1 left-1 opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6\"\n                    >\n                      <Settings className=\"w-3 h-3\" />\n                    </Button>\n                  </div>\n                  <span className=\"text-sm text-muted-foreground\">قميص {num}</span>\n                </div>\n              ))}\n            </div>\n          </div>\n\n          {/* Description */}\n          <div>\n            <Label>مقدمة</Label>\n            <Textarea\n              value={formData.description}\n              onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n              placeholder=\"وصف الفريق...\"\n              rows={4}\n              data-testid=\"input-team-description\"\n            />\n          </div>\n\n          {/* Tournament Selection */}\n          <div>\n            <Label>البطولة (اختياري)</Label>\n            <Select value={selectedTournamentId} onValueChange={setSelectedTournamentId}>\n              <SelectTrigger data-testid=\"select-team-tournament\">\n                <SelectValue placeholder=\"اختر البطولة\" />\n              </SelectTrigger>\n              <SelectContent>\n                {tournaments?.map((t) => (\n                  <SelectItem key={t.id} value={t.id}>{t.name}</SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          <Button \n            type=\"submit\" \n            className=\"w-full\" \n            disabled={mutation.isPending}\n            data-testid=\"button-create-team\"\n          >\n            {mutation.isPending ? \"جاري الحفظ...\" : \"حفظ\"}\n          </Button>\n        </form>\n      </CardContent>\n    </Card>\n  );\n}\n\n// ========== DRAGGABLE PLAYER COMPONENT ==========\ninterface DraggablePlayerProps {\n  id: string;\n  name: string;\n  number: number;\n  position: { x: number; y: number };\n  isDragging?: boolean;\n}\n\nfunction DraggablePlayer({ id, name, number, position, isDragging }: DraggablePlayerProps) {\n  const { attributes, listeners, setNodeRef, transform } = useDraggable({\n    id: id,\n  });\n\n  const style: React.CSSProperties = {\n    left: `${position.x}%`,\n    top: `${position.y}%`,\n    transform: transform \n      ? `translate3d(${transform.x}px, ${transform.y}px, 0) translate(-50%, -50%)`\n      : 'translate(-50%, -50%)',\n    cursor: 'grab',\n    opacity: isDragging ? 0.5 : 1,\n    zIndex: isDragging ? 100 : 10,\n    touchAction: 'none',\n  };\n\n  return (\n    <div\n      ref={setNodeRef}\n      {...listeners}\n      {...attributes}\n      className=\"absolute group\"\n      style={style}\n      data-testid={`draggable-player-${id}`}\n    >\n      <div className=\"relative\">\n        <div className=\"w-10 h-12 bg-gradient-to-b from-red-500 to-red-600 rounded-t-full flex items-center justify-center text-white font-bold text-xs shadow-lg transition-transform group-hover:scale-110 group-active:scale-95\">\n          {number}\n        </div>\n        <div className=\"absolute -bottom-4 left-1/2 -translate-x-1/2 whitespace-nowrap text-[10px] text-white bg-black/50 px-1 rounded\">\n          {name}\n        </div>\n        <div className=\"absolute -top-1 -right-1 w-4 h-4 bg-white/80 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity\">\n          <Move className=\"w-2.5 h-2.5 text-gray-700\" />\n        </div>\n      </div>\n    </div>\n  );\n}\n\n// ========== LINEUP/FORMATION BUILDER ==========\nconst formations = [\n  { id: \"4-3-3\", name: \"4-3-3\", positions: [\"GK\", \"LB\", \"CB\", \"CB\", \"RB\", \"CM\", \"CM\", \"CM\", \"LW\", \"ST\", \"RW\"] },\n  { id: \"4-4-2\", name: \"4-4-2\", positions: [\"GK\", \"LB\", \"CB\", \"CB\", \"RB\", \"LM\", \"CM\", \"CM\", \"RM\", \"ST\", \"ST\"] },\n  { id: \"3-5-2\", name: \"3-5-2\", positions: [\"GK\", \"CB\", \"CB\", \"CB\", \"LWB\", \"CM\", \"CM\", \"CM\", \"RWB\", \"ST\", \"ST\"] },\n  { id: \"4-2-3-1\", name: \"4-2-3-1\", positions: [\"GK\", \"LB\", \"CB\", \"CB\", \"RB\", \"CDM\", \"CDM\", \"LW\", \"CAM\", \"RW\", \"ST\"] },\n  { id: \"3-4-3\", name: \"3-4-3\", positions: [\"GK\", \"CB\", \"CB\", \"CB\", \"LM\", \"CM\", \"CM\", \"RM\", \"LW\", \"ST\", \"RW\"] },\n];\n\nconst positionCoordinates: { [key: string]: { [key: string]: { x: number; y: number } } } = {\n  \"4-3-3\": {\n    GK: { x: 50, y: 90 },\n    LB: { x: 15, y: 70 },\n    CB: { x: 35, y: 75 },\n    \"CB-2\": { x: 65, y: 75 },\n    RB: { x: 85, y: 70 },\n    \"CM-1\": { x: 25, y: 50 },\n    \"CM-2\": { x: 50, y: 45 },\n    \"CM-3\": { x: 75, y: 50 },\n    LW: { x: 15, y: 20 },\n    ST: { x: 50, y: 15 },\n    RW: { x: 85, y: 20 },\n  },\n  \"4-4-2\": {\n    GK: { x: 50, y: 90 },\n    LB: { x: 15, y: 70 },\n    CB: { x: 35, y: 75 },\n    \"CB-2\": { x: 65, y: 75 },\n    RB: { x: 85, y: 70 },\n    LM: { x: 15, y: 45 },\n    \"CM-1\": { x: 35, y: 50 },\n    \"CM-2\": { x: 65, y: 50 },\n    RM: { x: 85, y: 45 },\n    \"ST-1\": { x: 35, y: 20 },\n    \"ST-2\": { x: 65, y: 20 },\n  },\n};\n\nfunction LineupBuilder() {\n  const { toast } = useToast();\n  const [teamName, setTeamName] = useState(\"\");\n  const [lineupName, setLineupName] = useState(\"\");\n  const [selectedFormation, setSelectedFormation] = useState(\"4-3-3\");\n  const [playerCount, setPlayerCount] = useState(\"11\");\n  const [policy, setPolicy] = useState(\"public\");\n  const [fieldBackground, setFieldBackground] = useState(\"field_6\");\n  const [activeId, setActiveId] = useState<string | null>(null);\n  const [fieldRef, setFieldRef] = useState<HTMLDivElement | null>(null);\n\n  const { data: teams } = useQuery<Team[]>({\n    queryKey: [\"/api/teams\"],\n  });\n\n  const { data: allPlayers } = useQuery<Player[]>({\n    queryKey: [\"/api/players\"],\n  });\n\n  const [selectedTeamId, setSelectedTeamId] = useState<string>(\"\");\n  \n  // Default positions for 7 players on field\n  const defaultPositions = [\n    { x: 50, y: 85 }, // GK\n    { x: 20, y: 65 }, // LB\n    { x: 40, y: 70 }, // CB\n    { x: 60, y: 70 }, // CB\n    { x: 80, y: 65 }, // RB\n    { x: 30, y: 40 }, // CM\n    { x: 70, y: 40 }, // CM\n    { x: 15, y: 20 }, // LW\n    { x: 50, y: 15 }, // ST\n    { x: 85, y: 20 }, // RW\n    { x: 50, y: 50 }, // Extra\n  ];\n  \n  const [lineupPlayers, setLineupPlayers] = useState<Array<{\n    id: string;\n    name: string;\n    number: number;\n    position: string;\n    selected: boolean;\n    fieldPosition: { x: number; y: number };\n  }>>([\n    { id: \"1\", name: \"اللاعب A\", number: 1, position: \"goalkeeper\", selected: true, fieldPosition: defaultPositions[0] },\n    { id: \"2\", name: \"اللاعب B\", number: 2, position: \"defender\", selected: true, fieldPosition: defaultPositions[1] },\n    { id: \"3\", name: \"اللاعب C\", number: 3, position: \"defender\", selected: true, fieldPosition: defaultPositions[2] },\n    { id: \"4\", name: \"اللاعب D\", number: 4, position: \"defender\", selected: true, fieldPosition: defaultPositions[3] },\n    { id: \"5\", name: \"اللاعب E\", number: 5, position: \"defender\", selected: true, fieldPosition: defaultPositions[4] },\n    { id: \"6\", name: \"اللاعب F\", number: 6, position: \"midfielder\", selected: true, fieldPosition: defaultPositions[5] },\n    { id: \"7\", name: \"اللاعب G\", number: 7, position: \"midfielder\", selected: true, fieldPosition: defaultPositions[6] },\n    { id: \"8\", name: \"اللاعب H\", number: 8, position: \"midfielder\", selected: false, fieldPosition: defaultPositions[7] },\n    { id: \"9\", name: \"اللاعب I\", number: 9, position: \"midfielder\", selected: false, fieldPosition: defaultPositions[8] },\n    { id: \"10\", name: \"اللاعب J\", number: 10, position: \"forward\", selected: false, fieldPosition: defaultPositions[9] },\n    { id: \"11\", name: \"اللاعب K\", number: 11, position: \"forward\", selected: false, fieldPosition: defaultPositions[10] },\n  ]);\n\n  // DnD sensors\n  const sensors = useSensors(\n    useSensor(PointerSensor, {\n      activationConstraint: {\n        distance: 8,\n      },\n    })\n  );\n\n  const handleDragStart = useCallback((event: DragStartEvent) => {\n    setActiveId(event.active.id as string);\n  }, []);\n\n  const handleDragEnd = useCallback((event: DragEndEvent) => {\n    const { active, delta } = event;\n    const playerId = active.id as string;\n    \n    if (fieldRef) {\n      const fieldRect = fieldRef.getBoundingClientRect();\n      \n      setLineupPlayers((prev) =>\n        prev.map((player) => {\n          if (player.id === playerId) {\n            // Calculate new position based on drag delta\n            const deltaXPercent = (delta.x / fieldRect.width) * 100;\n            const deltaYPercent = (delta.y / fieldRect.height) * 100;\n            \n            const newX = Math.max(5, Math.min(95, player.fieldPosition.x + deltaXPercent));\n            const newY = Math.max(5, Math.min(95, player.fieldPosition.y + deltaYPercent));\n            \n            return {\n              ...player,\n              fieldPosition: { x: newX, y: newY },\n            };\n          }\n          return player;\n        })\n      );\n    }\n    \n    setActiveId(null);\n  }, [fieldRef]);\n\n  const positionLabels: { [key: string]: string } = {\n    goalkeeper: \"حارس مرمى\",\n    defender: \"مدافع\",\n    midfielder: \"وسط\",\n    forward: \"مهاجم\",\n  };\n\n  const handleSave = () => {\n    toast({ title: \"تم حفظ التشكيلة بنجاح\" });\n  };\n\n  return (\n    <div className=\"grid lg:grid-cols-2 gap-6\">\n      {/* Left Panel - Player List */}\n      <Card className=\"border-0 shadow-lg\">\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Users className=\"w-5 h-5\" />\n            حدد اللاعبين\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"py-2 text-right\"></th>\n                  <th className=\"py-2 text-right\">* الرقم</th>\n                  <th className=\"py-2 text-right\">* الاسم على القميص</th>\n                  <th className=\"py-2 text-right\">المركز</th>\n                </tr>\n              </thead>\n              <tbody>\n                {lineupPlayers.map((player, index) => (\n                  <tr key={player.id} className=\"border-b hover:bg-muted/50\">\n                    <td className=\"py-2\">\n                      <Checkbox\n                        checked={player.selected}\n                        onCheckedChange={(checked) => {\n                          const updated = [...lineupPlayers];\n                          updated[index].selected = checked as boolean;\n                          setLineupPlayers(updated);\n                        }}\n                        className=\"border-primary data-[state=checked]:bg-primary\"\n                      />\n                    </td>\n                    <td className=\"py-2\">\n                      <Input\n                        type=\"number\"\n                        value={player.number}\n                        onChange={(e) => {\n                          const updated = [...lineupPlayers];\n                          updated[index].number = parseInt(e.target.value) || 0;\n                          setLineupPlayers(updated);\n                        }}\n                        className=\"w-16 h-8\"\n                      />\n                    </td>\n                    <td className=\"py-2\">\n                      <Input\n                        value={player.name}\n                        onChange={(e) => {\n                          const updated = [...lineupPlayers];\n                          updated[index].name = e.target.value;\n                          setLineupPlayers(updated);\n                        }}\n                        className=\"h-8\"\n                      />\n                    </td>\n                    <td className=\"py-2\">\n                      <Select\n                        value={player.position}\n                        onValueChange={(v) => {\n                          const updated = [...lineupPlayers];\n                          updated[index].position = v;\n                          setLineupPlayers(updated);\n                        }}\n                      >\n                        <SelectTrigger className=\"h-8 w-32\">\n                          <SelectValue />\n                        </SelectTrigger>\n                        <SelectContent>\n                          <SelectItem value=\"goalkeeper\">حارس مرمى</SelectItem>\n                          <SelectItem value=\"defender\">مدافع</SelectItem>\n                          <SelectItem value=\"midfielder\">وسط</SelectItem>\n                          <SelectItem value=\"forward\">مهاجم</SelectItem>\n                        </SelectContent>\n                      </Select>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Right Panel - Formation & Settings */}\n      <div className=\"space-y-4\">\n        {/* Visual Field with Drag & Drop */}\n        <Card className=\"border-0 shadow-lg overflow-hidden\">\n          <DndContext \n            sensors={sensors}\n            onDragStart={handleDragStart}\n            onDragEnd={handleDragEnd}\n          >\n            <div \n              ref={setFieldRef}\n              className=\"relative aspect-[4/3] bg-gradient-to-b from-green-600 to-green-700\"\n              data-testid=\"lineup-field\"\n            >\n              {/* Field markings */}\n              <div className=\"absolute inset-4 border-2 border-white/50 rounded-sm\">\n                {/* Center line */}\n                <div className=\"absolute top-1/2 left-0 right-0 h-0.5 bg-white/50\" />\n                {/* Center circle */}\n                <div className=\"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-20 h-20 border-2 border-white/50 rounded-full\" />\n                {/* Penalty areas */}\n                <div className=\"absolute bottom-0 left-1/2 -translate-x-1/2 w-40 h-16 border-2 border-t-0 border-white/50\" />\n                <div className=\"absolute top-0 left-1/2 -translate-x-1/2 w-40 h-16 border-2 border-b-0 border-white/50\" />\n              </div>\n\n              {/* Draggable Players on field */}\n              {lineupPlayers.filter(p => p.selected).slice(0, 11).map((player) => (\n                <DraggablePlayer\n                  key={player.id}\n                  id={player.id}\n                  name={player.name}\n                  number={player.number}\n                  position={player.fieldPosition}\n                  isDragging={activeId === player.id}\n                />\n              ))}\n\n              {/* Hint text */}\n              <div className=\"absolute top-2 right-2 text-xs text-white/70 flex items-center gap-1\">\n                <Move className=\"w-3 h-3\" />\n                اسحب اللاعبين لتغيير مواقعهم\n              </div>\n            </div>\n\n            {/* Drag Overlay for smooth dragging */}\n            <DragOverlay>\n              {activeId ? (\n                <div className=\"relative\">\n                  <div className=\"w-10 h-12 bg-gradient-to-b from-red-500 to-red-600 rounded-t-full flex items-center justify-center text-white font-bold text-xs shadow-xl scale-110\">\n                    {lineupPlayers.find(p => p.id === activeId)?.number}\n                  </div>\n                  <div className=\"absolute -bottom-4 left-1/2 -translate-x-1/2 whitespace-nowrap text-[10px] text-white bg-black/70 px-1 rounded\">\n                    {lineupPlayers.find(p => p.id === activeId)?.name}\n                  </div>\n                </div>\n              ) : null}\n            </DragOverlay>\n          </DndContext>\n        </Card>\n\n        {/* Formation Settings */}\n        <Card className=\"border-0 shadow-lg\">\n          <CardContent className=\"p-4 space-y-4\">\n            <div>\n              <Label>* اسم الفريق</Label>\n              <Input\n                value={teamName}\n                onChange={(e) => setTeamName(e.target.value)}\n                placeholder=\"اسم الفريق\"\n                data-testid=\"input-lineup-team\"\n              />\n            </div>\n\n            <div>\n              <Label>* اسم التشكيلة</Label>\n              <Input\n                value={lineupName}\n                onChange={(e) => setLineupName(e.target.value)}\n                placeholder=\"اسم التشكيلة\"\n                data-testid=\"input-lineup-name\"\n              />\n            </div>\n\n            <div>\n              <Label>* عدد اللاعبين</Label>\n              <Select value={playerCount} onValueChange={setPlayerCount}>\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"5\">5</SelectItem>\n                  <SelectItem value=\"7\">7</SelectItem>\n                  <SelectItem value=\"11\">11</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label>* التكوين</Label>\n              <Select value={selectedFormation} onValueChange={setSelectedFormation}>\n                <SelectTrigger data-testid=\"select-formation\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {formations.map((f) => (\n                    <SelectItem key={f.id} value={f.id}>{f.name}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label>* سياسة</Label>\n              <Select value={policy} onValueChange={setPolicy}>\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"public\">عام</SelectItem>\n                  <SelectItem value=\"private\">خاص</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label>خلفية الملعب</Label>\n              <Select value={fieldBackground} onValueChange={setFieldBackground}>\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"field_1\">الملعب 1</SelectItem>\n                  <SelectItem value=\"field_2\">الملعب 2</SelectItem>\n                  <SelectItem value=\"field_3\">الملعب 3</SelectItem>\n                  <SelectItem value=\"field_4\">الملعب 4</SelectItem>\n                  <SelectItem value=\"field_5\">الملعب 5</SelectItem>\n                  <SelectItem value=\"field_6\">الملعب 6</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div>\n              <Label>صورة اللاعب</Label>\n              <Select defaultValue=\"jersey_19\">\n                <SelectTrigger>\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {Array.from({ length: 20 }, (_, i) => (\n                    <SelectItem key={i} value={`jersey_${i + 1}`}>قميص {i + 1}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"flex gap-2\">\n              <Button variant=\"outline\" className=\"flex-1\">\n                تحميل\n              </Button>\n              <Button \n                className=\"flex-1\"\n                onClick={handleSave}\n                data-testid=\"button-save-lineup\"\n              >\n                إنشاء\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n\n// ========== LEAGUE/GROUPS CREATION WIZARD ==========\nfunction CreateLeagueWizard() {\n  const { toast } = useToast();\n  const [, navigate] = useLocation();\n  \n  const [formData, setFormData] = useState({\n    name: \"\",\n    phone: \"\",\n    policy: \"private\",\n    location: \"\",\n    imageUrl: \"\",\n    leagueType: \"teams\", // teams or individual\n    playersPerTeam: \"128\",\n    numberOfGroups: \"2\",\n    teamsPerGroup: \"4\",\n    winPoints: \"3\",\n    drawPoints: \"1\",\n    lossPoints: \"0\",\n    teamsAdvancing: \"2\",\n    matchesPerTeam: \"2\",\n    allowPlayerRegistration: false,\n    enableKnockoutAfterGroups: true,\n    isOpen: false,\n  });\n\n  const mutation = useMutation({\n    mutationFn: async (data: any) => {\n      return apiRequest(\"POST\", \"/api/tournaments\", data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم إنشاء الدوري بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\"] });\n      navigate(\"/leagues\");\n    },\n    onError: () => {\n      toast({ title: \"فشل في إنشاء الدوري\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSubmit = (e: React.FormEvent) => {\n    e.preventDefault();\n    mutation.mutate({\n      name: formData.name,\n      sport: \"football\",\n      type: \"groups\",\n      status: \"registration\",\n      maxTeams: parseInt(formData.playersPerTeam),\n      hasGroupStage: true,\n      numberOfGroups: parseInt(formData.numberOfGroups),\n      teamsAdvancingPerGroup: parseInt(formData.teamsAdvancing),\n      venues: formData.location ? [formData.location] : [],\n    });\n  };\n\n  const groupOptions = [\n    { icon: Users, count: \"2\", label: \"مجموعتين\" },\n    { icon: Users, count: \"3\", label: \"3 مجموعات\" },\n    { icon: Users, count: \"4\", label: \"4 مجموعات\" },\n    { icon: Users, count: \"6\", label: \"6 مجموعات\" },\n    { icon: Users, count: \"8\", label: \"8 مجموعات\" },\n    { icon: Users, count: \"10\", label: \"10 مجموعات\" },\n    { icon: Users, count: \"12\", label: \"12 مجموعات\" },\n    { icon: Users, count: \"16\", label: \"16 مجموعة\" },\n  ];\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-l from-primary/10 to-transparent rounded-t-lg\">\n        <div className=\"flex items-center justify-between\">\n          <div>\n            <CardTitle className=\"text-xl flex items-center gap-2\">\n              <Trophy className=\"w-6 h-6 text-primary\" />\n              إنشاء الدوري\n            </CardTitle>\n            <CardDescription>* يرجى ملء جميع الحقول المطلوبة بالبيانات الصحيحة</CardDescription>\n          </div>\n          <Button variant=\"default\" size=\"sm\">تقليص</Button>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <form onSubmit={handleSubmit} className=\"space-y-6\">\n          {/* Basic Info */}\n          <div className=\"grid md:grid-cols-2 gap-6\">\n            <div className=\"flex flex-col items-center justify-center p-6 border-2 border-dashed rounded-lg bg-muted/30\">\n              <div className=\"w-32 h-32 rounded-lg bg-gradient-to-br from-amber-400 to-amber-600 flex items-center justify-center mb-4\">\n                <Trophy className=\"w-16 h-16 text-white\" />\n              </div>\n              <p className=\"text-sm text-muted-foreground\">صورة الدوري</p>\n            </div>\n\n            <div className=\"space-y-4\">\n              <div>\n                <Label>* اسم الدوري</Label>\n                <Input\n                  value={formData.name}\n                  onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                  placeholder=\"اسم الدوري\"\n                  required\n                  data-testid=\"input-league-name\"\n                />\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div>\n                  <Label>* رقم الهاتف</Label>\n                  <Input\n                    value={formData.phone}\n                    onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                    placeholder=\"رقم الهاتف\"\n                    data-testid=\"input-league-phone\"\n                  />\n                </div>\n                <div>\n                  <Label>سياسة</Label>\n                  <Select value={formData.policy} onValueChange={(v) => setFormData({ ...formData, policy: v })}>\n                    <SelectTrigger>\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"public\">عام</SelectItem>\n                      <SelectItem value=\"private\">خاص</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n\n              <div>\n                <Label>* المكان</Label>\n                <Input\n                  value={formData.location}\n                  onChange={(e) => setFormData({ ...formData, location: e.target.value })}\n                  placeholder=\"أدخل موقع\"\n                  data-testid=\"input-league-location\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* League Type Selection */}\n          <div>\n            <Label className=\"mb-3 block\">نوع الدوري</Label>\n            <div className=\"grid grid-cols-2 gap-4\">\n              <Button\n                type=\"button\"\n                variant={formData.leagueType === \"teams\" ? \"default\" : \"outline\"}\n                className=\"h-auto py-4 flex flex-col gap-2\"\n                onClick={() => setFormData({ ...formData, leagueType: \"teams\" })}\n                data-testid=\"button-league-type-teams\"\n              >\n                <div className=\"w-20 h-20 bg-gradient-to-br from-blue-400 to-blue-600 rounded-lg flex items-center justify-center\">\n                  <Users className=\"w-10 h-10 text-white\" />\n                </div>\n                <span>فرق</span>\n              </Button>\n              <Button\n                type=\"button\"\n                variant={formData.leagueType === \"individual\" ? \"default\" : \"outline\"}\n                className=\"h-auto py-4 flex flex-col gap-2\"\n                onClick={() => setFormData({ ...formData, leagueType: \"individual\" })}\n                data-testid=\"button-league-type-individual\"\n              >\n                <div className=\"w-20 h-20 bg-gradient-to-br from-pink-400 to-pink-600 rounded-lg flex items-center justify-center\">\n                  <User className=\"w-10 h-10 text-white\" />\n                </div>\n                <span>فردي</span>\n              </Button>\n            </div>\n          </div>\n\n          {/* Group Settings */}\n          <div>\n            <Label className=\"mb-3 block\">* عدد المجموعات</Label>\n            <div className=\"grid grid-cols-4 md:grid-cols-8 gap-2\">\n              {groupOptions.map((opt) => (\n                <Button\n                  key={opt.count}\n                  type=\"button\"\n                  variant={formData.numberOfGroups === opt.count ? \"default\" : \"outline\"}\n                  className=\"h-auto py-3 flex flex-col gap-1\"\n                  onClick={() => setFormData({ ...formData, numberOfGroups: opt.count })}\n                >\n                  <Users className=\"w-5 h-5\" />\n                  <span className=\"text-xs\">{opt.count}</span>\n                </Button>\n              ))}\n            </div>\n          </div>\n\n          {/* Players/Teams per group */}\n          <div className=\"grid md:grid-cols-2 gap-4\">\n            <div>\n              <Label>* عدد المتنافسين [ 4 - 128 ]</Label>\n              <Input\n                type=\"number\"\n                min=\"4\"\n                max=\"128\"\n                value={formData.playersPerTeam}\n                onChange={(e) => setFormData({ ...formData, playersPerTeam: e.target.value })}\n                data-testid=\"input-players-count\"\n              />\n            </div>\n            <div>\n              <Label>* عدد الفرق في كل مجموعة</Label>\n              <Select value={formData.teamsPerGroup} onValueChange={(v) => setFormData({ ...formData, teamsPerGroup: v })}>\n                <SelectTrigger data-testid=\"select-teams-per-group\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  {[3, 4, 5, 6, 7, 8].map((n) => (\n                    <SelectItem key={n} value={n.toString()}>{n}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          {/* Points System */}\n          <div>\n            <Label className=\"mb-3 block\">* عدد المرحلة الثانية</Label>\n            <p className=\"text-sm text-muted-foreground mb-2\">عدد جميع الفرق المسموح لها بالتقدم إلى المرحلة المريح لجميع المجموعات</p>\n            <div className=\"grid grid-cols-4 gap-4\">\n              <div>\n                <Label className=\"text-xs\">نقاط الفوز</Label>\n                <Input\n                  type=\"number\"\n                  value={formData.winPoints}\n                  onChange={(e) => setFormData({ ...formData, winPoints: e.target.value })}\n                  className=\"text-center\"\n                />\n              </div>\n              <div>\n                <Label className=\"text-xs\">نقاط التعادل</Label>\n                <Input\n                  type=\"number\"\n                  value={formData.drawPoints}\n                  onChange={(e) => setFormData({ ...formData, drawPoints: e.target.value })}\n                  className=\"text-center\"\n                />\n              </div>\n              <div>\n                <Label className=\"text-xs\">نقاط الخسارة</Label>\n                <Input\n                  type=\"number\"\n                  value={formData.lossPoints}\n                  onChange={(e) => setFormData({ ...formData, lossPoints: e.target.value })}\n                  className=\"text-center\"\n                />\n              </div>\n              <div>\n                <Label className=\"text-xs\">عدد التأهل</Label>\n                <Input\n                  type=\"number\"\n                  value={formData.teamsAdvancing}\n                  onChange={(e) => setFormData({ ...formData, teamsAdvancing: e.target.value })}\n                  data-testid=\"input-teams-advancing\"\n                />\n              </div>\n            </div>\n          </div>\n\n          {/* Matches per team */}\n          <div>\n            <Label>* عدد المباريات في الدورة المجموعة</Label>\n            <div className=\"flex gap-2 mt-2\">\n              {[1, 2].map((n) => (\n                <Button\n                  key={n}\n                  type=\"button\"\n                  variant={formData.matchesPerTeam === n.toString() ? \"default\" : \"outline\"}\n                  onClick={() => setFormData({ ...formData, matchesPerTeam: n.toString() })}\n                >\n                  ذهاب{n === 2 ? \" وإياب\" : \"\"}\n                </Button>\n              ))}\n            </div>\n          </div>\n\n          {/* Options */}\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                id=\"knockoutAfterGroups\"\n                checked={formData.enableKnockoutAfterGroups}\n                onCheckedChange={(c) => setFormData({ ...formData, enableKnockoutAfterGroups: c as boolean })}\n              />\n              <Label htmlFor=\"knockoutAfterGroups\">تفعيل وضع الطازجين - الفاشلين بعد مرحلة مرحلة المجموعات</Label>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                id=\"allowPlayerReg\"\n                checked={formData.allowPlayerRegistration}\n                onCheckedChange={(c) => setFormData({ ...formData, allowPlayerRegistration: c as boolean })}\n              />\n              <Label htmlFor=\"allowPlayerReg\">السماح بإنشاء مجموعة في كل مباراة</Label>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <Checkbox\n                id=\"isOpen\"\n                checked={formData.isOpen}\n                onCheckedChange={(c) => setFormData({ ...formData, isOpen: c as boolean })}\n              />\n              <Label htmlFor=\"isOpen\">\n                هذا الدوري مفتوح للتسجيل\n                <span className=\"text-xs text-muted-foreground mr-2\">\n                  (بالاشتراك مع MyLeague، يتم تشغيل هذا الدوري دائما من قبل الإدارة ولا يسمح للفرق الأخرى)\n                </span>\n              </Label>\n            </div>\n          </div>\n\n          <Button \n            type=\"submit\" \n            className=\"w-full\" \n            size=\"lg\"\n            disabled={mutation.isPending}\n            data-testid=\"button-create-league\"\n          >\n            {mutation.isPending ? \"جاري الإنشاء...\" : \"إنشاء الدوري\"}\n          </Button>\n        </form>\n      </CardContent>\n    </Card>\n  );\n}\n\n// ========== TEAMS LIST VIEW ==========\nfunction TeamsListView() {\n  const { data: teams, isLoading: teamsLoading } = useQuery<Team[]>({\n    queryKey: [\"/api/teams\"],\n  });\n\n  const { data: tournaments } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n  });\n\n  const getTournamentName = (tournamentId: string | null) => {\n    if (!tournamentId || !tournaments) return \"غير مرتبط\";\n    const tournament = tournaments.find(t => t.id === tournamentId);\n    return tournament?.name || \"غير معروف\";\n  };\n\n  const getLevelLabel = (level: string | null) => {\n    const levels: Record<string, string> = {\n      beginner: \"مبتدئ\",\n      intermediate: \"متوسط\",\n      advanced: \"متقدم\",\n      professional: \"محترف\",\n    };\n    return levels[level || \"\"] || \"غير محدد\";\n  };\n\n  if (teamsLoading) {\n    return (\n      <Card className=\"border-0 shadow-lg\">\n        <CardContent className=\"p-8 text-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin mx-auto mb-4\" />\n          <p className=\"text-muted-foreground\">جاري تحميل الفرق...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-l from-primary/10 to-transparent rounded-t-lg\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center\">\n            <Shield className=\"w-6 h-6 text-white\" />\n          </div>\n          <div>\n            <CardTitle className=\"text-xl\">قائمة الفرق</CardTitle>\n            <CardDescription>عرض جميع الفرق المسجلة مع تفاصيلها</CardDescription>\n          </div>\n          <Badge className=\"mr-auto\">{teams?.length || 0} فريق</Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        {!teams || teams.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <Shield className=\"w-16 h-16 mx-auto text-muted-foreground/30 mb-4\" />\n            <p className=\"text-muted-foreground\">لا توجد فرق مسجلة حتى الآن</p>\n          </div>\n        ) : (\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {teams.map((team) => (\n              <Card key={team.id} className=\"hover-elevate transition-all\" data-testid={`team-card-${team.id}`}>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-start gap-4\">\n                    {team.logoUrl ? (\n                      <img \n                        src={team.logoUrl} \n                        alt={team.name} \n                        className=\"w-16 h-16 rounded-lg object-cover\"\n                      />\n                    ) : (\n                      <div className=\"w-16 h-16 rounded-lg bg-gradient-to-br from-amber-500 to-amber-700 flex items-center justify-center text-white font-bold text-lg\">\n                        {team.name.slice(0, 2)}\n                      </div>\n                    )}\n                    <div className=\"flex-1 min-w-0\">\n                      <h3 className=\"font-bold text-lg truncate\" data-testid={`text-team-name-${team.id}`}>{team.name}</h3>\n                      <div className=\"flex flex-wrap gap-1 mt-1\">\n                        <Badge variant=\"secondary\" className=\"text-xs\">{getLevelLabel(team.level)}</Badge>\n                        {team.tournamentId && (\n                          <Badge variant=\"outline\" className=\"text-xs\">\n                            <Trophy className=\"w-3 h-3 ml-1\" />\n                            {getTournamentName(team.tournamentId)}\n                          </Badge>\n                        )}\n                      </div>\n                      {team.representativeName && (\n                        <p className=\"text-sm text-muted-foreground mt-2 flex items-center gap-1\">\n                          <User className=\"w-3 h-3\" />\n                          {team.representativeName}\n                        </p>\n                      )}\n                      {team.contactPhone && (\n                        <p className=\"text-sm text-muted-foreground flex items-center gap-1\">\n                          <Phone className=\"w-3 h-3\" />\n                          {team.contactPhone}\n                        </p>\n                      )}\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\n// ========== PLAYERS LIST VIEW ==========\ninterface PlayerWithUser extends Player {\n  user?: { fullName: string; employeeId: string } | null;\n  team?: { name: string; logoUrl: string | null } | null;\n}\n\nfunction PlayersListView() {\n  const { data: players, isLoading: playersLoading } = useQuery<PlayerWithUser[]>({\n    queryKey: [\"/api/players/with-details\"],\n  });\n\n  const { data: allPlayers } = useQuery<Player[]>({\n    queryKey: [\"/api/players\"],\n  });\n\n  const { data: teams } = useQuery<Team[]>({\n    queryKey: [\"/api/teams\"],\n  });\n\n  const getPositionLabel = (position: string | null) => {\n    const positions: Record<string, string> = {\n      goalkeeper: \"حارس مرمى\",\n      defender: \"مدافع\",\n      midfielder: \"وسط\",\n      forward: \"مهاجم\",\n    };\n    return positions[position || \"\"] || \"غير محدد\";\n  };\n\n  const getLevelLabel = (level: string | null) => {\n    const levels: Record<string, string> = {\n      beginner: \"مبتدئ\",\n      intermediate: \"متوسط\",\n      advanced: \"متقدم\",\n      professional: \"محترف\",\n    };\n    return levels[level || \"\"] || \"غير محدد\";\n  };\n\n  const getTeamName = (teamId: string | null) => {\n    if (!teamId || !teams) return null;\n    const team = teams.find(t => t.id === teamId);\n    return team?.name || null;\n  };\n\n  const displayPlayers = players || allPlayers;\n\n  if (playersLoading) {\n    return (\n      <Card className=\"border-0 shadow-lg\">\n        <CardContent className=\"p-8 text-center\">\n          <Loader2 className=\"w-8 h-8 animate-spin mx-auto mb-4\" />\n          <p className=\"text-muted-foreground\">جاري تحميل اللاعبين...</p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <Card className=\"border-0 shadow-lg\">\n      <CardHeader className=\"bg-gradient-to-l from-primary/10 to-transparent rounded-t-lg\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-green-500 to-green-700 flex items-center justify-center\">\n            <Users className=\"w-6 h-6 text-white\" />\n          </div>\n          <div>\n            <CardTitle className=\"text-xl\">قائمة اللاعبين</CardTitle>\n            <CardDescription>عرض جميع اللاعبين مع تفاصيلهم وربطهم بالموظفين</CardDescription>\n          </div>\n          <Badge className=\"mr-auto\">{displayPlayers?.length || 0} لاعب</Badge>\n        </div>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        {!displayPlayers || displayPlayers.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <User className=\"w-16 h-16 mx-auto text-muted-foreground/30 mb-4\" />\n            <p className=\"text-muted-foreground\">لا يوجد لاعبين مسجلين حتى الآن</p>\n          </div>\n        ) : (\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full\">\n              <thead>\n                <tr className=\"border-b\">\n                  <th className=\"text-right py-3 px-2\">الصورة</th>\n                  <th className=\"text-right py-3 px-2\">الاسم</th>\n                  <th className=\"text-right py-3 px-2\">الرقم</th>\n                  <th className=\"text-right py-3 px-2\">المركز</th>\n                  <th className=\"text-right py-3 px-2\">المستوى</th>\n                  <th className=\"text-right py-3 px-2\">الفريق</th>\n                  <th className=\"text-right py-3 px-2\">الموظف المرتبط</th>\n                </tr>\n              </thead>\n              <tbody>\n                {displayPlayers.map((player) => (\n                  <tr key={player.id} className=\"border-b hover:bg-muted/50\" data-testid={`player-row-${player.id}`}>\n                    <td className=\"py-3 px-2\">\n                      {player.imageUrl ? (\n                        <img \n                          src={player.imageUrl} \n                          alt={player.name} \n                          className=\"w-10 h-10 rounded-full object-cover\"\n                        />\n                      ) : (\n                        <div className=\"w-10 h-10 rounded-full bg-gradient-to-br from-gray-600 to-gray-800 flex items-center justify-center\">\n                          <User className=\"w-5 h-5 text-white\" />\n                        </div>\n                      )}\n                    </td>\n                    <td className=\"py-3 px-2 font-medium\" data-testid={`text-player-name-${player.id}`}>\n                      {player.name}\n                    </td>\n                    <td className=\"py-3 px-2\">\n                      {player.number ? (\n                        <Badge variant=\"secondary\">{player.number}</Badge>\n                      ) : (\n                        <span className=\"text-muted-foreground\">-</span>\n                      )}\n                    </td>\n                    <td className=\"py-3 px-2\">\n                      <Badge variant=\"outline\">{getPositionLabel(player.position)}</Badge>\n                    </td>\n                    <td className=\"py-3 px-2\">\n                      <span className=\"text-sm\">{getLevelLabel(player.level)}</span>\n                    </td>\n                    <td className=\"py-3 px-2\">\n                      {player.teamId ? (\n                        <Badge className=\"bg-amber-500/20 text-amber-600 dark:text-amber-400\">\n                          <Shield className=\"w-3 h-3 ml-1\" />\n                          {(player as PlayerWithUser).team?.name || getTeamName(player.teamId) || \"فريق\"}\n                        </Badge>\n                      ) : (\n                        <span className=\"text-muted-foreground text-sm\">غير مرتبط</span>\n                      )}\n                    </td>\n                    <td className=\"py-3 px-2\">\n                      {player.userId ? (\n                        <Badge className=\"bg-green-500/20 text-green-600 dark:text-green-400\">\n                          <User className=\"w-3 h-3 ml-1\" />\n                          {(player as PlayerWithUser).user?.fullName || \"موظف مرتبط\"}\n                        </Badge>\n                      ) : (\n                        <span className=\"text-muted-foreground text-sm\">غير مرتبط</span>\n                      )}\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n\n// ========== MAIN WIZARD PAGE ==========\nexport default function TeamWizard() {\n  const [activeTab, setActiveTab] = useState(\"player\");\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      {/* Header */}\n      <div className=\"bg-gradient-to-l from-primary/20 to-primary/5 py-8 px-4\">\n        <div className=\"container mx-auto\">\n          <h1 className=\"text-3xl font-bold text-foreground mb-2\">معالج إنشاء الفرق والبطولات</h1>\n          <p className=\"text-muted-foreground\">إنشاء لاعبين وفرق وتشكيلات ودوريات بطريقة سهلة ومرئية</p>\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"container mx-auto px-4 py-6\">\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-6 h-auto p-1\">\n            <TabsTrigger value=\"player\" className=\"flex items-center gap-2 py-3\" data-testid=\"tab-player\">\n              <UserPlus className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">إنشاء لاعب</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"team\" className=\"flex items-center gap-2 py-3\" data-testid=\"tab-team\">\n              <Shield className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">إنشاء فريق</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"lineup\" className=\"flex items-center gap-2 py-3\" data-testid=\"tab-lineup\">\n              <Users className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">إنشاء تشكيلة</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"league\" className=\"flex items-center gap-2 py-3\" data-testid=\"tab-league\">\n              <Trophy className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">إنشاء دوري</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"teams-list\" className=\"flex items-center gap-2 py-3\" data-testid=\"tab-teams-list\">\n              <Shield className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">قائمة الفرق</span>\n            </TabsTrigger>\n            <TabsTrigger value=\"players-list\" className=\"flex items-center gap-2 py-3\" data-testid=\"tab-players-list\">\n              <Users className=\"w-4 h-4\" />\n              <span className=\"hidden sm:inline\">قائمة اللاعبين</span>\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"player\">\n            <CreatePlayerForm />\n          </TabsContent>\n\n          <TabsContent value=\"team\">\n            <CreateTeamForm />\n          </TabsContent>\n\n          <TabsContent value=\"lineup\">\n            <LineupBuilder />\n          </TabsContent>\n\n          <TabsContent value=\"league\">\n            <CreateLeagueWizard />\n          </TabsContent>\n\n          <TabsContent value=\"teams-list\">\n            <TeamsListView />\n          </TabsContent>\n\n          <TabsContent value=\"players-list\">\n            <PlayersListView />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":74325,"size_tokens":null},"client/src/components/KnockoutBracket.tsx":{"content":"import { motion } from \"framer-motion\";\nimport { Link } from \"wouter\";\nimport { Trophy, Calendar, Play } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport type { MatchWithTeams, Tournament } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\ninterface KnockoutBracketProps {\n  matches: MatchWithTeams[];\n  tournament?: Tournament;\n  groupStageComplete?: boolean;\n}\n\nconst stageLabels: Record<string, string> = {\n  round_of_16: \"دور الـ 16\",\n  quarter_final: \"ربع النهائي\",\n  semi_final: \"نصف النهائي\",\n  final: \"النهائي\",\n  third_place: \"المركز الثالث\",\n};\n\n// Get knockout stage match label like \"نصف النهائي 1\" or \"ربع النهائي 2\"\nfunction getKnockoutMatchLabel(stage: string, matchIndex: number): string {\n  const stageLabel = stageLabels[stage] || stage;\n  if (stage === \"final\" || stage === \"third_place\") {\n    return stageLabel;\n  }\n  return `${stageLabel} ${matchIndex + 1}`;\n}\n\n// Arabic group letters\nconst groupLetters: Record<number, string> = {\n  1: \"أ\", 2: \"ب\", 3: \"ج\", 4: \"د\", 5: \"هـ\", 6: \"و\", 7: \"ز\", 8: \"ح\",\n};\n\n// Generate knockout pairing patterns dynamically based on number of groups\n// Standard format: A1 vs B2, B1 vs A2, C1 vs D2, D1 vs C2, etc.\nfunction generateKnockoutPairings(numGroups: number): { home: string; away: string }[] {\n  const pairings: { home: string; away: string }[] = [];\n  \n  // Pair groups in twos: (A,B), (C,D), (E,F), etc.\n  for (let i = 0; i < numGroups; i += 2) {\n    const groupA = i + 1;\n    const groupB = i + 2;\n    \n    if (groupB <= numGroups) {\n      // A1 vs B2\n      pairings.push({\n        home: `${groupLetters[groupA] || groupA}1`,\n        away: `${groupLetters[groupB] || groupB}2`\n      });\n      // B1 vs A2\n      pairings.push({\n        home: `${groupLetters[groupB] || groupB}1`,\n        away: `${groupLetters[groupA] || groupA}2`\n      });\n    }\n  }\n  \n  return pairings;\n}\n\n// Get position label like \"أ1\" (A1) or \"ب2\" (B2)\n// Dynamically generates labels based on stage and match index\nfunction getPositionLabel(matchIndex: number, isHome: boolean, stage: string, numGroups: number = 2): string {\n  // For final - winners from semi-finals\n  if (stage === \"final\") {\n    return isHome ? \"فائز 1\" : \"فائز 2\";\n  }\n  \n  // For third place match\n  if (stage === \"third_place\") {\n    return isHome ? \"خاسر 1\" : \"خاسر 2\";\n  }\n  \n  // For knockout stages (semi_final, quarter_final, round_of_16)\n  // Generate pairings dynamically based on number of groups\n  const pairings = generateKnockoutPairings(numGroups);\n  \n  if (matchIndex < pairings.length) {\n    return isHome ? pairings[matchIndex].home : pairings[matchIndex].away;\n  }\n  \n  // Fallback for matches beyond generated pairings\n  // This handles cases where there are more matches than groups can generate\n  const fallbackGroup = Math.floor(matchIndex / 2) * 2 + 1;\n  const isFirstInPair = matchIndex % 2 === 0;\n  if (isFirstInPair) {\n    return isHome \n      ? `${groupLetters[fallbackGroup] || fallbackGroup}1` \n      : `${groupLetters[fallbackGroup + 1] || (fallbackGroup + 1)}2`;\n  } else {\n    return isHome \n      ? `${groupLetters[fallbackGroup + 1] || (fallbackGroup + 1)}1` \n      : `${groupLetters[fallbackGroup] || fallbackGroup}2`;\n  }\n}\n\nconst stageOrder = [\"round_of_16\", \"quarter_final\", \"semi_final\", \"final\"];\n\nconst matchStatusLabels: Record<string, string> = {\n  scheduled: \"قادمة\",\n  live: \"مباشر\",\n  completed: \"انتهت\",\n  postponed: \"مؤجلة\",\n};\n\nconst matchStatusColors: Record<string, string> = {\n  scheduled: \"bg-blue-500/10 text-blue-500 border-blue-500/20\",\n  live: \"bg-red-500 text-white animate-pulse\",\n  completed: \"bg-emerald-500/10 text-emerald-500 border-emerald-500/20\",\n  postponed: \"bg-yellow-500/10 text-yellow-500 border-yellow-500/20\",\n};\n\nfunction CompactMatchCard({ \n  match, \n  groupStageComplete = true,\n  isRightSide = false,\n  matchIndex = 0,\n  numGroups = 2,\n}: { \n  match: MatchWithTeams; \n  groupStageComplete?: boolean;\n  isRightSide?: boolean;\n  matchIndex?: number;\n  numGroups?: number;\n}) {\n  const isCompleted = match.status === \"completed\";\n  const isLive = match.status === \"live\";\n  const showScores = isCompleted || isLive;\n  \n  const homeWon = isCompleted && (match.homeScore ?? 0) > (match.awayScore ?? 0);\n  const awayWon = isCompleted && (match.awayScore ?? 0) > (match.homeScore ?? 0);\n\n  const homeTeamName = groupStageComplete \n    ? (match.homeTeam?.name || \"TBD\") \n    : getPositionLabel(matchIndex, true, match.stage || \"semi_final\", numGroups);\n  const awayTeamName = groupStageComplete \n    ? (match.awayTeam?.name || \"TBD\") \n    : getPositionLabel(matchIndex, false, match.stage || \"semi_final\", numGroups);\n\n  const getShortName = (name: string) => {\n    if (name === \"TBD\") return \"TBD\";\n    const words = name.split(/[\\s&]+/).filter(w => w.length > 0);\n    if (words.length >= 2) {\n      return words.slice(0, 2).map(w => w.substring(0, 3).toUpperCase()).join(\" \");\n    }\n    return name.substring(0, 6).toUpperCase();\n  };\n\n  return (\n    <Link href={`/matches/${match.id}`}>\n      <motion.div\n        whileHover={{ scale: 1.03 }}\n        className=\"bg-card border-2 border-primary/20 rounded-lg overflow-hidden cursor-pointer hover-elevate w-[140px] shadow-md\"\n        data-testid={`bracket-match-${match.id}`}\n      >\n        <div className={`flex items-center justify-between px-2 py-1 ${homeWon ? \"bg-emerald-500/20\" : \"bg-muted/50\"}`}>\n          <span className={`text-xs font-bold truncate flex-1 ${homeWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"} ${!groupStageComplete ? \"text-muted-foreground italic\" : \"\"}`}>\n            {getShortName(homeTeamName)}\n          </span>\n          <span className={`text-xs font-bold min-w-[20px] text-center rounded px-1 ${homeWon ? \"bg-emerald-500 text-white\" : \"bg-muted\"}`}>\n            {showScores ? (match.homeScore ?? 0) : \"-\"}\n          </span>\n        </div>\n\n        <div className={`flex items-center justify-between px-2 py-1 ${awayWon ? \"bg-emerald-500/20\" : \"bg-muted/50\"}`}>\n          <span className={`text-xs font-bold truncate flex-1 ${awayWon ? \"text-emerald-600 dark:text-emerald-400\" : \"\"} ${!groupStageComplete ? \"text-muted-foreground italic\" : \"\"}`}>\n            {getShortName(awayTeamName)}\n          </span>\n          <span className={`text-xs font-bold min-w-[20px] text-center rounded px-1 ${awayWon ? \"bg-emerald-500 text-white\" : \"bg-muted\"}`}>\n            {showScores ? (match.awayScore ?? 0) : \"-\"}\n          </span>\n        </div>\n\n        <div className=\"flex items-center justify-center px-1 py-0.5 bg-primary/5 text-[10px] text-muted-foreground\">\n          {match.matchDate ? (\n            format(new Date(match.matchDate), \"dd/MM/yyyy HH:mm\", { locale: ar })\n          ) : (\n            \"موعد غير محدد\"\n          )}\n        </div>\n      </motion.div>\n    </Link>\n  );\n}\n\nfunction HorizontalBracket({ \n  matches, \n  groupStageComplete,\n  trophyImageUrl,\n  numGroups = 2,\n}: { \n  matches: MatchWithTeams[];\n  groupStageComplete: boolean;\n  trophyImageUrl?: string;\n  numGroups?: number;\n}) {\n  const round16 = matches.filter(m => m.stage === \"round_of_16\").sort((a, b) => (a.round || 0) - (b.round || 0));\n  const quarterFinals = matches.filter(m => m.stage === \"quarter_final\").sort((a, b) => (a.round || 0) - (b.round || 0));\n  const semiFinals = matches.filter(m => m.stage === \"semi_final\").sort((a, b) => (a.round || 0) - (b.round || 0));\n  const final = matches.find(m => m.stage === \"final\");\n  const thirdPlace = matches.find(m => m.stage === \"third_place\");\n\n  const leftR16 = round16.slice(0, 4);\n  const rightR16 = round16.slice(4, 8);\n  const leftQF = quarterFinals.slice(0, 2);\n  const rightQF = quarterFinals.slice(2, 4);\n  const leftSF = semiFinals.slice(0, 1);\n  const rightSF = semiFinals.slice(1, 2);\n\n  const hasR16 = round16.length > 0;\n  const hasQF = quarterFinals.length > 0;\n  const hasSF = semiFinals.length > 0;\n  const hasFinal = !!final;\n\n  return (\n    <div className=\"relative overflow-x-auto pb-4\">\n      <div className=\"min-w-[900px] relative\">\n        <div className=\"text-center mb-6\">\n          <div className=\"inline-flex items-center gap-2 px-6 py-2 rounded-full bg-gradient-to-r from-yellow-500 to-orange-500 text-white font-bold\">\n            <Trophy className=\"h-5 w-5\" />\n            النهائي\n          </div>\n        </div>\n\n        <div className=\"flex items-center justify-center gap-4\">\n          <div className=\"flex flex-col gap-4\">\n            {hasR16 && (\n              <div className=\"flex flex-col gap-8\">\n                <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">دور الـ 16</div>\n                {leftR16.map((match, i) => (\n                  <div key={match.id} className=\"relative\">\n                    <CompactMatchCard match={match} groupStageComplete={groupStageComplete} matchIndex={i} numGroups={numGroups} />\n                    <div className=\"absolute top-1/2 -left-4 w-4 h-px bg-primary/30\" />\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {hasQF && (\n            <div className=\"flex flex-col gap-4\">\n              <div className=\"flex flex-col gap-20\">\n                <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">ربع النهائي</div>\n                {leftQF.map((match, i) => (\n                  <div key={match.id} className=\"relative\">\n                    <CompactMatchCard match={match} groupStageComplete={groupStageComplete} matchIndex={i} numGroups={numGroups} />\n                    <div className=\"absolute top-1/2 -left-4 w-4 h-px bg-primary/30\" />\n                    <div className=\"absolute top-1/2 -right-4 w-4 h-px bg-primary/30\" />\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {hasSF && (\n            <div className=\"flex flex-col gap-4\">\n              <div className=\"flex flex-col gap-32\">\n                <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">نصف النهائي</div>\n                {leftSF.map((match) => (\n                  <div key={match.id} className=\"relative\">\n                    <CompactMatchCard match={match} groupStageComplete={groupStageComplete} matchIndex={0} numGroups={numGroups} />\n                    <div className=\"absolute top-1/2 -left-4 w-4 h-px bg-primary/30\" />\n                    <div className=\"absolute top-1/2 -right-4 w-4 h-px bg-primary/30\" />\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div className=\"flex flex-col items-center gap-4 mx-8\">\n            {trophyImageUrl ? (\n              <img \n                src={trophyImageUrl} \n                alt=\"كأس البطولة\" \n                className=\"w-32 h-40 object-contain drop-shadow-2xl\"\n              />\n            ) : (\n              <div className=\"w-32 h-40 flex items-center justify-center\">\n                <Trophy className=\"w-24 h-24 text-yellow-500 drop-shadow-lg\" />\n              </div>\n            )}\n            \n            {hasFinal && final && (\n              <div className=\"mt-4\">\n                <CompactMatchCard match={final} groupStageComplete={groupStageComplete} matchIndex={0} numGroups={numGroups} />\n              </div>\n            )}\n\n            {thirdPlace && (\n              <div className=\"mt-4\">\n                <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">المركز الثالث</div>\n                <CompactMatchCard match={thirdPlace} groupStageComplete={groupStageComplete} matchIndex={0} numGroups={numGroups} />\n              </div>\n            )}\n          </div>\n\n          {hasSF && (\n            <div className=\"flex flex-col gap-4\">\n              <div className=\"flex flex-col gap-32\">\n                <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">نصف النهائي</div>\n                {rightSF.map((match) => (\n                  <div key={match.id} className=\"relative\">\n                    <CompactMatchCard match={match} groupStageComplete={groupStageComplete} isRightSide matchIndex={1} numGroups={numGroups} />\n                    <div className=\"absolute top-1/2 -left-4 w-4 h-px bg-primary/30\" />\n                    <div className=\"absolute top-1/2 -right-4 w-4 h-px bg-primary/30\" />\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          {hasQF && (\n            <div className=\"flex flex-col gap-4\">\n              <div className=\"flex flex-col gap-20\">\n                <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">ربع النهائي</div>\n                {rightQF.map((match, i) => (\n                  <div key={match.id} className=\"relative\">\n                    <CompactMatchCard match={match} groupStageComplete={groupStageComplete} isRightSide matchIndex={i + 2} numGroups={numGroups} />\n                    <div className=\"absolute top-1/2 -left-4 w-4 h-px bg-primary/30\" />\n                    <div className=\"absolute top-1/2 -right-4 w-4 h-px bg-primary/30\" />\n                  </div>\n                ))}\n              </div>\n            </div>\n          )}\n\n          <div className=\"flex flex-col gap-4\">\n            {hasR16 && (\n              <div className=\"flex flex-col gap-8\">\n                <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">دور الـ 16</div>\n                {rightR16.map((match, i) => (\n                  <div key={match.id} className=\"relative\">\n                    <CompactMatchCard match={match} groupStageComplete={groupStageComplete} isRightSide matchIndex={i + 4} numGroups={numGroups} />\n                    <div className=\"absolute top-1/2 -right-4 w-4 h-px bg-primary/30\" />\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction SimpleBracket({ \n  matches, \n  groupStageComplete,\n  trophyImageUrl,\n  numGroups = 2,\n}: { \n  matches: MatchWithTeams[];\n  groupStageComplete: boolean;\n  trophyImageUrl?: string;\n  numGroups?: number;\n}) {\n  const semiFinals = matches.filter(m => m.stage === \"semi_final\").sort((a, b) => (a.round || 0) - (b.round || 0));\n  const final = matches.find(m => m.stage === \"final\");\n  const thirdPlace = matches.find(m => m.stage === \"third_place\");\n\n  const leftSF = semiFinals[0];\n  const rightSF = semiFinals[1];\n\n  return (\n    <div className=\"flex items-stretch justify-center gap-2 md:gap-4 py-8 overflow-x-auto\">\n      <div className=\"flex flex-col justify-center\">\n        {leftSF && (\n          <div className=\"relative\">\n            <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">نصف النهائي</div>\n            <CompactMatchCard match={leftSF} groupStageComplete={groupStageComplete} matchIndex={0} numGroups={numGroups} />\n            <div className=\"absolute top-1/2 -left-2 md:-left-4 w-2 md:w-4 h-px bg-primary/40\" />\n          </div>\n        )}\n      </div>\n\n      <div className=\"flex items-center\">\n        <div className=\"w-8 md:w-16 h-px bg-primary/40\" />\n      </div>\n\n      <div className=\"flex flex-col items-center justify-center gap-4\">\n        {trophyImageUrl ? (\n          <img \n            src={trophyImageUrl} \n            alt=\"كأس البطولة\" \n            className=\"w-20 h-28 md:w-28 md:h-36 object-contain drop-shadow-2xl\"\n          />\n        ) : (\n          <div className=\"w-20 h-28 md:w-28 md:h-36 flex items-center justify-center bg-gradient-to-b from-yellow-400/20 to-orange-400/20 rounded-lg\">\n            <Trophy className=\"w-12 h-12 md:w-16 md:h-16 text-yellow-500 drop-shadow-lg\" />\n          </div>\n        )}\n        \n        {final ? (\n          <div>\n            <div className=\"text-center text-xs font-medium text-yellow-600 dark:text-yellow-400 mb-2\">النهائي</div>\n            <CompactMatchCard match={final} groupStageComplete={groupStageComplete} matchIndex={0} numGroups={numGroups} />\n          </div>\n        ) : (\n          <div>\n            <div className=\"text-center text-xs font-medium text-yellow-600 dark:text-yellow-400 mb-2\">النهائي</div>\n            <div className=\"bg-card border-2 border-dashed border-yellow-500/40 rounded-lg w-[140px] shadow-md\">\n              <div className=\"flex items-center justify-between px-2 py-1 bg-muted/30\">\n                <span className=\"text-xs font-bold text-muted-foreground italic\">فائز 1</span>\n                <span className=\"text-xs font-bold min-w-[20px] text-center rounded px-1 bg-muted\">-</span>\n              </div>\n              <div className=\"flex items-center justify-between px-2 py-1 bg-muted/30\">\n                <span className=\"text-xs font-bold text-muted-foreground italic\">فائز 2</span>\n                <span className=\"text-xs font-bold min-w-[20px] text-center rounded px-1 bg-muted\">-</span>\n              </div>\n              <div className=\"flex items-center justify-center px-1 py-0.5 bg-primary/5 text-[10px] text-muted-foreground\">\n                موعد غير محدد\n              </div>\n            </div>\n          </div>\n        )}\n\n        {thirdPlace && (\n          <div className=\"mt-2\">\n            <div className=\"text-center text-[10px] font-medium text-muted-foreground mb-1\">المركز الثالث</div>\n            <CompactMatchCard match={thirdPlace} groupStageComplete={groupStageComplete} matchIndex={0} numGroups={numGroups} />\n          </div>\n        )}\n      </div>\n\n      <div className=\"flex items-center\">\n        <div className=\"w-8 md:w-16 h-px bg-primary/40\" />\n      </div>\n\n      <div className=\"flex flex-col justify-center\">\n        {rightSF && (\n          <div className=\"relative\">\n            <div className=\"text-center text-xs font-medium text-muted-foreground mb-2\">نصف النهائي</div>\n            <CompactMatchCard match={rightSF} groupStageComplete={groupStageComplete} isRightSide matchIndex={1} numGroups={numGroups} />\n            <div className=\"absolute top-1/2 -right-2 md:-right-4 w-2 md:w-4 h-px bg-primary/40\" />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport function KnockoutBracket({ matches, tournament, groupStageComplete = true }: KnockoutBracketProps) {\n  const knockoutMatches = matches.filter(m => m.stage && m.stage !== \"group\" && m.stage !== \"league\");\n  \n  if (knockoutMatches.length === 0) {\n    return (\n      <div className=\"text-center py-12 text-muted-foreground\">\n        <Trophy className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n        <p className=\"font-medium\">لم تبدأ مرحلة خروج المغلوب بعد</p>\n        <p className=\"text-sm mt-2\">ستظهر شجرة التصفيات عند بدء الأدوار الإقصائية</p>\n        {!groupStageComplete && (\n          <p className=\"text-sm mt-4 text-orange-500\">\n            يجب إكمال مباريات المجموعات أولاً\n          </p>\n        )}\n      </div>\n    );\n  }\n\n  const hasR16 = knockoutMatches.some(m => m.stage === \"round_of_16\");\n  const hasQF = knockoutMatches.some(m => m.stage === \"quarter_final\");\n  const trophyImageUrl = tournament?.trophyImageUrl ?? undefined;\n  const numGroups = tournament?.numberOfGroups || 2;\n\n  return (\n    <div className=\"space-y-6\">\n      <Card className=\"bg-gradient-to-b from-blue-950/50 to-blue-900/30 dark:from-blue-950/80 dark:to-blue-900/50 border-blue-500/20\">\n        <CardHeader className=\"pb-2\">\n          <CardTitle className=\"flex items-center justify-between\">\n            <div className=\"flex items-center gap-2 text-white\">\n              <Trophy className=\"h-5 w-5 text-yellow-400\" />\n              شجرة خروج المغلوب\n            </div>\n            {!groupStageComplete && (\n              <Badge variant=\"outline\" className=\"text-orange-400 border-orange-400/30 bg-orange-500/10\">\n                في انتظار نتائج المجموعات\n              </Badge>\n            )}\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {(hasR16 || hasQF) ? (\n            <HorizontalBracket \n              matches={knockoutMatches} \n              groupStageComplete={groupStageComplete}\n              trophyImageUrl={trophyImageUrl}\n              numGroups={numGroups}\n            />\n          ) : (\n            <SimpleBracket \n              matches={knockoutMatches} \n              groupStageComplete={groupStageComplete}\n              trophyImageUrl={trophyImageUrl}\n              numGroups={numGroups}\n            />\n          )}\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2 text-base\">\n            <Calendar className=\"h-4 w-4\" />\n            قائمة مباريات خروج المغلوب\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"space-y-3\">\n            {knockoutMatches\n              .sort((a, b) => {\n                const stageIndexA = stageOrder.indexOf(a.stage || \"\");\n                const stageIndexB = stageOrder.indexOf(b.stage || \"\");\n                if (stageIndexA !== stageIndexB) return stageIndexA - stageIndexB;\n                return (a.round || 0) - (b.round || 0);\n              })\n              .map((match, index) => {\n                const stageMatches = knockoutMatches.filter(m => m.stage === match.stage);\n                const matchIndex = stageMatches.findIndex(m => m.id === match.id);\n                const homeLabel = getPositionLabel(matchIndex, true, match.stage || \"semi_final\", numGroups);\n                const awayLabel = getPositionLabel(matchIndex, false, match.stage || \"semi_final\", numGroups);\n                \n                return (\n                  <Link key={match.id} href={`/matches/${match.id}`}>\n                    <motion.div\n                      whileHover={{ x: -4 }}\n                      className=\"flex items-center justify-between p-3 bg-muted/50 rounded-lg cursor-pointer hover-elevate\"\n                      data-testid={`list-match-${match.id}`}\n                    >\n                      <div className=\"flex items-center gap-3\">\n                        <span className=\"w-6 h-6 flex items-center justify-center bg-primary/10 rounded-full text-xs font-bold text-primary\">\n                          {index + 1}\n                        </span>\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {getKnockoutMatchLabel(match.stage || \"\", matchIndex)}\n                        </Badge>\n                        <span className=\"font-medium\">\n                          {groupStageComplete \n                            ? `${match.homeTeam?.name || \"TBD\"} × ${match.awayTeam?.name || \"TBD\"}`\n                            : `(${homeLabel}) × (${awayLabel})`\n                          }\n                        </span>\n                      </div>\n                      <div className=\"flex items-center gap-3\">\n                        {match.status === \"completed\" && (\n                          <span className=\"font-bold\">\n                            {match.homeScore} - {match.awayScore}\n                          </span>\n                        )}\n                        <Badge className={matchStatusColors[match.status]}>\n                          {matchStatusLabels[match.status]}\n                        </Badge>\n                      </div>\n                    </motion.div>\n                  </Link>\n                );\n              })}\n          </div>\n        </CardContent>\n      </Card>\n\n      {!groupStageComplete && (\n        <Card className=\"border-orange-500/30 bg-orange-500/5\">\n          <CardContent className=\"py-4\">\n            <div className=\"text-center text-sm text-orange-600 dark:text-orange-400\">\n              <p className=\"font-medium mb-1\">نظام التوزيع في خروج المغلوب</p>\n              <p className=\"text-muted-foreground\">\n                الأول يواجه الثاني، الثالث يواجه الرابع، وهكذا\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n\nexport default KnockoutBracket;\n","path":null,"size_bytes":24415,"size_tokens":null},"client/src/pages/bracket.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Link } from \"wouter\";\nimport { Trophy, ChevronLeft, Users, Calendar, MapPin, Loader2, Flag } from \"lucide-react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from \"@/components/ui/select\";\nimport type { Tournament, MatchWithTeams } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\n\nconst STAGE_ORDER = [\"round_of_16\", \"quarter_final\", \"semi_final\", \"final\"];\nconst STAGE_LABELS: Record<string, string> = {\n  round_of_16: \"دور الـ 16\",\n  quarter_final: \"ربع النهائي\",\n  semi_final: \"نصف النهائي\",\n  final: \"النهائي\",\n};\n\nfunction TeamSlot({ \n  team, \n  score, \n  isWinner, \n  ranking,\n  showScore = true \n}: { \n  team?: { id: string; name: string; logoUrl?: string | null } | null;\n  score?: number | null;\n  isWinner?: boolean;\n  ranking?: number;\n  showScore?: boolean;\n}) {\n  return (\n    <div className={`flex items-center justify-between gap-2 p-2 border-b last:border-b-0 ${\n      isWinner ? \"bg-emerald-50 dark:bg-emerald-900/20\" : \"bg-background\"\n    }`}>\n      <div className=\"flex items-center gap-2 flex-1 min-w-0\">\n        {team ? (\n          <>\n            <div className=\"w-8 h-8 rounded-full bg-gradient-to-br from-primary/20 to-primary/5 flex items-center justify-center flex-shrink-0 border\">\n              {team.logoUrl ? (\n                <img src={team.logoUrl} alt={team.name} className=\"w-6 h-6 rounded-full object-cover\" />\n              ) : (\n                <Flag className=\"w-4 h-4 text-primary\" />\n              )}\n            </div>\n            <span className={`text-sm truncate ${isWinner ? \"font-bold\" : \"\"}`}>\n              {team.name}\n            </span>\n            {ranking && (\n              <span className=\"text-xs text-muted-foreground\">({ranking})</span>\n            )}\n          </>\n        ) : (\n          <>\n            <div className=\"w-8 h-8 rounded-full bg-muted flex items-center justify-center flex-shrink-0\">\n              <Users className=\"w-4 h-4 text-muted-foreground\" />\n            </div>\n            <span className=\"text-sm text-muted-foreground\">TBD</span>\n          </>\n        )}\n      </div>\n      {showScore && (\n        <div className={`min-w-[32px] h-8 flex items-center justify-center rounded font-bold text-sm ${\n          isWinner \n            ? \"bg-emerald-500 text-white\" \n            : score !== null && score !== undefined\n              ? \"bg-muted text-foreground\"\n              : \"bg-muted/50 text-muted-foreground\"\n        }`}>\n          {score !== null && score !== undefined ? score : \"-\"}\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction BracketMatchCard({ match }: { match: MatchWithTeams }) {\n  const homeWinner = match.status === \"completed\" && \n    match.homeScore !== null && match.awayScore !== null && \n    match.homeScore > match.awayScore;\n  const awayWinner = match.status === \"completed\" && \n    match.homeScore !== null && match.awayScore !== null && \n    match.awayScore > match.homeScore;\n\n  return (\n    <Link href={`/matches/${match.id}`}>\n      <div className=\"w-52 hover-elevate cursor-pointer\" data-testid={`bracket-match-${match.id}`}>\n        {/* Date Header */}\n        {match.matchDate && (\n          <div className=\"text-xs text-muted-foreground text-center mb-1 flex items-center justify-center gap-1\">\n            <Calendar className=\"w-3 h-3\" />\n            {format(new Date(match.matchDate), \"EEEE dd/MM/yyyy\", { locale: ar })}\n            {match.matchTime && ` - ${match.matchTime}`}\n          </div>\n        )}\n        \n        {/* Match Box */}\n        <div className=\"border rounded-lg overflow-hidden bg-card shadow-sm\">\n          <TeamSlot \n            team={match.homeTeam} \n            score={match.homeScore} \n            isWinner={homeWinner}\n          />\n          <TeamSlot \n            team={match.awayTeam} \n            score={match.awayScore} \n            isWinner={awayWinner}\n          />\n        </div>\n\n        {/* Penalty Score */}\n        {match.homePenaltyScore !== null && match.awayPenaltyScore !== null && (\n          <div className=\"text-xs text-center text-muted-foreground mt-1\">\n            ركلات الترجيح: {match.homePenaltyScore} - {match.awayPenaltyScore}\n          </div>\n        )}\n\n        {/* Status Badge */}\n        <div className=\"flex justify-center mt-1\">\n          <Badge \n            variant=\"outline\" \n            className={`text-[10px] ${\n              match.status === \"completed\" ? \"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/30 dark:text-emerald-400\" :\n              match.status === \"live\" ? \"bg-red-500 text-white animate-pulse\" :\n              \"bg-muted\"\n            }`}\n          >\n            {match.status === \"completed\" ? \"انتهت\" :\n             match.status === \"live\" ? \"مباشر\" :\n             match.status === \"postponed\" ? \"مؤجلة\" : \"قادمة\"}\n          </Badge>\n        </div>\n      </div>\n    </Link>\n  );\n}\n\nfunction BracketConnector({ matchCount, direction = \"left\" }: { matchCount: number; direction?: \"left\" | \"right\" }) {\n  if (matchCount <= 1) {\n    return (\n      <div className=\"w-12 flex items-center justify-center\">\n        <div className=\"w-full h-px bg-border\" />\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"w-12 flex flex-col justify-center relative\">\n      <svg className=\"w-full h-full absolute inset-0\" preserveAspectRatio=\"none\">\n        <line x1=\"0\" y1=\"50%\" x2=\"100%\" y2=\"50%\" stroke=\"currentColor\" strokeWidth=\"1\" className=\"text-border\" />\n      </svg>\n    </div>\n  );\n}\n\nfunction BracketColumn({ \n  stage, \n  matches,\n  isFirst,\n  isLast\n}: { \n  stage: string; \n  matches: MatchWithTeams[];\n  isFirst: boolean;\n  isLast: boolean;\n}) {\n  const stageMatches = matches\n    .filter(m => m.stage === stage)\n    .sort((a, b) => (a.round || 0) - (b.round || 0));\n\n  const getGap = () => {\n    switch (stage) {\n      case \"round_of_16\": return \"gap-2\";\n      case \"quarter_final\": return \"gap-8\";\n      case \"semi_final\": return \"gap-24\";\n      case \"final\": return \"gap-0\";\n      default: return \"gap-4\";\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-center\">\n      {/* Stage Header */}\n      <div className={`mb-4 px-4 py-2 rounded-lg text-center ${\n        stage === \"final\" \n          ? \"bg-gradient-to-r from-yellow-400 to-yellow-500 text-yellow-900\" \n          : \"bg-primary/10\"\n      }`}>\n        <div className=\"flex items-center gap-2 justify-center\">\n          {stage === \"final\" && <Trophy className=\"w-4 h-4\" />}\n          <span className=\"font-bold text-sm\">{STAGE_LABELS[stage]}</span>\n        </div>\n      </div>\n\n      {/* Matches */}\n      <div className={`flex flex-col ${getGap()} justify-center flex-1`}>\n        {stageMatches.length > 0 ? (\n          stageMatches.map((match) => (\n            <div key={match.id} className=\"flex items-center\">\n              {!isFirst && <BracketConnector matchCount={stageMatches.length} direction=\"right\" />}\n              <BracketMatchCard match={match} />\n              {!isLast && <BracketConnector matchCount={stageMatches.length} direction=\"left\" />}\n            </div>\n          ))\n        ) : (\n          <div className=\"w-52 h-24 border-2 border-dashed rounded-lg flex items-center justify-center text-muted-foreground text-sm\">\n            لم تحدد بعد\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\nfunction EnhancedBracketTree({ matches, tournamentName }: { matches: MatchWithTeams[]; tournamentName?: string }) {\n  const knockoutMatches = matches.filter(m => m.stage && m.stage !== \"group\");\n  \n  if (knockoutMatches.length === 0) {\n    return (\n      <Card className=\"text-center p-12\">\n        <Trophy className=\"w-16 h-16 mx-auto text-muted-foreground mb-4\" />\n        <h3 className=\"text-xl font-bold mb-2\">لا توجد مباريات تصفيات</h3>\n        <p className=\"text-muted-foreground\">\n          لم يتم جدولة مباريات خروج المغلوب بعد\n        </p>\n      </Card>\n    );\n  }\n\n  // Get available stages in order (RTL: final first visually on left)\n  const availableStages = STAGE_ORDER.filter(stage => \n    knockoutMatches.some(m => m.stage === stage)\n  ).reverse(); // Reverse for RTL layout\n\n  return (\n    <Card>\n      <CardHeader className=\"border-b\">\n        <CardTitle className=\"flex items-center justify-center gap-2 text-xl\">\n          <Trophy className=\"h-6 w-6 text-primary\" />\n          {tournamentName} خروج المغلوب\n        </CardTitle>\n      </CardHeader>\n      <CardContent className=\"p-6\">\n        <div className=\"overflow-x-auto pb-4\" dir=\"ltr\">\n          <div className=\"flex items-stretch justify-center gap-4 min-w-max py-4\">\n            {availableStages.map((stage, index) => (\n              <div key={stage} className=\"flex items-center\">\n                <BracketColumn \n                  stage={stage} \n                  matches={knockoutMatches}\n                  isFirst={index === 0}\n                  isLast={index === availableStages.length - 1}\n                />\n              </div>\n            ))}\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction TournamentWinner({ matches }: { matches: MatchWithTeams[] }) {\n  const finalMatch = matches.find(m => m.stage === \"final\" && m.status === \"completed\");\n  \n  if (!finalMatch || finalMatch.homeScore === null || finalMatch.awayScore === null) {\n    return null;\n  }\n\n  const winner = finalMatch.homeScore > finalMatch.awayScore \n    ? finalMatch.homeTeam \n    : finalMatch.awayScore > finalMatch.homeScore \n      ? finalMatch.awayTeam \n      : null;\n\n  if (!winner) return null;\n\n  return (\n    <Card className=\"bg-gradient-to-r from-yellow-100 to-yellow-50 dark:from-yellow-900/20 dark:to-yellow-800/10 border-yellow-300 dark:border-yellow-700\">\n      <CardContent className=\"p-6 text-center\">\n        <div className=\"inline-flex items-center justify-center w-20 h-20 bg-yellow-400 rounded-full mb-4\">\n          <Trophy className=\"w-10 h-10 text-yellow-900\" />\n        </div>\n        <h2 className=\"text-2xl font-bold mb-2 flex items-center justify-center gap-2\">\n          <Trophy className=\"w-6 h-6 text-yellow-600\" />\n          البطل\n          <Trophy className=\"w-6 h-6 text-yellow-600\" />\n        </h2>\n        <p className=\"text-3xl font-display font-bold text-yellow-700 dark:text-yellow-400\">\n          {winner.name}\n        </p>\n      </CardContent>\n    </Card>\n  );\n}\n\nfunction MatchResultsList({ matches }: { matches: MatchWithTeams[] }) {\n  const completedMatches = matches\n    .filter(m => m.status === \"completed\")\n    .sort((a, b) => {\n      if (a.matchDate && b.matchDate) {\n        return new Date(b.matchDate).getTime() - new Date(a.matchDate).getTime();\n      }\n      return 0;\n    });\n\n  if (completedMatches.length === 0) {\n    return (\n      <div className=\"text-center py-8 text-muted-foreground\">\n        <Trophy className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n        <p>لا توجد نتائج بعد</p>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      {completedMatches.map((match) => {\n        const homeWinner = match.homeScore !== null && match.awayScore !== null && match.homeScore > match.awayScore;\n        const awayWinner = match.homeScore !== null && match.awayScore !== null && match.awayScore > match.homeScore;\n        \n        return (\n          <Link key={match.id} href={`/matches/${match.id}`}>\n            <Card className=\"hover-elevate cursor-pointer\" data-testid={`result-match-${match.id}`}>\n              <CardContent className=\"p-4\">\n                <div className=\"flex items-center justify-between gap-4\">\n                  {/* Home Team */}\n                  <div className={`flex items-center gap-2 flex-1 justify-end ${homeWinner ? \"font-bold\" : \"\"}`}>\n                    <span className=\"text-sm truncate\">{match.homeTeam?.name || \"فريق 1\"}</span>\n                    <div className=\"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0\">\n                      <Flag className=\"w-4 h-4 text-primary\" />\n                    </div>\n                  </div>\n\n                  {/* Score */}\n                  <div className=\"flex items-center gap-1\">\n                    <div className={`w-8 h-8 flex items-center justify-center rounded font-bold ${\n                      homeWinner ? \"bg-emerald-500 text-white\" : \"bg-muted\"\n                    }`}>\n                      {match.homeScore ?? \"-\"}\n                    </div>\n                    <span className=\"text-muted-foreground\">-</span>\n                    <div className={`w-8 h-8 flex items-center justify-center rounded font-bold ${\n                      awayWinner ? \"bg-emerald-500 text-white\" : \"bg-muted\"\n                    }`}>\n                      {match.awayScore ?? \"-\"}\n                    </div>\n                  </div>\n\n                  {/* Away Team */}\n                  <div className={`flex items-center gap-2 flex-1 ${awayWinner ? \"font-bold\" : \"\"}`}>\n                    <div className=\"w-8 h-8 rounded-full bg-secondary/50 flex items-center justify-center flex-shrink-0\">\n                      <Flag className=\"w-4 h-4\" />\n                    </div>\n                    <span className=\"text-sm truncate\">{match.awayTeam?.name || \"فريق 2\"}</span>\n                  </div>\n                </div>\n\n                {/* Match Info */}\n                <div className=\"flex items-center justify-center gap-4 mt-2 text-xs text-muted-foreground\">\n                  {match.matchDate && (\n                    <span className=\"flex items-center gap-1\">\n                      <Calendar className=\"w-3 h-3\" />\n                      {format(new Date(match.matchDate), \"dd/MM/yyyy\", { locale: ar })}\n                    </span>\n                  )}\n                  {match.stage && (\n                    <Badge variant=\"outline\" className=\"text-[10px]\">\n                      {STAGE_LABELS[match.stage] || match.stage}\n                    </Badge>\n                  )}\n                </div>\n              </CardContent>\n            </Card>\n          </Link>\n        );\n      })}\n    </div>\n  );\n}\n\nexport default function Bracket() {\n  const [selectedTournamentId, setSelectedTournamentId] = useState<string>(\"\");\n  const [viewMode, setViewMode] = useState<\"bracket\" | \"results\">(\"bracket\");\n\n  const { data: tournaments = [], isLoading: tournamentsLoading } = useQuery<Tournament[]>({\n    queryKey: [\"/api/tournaments\"],\n  });\n\n  const { data: matches = [], isLoading: matchesLoading } = useQuery<MatchWithTeams[]>({\n    queryKey: [`/api/tournaments/${selectedTournamentId}/matches`],\n    enabled: !!selectedTournamentId,\n  });\n\n  const knockoutTournaments = tournaments.filter(t => \n    t.type === \"knockout\" || t.type === \"groups_knockout\"\n  );\n\n  const selectedTournament = tournaments.find(t => t.id === selectedTournamentId);\n\n  return (\n    <div className=\"min-h-screen py-8\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        <div className=\"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-8\">\n          <div>\n            <h1 className=\"text-3xl font-display font-bold flex items-center gap-3\">\n              <Trophy className=\"h-8 w-8 text-primary\" />\n              شجرة التصفيات\n            </h1>\n            <p className=\"text-muted-foreground mt-1\">\n              تتبع مسار الفرق في مراحل خروج المغلوب\n            </p>\n          </div>\n\n          <div className=\"flex items-center gap-3\">\n            <Select value={selectedTournamentId} onValueChange={setSelectedTournamentId}>\n              <SelectTrigger className=\"w-[280px]\" data-testid=\"select-tournament-bracket\">\n                <SelectValue placeholder=\"اختر البطولة\" />\n              </SelectTrigger>\n              <SelectContent>\n                {tournamentsLoading ? (\n                  <div className=\"p-4 text-center\">\n                    <Loader2 className=\"h-4 w-4 animate-spin mx-auto\" />\n                  </div>\n                ) : knockoutTournaments.length === 0 ? (\n                  <div className=\"p-4 text-center text-muted-foreground text-sm\">\n                    لا توجد بطولات تصفيات\n                  </div>\n                ) : (\n                  knockoutTournaments.map((tournament) => (\n                    <SelectItem key={tournament.id} value={tournament.id}>\n                      {tournament.name}\n                    </SelectItem>\n                  ))\n                )}\n                {tournaments.filter(t => t.type !== \"knockout\" && t.type !== \"groups_knockout\").length > 0 && (\n                  <>\n                    <div className=\"px-2 py-1.5 text-xs text-muted-foreground border-t mt-1\">\n                      بطولات أخرى (دوري)\n                    </div>\n                    {tournaments.filter(t => t.type !== \"knockout\" && t.type !== \"groups_knockout\").map((tournament) => (\n                      <SelectItem key={tournament.id} value={tournament.id}>\n                        {tournament.name}\n                      </SelectItem>\n                    ))}\n                  </>\n                )}\n              </SelectContent>\n            </Select>\n          </div>\n        </div>\n\n        {!selectedTournamentId ? (\n          <Card className=\"text-center p-12\">\n            <Trophy className=\"w-16 h-16 mx-auto text-muted-foreground mb-4\" />\n            <h3 className=\"text-xl font-bold mb-2\">اختر بطولة</h3>\n            <p className=\"text-muted-foreground\">\n              اختر بطولة من القائمة لعرض شجرة التصفيات\n            </p>\n          </Card>\n        ) : matchesLoading ? (\n          <div className=\"flex items-center justify-center py-16\">\n            <Loader2 className=\"h-8 w-8 animate-spin text-primary\" />\n          </div>\n        ) : (\n          <div className=\"space-y-8\">\n            {/* Tournament Info */}\n            {selectedTournament && (\n              <Card>\n                <CardHeader className=\"pb-3\">\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Trophy className=\"h-5 w-5\" />\n                    {selectedTournament.name}\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <div className=\"flex flex-wrap gap-4 text-sm text-muted-foreground\">\n                    {selectedTournament.startDate && (\n                      <span className=\"flex items-center gap-1\">\n                        <Calendar className=\"h-4 w-4\" />\n                        {new Date(selectedTournament.startDate).toLocaleDateString('ar-SA')}\n                      </span>\n                    )}\n                    {selectedTournament.venues && (\n                      <span className=\"flex items-center gap-1\">\n                        <MapPin className=\"h-4 w-4\" />\n                        {Array.isArray(selectedTournament.venues) \n                          ? selectedTournament.venues.join(\", \") \n                          : selectedTournament.venues}\n                      </span>\n                    )}\n                    <Badge>\n                      {selectedTournament.type === \"knockout\" ? \"خروج مغلوب\" :\n                       selectedTournament.type === \"groups_knockout\" ? \"مجموعات + تصفيات\" :\n                       \"دوري\"}\n                    </Badge>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n\n            {/* View Mode Toggle */}\n            <div className=\"flex items-center gap-2 justify-center\">\n              <Badge \n                variant={viewMode === \"bracket\" ? \"default\" : \"outline\"}\n                className=\"cursor-pointer px-4 py-2\"\n                onClick={() => setViewMode(\"bracket\")}\n                data-testid=\"view-bracket\"\n              >\n                شجرة التصفيات\n              </Badge>\n              <Badge \n                variant={viewMode === \"results\" ? \"default\" : \"outline\"}\n                className=\"cursor-pointer px-4 py-2\"\n                onClick={() => setViewMode(\"results\")}\n                data-testid=\"view-results\"\n              >\n                النتائج\n              </Badge>\n            </div>\n\n            {/* Winner */}\n            <TournamentWinner matches={matches} />\n            \n            {/* Content */}\n            {viewMode === \"bracket\" ? (\n              <EnhancedBracketTree \n                matches={matches} \n                tournamentName={selectedTournament?.name}\n              />\n            ) : (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Trophy className=\"h-5 w-5\" />\n                    نتائج المباريات\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <MatchResultsList matches={matches} />\n                </CardContent>\n              </Card>\n            )}\n\n            {/* Legend */}\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">مفتاح الألوان</CardTitle>\n              </CardHeader>\n              <CardContent>\n                <div className=\"flex flex-wrap gap-4 text-sm\">\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"w-6 h-6 bg-emerald-500 rounded text-white flex items-center justify-center text-xs font-bold\">2</div>\n                    <span>الفائز</span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <div className=\"w-6 h-6 bg-muted rounded flex items-center justify-center text-xs font-bold\">1</div>\n                    <span>الخاسر</span>\n                  </div>\n                  <div className=\"flex items-center gap-2\">\n                    <Badge variant=\"outline\" className=\"bg-red-500 text-white text-[10px]\">مباشر</Badge>\n                    <span>مباراة جارية</span>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":22411,"size_tokens":null},"client/src/pages/tournament-edit.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { useRoute, Link, useLocation } from \"wouter\";\nimport { \n  Trophy, \n  Users, \n  ArrowRight,\n  Target,\n  Plus,\n  Trash2,\n  Pencil,\n  Shield,\n  Loader2,\n  Save,\n  Gavel,\n  Calendar,\n  Phone,\n  Mail,\n  User,\n  MapPin,\n  Layers,\n  GitBranch,\n  CheckCircle2,\n  RefreshCw,\n  Palette,\n  Image,\n  Upload,\n  Clock,\n  ChevronDown,\n  ChevronUp\n} from \"lucide-react\";\nimport { TeamColorPicker } from \"@/components/TeamBox\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogTrigger, DialogFooter, DialogClose } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport type { Tournament, Team, MatchWithTeams, Referee } from \"@shared/schema\";\nimport { format } from \"date-fns\";\nimport { ar } from \"date-fns/locale\";\nimport KnockoutBracket from \"@/components/KnockoutBracket\";\n\nconst sportLabels: Record<string, string> = {\n  football: \"كرة القدم\",\n  basketball: \"كرة السلة\",\n  volleyball: \"الكرة الطائرة\",\n  tennis: \"التنس\",\n};\n\nconst typeLabels: Record<string, string> = {\n  round_robin: \"دوري كامل\",\n  knockout: \"خروج مغلوب\",\n  groups: \"مجموعات\",\n  groups_knockout: \"مجموعات + خروج مغلوب\",\n};\n\nconst statusLabels: Record<string, string> = {\n  registration: \"التسجيل مفتوح\",\n  ongoing: \"جارية\",\n  completed: \"منتهية\",\n};\n\nconst levelLabels: Record<string, string> = {\n  beginner: \"مبتدئ\",\n  intermediate: \"متوسط\",\n  advanced: \"متقدم\",\n  fifa: \"دولي (FIFA)\",\n};\n\n// Group letter mapping: number -> Arabic letter\nconst groupLetterMap: Record<number, string> = {\n  1: \"أ\",\n  2: \"ب\",\n  3: \"ج\",\n  4: \"د\",\n  5: \"هـ\",\n  6: \"و\",\n  7: \"ز\",\n  8: \"ح\",\n};\n\n// Reverse mapping: Arabic letter -> number\nconst letterToNumberMap: Record<string, number> = {\n  \"أ\": 1,\n  \"ب\": 2,\n  \"ج\": 3,\n  \"د\": 4,\n  \"هـ\": 5,\n  \"و\": 6,\n  \"ز\": 7,\n  \"ح\": 8,\n};\n\n// Available group letters for selection\nconst availableGroupLetters = [\"أ\", \"ب\", \"ج\", \"د\", \"هـ\", \"و\", \"ز\", \"ح\"];\n\nconst specializationLabels: Record<string, string> = {\n  main: \"حكم رئيسي\",\n  assistant: \"حكم مساعد\",\n  var: \"حكم الفيديو\",\n};\n\nexport default function TournamentEdit() {\n  const [, params] = useRoute(\"/admin/tournaments/:id/edit\");\n  const tournamentId = params?.id;\n  const { toast } = useToast();\n  const { user, isAuthenticated, isLoading: authLoading } = useAuth();\n  const [, navigate] = useLocation();\n  const [activeTab, setActiveTab] = useState(\"info\");\n\n  const isAdmin = user?.role === \"admin\" || user?.role === \"committee_member\";\n\n  const { data: tournament, isLoading: tournamentLoading } = useQuery<Tournament>({\n    queryKey: [\"/api/tournaments\", tournamentId],\n    enabled: !!tournamentId && isAdmin,\n  });\n\n  const { data: teams = [] } = useQuery<Team[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"teams\"],\n    enabled: !!tournamentId && isAdmin,\n  });\n\n  const { data: referees = [] } = useQuery<Referee[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"referees\"],\n    enabled: !!tournamentId && isAdmin,\n  });\n\n  const { data: matches = [] } = useQuery<MatchWithTeams[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"matches\"],\n    enabled: !!tournamentId && isAdmin,\n  });\n\n  if (authLoading || tournamentLoading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center\">\n        <Loader2 className=\"w-8 h-8 animate-spin text-primary\" />\n      </div>\n    );\n  }\n\n  if (!isAuthenticated) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\" dir=\"rtl\">\n        <Card className=\"max-w-md w-full text-center p-8\">\n          <Shield className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n          <h2 className=\"text-2xl font-bold mb-4\">يجب تسجيل الدخول</h2>\n          <p className=\"text-muted-foreground mb-6\">\n            يرجى تسجيل الدخول للوصول إلى هذه الصفحة\n          </p>\n          <Button onClick={() => navigate(\"/login\")} data-testid=\"button-login\">\n            تسجيل الدخول\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!isAdmin) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center p-4\" dir=\"rtl\">\n        <Card className=\"max-w-md w-full text-center p-8\">\n          <Shield className=\"h-16 w-16 mx-auto text-destructive mb-4\" />\n          <h2 className=\"text-2xl font-bold mb-4\">غير مصرح</h2>\n          <p className=\"text-muted-foreground mb-6\">\n            ليس لديك صلاحية للوصول إلى هذه الصفحة\n          </p>\n          <Button onClick={() => navigate(\"/\")} data-testid=\"button-home\">\n            العودة للرئيسية\n          </Button>\n        </Card>\n      </div>\n    );\n  }\n\n  if (!tournament) {\n    return (\n      <div className=\"min-h-screen flex flex-col items-center justify-center gap-4\" dir=\"rtl\">\n        <Trophy className=\"h-16 w-16 text-muted-foreground\" />\n        <h2 className=\"text-xl font-medium\">البطولة غير موجودة</h2>\n        <Link href=\"/admin\">\n          <Button data-testid=\"button-return-admin\">\n            <ArrowRight className=\"ml-2 h-4 w-4\" />\n            العودة للوحة التحكم\n          </Button>\n        </Link>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background py-8\" dir=\"rtl\">\n      <div className=\"container mx-auto px-4 md:px-6\">\n        <div className=\"flex items-center justify-between mb-8\">\n          <div className=\"flex items-center gap-4\">\n            <Link href=\"/admin\">\n              <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back\">\n                <ArrowRight className=\"h-5 w-5\" />\n              </Button>\n            </Link>\n            <div>\n              <h1 className=\"text-2xl font-bold flex items-center gap-2\">\n                <Target className=\"h-6 w-6 text-primary\" />\n                تعديل البطولة\n              </h1>\n              <p className=\"text-muted-foreground\">{tournament.name}</p>\n            </div>\n          </div>\n          <Badge className={\n            tournament.status === \"registration\" ? \"bg-emerald-500\" :\n            tournament.status === \"ongoing\" ? \"bg-orange-500\" : \"bg-gray-500\"\n          }>\n            {statusLabels[tournament.status]}\n          </Badge>\n        </div>\n\n        <Tabs value={activeTab} onValueChange={setActiveTab} className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-6 max-w-3xl\">\n            <TabsTrigger value=\"info\" data-testid=\"tab-info\">\n              <Target className=\"h-4 w-4 ml-2\" />\n              المعلومات\n            </TabsTrigger>\n            <TabsTrigger value=\"theme\" data-testid=\"tab-theme\">\n              <Palette className=\"h-4 w-4 ml-2\" />\n              الثيم\n            </TabsTrigger>\n            <TabsTrigger value=\"teams\" data-testid=\"tab-teams\">\n              <Users className=\"h-4 w-4 ml-2\" />\n              الفرق\n            </TabsTrigger>\n            <TabsTrigger value=\"referees\" data-testid=\"tab-referees\">\n              <Gavel className=\"h-4 w-4 ml-2\" />\n              الحكام\n            </TabsTrigger>\n            <TabsTrigger value=\"matches\" data-testid=\"tab-matches\">\n              <Trophy className=\"h-4 w-4 ml-2\" />\n              المباريات\n            </TabsTrigger>\n            <TabsTrigger value=\"stages\" data-testid=\"tab-stages\">\n              <Layers className=\"h-4 w-4 ml-2\" />\n              المراحل\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"info\">\n            <TournamentInfoTab tournament={tournament} />\n          </TabsContent>\n\n          <TabsContent value=\"theme\">\n            <ThemeTab tournament={tournament} />\n          </TabsContent>\n\n          <TabsContent value=\"teams\">\n            <TeamsTab tournamentId={tournamentId!} teams={teams} />\n          </TabsContent>\n\n          <TabsContent value=\"referees\">\n            <RefereesTab tournamentId={tournamentId!} referees={referees} />\n          </TabsContent>\n\n          <TabsContent value=\"matches\">\n            <MatchesTab tournamentId={tournamentId!} tournament={tournament} matches={matches} teams={teams} />\n          </TabsContent>\n\n          <TabsContent value=\"stages\">\n            <StagesTab tournamentId={tournamentId!} tournament={tournament} teams={teams} />\n          </TabsContent>\n        </Tabs>\n      </div>\n    </div>\n  );\n}\n\nfunction TournamentInfoTab({ tournament }: { tournament: Tournament }) {\n  const { toast } = useToast();\n  const [isEditing, setIsEditing] = useState(false);\n  const [uploadingTrophy, setUploadingTrophy] = useState(false);\n  const [uploadingImage, setUploadingImage] = useState(false);\n  \n  // Parse schedule config\n  const scheduleConfig = tournament.scheduleConfig ? JSON.parse(tournament.scheduleConfig) : { dailyStartTime: \"16:00\", matchesPerDayPerVenue: 3 };\n  \n  const [formData, setFormData] = useState({\n    name: tournament.name,\n    description: tournament.description || \"\",\n    sport: tournament.sport,\n    type: tournament.type,\n    status: tournament.status,\n    maxTeams: tournament.maxTeams,\n    pointsForWin: tournament.pointsForWin,\n    pointsForDraw: tournament.pointsForDraw,\n    pointsForLoss: tournament.pointsForLoss,\n    halfDuration: tournament.halfDuration,\n    breakBetweenHalves: tournament.breakBetweenHalves,\n    trophyImageUrl: tournament.trophyImageUrl || \"\",\n    // New fields\n    tournamentStructure: tournament.tournamentStructure || \"team\",\n    startDate: tournament.startDate ? new Date(tournament.startDate).toISOString().split('T')[0] : \"\",\n    endDate: tournament.endDate ? new Date(tournament.endDate).toISOString().split('T')[0] : \"\",\n    numberOfGroups: tournament.numberOfGroups || 2,\n    numberOfVenues: tournament.numberOfVenues || 1,\n    excludedDays: tournament.excludedDays || [],\n    venues: tournament.venues?.join(\"، \") || \"\",\n    imageUrl: tournament.imageUrl || \"\",\n    phoneNumber: tournament.phoneNumber || \"\",\n    address: tournament.address || \"\",\n    policy: tournament.policy || \"public\",\n    numberOfRounds: tournament.numberOfRounds || 1,\n    isOpenForRegistration: tournament.isOpenForRegistration ?? true,\n    hasThirdPlaceMatch: tournament.hasThirdPlaceMatch ?? false,\n    dailyStartTime: scheduleConfig.dailyStartTime || \"16:00\",\n    matchesPerDayPerVenue: scheduleConfig.matchesPerDayPerVenue || 3,\n  });\n  \n  const daysOfWeek = [\n    { value: \"friday\", label: \"الجمعة\" },\n    { value: \"saturday\", label: \"السبت\" },\n    { value: \"sunday\", label: \"الأحد\" },\n    { value: \"monday\", label: \"الاثنين\" },\n    { value: \"tuesday\", label: \"الثلاثاء\" },\n    { value: \"wednesday\", label: \"الأربعاء\" },\n    { value: \"thursday\", label: \"الخميس\" },\n  ];\n  \n  const toggleExcludedDay = (day: string) => {\n    setFormData(prev => ({\n      ...prev,\n      excludedDays: prev.excludedDays.includes(day)\n        ? prev.excludedDays.filter(d => d !== day)\n        : [...prev.excludedDays, day]\n    }));\n  };\n  \n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    \n    setUploadingImage(true);\n    try {\n      const formDataUpload = new FormData();\n      formDataUpload.append(\"image\", file);\n      \n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formDataUpload,\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) throw new Error(\"فشل رفع الصورة\");\n      \n      const data = await response.json();\n      setFormData({ ...formData, imageUrl: data.url });\n      toast({ title: \"تم رفع صورة البطولة بنجاح\" });\n    } catch (error) {\n      toast({ title: \"فشل رفع صورة البطولة\", variant: \"destructive\" });\n    } finally {\n      setUploadingImage(false);\n    }\n  };\n\n  const handleTrophyUpload = async (e: React.ChangeEvent<HTMLInputElement>) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    \n    setUploadingTrophy(true);\n    try {\n      const formDataUpload = new FormData();\n      formDataUpload.append(\"image\", file);\n      \n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formDataUpload,\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) throw new Error(\"فشل رفع الصورة\");\n      \n      const data = await response.json();\n      setFormData({ ...formData, trophyImageUrl: data.url });\n      toast({ title: \"تم رفع صورة الكأس بنجاح\" });\n    } catch (error) {\n      toast({ title: \"فشل رفع صورة الكأس\", variant: \"destructive\" });\n    } finally {\n      setUploadingTrophy(false);\n    }\n  };\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: typeof formData) => {\n      const submitData: any = {\n        name: data.name,\n        description: data.description || undefined,\n        sport: data.sport,\n        type: data.type,\n        status: data.status,\n        maxTeams: data.maxTeams,\n        pointsForWin: data.pointsForWin,\n        pointsForDraw: data.pointsForDraw,\n        pointsForLoss: data.pointsForLoss,\n        halfDuration: data.halfDuration,\n        breakBetweenHalves: data.breakBetweenHalves,\n        trophyImageUrl: data.trophyImageUrl || undefined,\n        tournamentStructure: data.tournamentStructure,\n        numberOfGroups: data.numberOfGroups,\n        numberOfVenues: data.numberOfVenues,\n        excludedDays: data.excludedDays,\n        imageUrl: data.imageUrl || undefined,\n        phoneNumber: data.phoneNumber || undefined,\n        address: data.address || undefined,\n        policy: data.policy,\n        numberOfRounds: data.numberOfRounds,\n        isOpenForRegistration: data.isOpenForRegistration,\n        hasThirdPlaceMatch: data.hasThirdPlaceMatch,\n        hasGroupStage: data.type === \"groups\" || data.type === \"groups_knockout\",\n        scheduleConfig: JSON.stringify({\n          dailyStartTime: data.dailyStartTime,\n          matchesPerDayPerVenue: data.matchesPerDayPerVenue\n        }),\n      };\n      \n      if (data.startDate) {\n        submitData.startDate = new Date(data.startDate).toISOString();\n      }\n      if (data.endDate) {\n        submitData.endDate = new Date(data.endDate).toISOString();\n      }\n      submitData.venues = data.venues ? data.venues.split(\"،\").map((v: string) => v.trim()).filter((v: string) => v) : [];\n      \n      return await apiRequest(\"PATCH\", `/api/tournaments/${tournament.id}`, submitData);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تحديث البطولة بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournament.id] });\n      setIsEditing(false);\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث البطولة\", variant: \"destructive\" });\n    },\n  });\n\n  return (\n    <Card>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <Target className=\"h-5 w-5\" />\n          معلومات البطولة\n        </CardTitle>\n        {!isEditing ? (\n          <Button variant=\"outline\" onClick={() => setIsEditing(true)} data-testid=\"button-edit-info\">\n            <Pencil className=\"h-4 w-4 ml-2\" />\n            تعديل\n          </Button>\n        ) : (\n          <div className=\"flex gap-2\">\n            <Button \n              variant=\"outline\" \n              onClick={() => setIsEditing(false)}\n              data-testid=\"button-cancel-edit\"\n            >\n              إلغاء\n            </Button>\n            <Button \n              onClick={() => updateMutation.mutate(formData)}\n              disabled={updateMutation.isPending}\n              data-testid=\"button-save-info\"\n            >\n              <Save className=\"h-4 w-4 ml-2\" />\n              {updateMutation.isPending ? \"جاري الحفظ...\" : \"حفظ\"}\n            </Button>\n          </div>\n        )}\n      </CardHeader>\n      <CardContent className=\"space-y-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-2\">\n            <Label>اسم البطولة</Label>\n            {isEditing ? (\n              <Input\n                value={formData.name}\n                onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n                data-testid=\"input-tournament-name\"\n              />\n            ) : (\n              <p className=\"font-medium\">{tournament.name}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>الرياضة</Label>\n            {isEditing ? (\n              <Select\n                value={formData.sport}\n                onValueChange={(value) => setFormData({ ...formData, sport: value })}\n              >\n                <SelectTrigger data-testid=\"select-sport\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"football\" data-testid=\"option-sport-football\">كرة القدم</SelectItem>\n                  <SelectItem value=\"basketball\" data-testid=\"option-sport-basketball\">كرة السلة</SelectItem>\n                  <SelectItem value=\"volleyball\" data-testid=\"option-sport-volleyball\">الكرة الطائرة</SelectItem>\n                  <SelectItem value=\"tennis\" data-testid=\"option-sport-tennis\">التنس</SelectItem>\n                </SelectContent>\n              </Select>\n            ) : (\n              <p className=\"font-medium\">{sportLabels[tournament.sport]}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>نوع البطولة</Label>\n            {isEditing ? (\n              <Select\n                value={formData.type}\n                onValueChange={(value) => setFormData({ ...formData, type: value })}\n              >\n                <SelectTrigger data-testid=\"select-type\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"round_robin\" data-testid=\"option-type-round-robin\">دوري كامل</SelectItem>\n                  <SelectItem value=\"knockout\" data-testid=\"option-type-knockout\">خروج مغلوب</SelectItem>\n                  <SelectItem value=\"groups\" data-testid=\"option-type-groups\">مجموعات</SelectItem>\n                  <SelectItem value=\"groups_knockout\" data-testid=\"option-type-groups-knockout\">مجموعات + خروج مغلوب</SelectItem>\n                </SelectContent>\n              </Select>\n            ) : (\n              <p className=\"font-medium\">{typeLabels[tournament.type]}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>الحالة</Label>\n            {isEditing ? (\n              <Select\n                value={formData.status}\n                onValueChange={(value) => setFormData({ ...formData, status: value })}\n              >\n                <SelectTrigger data-testid=\"select-status\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"registration\" data-testid=\"option-status-registration\">التسجيل مفتوح</SelectItem>\n                  <SelectItem value=\"ongoing\" data-testid=\"option-status-ongoing\">جارية</SelectItem>\n                  <SelectItem value=\"completed\" data-testid=\"option-status-completed\">منتهية</SelectItem>\n                </SelectContent>\n              </Select>\n            ) : (\n              <Badge className={\n                tournament.status === \"registration\" ? \"bg-emerald-500\" :\n                tournament.status === \"ongoing\" ? \"bg-orange-500\" : \"bg-gray-500\"\n              }>\n                {statusLabels[tournament.status]}\n              </Badge>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>الحد الأقصى للفرق</Label>\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={formData.maxTeams}\n                onChange={(e) => setFormData({ ...formData, maxTeams: parseInt(e.target.value) })}\n                data-testid=\"input-max-teams\"\n              />\n            ) : (\n              <p className=\"font-medium\">{tournament.maxTeams} فريق</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>نقاط الفوز / التعادل / الخسارة</Label>\n            {isEditing ? (\n              <div className=\"flex gap-2\">\n                <Input\n                  type=\"number\"\n                  value={formData.pointsForWin}\n                  onChange={(e) => setFormData({ ...formData, pointsForWin: parseInt(e.target.value) })}\n                  className=\"w-16\"\n                  data-testid=\"input-points-win\"\n                />\n                <Input\n                  type=\"number\"\n                  value={formData.pointsForDraw}\n                  onChange={(e) => setFormData({ ...formData, pointsForDraw: parseInt(e.target.value) })}\n                  className=\"w-16\"\n                  data-testid=\"input-points-draw\"\n                />\n                <Input\n                  type=\"number\"\n                  value={formData.pointsForLoss}\n                  onChange={(e) => setFormData({ ...formData, pointsForLoss: parseInt(e.target.value) })}\n                  className=\"w-16\"\n                  data-testid=\"input-points-loss\"\n                />\n              </div>\n            ) : (\n              <p className=\"font-medium\">\n                {tournament.pointsForWin} / {tournament.pointsForDraw} / {tournament.pointsForLoss}\n              </p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>مدة الشوط (دقيقة)</Label>\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={formData.halfDuration}\n                onChange={(e) => setFormData({ ...formData, halfDuration: parseInt(e.target.value) })}\n                min={5}\n                max={90}\n                className=\"w-24\"\n                data-testid=\"input-half-duration\"\n              />\n            ) : (\n              <p className=\"font-medium\">{tournament.halfDuration} دقيقة</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>الفترة بين الشوطين (دقيقة)</Label>\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={formData.breakBetweenHalves}\n                onChange={(e) => setFormData({ ...formData, breakBetweenHalves: parseInt(e.target.value) })}\n                min={0}\n                max={30}\n                className=\"w-24\"\n                data-testid=\"input-break-between-halves\"\n              />\n            ) : (\n              <p className=\"font-medium\">{tournament.breakBetweenHalves} دقيقة</p>\n            )}\n          </div>\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label>الوصف</Label>\n          {isEditing ? (\n            <Textarea\n              value={formData.description}\n              onChange={(e) => setFormData({ ...formData, description: e.target.value })}\n              rows={4}\n              data-testid=\"input-description\"\n            />\n          ) : (\n            <p className=\"text-muted-foreground\">{tournament.description || \"لا يوجد وصف\"}</p>\n          )}\n        </div>\n\n        <div className=\"space-y-2\">\n          <Label className=\"flex items-center gap-2\">\n            <Trophy className=\"h-4 w-4 text-yellow-500\" />\n            صورة الكأس (للعرض في شجرة خروج المغلوب)\n          </Label>\n          <div className=\"flex items-center gap-4\">\n            {(formData.trophyImageUrl || tournament.trophyImageUrl) && (\n              <div className=\"relative\">\n                <img \n                  src={formData.trophyImageUrl || tournament.trophyImageUrl || \"\"} \n                  alt=\"صورة الكأس\" \n                  className=\"w-20 h-28 object-contain border rounded-lg bg-gradient-to-b from-yellow-400/20 to-orange-400/20\"\n                />\n                {isEditing && (\n                  <Button\n                    variant=\"destructive\"\n                    size=\"icon\"\n                    className=\"absolute -top-2 -left-2 h-6 w-6\"\n                    onClick={() => setFormData({ ...formData, trophyImageUrl: \"\" })}\n                    data-testid=\"button-remove-trophy\"\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                )}\n              </div>\n            )}\n            {isEditing && (\n              <div className=\"flex-1\">\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleTrophyUpload}\n                  disabled={uploadingTrophy}\n                  className=\"hidden\"\n                  id=\"trophy-upload\"\n                  data-testid=\"input-trophy-upload\"\n                />\n                <label htmlFor=\"trophy-upload\">\n                  <Button \n                    variant=\"outline\" \n                    asChild\n                    disabled={uploadingTrophy}\n                  >\n                    <span className=\"cursor-pointer\">\n                      {uploadingTrophy ? (\n                        <>\n                          <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                          جاري الرفع...\n                        </>\n                      ) : (\n                        <>\n                          <Plus className=\"h-4 w-4 ml-2\" />\n                          {formData.trophyImageUrl ? \"تغيير الصورة\" : \"رفع صورة الكأس\"}\n                        </>\n                      )}\n                    </span>\n                  </Button>\n                </label>\n                <p className=\"text-xs text-muted-foreground mt-2\">\n                  ستظهر صورة الكأس في منتصف شجرة خروج المغلوب\n                </p>\n              </div>\n            )}\n            {!isEditing && !tournament.trophyImageUrl && (\n              <div className=\"flex items-center gap-2 text-muted-foreground\">\n                <Trophy className=\"h-8 w-8\" />\n                <p className=\"text-sm\">لم يتم رفع صورة الكأس بعد</p>\n              </div>\n            )}\n          </div>\n        </div>\n\n        {/* صورة البطولة الرئيسية */}\n        <div className=\"space-y-2\">\n          <Label className=\"flex items-center gap-2\">\n            <Image className=\"h-4 w-4\" />\n            صورة البطولة الرئيسية\n          </Label>\n          <div className=\"flex items-center gap-4\">\n            {(formData.imageUrl || tournament.imageUrl) && (\n              <div className=\"relative\">\n                <img \n                  src={formData.imageUrl || tournament.imageUrl || \"\"} \n                  alt=\"صورة البطولة\" \n                  className=\"w-32 h-20 object-cover border rounded-lg\"\n                />\n                {isEditing && (\n                  <Button\n                    variant=\"destructive\"\n                    size=\"icon\"\n                    className=\"absolute -top-2 -left-2 h-6 w-6\"\n                    onClick={() => setFormData({ ...formData, imageUrl: \"\" })}\n                    data-testid=\"button-remove-image\"\n                  >\n                    <Trash2 className=\"h-3 w-3\" />\n                  </Button>\n                )}\n              </div>\n            )}\n            {isEditing && (\n              <div className=\"flex-1\">\n                <input\n                  type=\"file\"\n                  accept=\"image/*\"\n                  onChange={handleImageUpload}\n                  disabled={uploadingImage}\n                  className=\"hidden\"\n                  id=\"tournament-image-upload\"\n                  data-testid=\"input-image-upload\"\n                />\n                <label htmlFor=\"tournament-image-upload\">\n                  <Button \n                    variant=\"outline\" \n                    asChild\n                    disabled={uploadingImage}\n                  >\n                    <span className=\"cursor-pointer\">\n                      {uploadingImage ? (\n                        <>\n                          <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                          جاري الرفع...\n                        </>\n                      ) : (\n                        <>\n                          <Upload className=\"h-4 w-4 ml-2\" />\n                          {formData.imageUrl ? \"تغيير الصورة\" : \"رفع صورة البطولة\"}\n                        </>\n                      )}\n                    </span>\n                  </Button>\n                </label>\n              </div>\n            )}\n            {!isEditing && !tournament.imageUrl && (\n              <p className=\"text-sm text-muted-foreground\">لم يتم رفع صورة بعد</p>\n            )}\n          </div>\n        </div>\n\n        {/* نوع الدوري - فردي/فرقي */}\n        <div className=\"space-y-2\">\n          <Label>نوع الدوري</Label>\n          {isEditing ? (\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div\n                onClick={() => setFormData({ ...formData, tournamentStructure: \"individual\" })}\n                className={`cursor-pointer rounded-xl p-4 border-2 transition-all ${\n                  formData.tournamentStructure === \"individual\"\n                    ? \"border-amber-500 bg-amber-50 dark:bg-amber-950/30\"\n                    : \"border-border hover:border-amber-300\"\n                }`}\n                data-testid=\"card-structure-individual\"\n              >\n                <div className=\"flex flex-col items-center text-center gap-2\">\n                  <div className={`w-10 h-10 rounded-full flex items-center justify-center ${\n                    formData.tournamentStructure === \"individual\" \n                      ? \"bg-amber-500 text-white\" \n                      : \"bg-amber-100 dark:bg-amber-900/30 text-amber-600\"\n                  }`}>\n                    <User className=\"h-5 w-5\" />\n                  </div>\n                  <span className=\"font-bold text-sm\">فردي</span>\n                </div>\n              </div>\n              <div\n                onClick={() => setFormData({ ...formData, tournamentStructure: \"team\" })}\n                className={`cursor-pointer rounded-xl p-4 border-2 transition-all ${\n                  formData.tournamentStructure === \"team\"\n                    ? \"border-cyan-500 bg-cyan-50 dark:bg-cyan-950/30\"\n                    : \"border-border hover:border-cyan-300\"\n                }`}\n                data-testid=\"card-structure-team\"\n              >\n                <div className=\"flex flex-col items-center text-center gap-2\">\n                  <div className={`w-10 h-10 rounded-full flex items-center justify-center ${\n                    formData.tournamentStructure === \"team\" \n                      ? \"bg-cyan-500 text-white\" \n                      : \"bg-cyan-100 dark:bg-cyan-900/30 text-cyan-600\"\n                  }`}>\n                    <Users className=\"h-5 w-5\" />\n                  </div>\n                  <span className=\"font-bold text-sm\">فرقي</span>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <p className=\"font-medium\">{tournament.tournamentStructure === \"individual\" ? \"فردي\" : \"فرقي\"}</p>\n          )}\n        </div>\n\n        {/* التواريخ */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-2\">\n            <Label className=\"flex items-center gap-2\">\n              <Calendar className=\"h-4 w-4\" />\n              تاريخ البداية\n            </Label>\n            {isEditing ? (\n              <Input\n                type=\"date\"\n                value={formData.startDate}\n                onChange={(e) => setFormData({ ...formData, startDate: e.target.value })}\n                data-testid=\"input-start-date\"\n              />\n            ) : (\n              <p className=\"font-medium\">\n                {tournament.startDate \n                  ? format(new Date(tournament.startDate), \"dd/MM/yyyy\", { locale: ar })\n                  : \"غير محدد\"}\n              </p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label className=\"flex items-center gap-2\">\n              <Calendar className=\"h-4 w-4\" />\n              تاريخ النهاية\n            </Label>\n            {isEditing ? (\n              <Input\n                type=\"date\"\n                value={formData.endDate}\n                onChange={(e) => setFormData({ ...formData, endDate: e.target.value })}\n                data-testid=\"input-end-date\"\n              />\n            ) : (\n              <p className=\"font-medium\">\n                {tournament.endDate \n                  ? format(new Date(tournament.endDate), \"dd/MM/yyyy\", { locale: ar })\n                  : \"غير محدد\"}\n              </p>\n            )}\n          </div>\n        </div>\n\n        {/* معلومات الاتصال */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-2\">\n            <Label className=\"flex items-center gap-2\">\n              <Phone className=\"h-4 w-4\" />\n              رقم الهاتف\n            </Label>\n            {isEditing ? (\n              <Input\n                value={formData.phoneNumber}\n                onChange={(e) => setFormData({ ...formData, phoneNumber: e.target.value })}\n                placeholder=\"05xxxxxxxx\"\n                data-testid=\"input-phone-number\"\n              />\n            ) : (\n              <p className=\"font-medium\">{tournament.phoneNumber || \"غير محدد\"}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>السياسة</Label>\n            {isEditing ? (\n              <Select\n                value={formData.policy}\n                onValueChange={(value) => setFormData({ ...formData, policy: value })}\n              >\n                <SelectTrigger data-testid=\"select-policy\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"public\">عام</SelectItem>\n                  <SelectItem value=\"private\">خاص</SelectItem>\n                </SelectContent>\n              </Select>\n            ) : (\n              <Badge variant=\"outline\">\n                {tournament.policy === \"public\" ? \"عام\" : \"خاص\"}\n              </Badge>\n            )}\n          </div>\n        </div>\n\n        {/* العنوان */}\n        <div className=\"space-y-2\">\n          <Label className=\"flex items-center gap-2\">\n            <MapPin className=\"h-4 w-4\" />\n            العنوان\n          </Label>\n          {isEditing ? (\n            <Input\n              value={formData.address}\n              onChange={(e) => setFormData({ ...formData, address: e.target.value })}\n              placeholder=\"مدينة/حي/شارع\"\n              data-testid=\"input-address\"\n            />\n          ) : (\n            <p className=\"font-medium\">{tournament.address || \"غير محدد\"}</p>\n          )}\n        </div>\n\n        {/* عدد المجموعات والملاعب */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          {(formData.type === \"groups\" || formData.type === \"groups_knockout\") && (\n            <div className=\"space-y-2\">\n              <Label>عدد المجموعات</Label>\n              {isEditing ? (\n                <Input\n                  type=\"number\"\n                  value={formData.numberOfGroups}\n                  onChange={(e) => setFormData({ ...formData, numberOfGroups: parseInt(e.target.value) || 2 })}\n                  min={2}\n                  max={16}\n                  data-testid=\"input-number-of-groups\"\n                />\n              ) : (\n                <p className=\"font-medium\">{tournament.numberOfGroups || 2} مجموعة</p>\n              )}\n            </div>\n          )}\n\n          <div className=\"space-y-2\">\n            <Label>عدد الملاعب</Label>\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={formData.numberOfVenues}\n                onChange={(e) => setFormData({ ...formData, numberOfVenues: parseInt(e.target.value) || 1 })}\n                min={1}\n                max={20}\n                data-testid=\"input-number-of-venues\"\n              />\n            ) : (\n              <p className=\"font-medium\">{tournament.numberOfVenues || 1} ملعب</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>عدد الجولات</Label>\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={formData.numberOfRounds}\n                onChange={(e) => setFormData({ ...formData, numberOfRounds: parseInt(e.target.value) || 1 })}\n                min={1}\n                max={10}\n                data-testid=\"input-number-of-rounds\"\n              />\n            ) : (\n              <p className=\"font-medium\">{tournament.numberOfRounds || 1} جولة</p>\n            )}\n          </div>\n        </div>\n\n        {/* أسماء الملاعب */}\n        <div className=\"space-y-2\">\n          <Label>أسماء الملاعب (مفصولة بفاصلة عربية ،)</Label>\n          {isEditing ? (\n            <Input\n              value={formData.venues}\n              onChange={(e) => setFormData({ ...formData, venues: e.target.value })}\n              placeholder=\"ملعب 1، ملعب 2، ملعب 3\"\n              data-testid=\"input-venues\"\n            />\n          ) : (\n            <p className=\"font-medium\">\n              {tournament.venues?.join(\"، \") || \"غير محدد\"}\n            </p>\n          )}\n        </div>\n\n        {/* إعدادات الجدولة */}\n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"space-y-2\">\n            <Label className=\"flex items-center gap-2\">\n              <Clock className=\"h-4 w-4\" />\n              توقيت البداية اليومي\n            </Label>\n            {isEditing ? (\n              <Input\n                type=\"time\"\n                value={formData.dailyStartTime}\n                onChange={(e) => setFormData({ ...formData, dailyStartTime: e.target.value })}\n                data-testid=\"input-daily-start-time\"\n              />\n            ) : (\n              <p className=\"font-medium\">{scheduleConfig.dailyStartTime || \"16:00\"}</p>\n            )}\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>عدد المباريات/ملعب/يوم</Label>\n            {isEditing ? (\n              <Input\n                type=\"number\"\n                value={formData.matchesPerDayPerVenue}\n                onChange={(e) => setFormData({ ...formData, matchesPerDayPerVenue: parseInt(e.target.value) || 3 })}\n                min={1}\n                max={10}\n                data-testid=\"input-matches-per-venue\"\n              />\n            ) : (\n              <p className=\"font-medium\">{scheduleConfig.matchesPerDayPerVenue || 3} مباراة</p>\n            )}\n          </div>\n        </div>\n\n        {/* الأيام المستبعدة */}\n        <div className=\"space-y-2\">\n          <Label>الأيام المستبعدة من الجدولة</Label>\n          {isEditing ? (\n            <div className=\"flex flex-wrap gap-2\">\n              {daysOfWeek.map((day) => (\n                <Badge\n                  key={day.value}\n                  variant={formData.excludedDays.includes(day.value) ? \"default\" : \"outline\"}\n                  className=\"cursor-pointer\"\n                  onClick={() => toggleExcludedDay(day.value)}\n                  data-testid={`badge-day-${day.value}`}\n                >\n                  {day.label}\n                </Badge>\n              ))}\n            </div>\n          ) : (\n            <p className=\"font-medium\">\n              {tournament.excludedDays && tournament.excludedDays.length > 0\n                ? tournament.excludedDays.map(d => daysOfWeek.find(day => day.value === d)?.label).join(\"، \")\n                : \"لا يوجد أيام مستبعدة\"}\n            </p>\n          )}\n        </div>\n\n        {/* التسجيل مفتوح */}\n        <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n          <div className=\"space-y-1\">\n            <Label>التسجيل مفتوح</Label>\n            <p className=\"text-sm text-muted-foreground\">\n              السماح للفرق بالتسجيل في البطولة\n            </p>\n          </div>\n          {isEditing ? (\n            <Switch\n              checked={formData.isOpenForRegistration}\n              onCheckedChange={(checked) => setFormData({ ...formData, isOpenForRegistration: checked })}\n              data-testid=\"switch-registration\"\n            />\n          ) : (\n            <Badge variant={tournament.isOpenForRegistration ? \"default\" : \"secondary\"}>\n              {tournament.isOpenForRegistration ? \"مفتوح\" : \"مغلق\"}\n            </Badge>\n          )}\n        </div>\n\n        {/* مباراة تحديد المركز الثالث */}\n        <div className=\"flex items-center justify-between p-4 border rounded-lg\">\n          <div className=\"space-y-1\">\n            <Label>مباراة تحديد المركز الثالث</Label>\n            <p className=\"text-sm text-muted-foreground\">\n              إضافة مباراة لتحديد المركز الثالث بين خاسري الدور نصف النهائي\n            </p>\n          </div>\n          {isEditing ? (\n            <Switch\n              checked={formData.hasThirdPlaceMatch}\n              onCheckedChange={(checked) => setFormData({ ...formData, hasThirdPlaceMatch: checked })}\n              data-testid=\"switch-third-place\"\n            />\n          ) : (\n            <Badge variant={tournament.hasThirdPlaceMatch ? \"default\" : \"secondary\"}>\n              {tournament.hasThirdPlaceMatch ? \"مفعّل\" : \"غير مفعّل\"}\n            </Badge>\n          )}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n\ninterface ThemeConfig {\n  primaryColor: string;\n  secondaryColor: string;\n  useUnifiedImage: boolean;\n}\n\nconst defaultThemeColors = [\n  { name: \"أزرق\", primary: \"#2563eb\", secondary: \"#3b82f6\" },\n  { name: \"أخضر\", primary: \"#16a34a\", secondary: \"#22c55e\" },\n  { name: \"أحمر\", primary: \"#dc2626\", secondary: \"#ef4444\" },\n  { name: \"برتقالي\", primary: \"#ea580c\", secondary: \"#f97316\" },\n  { name: \"بنفسجي\", primary: \"#9333ea\", secondary: \"#a855f7\" },\n  { name: \"ذهبي\", primary: \"#ca8a04\", secondary: \"#eab308\" },\n  { name: \"وردي\", primary: \"#db2777\", secondary: \"#ec4899\" },\n  { name: \"سماوي\", primary: \"#0891b2\", secondary: \"#06b6d4\" },\n];\n\nfunction safeParseThemeConfig(config: string | null | undefined): ThemeConfig {\n  const defaultTheme: ThemeConfig = { primaryColor: \"#2563eb\", secondaryColor: \"#3b82f6\", useUnifiedImage: true };\n  if (!config) return defaultTheme;\n  try {\n    const parsed = JSON.parse(config);\n    return {\n      primaryColor: parsed.primaryColor || defaultTheme.primaryColor,\n      secondaryColor: parsed.secondaryColor || defaultTheme.secondaryColor,\n      useUnifiedImage: parsed.useUnifiedImage ?? defaultTheme.useUnifiedImage,\n    };\n  } catch {\n    return defaultTheme;\n  }\n}\n\nfunction ThemeTab({ tournament }: { tournament: Tournament }) {\n  const { toast } = useToast();\n  const [uploading, setUploading] = useState<string | null>(null);\n  \n  const existingTheme = safeParseThemeConfig(tournament.themeConfig);\n  \n  const [themeData, setThemeData] = useState({\n    primaryColor: existingTheme.primaryColor,\n    secondaryColor: existingTheme.secondaryColor,\n    useUnifiedImage: existingTheme.useUnifiedImage,\n    heroImageUrl: tournament.heroImageUrl || \"\",\n    standingsImageUrl: tournament.standingsImageUrl || \"\",\n    matchesImageUrl: tournament.matchesImageUrl || \"\",\n    teamsImageUrl: tournament.teamsImageUrl || \"\",\n    scorersImageUrl: tournament.scorersImageUrl || \"\",\n  });\n\n  const handleImageUpload = async (e: React.ChangeEvent<HTMLInputElement>, imageType: string) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n    \n    setUploading(imageType);\n    try {\n      const formDataUpload = new FormData();\n      formDataUpload.append(\"image\", file);\n      \n      const response = await fetch(\"/api/upload\", {\n        method: \"POST\",\n        body: formDataUpload,\n        credentials: \"include\",\n      });\n      \n      if (!response.ok) throw new Error(\"فشل رفع الصورة\");\n      \n      const data = await response.json();\n      setThemeData({ ...themeData, [imageType]: data.url });\n      toast({ title: \"تم رفع الصورة بنجاح\" });\n    } catch (error) {\n      toast({ title: \"فشل رفع الصورة\", variant: \"destructive\" });\n    } finally {\n      setUploading(null);\n    }\n  };\n\n  const updateMutation = useMutation({\n    mutationFn: async () => {\n      const themeConfig = JSON.stringify({\n        primaryColor: themeData.primaryColor,\n        secondaryColor: themeData.secondaryColor,\n        useUnifiedImage: themeData.useUnifiedImage,\n      });\n      return await apiRequest(\"PATCH\", `/api/tournaments/${tournament.id}`, {\n        themeConfig,\n        heroImageUrl: themeData.heroImageUrl || null,\n        standingsImageUrl: themeData.useUnifiedImage ? null : themeData.standingsImageUrl || null,\n        matchesImageUrl: themeData.useUnifiedImage ? null : themeData.matchesImageUrl || null,\n        teamsImageUrl: themeData.useUnifiedImage ? null : themeData.teamsImageUrl || null,\n        scorersImageUrl: themeData.useUnifiedImage ? null : themeData.scorersImageUrl || null,\n      });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حفظ ثيم البطولة بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournament.id] });\n    },\n    onError: () => {\n      toast({ title: \"فشل حفظ الثيم\", variant: \"destructive\" });\n    },\n  });\n\n  const applyPresetTheme = (primary: string, secondary: string) => {\n    setThemeData({ ...themeData, primaryColor: primary, secondaryColor: secondary });\n  };\n\n  const pageImages = [\n    { key: \"heroImageUrl\", label: \"صورة البانر الرئيسية\", icon: Image },\n    { key: \"standingsImageUrl\", label: \"صورة صفحة الترتيب\", icon: Trophy },\n    { key: \"matchesImageUrl\", label: \"صورة صفحة المباريات\", icon: Calendar },\n    { key: \"teamsImageUrl\", label: \"صورة صفحة الفرق\", icon: Users },\n    { key: \"scorersImageUrl\", label: \"صورة صفحة الهدافين\", icon: Target },\n  ];\n\n  return (\n    <div className=\"space-y-6\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Palette className=\"h-5 w-5\" />\n            ألوان البطولة\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          <div>\n            <Label className=\"mb-3 block\">ثيمات جاهزة</Label>\n            <div className=\"flex flex-wrap gap-3\">\n              {defaultThemeColors.map((theme) => (\n                <button\n                  key={theme.name}\n                  onClick={() => applyPresetTheme(theme.primary, theme.secondary)}\n                  className=\"flex items-center gap-2 px-3 py-2 rounded-lg border hover-elevate transition-all\"\n                  style={{ borderColor: theme.primary }}\n                  data-testid={`button-theme-${theme.name}`}\n                >\n                  <div \n                    className=\"w-6 h-6 rounded-full\" \n                    style={{ background: `linear-gradient(135deg, ${theme.primary}, ${theme.secondary})` }}\n                  />\n                  <span className=\"text-sm\">{theme.name}</span>\n                </button>\n              ))}\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            <div className=\"space-y-2\">\n              <Label>اللون الرئيسي</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  type=\"color\"\n                  value={themeData.primaryColor}\n                  onChange={(e) => setThemeData({ ...themeData, primaryColor: e.target.value })}\n                  className=\"w-16 h-10 p-1 cursor-pointer\"\n                  data-testid=\"input-primary-color\"\n                />\n                <Input\n                  value={themeData.primaryColor}\n                  onChange={(e) => setThemeData({ ...themeData, primaryColor: e.target.value })}\n                  className=\"flex-1\"\n                  placeholder=\"#2563eb\"\n                  data-testid=\"input-primary-color-text\"\n                />\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <Label>اللون الثانوي</Label>\n              <div className=\"flex gap-2\">\n                <Input\n                  type=\"color\"\n                  value={themeData.secondaryColor}\n                  onChange={(e) => setThemeData({ ...themeData, secondaryColor: e.target.value })}\n                  className=\"w-16 h-10 p-1 cursor-pointer\"\n                  data-testid=\"input-secondary-color\"\n                />\n                <Input\n                  value={themeData.secondaryColor}\n                  onChange={(e) => setThemeData({ ...themeData, secondaryColor: e.target.value })}\n                  className=\"flex-1\"\n                  placeholder=\"#3b82f6\"\n                  data-testid=\"input-secondary-color-text\"\n                />\n              </div>\n            </div>\n          </div>\n\n          <div \n            className=\"h-24 rounded-lg flex items-center justify-center text-white font-bold text-lg\"\n            style={{ background: `linear-gradient(135deg, ${themeData.primaryColor}, ${themeData.secondaryColor})` }}\n          >\n            معاينة ألوان البطولة\n          </div>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Image className=\"h-5 w-5\" />\n            صور صفحات البطولة\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          <div className=\"flex items-center gap-4 p-4 bg-muted/50 rounded-lg\">\n            <input\n              type=\"checkbox\"\n              id=\"unified-image\"\n              checked={themeData.useUnifiedImage}\n              onChange={(e) => setThemeData({ ...themeData, useUnifiedImage: e.target.checked })}\n              className=\"w-5 h-5\"\n              data-testid=\"checkbox-unified-image\"\n            />\n            <Label htmlFor=\"unified-image\" className=\"cursor-pointer\">\n              استخدام صورة واحدة لجميع الصفحات\n            </Label>\n          </div>\n\n          {themeData.useUnifiedImage ? (\n            <div className=\"space-y-3\">\n              <Label>الصورة الموحدة لجميع الصفحات</Label>\n              <div className=\"flex items-start gap-4\">\n                {themeData.heroImageUrl && (\n                  <div className=\"relative\">\n                    <img \n                      src={themeData.heroImageUrl} \n                      alt=\"صورة البطولة\" \n                      className=\"w-40 h-24 object-cover rounded-lg border\"\n                    />\n                    <Button\n                      variant=\"destructive\"\n                      size=\"icon\"\n                      className=\"absolute -top-2 -left-2 h-6 w-6\"\n                      onClick={() => setThemeData({ ...themeData, heroImageUrl: \"\" })}\n                      data-testid=\"button-remove-hero-image\"\n                    >\n                      <Trash2 className=\"h-3 w-3\" />\n                    </Button>\n                  </div>\n                )}\n                <div>\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    onChange={(e) => handleImageUpload(e, \"heroImageUrl\")}\n                    disabled={uploading === \"heroImageUrl\"}\n                    className=\"hidden\"\n                    id=\"hero-upload\"\n                    data-testid=\"input-hero-upload\"\n                  />\n                  <label htmlFor=\"hero-upload\">\n                    <Button variant=\"outline\" asChild disabled={uploading === \"heroImageUrl\"}>\n                      <span className=\"cursor-pointer\">\n                        {uploading === \"heroImageUrl\" ? (\n                          <>\n                            <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                            جاري الرفع...\n                          </>\n                        ) : (\n                          <>\n                            <Upload className=\"h-4 w-4 ml-2\" />\n                            {themeData.heroImageUrl ? \"تغيير الصورة\" : \"رفع صورة\"}\n                          </>\n                        )}\n                      </span>\n                    </Button>\n                  </label>\n                </div>\n              </div>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n              {pageImages.map((page) => (\n                <div key={page.key} className=\"space-y-3 p-4 border rounded-lg\">\n                  <Label className=\"flex items-center gap-2\">\n                    <page.icon className=\"h-4 w-4\" />\n                    {page.label}\n                  </Label>\n                  <div className=\"flex items-start gap-3\">\n                    {themeData[page.key as keyof typeof themeData] && (\n                      <div className=\"relative\">\n                        <img \n                          src={themeData[page.key as keyof typeof themeData] as string} \n                          alt={page.label} \n                          className=\"w-24 h-16 object-cover rounded border\"\n                        />\n                        <Button\n                          variant=\"destructive\"\n                          size=\"icon\"\n                          className=\"absolute -top-2 -left-2 h-5 w-5\"\n                          onClick={() => setThemeData({ ...themeData, [page.key]: \"\" })}\n                          data-testid={`button-remove-${page.key}`}\n                        >\n                          <Trash2 className=\"h-3 w-3\" />\n                        </Button>\n                      </div>\n                    )}\n                    <div>\n                      <input\n                        type=\"file\"\n                        accept=\"image/*\"\n                        onChange={(e) => handleImageUpload(e, page.key)}\n                        disabled={uploading === page.key}\n                        className=\"hidden\"\n                        id={`${page.key}-upload`}\n                        data-testid={`input-${page.key}-upload`}\n                      />\n                      <label htmlFor={`${page.key}-upload`}>\n                        <Button variant=\"outline\" size=\"sm\" asChild disabled={uploading === page.key}>\n                          <span className=\"cursor-pointer\">\n                            {uploading === page.key ? (\n                              <Loader2 className=\"h-4 w-4 animate-spin\" />\n                            ) : (\n                              <Upload className=\"h-4 w-4\" />\n                            )}\n                          </span>\n                        </Button>\n                      </label>\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <div className=\"flex justify-end\">\n        <Button \n          onClick={() => updateMutation.mutate()}\n          disabled={updateMutation.isPending}\n          size=\"lg\"\n          data-testid=\"button-save-theme\"\n        >\n          {updateMutation.isPending ? (\n            <>\n              <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n              جاري الحفظ...\n            </>\n          ) : (\n            <>\n              <Save className=\"h-4 w-4 ml-2\" />\n              حفظ ثيم البطولة\n            </>\n          )}\n        </Button>\n      </div>\n    </div>\n  );\n}\n\nfunction TeamsTab({ tournamentId, teams }: { tournamentId: string; teams: Team[] }) {\n  const { toast } = useToast();\n  const [isAddOpen, setIsAddOpen] = useState(false);\n  const [editingTeam, setEditingTeam] = useState<Team | null>(null);\n  const [dialogTab, setDialogTab] = useState<\"existing\" | \"new\">(\"existing\");\n  const [newTeam, setNewTeam] = useState({\n    name: \"\",\n    level: \"intermediate\",\n    representativeName: \"\",\n    contactPhone: \"\",\n    contactEmail: \"\",\n    description: \"\",\n    groupNumber: undefined as number | undefined,\n  });\n\n  const { data: allTeams = [], isLoading: teamsLoading } = useQuery<Team[]>({\n    queryKey: [\"/api/teams\"],\n    enabled: isAddOpen,\n  });\n\n  const availableTeams = allTeams.filter(t => t.tournamentId !== tournamentId);\n\n  const addTeamMutation = useMutation({\n    mutationFn: async (data: typeof newTeam) => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/teams`, data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم إضافة الفريق بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/teams\"] });\n      setIsAddOpen(false);\n      setNewTeam({ name: \"\", level: \"intermediate\", representativeName: \"\", contactPhone: \"\", contactEmail: \"\", description: \"\", groupNumber: undefined });\n    },\n    onError: () => {\n      toast({ title: \"فشل إضافة الفريق\", variant: \"destructive\" });\n    },\n  });\n\n  const assignTeamMutation = useMutation({\n    mutationFn: async (teamId: string) => {\n      return await apiRequest(\"PATCH\", `/api/teams/${teamId}`, { tournamentId });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تعيين الفريق للبطولة بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/teams\"] });\n      setIsAddOpen(false);\n    },\n    onError: () => {\n      toast({ title: \"فشل تعيين الفريق\", variant: \"destructive\" });\n    },\n  });\n\n  const updateTeamMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: Partial<Team> }) => {\n      return await apiRequest(\"PATCH\", `/api/teams/${id}`, data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تحديث الفريق بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n      setEditingTeam(null);\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث الفريق\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteTeamMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/teams/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حذف الفريق\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل حذف الفريق\", variant: \"destructive\" });\n    },\n  });\n\n  return (\n    <Card>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <Users className=\"h-5 w-5\" />\n          الفرق المشاركة ({teams.length})\n        </CardTitle>\n        <Dialog open={isAddOpen} onOpenChange={(open) => {\n          setIsAddOpen(open);\n          if (!open) {\n            setDialogTab(\"existing\");\n          }\n        }}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-add-team\">\n              <Plus className=\"h-4 w-4 ml-2\" />\n              إضافة فريق\n            </Button>\n          </DialogTrigger>\n          <DialogContent dir=\"rtl\" className=\"max-w-2xl\">\n            <DialogHeader>\n              <DialogTitle>إضافة فريق</DialogTitle>\n            </DialogHeader>\n            <Tabs value={dialogTab} onValueChange={(v) => setDialogTab(v as \"existing\" | \"new\")} className=\"mt-4\">\n              <TabsList className=\"grid w-full grid-cols-2\">\n                <TabsTrigger value=\"existing\" data-testid=\"tab-add-existing-team\">\n                  <Users className=\"h-4 w-4 ml-2\" />\n                  إضافة فريق موجود\n                </TabsTrigger>\n                <TabsTrigger value=\"new\" data-testid=\"tab-create-new-team\">\n                  <Plus className=\"h-4 w-4 ml-2\" />\n                  إنشاء فريق جديد\n                </TabsTrigger>\n              </TabsList>\n              \n              <TabsContent value=\"existing\" className=\"mt-4\">\n                {teamsLoading ? (\n                  <div className=\"flex items-center justify-center py-8\">\n                    <Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n                  </div>\n                ) : availableTeams.length > 0 ? (\n                  <div className=\"space-y-2 max-h-[400px] overflow-y-auto\">\n                    {availableTeams.map((team) => (\n                      <div \n                        key={team.id}\n                        className=\"flex items-center justify-between p-3 border rounded-lg hover-elevate\"\n                        data-testid={`available-team-${team.id}`}\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <div className=\"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center\">\n                            <Shield className=\"h-5 w-5 text-primary\" />\n                          </div>\n                          <div>\n                            <p className=\"font-medium\">{team.name}</p>\n                            <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                              {team.representativeName && (\n                                <span className=\"flex items-center gap-1\">\n                                  <User className=\"h-3 w-3\" />\n                                  {team.representativeName}\n                                </span>\n                              )}\n                              {team.level && (\n                                <Badge variant=\"outline\" className=\"text-xs\">\n                                  {levelLabels[team.level] || team.level}\n                                </Badge>\n                              )}\n                            </div>\n                          </div>\n                        </div>\n                        <Button\n                          size=\"sm\"\n                          onClick={() => assignTeamMutation.mutate(team.id)}\n                          disabled={assignTeamMutation.isPending}\n                          data-testid={`button-assign-team-${team.id}`}\n                        >\n                          {assignTeamMutation.isPending ? (\n                            <Loader2 className=\"h-4 w-4 animate-spin\" />\n                          ) : (\n                            <>\n                              <Plus className=\"h-4 w-4 ml-1\" />\n                              إضافة\n                            </>\n                          )}\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 text-muted-foreground\">\n                    <Users className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n                    <p>لا توجد فرق متاحة للإضافة</p>\n                    <p className=\"text-sm mt-2\">يمكنك إنشاء فريق جديد من التبويب الآخر</p>\n                  </div>\n                )}\n              </TabsContent>\n              \n              <TabsContent value=\"new\" className=\"mt-4\">\n                <div className=\"space-y-4\">\n                  <div className=\"space-y-2\">\n                    <Label>اسم الفريق *</Label>\n                    <Input\n                      value={newTeam.name}\n                      onChange={(e) => setNewTeam({ ...newTeam, name: e.target.value })}\n                      placeholder=\"أدخل اسم الفريق\"\n                      data-testid=\"input-new-team-name\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>المستوى</Label>\n                    <Select\n                      value={newTeam.level}\n                      onValueChange={(value) => setNewTeam({ ...newTeam, level: value })}\n                    >\n                      <SelectTrigger data-testid=\"select-team-level\">\n                        <SelectValue />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"beginner\" data-testid=\"option-team-level-beginner\">مبتدئ</SelectItem>\n                        <SelectItem value=\"intermediate\" data-testid=\"option-team-level-intermediate\">متوسط</SelectItem>\n                        <SelectItem value=\"advanced\" data-testid=\"option-team-level-advanced\">متقدم</SelectItem>\n                        <SelectItem value=\"professional\" data-testid=\"option-team-level-professional\">محترف</SelectItem>\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>الممثل</Label>\n                    <Input\n                      value={newTeam.representativeName}\n                      onChange={(e) => setNewTeam({ ...newTeam, representativeName: e.target.value })}\n                      placeholder=\"اسم ممثل الفريق\"\n                      data-testid=\"input-team-representative\"\n                    />\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>المجموعة (اختياري)</Label>\n                    <Select\n                      value={newTeam.groupNumber ? groupLetterMap[newTeam.groupNumber] : \"none\"}\n                      onValueChange={(value) => setNewTeam({ ...newTeam, groupNumber: value === \"none\" ? undefined : letterToNumberMap[value] })}\n                    >\n                      <SelectTrigger data-testid=\"select-team-group\">\n                        <SelectValue placeholder=\"اختر المجموعة\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"none\" data-testid=\"option-team-group-none\">بدون مجموعة</SelectItem>\n                        {availableGroupLetters.map((letter) => (\n                          <SelectItem key={letter} value={letter} data-testid={`option-team-group-${letter}`}>\n                            المجموعة {letter}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label>رقم الهاتف</Label>\n                      <Input\n                        value={newTeam.contactPhone}\n                        onChange={(e) => setNewTeam({ ...newTeam, contactPhone: e.target.value })}\n                        placeholder=\"05xxxxxxxx\"\n                        data-testid=\"input-team-phone\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>البريد الإلكتروني</Label>\n                      <Input\n                        type=\"email\"\n                        value={newTeam.contactEmail}\n                        onChange={(e) => setNewTeam({ ...newTeam, contactEmail: e.target.value })}\n                        placeholder=\"email@example.com\"\n                        data-testid=\"input-team-email\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"flex justify-end gap-2 pt-4\">\n                    <DialogClose asChild>\n                      <Button variant=\"outline\" data-testid=\"button-cancel-add-team\">إلغاء</Button>\n                    </DialogClose>\n                    <Button \n                      onClick={() => addTeamMutation.mutate(newTeam)}\n                      disabled={!newTeam.name.trim() || addTeamMutation.isPending}\n                      data-testid=\"button-submit-team\"\n                    >\n                      {addTeamMutation.isPending ? \"جاري الإضافة...\" : \"إضافة الفريق\"}\n                    </Button>\n                  </div>\n                </div>\n              </TabsContent>\n            </Tabs>\n          </DialogContent>\n        </Dialog>\n      </CardHeader>\n      <CardContent>\n        {teams.length > 0 ? (\n          <Table>\n            <TableHeader>\n              <TableRow>\n                <TableHead className=\"text-right\">#</TableHead>\n                <TableHead className=\"text-right\">الفريق</TableHead>\n                <TableHead className=\"text-center\">المجموعة</TableHead>\n                <TableHead className=\"text-right\">المستوى</TableHead>\n                <TableHead className=\"text-right\">الممثل</TableHead>\n                <TableHead className=\"text-center\">لعب</TableHead>\n                <TableHead className=\"text-center\">فاز</TableHead>\n                <TableHead className=\"text-center\">نقاط</TableHead>\n                <TableHead className=\"text-center\">إجراءات</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {teams.map((team, index) => (\n                <TableRow key={team.id} data-testid={`row-team-${team.id}`}>\n                  <TableCell>{index + 1}</TableCell>\n                  <TableCell className=\"font-medium\">{team.name}</TableCell>\n                  <TableCell className=\"text-center\">\n                    <Select\n                      value={team.groupNumber ? groupLetterMap[team.groupNumber] : \"none\"}\n                      onValueChange={(value) => {\n                        const groupNumber = value === \"none\" ? 0 : letterToNumberMap[value];\n                        updateTeamMutation.mutate({ id: team.id, data: { groupNumber } });\n                      }}\n                    >\n                      <SelectTrigger className=\"w-24 h-8\" data-testid={`select-team-group-inline-${team.id}`}>\n                        <SelectValue placeholder=\"-\" />\n                      </SelectTrigger>\n                      <SelectContent>\n                        <SelectItem value=\"none\">-</SelectItem>\n                        {availableGroupLetters.map((letter) => (\n                          <SelectItem key={letter} value={letter}>\n                            {letter}\n                          </SelectItem>\n                        ))}\n                      </SelectContent>\n                    </Select>\n                  </TableCell>\n                  <TableCell>\n                    <Badge variant=\"outline\">\n                      {levelLabels[team.level || \"intermediate\"] || team.level}\n                    </Badge>\n                  </TableCell>\n                  <TableCell>{team.representativeName || \"-\"}</TableCell>\n                  <TableCell className=\"text-center\">{team.played}</TableCell>\n                  <TableCell className=\"text-center text-emerald-500\">{team.won}</TableCell>\n                  <TableCell className=\"text-center font-bold\">{team.points}</TableCell>\n                  <TableCell>\n                    <div className=\"flex justify-center gap-2\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        onClick={() => setEditingTeam(team)}\n                        data-testid={`button-edit-team-${team.id}`}\n                      >\n                        <Pencil className=\"h-4 w-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        className=\"text-destructive\"\n                        onClick={() => deleteTeamMutation.mutate(team.id)}\n                        data-testid={`button-delete-team-${team.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n        ) : (\n          <div className=\"text-center py-12 text-muted-foreground\">\n            <Users className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n            <p>لم يتم تسجيل أي فرق بعد</p>\n          </div>\n        )}\n      </CardContent>\n\n      {editingTeam && (\n        <EditTeamDialog \n          team={editingTeam} \n          onClose={() => setEditingTeam(null)}\n          onSave={(data) => updateTeamMutation.mutate({ id: editingTeam.id, data })}\n          isPending={updateTeamMutation.isPending}\n        />\n      )}\n    </Card>\n  );\n}\n\nfunction EditTeamDialog({ \n  team, \n  onClose, \n  onSave, \n  isPending \n}: { \n  team: Team; \n  onClose: () => void; \n  onSave: (data: Partial<Team>) => void;\n  isPending: boolean;\n}) {\n  const [formData, setFormData] = useState({\n    name: team.name,\n    level: team.level || \"intermediate\",\n    representativeName: team.representativeName || \"\",\n    contactPhone: team.contactPhone || \"\",\n    contactEmail: team.contactEmail || \"\",\n    groupNumber: team.groupNumber || undefined,\n    primaryJersey: team.primaryJersey || \"\",\n  });\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent dir=\"rtl\">\n        <DialogHeader>\n          <DialogTitle>تعديل الفريق</DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label>اسم الفريق</Label>\n            <Input\n              value={formData.name}\n              onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n              data-testid=\"input-edit-team-name\"\n            />\n          </div>\n          <div className=\"space-y-2\">\n            <Label>المستوى</Label>\n            <Select\n              value={formData.level}\n              onValueChange={(value) => setFormData({ ...formData, level: value })}\n            >\n              <SelectTrigger data-testid=\"select-edit-team-level\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"beginner\" data-testid=\"option-edit-team-level-beginner\">مبتدئ</SelectItem>\n                <SelectItem value=\"intermediate\" data-testid=\"option-edit-team-level-intermediate\">متوسط</SelectItem>\n                <SelectItem value=\"advanced\" data-testid=\"option-edit-team-level-advanced\">متقدم</SelectItem>\n                <SelectItem value=\"professional\" data-testid=\"option-edit-team-level-professional\">محترف</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n          <div className=\"space-y-2\">\n            <Label>المجموعة</Label>\n            <Select\n              value={formData.groupNumber ? groupLetterMap[formData.groupNumber] : \"none\"}\n              onValueChange={(value) => setFormData({ ...formData, groupNumber: value === \"none\" ? 0 : letterToNumberMap[value] })}\n            >\n              <SelectTrigger data-testid=\"select-edit-team-group\">\n                <SelectValue placeholder=\"اختر المجموعة\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"none\">بدون مجموعة</SelectItem>\n                {availableGroupLetters.map((letter) => (\n                  <SelectItem key={letter} value={letter}>\n                    المجموعة {letter}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n          <TeamColorPicker\n            value={formData.primaryJersey}\n            onChange={(color) => setFormData({ ...formData, primaryJersey: color })}\n            label=\"لون القميص الأساسي\"\n          />\n          <div className=\"space-y-2\">\n            <Label>الممثل</Label>\n            <Input\n              value={formData.representativeName}\n              onChange={(e) => setFormData({ ...formData, representativeName: e.target.value })}\n              data-testid=\"input-edit-team-rep\"\n            />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>الهاتف</Label>\n              <Input\n                value={formData.contactPhone}\n                onChange={(e) => setFormData({ ...formData, contactPhone: e.target.value })}\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>البريد</Label>\n              <Input\n                type=\"email\"\n                value={formData.contactEmail}\n                onChange={(e) => setFormData({ ...formData, contactEmail: e.target.value })}\n              />\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose} data-testid=\"button-cancel-edit-team\">إلغاء</Button>\n          <Button onClick={() => onSave(formData)} disabled={isPending} data-testid=\"button-save-team\">\n            {isPending ? \"جاري الحفظ...\" : \"حفظ التغييرات\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction RefereesTab({ tournamentId, referees }: { tournamentId: string; referees: Referee[] }) {\n  const { toast } = useToast();\n  const [isAddOpen, setIsAddOpen] = useState(false);\n  const [editingReferee, setEditingReferee] = useState<Referee | null>(null);\n  const [newReferee, setNewReferee] = useState({\n    name: \"\",\n    phone: \"\",\n    email: \"\",\n    level: \"intermediate\",\n    specialization: \"main\",\n    notes: \"\",\n  });\n\n  const addRefereeMutation = useMutation({\n    mutationFn: async (data: typeof newReferee) => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/referees`, data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم إضافة الحكم بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"referees\"] });\n      setIsAddOpen(false);\n      setNewReferee({ name: \"\", phone: \"\", email: \"\", level: \"intermediate\", specialization: \"main\", notes: \"\" });\n    },\n    onError: () => {\n      toast({ title: \"فشل إضافة الحكم\", variant: \"destructive\" });\n    },\n  });\n\n  const updateRefereeMutation = useMutation({\n    mutationFn: async ({ id, data }: { id: string; data: Partial<Referee> }) => {\n      return await apiRequest(\"PATCH\", `/api/referees/${id}`, data);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم تحديث الحكم بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"referees\"] });\n      setEditingReferee(null);\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث الحكم\", variant: \"destructive\" });\n    },\n  });\n\n  const deleteRefereeMutation = useMutation({\n    mutationFn: async (id: string) => {\n      return await apiRequest(\"DELETE\", `/api/referees/${id}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حذف الحكم\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"referees\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل حذف الحكم\", variant: \"destructive\" });\n    },\n  });\n\n  return (\n    <Card>\n      <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n        <CardTitle className=\"flex items-center gap-2\">\n          <Gavel className=\"h-5 w-5\" />\n          الحكام ({referees.length})\n        </CardTitle>\n        <Dialog open={isAddOpen} onOpenChange={setIsAddOpen}>\n          <DialogTrigger asChild>\n            <Button data-testid=\"button-add-referee\">\n              <Plus className=\"h-4 w-4 ml-2\" />\n              إضافة حكم\n            </Button>\n          </DialogTrigger>\n          <DialogContent dir=\"rtl\">\n            <DialogHeader>\n              <DialogTitle>إضافة حكم جديد</DialogTitle>\n            </DialogHeader>\n            <div className=\"space-y-4 py-4\">\n              <div className=\"space-y-2\">\n                <Label>اسم الحكم *</Label>\n                <Input\n                  value={newReferee.name}\n                  onChange={(e) => setNewReferee({ ...newReferee, name: e.target.value })}\n                  placeholder=\"أدخل اسم الحكم\"\n                  data-testid=\"input-referee-name\"\n                />\n              </div>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>المستوى</Label>\n                  <Select\n                    value={newReferee.level}\n                    onValueChange={(value) => setNewReferee({ ...newReferee, level: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-referee-level\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"beginner\" data-testid=\"option-referee-level-beginner\">مبتدئ</SelectItem>\n                      <SelectItem value=\"intermediate\" data-testid=\"option-referee-level-intermediate\">متوسط</SelectItem>\n                      <SelectItem value=\"advanced\" data-testid=\"option-referee-level-advanced\">متقدم</SelectItem>\n                      <SelectItem value=\"fifa\" data-testid=\"option-referee-level-fifa\">دولي (FIFA)</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>التخصص</Label>\n                  <Select\n                    value={newReferee.specialization}\n                    onValueChange={(value) => setNewReferee({ ...newReferee, specialization: value })}\n                  >\n                    <SelectTrigger data-testid=\"select-referee-spec\">\n                      <SelectValue />\n                    </SelectTrigger>\n                    <SelectContent>\n                      <SelectItem value=\"main\" data-testid=\"option-referee-spec-main\">حكم رئيسي</SelectItem>\n                      <SelectItem value=\"assistant\" data-testid=\"option-referee-spec-assistant\">حكم مساعد</SelectItem>\n                      <SelectItem value=\"var\" data-testid=\"option-referee-spec-var\">حكم الفيديو</SelectItem>\n                    </SelectContent>\n                  </Select>\n                </div>\n              </div>\n              <div className=\"grid grid-cols-2 gap-4\">\n                <div className=\"space-y-2\">\n                  <Label>رقم الهاتف</Label>\n                  <Input\n                    value={newReferee.phone}\n                    onChange={(e) => setNewReferee({ ...newReferee, phone: e.target.value })}\n                    placeholder=\"05xxxxxxxx\"\n                    data-testid=\"input-referee-phone\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label>البريد الإلكتروني</Label>\n                  <Input\n                    type=\"email\"\n                    value={newReferee.email}\n                    onChange={(e) => setNewReferee({ ...newReferee, email: e.target.value })}\n                    placeholder=\"email@example.com\"\n                    data-testid=\"input-referee-email\"\n                  />\n                </div>\n              </div>\n              <div className=\"space-y-2\">\n                <Label>ملاحظات</Label>\n                <Textarea\n                  value={newReferee.notes}\n                  onChange={(e) => setNewReferee({ ...newReferee, notes: e.target.value })}\n                  placeholder=\"ملاحظات إضافية\"\n                  data-testid=\"input-referee-notes\"\n                />\n              </div>\n            </div>\n            <DialogFooter>\n              <DialogClose asChild>\n                <Button variant=\"outline\" data-testid=\"button-cancel-add-referee\">إلغاء</Button>\n              </DialogClose>\n              <Button \n                onClick={() => addRefereeMutation.mutate(newReferee)}\n                disabled={!newReferee.name.trim() || addRefereeMutation.isPending}\n                data-testid=\"button-submit-referee\"\n              >\n                {addRefereeMutation.isPending ? \"جاري الإضافة...\" : \"إضافة\"}\n              </Button>\n            </DialogFooter>\n          </DialogContent>\n        </Dialog>\n      </CardHeader>\n      <CardContent>\n        {referees.length > 0 ? (\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n            {referees.map((referee) => (\n              <Card key={referee.id} className=\"hover-elevate\" data-testid={`card-referee-${referee.id}`}>\n                <CardContent className=\"p-4\">\n                  <div className=\"flex items-start justify-between mb-3\">\n                    <div className=\"flex items-center gap-3\">\n                      <div className=\"w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center\">\n                        <Gavel className=\"h-6 w-6 text-primary\" />\n                      </div>\n                      <div>\n                        <h4 className=\"font-bold\">{referee.name}</h4>\n                        <Badge variant=\"outline\" className=\"text-xs\">\n                          {specializationLabels[referee.specialization || \"main\"]}\n                        </Badge>\n                      </div>\n                    </div>\n                    <div className=\"flex gap-1\">\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        onClick={() => setEditingReferee(referee)}\n                        data-testid={`button-edit-referee-${referee.id}`}\n                      >\n                        <Pencil className=\"h-4 w-4\" />\n                      </Button>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        className=\"text-destructive\"\n                        onClick={() => deleteRefereeMutation.mutate(referee.id)}\n                        data-testid={`button-delete-referee-${referee.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  <div className=\"space-y-2 text-sm text-muted-foreground\">\n                    <Badge className=\"ml-2\">\n                      {levelLabels[referee.level || \"intermediate\"]}\n                    </Badge>\n                    {referee.phone && (\n                      <div className=\"flex items-center gap-2\">\n                        <Phone className=\"h-3 w-3\" />\n                        <span>{referee.phone}</span>\n                      </div>\n                    )}\n                    {referee.email && (\n                      <div className=\"flex items-center gap-2\">\n                        <Mail className=\"h-3 w-3\" />\n                        <span>{referee.email}</span>\n                      </div>\n                    )}\n                    <div className=\"flex items-center gap-2\">\n                      <Trophy className=\"h-3 w-3\" />\n                      <span>{referee.matchesRefereed} مباراة</span>\n                    </div>\n                  </div>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : (\n          <div className=\"text-center py-12 text-muted-foreground\">\n            <Gavel className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n            <p>لم يتم إضافة أي حكام بعد</p>\n          </div>\n        )}\n      </CardContent>\n\n      {editingReferee && (\n        <EditRefereeDialog \n          referee={editingReferee} \n          onClose={() => setEditingReferee(null)}\n          onSave={(data) => updateRefereeMutation.mutate({ id: editingReferee.id, data })}\n          isPending={updateRefereeMutation.isPending}\n        />\n      )}\n    </Card>\n  );\n}\n\nfunction EditRefereeDialog({ \n  referee, \n  onClose, \n  onSave, \n  isPending \n}: { \n  referee: Referee; \n  onClose: () => void; \n  onSave: (data: Partial<Referee>) => void;\n  isPending: boolean;\n}) {\n  const [formData, setFormData] = useState({\n    name: referee.name,\n    phone: referee.phone || \"\",\n    email: referee.email || \"\",\n    level: referee.level || \"intermediate\",\n    specialization: referee.specialization || \"main\",\n    notes: referee.notes || \"\",\n  });\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent dir=\"rtl\">\n        <DialogHeader>\n          <DialogTitle>تعديل الحكم</DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-4 py-4\">\n          <div className=\"space-y-2\">\n            <Label>اسم الحكم</Label>\n            <Input\n              value={formData.name}\n              onChange={(e) => setFormData({ ...formData, name: e.target.value })}\n              data-testid=\"input-edit-referee-name\"\n            />\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>المستوى</Label>\n              <Select\n                value={formData.level}\n                onValueChange={(value) => setFormData({ ...formData, level: value })}\n              >\n                <SelectTrigger data-testid=\"select-edit-referee-level\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"beginner\" data-testid=\"option-edit-referee-level-beginner\">مبتدئ</SelectItem>\n                  <SelectItem value=\"intermediate\" data-testid=\"option-edit-referee-level-intermediate\">متوسط</SelectItem>\n                  <SelectItem value=\"advanced\" data-testid=\"option-edit-referee-level-advanced\">متقدم</SelectItem>\n                  <SelectItem value=\"fifa\" data-testid=\"option-edit-referee-level-fifa\">دولي (FIFA)</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>التخصص</Label>\n              <Select\n                value={formData.specialization}\n                onValueChange={(value) => setFormData({ ...formData, specialization: value })}\n              >\n                <SelectTrigger data-testid=\"select-edit-referee-spec\">\n                  <SelectValue />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"main\" data-testid=\"option-edit-referee-spec-main\">حكم رئيسي</SelectItem>\n                  <SelectItem value=\"assistant\" data-testid=\"option-edit-referee-spec-assistant\">حكم مساعد</SelectItem>\n                  <SelectItem value=\"var\" data-testid=\"option-edit-referee-spec-var\">حكم الفيديو</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>الهاتف</Label>\n              <Input\n                value={formData.phone}\n                onChange={(e) => setFormData({ ...formData, phone: e.target.value })}\n                data-testid=\"input-edit-referee-phone\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>البريد</Label>\n              <Input\n                type=\"email\"\n                value={formData.email}\n                onChange={(e) => setFormData({ ...formData, email: e.target.value })}\n                data-testid=\"input-edit-referee-email\"\n              />\n            </div>\n          </div>\n          <div className=\"space-y-2\">\n            <Label>ملاحظات</Label>\n            <Textarea\n              value={formData.notes}\n              onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n              data-testid=\"input-edit-referee-notes\"\n            />\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose} data-testid=\"button-cancel-edit-referee\">إلغاء</Button>\n          <Button onClick={() => onSave(formData)} disabled={isPending} data-testid=\"button-save-referee\">\n            {isPending ? \"جاري الحفظ...\" : \"حفظ التغييرات\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\nfunction MatchesTab({ \n  tournamentId, \n  tournament,\n  matches, \n  teams \n}: { \n  tournamentId: string; \n  tournament: Tournament;\n  matches: MatchWithTeams[]; \n  teams: Team[];\n}) {\n  const { toast } = useToast();\n  const [expandedMatchId, setExpandedMatchId] = useState<string | null>(null);\n  const [editingDataMap, setEditingDataMap] = useState<Record<string, Record<string, any>>>({});\n  const [isAddMatchOpen, setIsAddMatchOpen] = useState(false);\n  const [isGenerateOpen, setIsGenerateOpen] = useState(false);\n  \n  // Parse tournament schedule config and sync with state\n  const [scheduleConfig, setScheduleConfig] = useState({\n    matchesPerDay: 2,\n    dailyStartTime: \"16:00\",\n  });\n  \n  // Sync scheduleConfig when tournament changes\n  useEffect(() => {\n    const config = tournament.scheduleConfig \n      ? JSON.parse(tournament.scheduleConfig) \n      : { dailyStartTime: \"16:00\", matchesPerDayPerVenue: 3 };\n    setScheduleConfig({\n      matchesPerDay: config.matchesPerDayPerVenue || config.matchesPerDay || 2,\n      dailyStartTime: config.dailyStartTime || \"16:00\",\n    });\n  }, [tournament.scheduleConfig]);\n  const [newMatch, setNewMatch] = useState({\n    homeTeamId: \"\",\n    awayTeamId: \"\",\n    round: 1,\n    matchDate: \"\",\n    venue: \"\",\n  });\n\n  const getMatchEditingData = (matchId: string) => editingDataMap[matchId] || {};\n  \n  const setMatchEditingData = (matchId: string, data: Record<string, any>) => {\n    setEditingDataMap(prev => ({ ...prev, [matchId]: data }));\n  };\n  \n  const updateMatchField = (matchId: string, field: string, value: any) => {\n    setEditingDataMap(prev => ({\n      ...prev,\n      [matchId]: { ...prev[matchId], [field]: value }\n    }));\n  };\n\n  const toggleMatchExpand = (match: MatchWithTeams) => {\n    if (expandedMatchId === match.id) {\n      setExpandedMatchId(null);\n    } else {\n      setExpandedMatchId(match.id);\n      if (!editingDataMap[match.id]) {\n        let dateStr = \"\";\n        let timeStr = \"\";\n        if (match.matchDate) {\n          const isoDate = typeof match.matchDate === 'string' \n            ? match.matchDate \n            : new Date(match.matchDate).toISOString();\n          const parts = isoDate.split('T');\n          dateStr = parts[0];\n          timeStr = parts[1] ? parts[1].slice(0, 5) : \"\";\n        }\n        setMatchEditingData(match.id, {\n          homeTeamId: match.homeTeamId || \"\",\n          awayTeamId: match.awayTeamId || \"\",\n          matchDate: dateStr,\n          matchTime: timeStr,\n          homeScore: match.homeScore ?? 0,\n          awayScore: match.awayScore ?? 0,\n          status: match.status,\n          venue: match.venue || \"\",\n          referee: match.referee || \"\",\n          round: match.round || 1,\n        });\n      }\n    }\n  };\n\n  const updateMatchMutation = useMutation({\n    mutationFn: async ({ matchId, data }: { matchId: string; data: any }) => {\n      return await apiRequest(\"PATCH\", `/api/matches/${matchId}`, data);\n    },\n    onSuccess: (_, variables) => {\n      toast({ title: \"تم تحديث نتيجة المباراة\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"matches\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n      setExpandedMatchId(null);\n      setEditingDataMap(prev => {\n        const next = { ...prev };\n        delete next[variables.matchId];\n        return next;\n      });\n    },\n    onError: () => {\n      toast({ title: \"فشل تحديث النتيجة\", variant: \"destructive\" });\n    },\n  });\n\n  const handleSaveMatch = (matchId: string) => {\n    const data = getMatchEditingData(matchId);\n    let matchDateISO: string | null = null;\n    if (data.matchDate) {\n      const dateStr = data.matchDate;\n      const timeStr = data.matchTime || \"00:00\";\n      matchDateISO = `${dateStr}T${timeStr}:00.000Z`;\n    }\n    updateMatchMutation.mutate({ \n      matchId, \n      data: { ...data, matchDate: matchDateISO }\n    });\n  };\n\n  const generateMatchesMutation = useMutation({\n    mutationFn: async (config: typeof scheduleConfig) => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/generate-matches`, config);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم توليد جدول المباريات بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"matches\"] });\n      setIsGenerateOpen(false);\n    },\n    onError: () => {\n      toast({ title: \"فشل توليد جدول المباريات\", variant: \"destructive\" });\n    },\n  });\n\n  const addMatchMutation = useMutation({\n    mutationFn: async (data: typeof newMatch) => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/matches`, {\n        ...data,\n        matchDate: data.matchDate ? new Date(data.matchDate).toISOString() : null,\n      });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم إضافة المباراة بنجاح\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"matches\"] });\n      setIsAddMatchOpen(false);\n      setNewMatch({ homeTeamId: \"\", awayTeamId: \"\", round: 1, matchDate: \"\", venue: \"\" });\n    },\n    onError: (error: Error) => {\n      toast({ \n        title: \"فشل إضافة المباراة\", \n        description: error.message || \"حدث خطأ أثناء إضافة المباراة\",\n        variant: \"destructive\" \n      });\n    },\n  });\n\n  const deleteMatchMutation = useMutation({\n    mutationFn: async (matchId: string) => {\n      return await apiRequest(\"DELETE\", `/api/matches/${matchId}`);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم حذف المباراة\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"matches\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل حذف المباراة\", variant: \"destructive\" });\n    },\n  });\n\n  const scheduledMatches = matches\n    .filter(m => m.status === \"scheduled\" || m.status === \"live\")\n    .sort((a, b) => {\n      const dateA = a.matchDate ? new Date(a.matchDate).getTime() : 0;\n      const dateB = b.matchDate ? new Date(b.matchDate).getTime() : 0;\n      return dateA - dateB;\n    });\n  const completedMatches = matches\n    .filter(m => m.status === \"completed\")\n    .sort((a, b) => {\n      const dateA = a.matchDate ? new Date(a.matchDate).getTime() : 0;\n      const dateB = b.matchDate ? new Date(b.matchDate).getTime() : 0;\n      return dateB - dateA;\n    });\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Actions Card */}\n      <Card>\n        <CardHeader className=\"flex flex-row items-center justify-between gap-4\">\n          <CardTitle className=\"flex items-center gap-2\">\n            <Trophy className=\"h-5 w-5\" />\n            إدارة المباريات\n          </CardTitle>\n          <div className=\"flex gap-2\">\n            <Dialog open={isGenerateOpen} onOpenChange={setIsGenerateOpen}>\n              <DialogTrigger asChild>\n                <Button \n                  variant=\"outline\"\n                  disabled={teams.length < 2}\n                  data-testid=\"button-generate-matches\"\n                >\n                  <Calendar className=\"h-4 w-4 ml-2\" />\n                  توليد جدول المباريات\n                </Button>\n              </DialogTrigger>\n              <DialogContent dir=\"rtl\">\n                <DialogHeader>\n                  <DialogTitle>إعدادات توليد جدول المباريات</DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4 py-4\">\n                  {/* Warning if matches already exist */}\n                  {matches.length > 0 && (\n                    <div className=\"bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 text-red-800 dark:text-red-200 p-3 rounded-lg text-sm\">\n                      <strong>تحذير:</strong> يوجد {matches.length} مباراة حالياً. سيتم حذف جميع المباريات الموجودة وإعادة توليدها من جديد!\n                    </div>\n                  )}\n                  {/* Tournament Info */}\n                  <div className=\"bg-muted p-3 rounded-lg text-sm space-y-1\">\n                    <p className=\"font-semibold mb-2\">معلومات البطولة:</p>\n                    <p><strong>تاريخ البداية:</strong> {tournament.startDate ? format(new Date(tournament.startDate), \"yyyy/MM/dd\", { locale: ar }) : \"غير محدد\"}</p>\n                    <p><strong>تاريخ النهاية:</strong> {tournament.endDate ? format(new Date(tournament.endDate), \"yyyy/MM/dd\", { locale: ar }) : \"غير محدد\"}</p>\n                    <p><strong>عدد الفرق:</strong> {teams.length}</p>\n                    <p><strong>عدد المباريات المتوقع:</strong> {teams.length * (teams.length - 1) / 2}</p>\n                    {tournament.venues && tournament.venues.length > 0 && (\n                      <p><strong>الملاعب:</strong> {tournament.venues.join(\"، \")}</p>\n                    )}\n                  </div>\n                  \n                  {(!tournament.startDate || !tournament.endDate) && (\n                    <div className=\"bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-200 p-3 rounded-lg text-sm\">\n                      تنبيه: يرجى تحديد تاريخ البداية والنهاية من تبويب \"المعلومات\" أولاً\n                    </div>\n                  )}\n                  \n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label>عدد المباريات في اليوم</Label>\n                      <Input\n                        type=\"number\"\n                        min={1}\n                        max={10}\n                        value={scheduleConfig.matchesPerDay}\n                        onChange={(e) => setScheduleConfig({ ...scheduleConfig, matchesPerDay: parseInt(e.target.value) || 2 })}\n                        data-testid=\"input-matches-per-day\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>وقت بداية المباريات</Label>\n                      <Input\n                        type=\"time\"\n                        value={scheduleConfig.dailyStartTime}\n                        onChange={(e) => setScheduleConfig({ ...scheduleConfig, dailyStartTime: e.target.value })}\n                        data-testid=\"input-daily-start-time\"\n                      />\n                    </div>\n                  </div>\n                </div>\n                <DialogFooter>\n                  <Button \n                    variant=\"outline\" \n                    onClick={() => setIsGenerateOpen(false)}\n                    data-testid=\"button-cancel-generate\"\n                  >\n                    إلغاء\n                  </Button>\n                  <Button \n                    onClick={() => generateMatchesMutation.mutate(scheduleConfig)}\n                    disabled={generateMatchesMutation.isPending}\n                    data-testid=\"button-submit-generate\"\n                  >\n                    {generateMatchesMutation.isPending ? (\n                      <>\n                        <Loader2 className=\"h-4 w-4 ml-2 animate-spin\" />\n                        جاري التوليد...\n                      </>\n                    ) : (\n                      \"توليد المباريات\"\n                    )}\n                  </Button>\n                </DialogFooter>\n              </DialogContent>\n            </Dialog>\n            <Dialog open={isAddMatchOpen} onOpenChange={setIsAddMatchOpen}>\n              <DialogTrigger asChild>\n                <Button data-testid=\"button-add-match\" disabled={teams.length < 2}>\n                  <Plus className=\"h-4 w-4 ml-2\" />\n                  إضافة مباراة\n                </Button>\n              </DialogTrigger>\n              <DialogContent dir=\"rtl\">\n                <DialogHeader>\n                  <DialogTitle>إضافة مباراة جديدة</DialogTitle>\n                </DialogHeader>\n                <div className=\"space-y-4 py-4\">\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label>الفريق المضيف *</Label>\n                      <Select\n                        value={newMatch.homeTeamId}\n                        onValueChange={(value) => setNewMatch({ ...newMatch, homeTeamId: value })}\n                      >\n                        <SelectTrigger data-testid=\"select-home-team\">\n                          <SelectValue placeholder=\"اختر الفريق\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {teams.filter(t => t.id !== newMatch.awayTeamId).map((team) => (\n                            <SelectItem key={team.id} value={team.id} data-testid={`option-home-team-${team.id}`}>\n                              {team.name}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>الفريق الضيف *</Label>\n                      <Select\n                        value={newMatch.awayTeamId}\n                        onValueChange={(value) => setNewMatch({ ...newMatch, awayTeamId: value })}\n                      >\n                        <SelectTrigger data-testid=\"select-away-team\">\n                          <SelectValue placeholder=\"اختر الفريق\" />\n                        </SelectTrigger>\n                        <SelectContent>\n                          {teams.filter(t => t.id !== newMatch.homeTeamId).map((team) => (\n                            <SelectItem key={team.id} value={team.id} data-testid={`option-away-team-${team.id}`}>\n                              {team.name}\n                            </SelectItem>\n                          ))}\n                        </SelectContent>\n                      </Select>\n                    </div>\n                  </div>\n                  <div className=\"grid grid-cols-2 gap-4\">\n                    <div className=\"space-y-2\">\n                      <Label>رقم الجولة</Label>\n                      <Input\n                        type=\"number\"\n                        min={1}\n                        value={newMatch.round}\n                        onChange={(e) => setNewMatch({ ...newMatch, round: parseInt(e.target.value) || 1 })}\n                        data-testid=\"input-match-round\"\n                      />\n                    </div>\n                    <div className=\"space-y-2\">\n                      <Label>تاريخ المباراة</Label>\n                      <Input\n                        type=\"datetime-local\"\n                        value={newMatch.matchDate}\n                        onChange={(e) => setNewMatch({ ...newMatch, matchDate: e.target.value })}\n                        data-testid=\"input-match-date\"\n                      />\n                    </div>\n                  </div>\n                  <div className=\"space-y-2\">\n                    <Label>الملعب</Label>\n                    <Input\n                      value={newMatch.venue}\n                      onChange={(e) => setNewMatch({ ...newMatch, venue: e.target.value })}\n                      placeholder=\"أدخل اسم الملعب\"\n                      data-testid=\"input-new-match-venue\"\n                    />\n                  </div>\n                  {newMatch.homeTeamId && newMatch.awayTeamId && newMatch.homeTeamId === newMatch.awayTeamId && (\n                    <p className=\"text-sm text-destructive\" data-testid=\"error-same-team\">\n                      لا يمكن اختيار نفس الفريق كمضيف وضيف\n                    </p>\n                  )}\n                </div>\n                <DialogFooter>\n                  <Button \n                    variant=\"outline\" \n                    onClick={() => {\n                      setIsAddMatchOpen(false);\n                      setNewMatch({ homeTeamId: \"\", awayTeamId: \"\", round: 1, matchDate: \"\", venue: \"\" });\n                    }}\n                    data-testid=\"button-cancel-add-match\"\n                  >\n                    إلغاء\n                  </Button>\n                  <Button \n                    onClick={() => addMatchMutation.mutate(newMatch)}\n                    disabled={\n                      !newMatch.homeTeamId || \n                      !newMatch.awayTeamId || \n                      newMatch.homeTeamId === newMatch.awayTeamId ||\n                      addMatchMutation.isPending\n                    }\n                    data-testid=\"button-submit-match\"\n                  >\n                    {addMatchMutation.isPending ? \"جاري الإضافة...\" : \"إضافة المباراة\"}\n                  </Button>\n                </DialogFooter>\n              </DialogContent>\n            </Dialog>\n          </div>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-sm text-muted-foreground\">\n            {teams.length < 2 \n              ? \"يجب إضافة فريقين على الأقل لتوليد المباريات أو إضافة مباراة يدوياً\"\n              : `يمكنك توليد جدول مباريات تلقائي لـ ${teams.length} فرق أو إضافة مباريات يدوياً`\n            }\n          </p>\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Calendar className=\"h-5 w-5 text-blue-500\" />\n            المباريات القادمة ({scheduledMatches.length})\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {scheduledMatches.length > 0 ? (\n            <div className=\"space-y-3\">\n              {scheduledMatches.map((match) => {\n                const matchData = getMatchEditingData(match.id);\n                const isExpanded = expandedMatchId === match.id;\n                return (\n                <div key={match.id} className={`border rounded-lg overflow-visible ${isExpanded ? 'ring-2 ring-primary' : ''}`} data-testid={`match-row-${match.id}`}>\n                  <div \n                    className=\"flex items-center justify-between p-4 cursor-pointer hover-elevate\"\n                    onClick={() => toggleMatchExpand(match)}\n                  >\n                    <div className=\"flex items-center gap-4\">\n                      {isExpanded ? <ChevronUp className=\"h-4 w-4 text-primary\" /> : <ChevronDown className=\"h-4 w-4 text-muted-foreground\" />}\n                      <Badge variant=\"outline\">الجولة {match.round}</Badge>\n                      {match.groupNumber && (\n                        <Badge className=\"bg-blue-500 text-white\">\n                          مجموعة {groupLetterMap[match.groupNumber] || match.groupNumber}\n                        </Badge>\n                      )}\n                      {match.stage === 'knockout' && (\n                        <Badge className=\"bg-orange-500 text-white\">خروج المغلوب</Badge>\n                      )}\n                      <span className=\"font-medium\">{match.homeTeam?.name || \"TBD\"}</span>\n                      <span className=\"text-muted-foreground\">vs</span>\n                      <span className=\"font-medium\">{match.awayTeam?.name || \"TBD\"}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      {match.matchDate && (\n                        <span className=\"text-sm text-muted-foreground\">\n                          {format(new Date(match.matchDate), \"dd/MM/yyyy\", { locale: ar })}\n                        </span>\n                      )}\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        className=\"text-destructive\"\n                        onClick={(e) => { e.stopPropagation(); deleteMatchMutation.mutate(match.id); }}\n                        data-testid={`button-delete-match-${match.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  {isExpanded && (\n                    <div className=\"p-4 border-t bg-muted/30 space-y-4\">\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                        <div className=\"space-y-2\">\n                          <Label>الفريق المضيف</Label>\n                          <Select value={matchData.homeTeamId} onValueChange={(v) => updateMatchField(match.id, 'homeTeamId', v)}>\n                            <SelectTrigger data-testid=\"inline-select-home-team\"><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                              {teams.filter(t => t.id !== matchData.awayTeamId).map((team) => (\n                                <SelectItem key={team.id} value={team.id}>{team.name}</SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الفريق الضيف</Label>\n                          <Select value={matchData.awayTeamId} onValueChange={(v) => updateMatchField(match.id, 'awayTeamId', v)}>\n                            <SelectTrigger data-testid=\"inline-select-away-team\"><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                              {teams.filter(t => t.id !== matchData.homeTeamId).map((team) => (\n                                <SelectItem key={team.id} value={team.id}>{team.name}</SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>التاريخ</Label>\n                          <Input type=\"date\" value={matchData.matchDate || ''} onChange={(e) => updateMatchField(match.id, 'matchDate', e.target.value)} data-testid=\"inline-input-date\" />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الوقت</Label>\n                          <Input type=\"time\" value={matchData.matchTime || ''} onChange={(e) => updateMatchField(match.id, 'matchTime', e.target.value)} data-testid=\"inline-input-time\" />\n                        </div>\n                      </div>\n                      <div className=\"flex items-center justify-center gap-6 p-4 bg-card rounded-lg border\">\n                        <div className=\"text-center\">\n                          <p className=\"font-bold text-lg mb-1\">{teams.find(t => t.id === matchData.homeTeamId)?.name || \"المضيف\"}</p>\n                          <Input type=\"number\" min={0} value={matchData.homeScore ?? 0} onChange={(e) => updateMatchField(match.id, 'homeScore', parseInt(e.target.value) || 0)} className=\"w-20 text-center text-2xl font-bold\" data-testid=\"inline-input-home-score\" />\n                        </div>\n                        <span className=\"text-3xl font-bold text-muted-foreground\">-</span>\n                        <div className=\"text-center\">\n                          <p className=\"font-bold text-lg mb-1\">{teams.find(t => t.id === matchData.awayTeamId)?.name || \"الضيف\"}</p>\n                          <Input type=\"number\" min={0} value={matchData.awayScore ?? 0} onChange={(e) => updateMatchField(match.id, 'awayScore', parseInt(e.target.value) || 0)} className=\"w-20 text-center text-2xl font-bold\" data-testid=\"inline-input-away-score\" />\n                        </div>\n                      </div>\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                        <div className=\"space-y-2\">\n                          <Label>الحالة</Label>\n                          <Select value={matchData.status} onValueChange={(v) => updateMatchField(match.id, 'status', v)}>\n                            <SelectTrigger data-testid=\"inline-select-status\"><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"scheduled\">مجدولة</SelectItem>\n                              <SelectItem value=\"live\">مباشر</SelectItem>\n                              <SelectItem value=\"completed\">منتهية</SelectItem>\n                              <SelectItem value=\"postponed\">مؤجلة</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الجولة</Label>\n                          <Input type=\"number\" min={1} value={matchData.round ?? 1} onChange={(e) => updateMatchField(match.id, 'round', parseInt(e.target.value) || 1)} data-testid=\"inline-input-round\" />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الملعب</Label>\n                          <Input value={matchData.venue || ''} onChange={(e) => updateMatchField(match.id, 'venue', e.target.value)} placeholder=\"اسم الملعب\" data-testid=\"inline-input-venue\" />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الحكم</Label>\n                          <Input value={matchData.referee || ''} onChange={(e) => updateMatchField(match.id, 'referee', e.target.value)} placeholder=\"اسم الحكم\" data-testid=\"inline-input-referee\" />\n                        </div>\n                      </div>\n                      <div className=\"flex justify-end gap-2 pt-2\">\n                        <Button variant=\"outline\" onClick={() => setExpandedMatchId(null)} data-testid=\"button-cancel-inline-edit\">إلغاء</Button>\n                        <Button onClick={() => handleSaveMatch(match.id)} disabled={updateMatchMutation.isPending} data-testid=\"button-save-inline-edit\">\n                          <Save className=\"h-4 w-4 ml-2\" />\n                          {updateMatchMutation.isPending ? \"جاري الحفظ...\" : \"حفظ\"}\n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              );})}\n            </div>\n          ) : (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <Calendar className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n              <p>لا توجد مباريات قادمة</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <Trophy className=\"h-5 w-5 text-emerald-500\" />\n            المباريات المنتهية ({completedMatches.length})\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          {completedMatches.length > 0 ? (\n            <div className=\"space-y-3\">\n              {completedMatches.map((match) => {\n                const matchData = getMatchEditingData(match.id);\n                const isExpanded = expandedMatchId === match.id;\n                return (\n                <div key={match.id} className={`border rounded-lg overflow-visible ${isExpanded ? 'ring-2 ring-primary' : ''}`} data-testid={`completed-match-${match.id}`}>\n                  <div \n                    className=\"flex items-center justify-between p-4 cursor-pointer hover-elevate\"\n                    onClick={() => toggleMatchExpand(match)}\n                  >\n                    <div className=\"flex items-center gap-4\">\n                      {isExpanded ? <ChevronUp className=\"h-4 w-4 text-primary\" /> : <ChevronDown className=\"h-4 w-4 text-muted-foreground\" />}\n                      <Badge variant=\"outline\">الجولة {match.round}</Badge>\n                      {match.groupNumber && (\n                        <Badge className=\"bg-blue-500 text-white\">\n                          مجموعة {groupLetterMap[match.groupNumber] || match.groupNumber}\n                        </Badge>\n                      )}\n                      {match.stage === 'knockout' && (\n                        <Badge className=\"bg-orange-500 text-white\">خروج المغلوب</Badge>\n                      )}\n                      <span className=\"font-medium\">{match.homeTeam?.name}</span>\n                      <span className=\"font-bold text-lg px-2\">{match.homeScore} - {match.awayScore}</span>\n                      <span className=\"font-medium\">{match.awayTeam?.name}</span>\n                    </div>\n                    <div className=\"flex items-center gap-2\">\n                      {match.matchDate && (\n                        <span className=\"text-sm text-muted-foreground\">\n                          {format(new Date(match.matchDate), \"d/M/yyyy\", { locale: ar })}\n                        </span>\n                      )}\n                      <Badge className=\"bg-emerald-500\">منتهية</Badge>\n                      <Button \n                        variant=\"ghost\" \n                        size=\"icon\"\n                        className=\"text-destructive\"\n                        onClick={(e) => { e.stopPropagation(); deleteMatchMutation.mutate(match.id); }}\n                        data-testid={`button-delete-completed-${match.id}`}\n                      >\n                        <Trash2 className=\"h-4 w-4\" />\n                      </Button>\n                    </div>\n                  </div>\n                  {isExpanded && (\n                    <div className=\"p-4 border-t bg-muted/30 space-y-4\">\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                        <div className=\"space-y-2\">\n                          <Label>الفريق المضيف</Label>\n                          <Select value={matchData.homeTeamId} onValueChange={(v) => updateMatchField(match.id, 'homeTeamId', v)}>\n                            <SelectTrigger><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                              {teams.filter(t => t.id !== matchData.awayTeamId).map((team) => (\n                                <SelectItem key={team.id} value={team.id}>{team.name}</SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الفريق الضيف</Label>\n                          <Select value={matchData.awayTeamId} onValueChange={(v) => updateMatchField(match.id, 'awayTeamId', v)}>\n                            <SelectTrigger><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                              {teams.filter(t => t.id !== matchData.homeTeamId).map((team) => (\n                                <SelectItem key={team.id} value={team.id}>{team.name}</SelectItem>\n                              ))}\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>التاريخ</Label>\n                          <Input type=\"date\" value={matchData.matchDate || ''} onChange={(e) => updateMatchField(match.id, 'matchDate', e.target.value)} />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الوقت</Label>\n                          <Input type=\"time\" value={matchData.matchTime || ''} onChange={(e) => updateMatchField(match.id, 'matchTime', e.target.value)} />\n                        </div>\n                      </div>\n                      <div className=\"flex items-center justify-center gap-6 p-4 bg-card rounded-lg border\">\n                        <div className=\"text-center\">\n                          <p className=\"font-bold text-lg mb-1\">{teams.find(t => t.id === matchData.homeTeamId)?.name || \"المضيف\"}</p>\n                          <Input type=\"number\" min={0} value={matchData.homeScore ?? 0} onChange={(e) => updateMatchField(match.id, 'homeScore', parseInt(e.target.value) || 0)} className=\"w-20 text-center text-2xl font-bold\" />\n                        </div>\n                        <span className=\"text-3xl font-bold text-muted-foreground\">-</span>\n                        <div className=\"text-center\">\n                          <p className=\"font-bold text-lg mb-1\">{teams.find(t => t.id === matchData.awayTeamId)?.name || \"الضيف\"}</p>\n                          <Input type=\"number\" min={0} value={matchData.awayScore ?? 0} onChange={(e) => updateMatchField(match.id, 'awayScore', parseInt(e.target.value) || 0)} className=\"w-20 text-center text-2xl font-bold\" />\n                        </div>\n                      </div>\n                      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\n                        <div className=\"space-y-2\">\n                          <Label>الحالة</Label>\n                          <Select value={matchData.status} onValueChange={(v) => updateMatchField(match.id, 'status', v)}>\n                            <SelectTrigger><SelectValue /></SelectTrigger>\n                            <SelectContent>\n                              <SelectItem value=\"scheduled\">مجدولة</SelectItem>\n                              <SelectItem value=\"live\">مباشر</SelectItem>\n                              <SelectItem value=\"completed\">منتهية</SelectItem>\n                              <SelectItem value=\"postponed\">مؤجلة</SelectItem>\n                            </SelectContent>\n                          </Select>\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الجولة</Label>\n                          <Input type=\"number\" min={1} value={matchData.round ?? 1} onChange={(e) => updateMatchField(match.id, 'round', parseInt(e.target.value) || 1)} />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الملعب</Label>\n                          <Input value={matchData.venue || ''} onChange={(e) => updateMatchField(match.id, 'venue', e.target.value)} placeholder=\"اسم الملعب\" />\n                        </div>\n                        <div className=\"space-y-2\">\n                          <Label>الحكم</Label>\n                          <Input value={matchData.referee || ''} onChange={(e) => updateMatchField(match.id, 'referee', e.target.value)} placeholder=\"اسم الحكم\" />\n                        </div>\n                      </div>\n                      <div className=\"flex justify-end gap-2 pt-2\">\n                        <Button variant=\"outline\" onClick={() => setExpandedMatchId(null)}>إلغاء</Button>\n                        <Button onClick={() => handleSaveMatch(match.id)} disabled={updateMatchMutation.isPending}>\n                          <Save className=\"h-4 w-4 ml-2\" />\n                          {updateMatchMutation.isPending ? \"جاري الحفظ...\" : \"حفظ\"}\n                        </Button>\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )})}\n            </div>\n          ) : (\n            <div className=\"text-center py-8 text-muted-foreground\">\n              <Trophy className=\"h-12 w-12 mx-auto mb-4 opacity-50\" />\n              <p>لا توجد مباريات منتهية</p>\n            </div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\nfunction EditMatchDialog({ \n  match, \n  onClose, \n  onSave, \n  isPending,\n  teams = [],\n}: { \n  match: MatchWithTeams; \n  onClose: () => void; \n  onSave: (data: any) => void;\n  isPending: boolean;\n  teams?: Team[];\n}) {\n  const getDateFromMatch = () => {\n    if (!match.matchDate) return \"\";\n    const d = new Date(match.matchDate);\n    return d.toISOString().split('T')[0];\n  };\n  \n  const getTimeFromMatch = () => {\n    if (!match.matchDate) return \"\";\n    const d = new Date(match.matchDate);\n    return d.toTimeString().slice(0, 5);\n  };\n\n  const [formData, setFormData] = useState({\n    homeTeamId: match.homeTeamId || \"\",\n    awayTeamId: match.awayTeamId || \"\",\n    matchDate: getDateFromMatch(),\n    matchTime: getTimeFromMatch(),\n    homeScore: match.homeScore ?? 0,\n    awayScore: match.awayScore ?? 0,\n    status: match.status,\n    venue: match.venue || \"\",\n    referee: match.referee || \"\",\n    round: match.round || 1,\n  });\n\n  const handleSave = () => {\n    let matchDateISO: string | null = null;\n    if (formData.matchDate) {\n      const dateStr = formData.matchDate;\n      const timeStr = formData.matchTime || \"00:00\";\n      matchDateISO = new Date(`${dateStr}T${timeStr}:00`).toISOString();\n    }\n    \n    onSave({\n      ...formData,\n      matchDate: matchDateISO,\n    });\n  };\n\n  const selectedHomeTeam = teams.find(t => t.id === formData.homeTeamId);\n  const selectedAwayTeam = teams.find(t => t.id === formData.awayTeamId);\n\n  return (\n    <Dialog open={true} onOpenChange={onClose}>\n      <DialogContent dir=\"rtl\" className=\"max-w-lg max-h-[90vh] overflow-y-auto\">\n        <DialogHeader>\n          <DialogTitle>تعديل المباراة</DialogTitle>\n        </DialogHeader>\n        <div className=\"space-y-6 py-4\">\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>الفريق المضيف</Label>\n              <Select\n                value={formData.homeTeamId}\n                onValueChange={(value) => setFormData({ ...formData, homeTeamId: value })}\n              >\n                <SelectTrigger data-testid=\"select-home-team\">\n                  <SelectValue placeholder=\"اختر الفريق المضيف\">\n                    {selectedHomeTeam?.name || \"اختر الفريق\"}\n                  </SelectValue>\n                </SelectTrigger>\n                <SelectContent>\n                  {teams.filter(t => t.id !== formData.awayTeamId).map((team) => (\n                    <SelectItem key={team.id} value={team.id} data-testid={`option-home-team-${team.id}`}>\n                      {team.name}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div className=\"space-y-2\">\n              <Label>الفريق الضيف</Label>\n              <Select\n                value={formData.awayTeamId}\n                onValueChange={(value) => setFormData({ ...formData, awayTeamId: value })}\n              >\n                <SelectTrigger data-testid=\"select-away-team\">\n                  <SelectValue placeholder=\"اختر الفريق الضيف\">\n                    {selectedAwayTeam?.name || \"اختر الفريق\"}\n                  </SelectValue>\n                </SelectTrigger>\n                <SelectContent>\n                  {teams.filter(t => t.id !== formData.homeTeamId).map((team) => (\n                    <SelectItem key={team.id} value={team.id} data-testid={`option-away-team-${team.id}`}>\n                      {team.name}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          <div className=\"grid grid-cols-3 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>التاريخ</Label>\n              <Input\n                type=\"date\"\n                value={formData.matchDate}\n                onChange={(e) => setFormData({ ...formData, matchDate: e.target.value })}\n                data-testid=\"input-match-date\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>الوقت</Label>\n              <Input\n                type=\"time\"\n                value={formData.matchTime}\n                onChange={(e) => setFormData({ ...formData, matchTime: e.target.value })}\n                data-testid=\"input-match-time\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>الجولة</Label>\n              <Input\n                type=\"number\"\n                min={1}\n                value={formData.round}\n                onChange={(e) => setFormData({ ...formData, round: parseInt(e.target.value) || 1 })}\n                data-testid=\"input-match-round\"\n              />\n            </div>\n          </div>\n\n          <div className=\"flex items-center justify-center gap-4 p-4 bg-muted/50 rounded-lg\">\n            <div className=\"text-center\">\n              <p className=\"font-bold text-lg\">{selectedHomeTeam?.name || \"المضيف\"}</p>\n              <Label className=\"text-sm text-muted-foreground\">أهداف المضيف</Label>\n              <Input\n                type=\"number\"\n                min={0}\n                value={formData.homeScore}\n                onChange={(e) => setFormData({ ...formData, homeScore: parseInt(e.target.value) || 0 })}\n                className=\"w-20 text-center text-xl font-bold mx-auto mt-1\"\n                data-testid=\"input-home-score\"\n              />\n            </div>\n            <span className=\"text-2xl font-bold\">-</span>\n            <div className=\"text-center\">\n              <p className=\"font-bold text-lg\">{selectedAwayTeam?.name || \"الضيف\"}</p>\n              <Label className=\"text-sm text-muted-foreground\">أهداف الضيف</Label>\n              <Input\n                type=\"number\"\n                min={0}\n                value={formData.awayScore}\n                onChange={(e) => setFormData({ ...formData, awayScore: parseInt(e.target.value) || 0 })}\n                className=\"w-20 text-center text-xl font-bold mx-auto mt-1\"\n                data-testid=\"input-away-score\"\n              />\n            </div>\n          </div>\n\n          <div className=\"space-y-2\">\n            <Label>حالة المباراة</Label>\n            <Select\n              value={formData.status}\n              onValueChange={(value) => setFormData({ ...formData, status: value })}\n            >\n              <SelectTrigger data-testid=\"select-match-status\">\n                <SelectValue />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"scheduled\" data-testid=\"option-match-status-scheduled\">مجدولة</SelectItem>\n                <SelectItem value=\"live\" data-testid=\"option-match-status-live\">مباشر</SelectItem>\n                <SelectItem value=\"completed\" data-testid=\"option-match-status-completed\">منتهية</SelectItem>\n                <SelectItem value=\"postponed\" data-testid=\"option-match-status-postponed\">مؤجلة</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n\n          <div className=\"grid grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>الملعب</Label>\n              <Input\n                value={formData.venue}\n                onChange={(e) => setFormData({ ...formData, venue: e.target.value })}\n                placeholder=\"اسم الملعب\"\n                data-testid=\"input-venue\"\n              />\n            </div>\n            <div className=\"space-y-2\">\n              <Label>الحكم</Label>\n              <Input\n                value={formData.referee}\n                onChange={(e) => setFormData({ ...formData, referee: e.target.value })}\n                placeholder=\"اسم الحكم\"\n                data-testid=\"input-match-referee\"\n              />\n            </div>\n          </div>\n        </div>\n        <DialogFooter>\n          <Button variant=\"outline\" onClick={onClose} data-testid=\"button-cancel-edit-match\">إلغاء</Button>\n          <Button onClick={handleSave} disabled={isPending} data-testid=\"button-save-match\">\n            {isPending ? \"جاري الحفظ...\" : \"حفظ التغييرات\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n\ninterface GroupStanding {\n  teamId: string;\n  teamName: string;\n  groupName: string;\n  played: number;\n  won: number;\n  drawn: number;\n  lost: number;\n  goalsFor: number;\n  goalsAgainst: number;\n  goalDifference: number;\n  points: number;\n}\n\nfunction StagesTab({ \n  tournamentId, \n  tournament, \n  teams \n}: { \n  tournamentId: string; \n  tournament: Tournament; \n  teams: Team[];\n}) {\n  const { toast } = useToast();\n  const isGroupsTournament = tournament.type === \"groups\" || tournament.type === \"groups_knockout\";\n  const isKnockoutTournament = tournament.type === \"knockout\" || tournament.type === \"groups_knockout\";\n\n  const { data: groupStandings = [], isLoading: standingsLoading, refetch: refetchStandings } = useQuery<GroupStanding[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"group-standings\"],\n    enabled: isGroupsTournament,\n  });\n\n  const { data: matches = [] } = useQuery<MatchWithTeams[]>({\n    queryKey: [\"/api/tournaments\", tournamentId, \"matches\"],\n  });\n\n  const assignGroupsMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/assign-groups`, {\n        autoDistribute: true,\n        groupsCount: Math.ceil(teams.length / 4)\n      });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم توزيع الفرق على المجموعات\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"teams\"] });\n      refetchStandings();\n    },\n    onError: () => {\n      toast({ title: \"فشل توزيع الفرق\", variant: \"destructive\" });\n    },\n  });\n\n  // Parse tournament schedule config\n  const tournamentScheduleConfig = tournament.scheduleConfig \n    ? JSON.parse(tournament.scheduleConfig) \n    : { dailyStartTime: \"16:00\", matchesPerDayPerVenue: 3 };\n  \n  const generateGroupMatchesMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/generate-group-matches`, {\n        matchesPerDay: tournamentScheduleConfig.matchesPerDayPerVenue || tournamentScheduleConfig.matchesPerDay || 4,\n        dailyStartTime: tournamentScheduleConfig.dailyStartTime || \"16:00\",\n      });\n    },\n    onSuccess: () => {\n      toast({ title: \"تم توليد مباريات المجموعات\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"matches\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل توليد المباريات\", variant: \"destructive\" });\n    },\n  });\n\n  const completeGroupStageMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/complete-group-stage`, {\n        qualifyingTeamsPerGroup: 2\n      });\n    },\n    onSuccess: async () => {\n      toast({ title: \"تم إكمال مرحلة المجموعات\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId] });\n      \n      if (tournament.type === \"groups_knockout\") {\n        try {\n          await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/generate-knockout`);\n          toast({ title: \"تم توليد مباريات خروج المغلوب تلقائياً\" });\n          queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"matches\"] });\n        } catch (error) {\n          toast({ title: \"فشل توليد مباريات خروج المغلوب\", variant: \"destructive\" });\n        }\n      }\n    },\n    onError: () => {\n      toast({ title: \"فشل إكمال المرحلة\", variant: \"destructive\" });\n    },\n  });\n\n  const generateKnockoutMutation = useMutation({\n    mutationFn: async () => {\n      return await apiRequest(\"POST\", `/api/tournaments/${tournamentId}/generate-knockout`);\n    },\n    onSuccess: () => {\n      toast({ title: \"تم توليد مباريات خروج المغلوب\" });\n      queryClient.invalidateQueries({ queryKey: [\"/api/tournaments\", tournamentId, \"matches\"] });\n    },\n    onError: () => {\n      toast({ title: \"فشل توليد مباريات الإقصاء\", variant: \"destructive\" });\n    },\n  });\n\n  const groupedStandings = groupStandings.reduce((acc, standing) => {\n    if (!acc[standing.groupName]) {\n      acc[standing.groupName] = [];\n    }\n    acc[standing.groupName].push(standing);\n    return acc;\n  }, {} as Record<string, GroupStanding[]>);\n\n  const teamsWithGroups = teams.filter(t => t.groupNumber);\n  const teamsWithoutGroups = teams.filter(t => !t.groupNumber);\n\n  if (!isGroupsTournament && !isKnockoutTournament) {\n    return (\n      <Card>\n        <CardContent className=\"py-12 text-center\">\n          <Layers className=\"h-16 w-16 mx-auto text-muted-foreground mb-4\" />\n          <h3 className=\"text-lg font-medium mb-2\">إدارة المراحل</h3>\n          <p className=\"text-muted-foreground\">\n            إدارة المراحل متاحة فقط لبطولات المجموعات وخروج المغلوب\n          </p>\n        </CardContent>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {isGroupsTournament && (\n        <>\n          <Card data-testid=\"card-group-stage\">\n            <CardHeader>\n              <CardTitle className=\"flex items-center gap-2\">\n                <Layers className=\"h-5 w-5\" />\n                مرحلة المجموعات\n              </CardTitle>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <div className=\"flex flex-wrap gap-3\">\n                <Button\n                  onClick={() => assignGroupsMutation.mutate()}\n                  disabled={assignGroupsMutation.isPending || teams.length < 4}\n                  data-testid=\"button-assign-groups\"\n                >\n                  <RefreshCw className={`h-4 w-4 ml-2 ${assignGroupsMutation.isPending ? 'animate-spin' : ''}`} />\n                  {assignGroupsMutation.isPending ? \"جاري التوزيع...\" : \"توزيع الفرق تلقائياً\"}\n                </Button>\n                <Button\n                  variant=\"outline\"\n                  onClick={() => generateGroupMatchesMutation.mutate()}\n                  disabled={generateGroupMatchesMutation.isPending || teamsWithGroups.length < 4}\n                  data-testid=\"button-generate-group-matches\"\n                >\n                  <Calendar className=\"h-4 w-4 ml-2\" />\n                  {generateGroupMatchesMutation.isPending ? \"جاري التوليد...\" : \"توليد مباريات المجموعات\"}\n                </Button>\n                <Button\n                  variant=\"default\"\n                  onClick={() => completeGroupStageMutation.mutate()}\n                  disabled={completeGroupStageMutation.isPending || groupStandings.length === 0}\n                  className=\"bg-emerald-600 hover:bg-emerald-700\"\n                  data-testid=\"button-complete-group-stage\"\n                >\n                  <CheckCircle2 className=\"h-4 w-4 ml-2\" />\n                  {completeGroupStageMutation.isPending ? \"جاري الإكمال...\" : \"إكمال مرحلة المجموعات\"}\n                </Button>\n              </div>\n\n              {teams.length < 4 && (\n                <p className=\"text-sm text-muted-foreground\">\n                  يجب إضافة 4 فرق على الأقل لتوزيعها على المجموعات\n                </p>\n              )}\n\n              {teamsWithoutGroups.length > 0 && teamsWithGroups.length > 0 && (\n                <div className=\"p-3 bg-amber-50 dark:bg-amber-950 rounded-lg border border-amber-200 dark:border-amber-800\">\n                  <p className=\"text-amber-700 dark:text-amber-300 text-sm\">\n                    {teamsWithoutGroups.length} فريق لم يتم توزيعهم بعد على المجموعات\n                  </p>\n                </div>\n              )}\n            </CardContent>\n          </Card>\n\n          {standingsLoading ? (\n            <Card>\n              <CardContent className=\"py-8 flex justify-center\">\n                <Loader2 className=\"h-8 w-8 animate-spin text-muted-foreground\" />\n              </CardContent>\n            </Card>\n          ) : Object.keys(groupedStandings).length > 0 && (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n              {Object.entries(groupedStandings).sort().map(([groupName, standings]) => (\n                <Card key={groupName} data-testid={`card-group-${groupName.replace(/\\s+/g, '-')}`}>\n                  <CardHeader className=\"pb-2\">\n                    <CardTitle className=\"text-lg flex items-center gap-2\">\n                      <Shield className=\"h-4 w-4 text-primary\" />\n                      {groupName}\n                    </CardTitle>\n                  </CardHeader>\n                  <CardContent className=\"p-0\">\n                    <Table data-testid={`table-standings-${groupName.replace(/\\s+/g, '-')}`}>\n                      <TableHeader>\n                        <TableRow>\n                          <TableHead className=\"text-right\">#</TableHead>\n                          <TableHead className=\"text-right\">الفريق</TableHead>\n                          <TableHead className=\"text-center\">لعب</TableHead>\n                          <TableHead className=\"text-center\">ف</TableHead>\n                          <TableHead className=\"text-center\">ت</TableHead>\n                          <TableHead className=\"text-center\">خ</TableHead>\n                          <TableHead className=\"text-center\">له</TableHead>\n                          <TableHead className=\"text-center\">عليه</TableHead>\n                          <TableHead className=\"text-center\">+/-</TableHead>\n                          <TableHead className=\"text-center font-bold\">نقاط</TableHead>\n                        </TableRow>\n                      </TableHeader>\n                      <TableBody>\n                        {standings.map((team, index) => (\n                          <TableRow \n                            key={team.teamId}\n                            className={index < 2 ? \"bg-emerald-50 dark:bg-emerald-950/30\" : \"\"}\n                            data-testid={`row-standing-${team.teamId}`}\n                          >\n                            <TableCell className=\"font-medium\">{index + 1}</TableCell>\n                            <TableCell className=\"font-medium\" data-testid={`text-team-name-${team.teamId}`}>{team.teamName}</TableCell>\n                            <TableCell className=\"text-center\" data-testid={`text-played-${team.teamId}`}>{team.played}</TableCell>\n                            <TableCell className=\"text-center text-emerald-600\" data-testid={`text-won-${team.teamId}`}>{team.won}</TableCell>\n                            <TableCell className=\"text-center text-amber-600\" data-testid={`text-drawn-${team.teamId}`}>{team.drawn}</TableCell>\n                            <TableCell className=\"text-center text-red-600\" data-testid={`text-lost-${team.teamId}`}>{team.lost}</TableCell>\n                            <TableCell className=\"text-center\" data-testid={`text-goals-for-${team.teamId}`}>{team.goalsFor}</TableCell>\n                            <TableCell className=\"text-center\" data-testid={`text-goals-against-${team.teamId}`}>{team.goalsAgainst}</TableCell>\n                            <TableCell className=\"text-center font-medium\" data-testid={`text-goal-diff-${team.teamId}`}>\n                              {team.goalDifference > 0 ? `+${team.goalDifference}` : team.goalDifference}\n                            </TableCell>\n                            <TableCell className=\"text-center font-bold text-primary\" data-testid={`text-points-${team.teamId}`}>{team.points}</TableCell>\n                          </TableRow>\n                        ))}\n                      </TableBody>\n                    </Table>\n                  </CardContent>\n                </Card>\n              ))}\n            </div>\n          )}\n        </>\n      )}\n\n      {isKnockoutTournament && (\n        <Card data-testid=\"card-knockout-stage\">\n          <CardHeader>\n            <CardTitle className=\"flex items-center gap-2\">\n              <GitBranch className=\"h-5 w-5\" />\n              مرحلة خروج المغلوب\n            </CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            {tournament.type === \"knockout\" && (\n              <div className=\"p-3 bg-blue-50 dark:bg-blue-950 rounded-lg border border-blue-200 dark:border-blue-800 mb-4\">\n                <p className=\"text-blue-700 dark:text-blue-300 text-sm\" data-testid=\"text-knockout-info\">\n                  بطولة خروج المغلوب - {teams.length} فريق مسجل\n                </p>\n              </div>\n            )}\n\n            {tournament.type === \"knockout\" && (\n              <Button\n                onClick={() => generateKnockoutMutation.mutate()}\n                disabled={generateKnockoutMutation.isPending || teams.length < 2}\n                data-testid=\"button-generate-knockout\"\n              >\n                <GitBranch className={`h-4 w-4 ml-2 ${generateKnockoutMutation.isPending ? 'animate-spin' : ''}`} />\n                {generateKnockoutMutation.isPending ? \"جاري التوليد...\" : \"توليد شجرة خروج المغلوب\"}\n              </Button>\n            )}\n\n            {tournament.type === \"knockout\" && teams.length < 2 && (\n              <p className=\"text-sm text-muted-foreground\" data-testid=\"text-knockout-teams-warning\">\n                يجب إضافة فريقين على الأقل لتوليد شجرة خروج المغلوب\n              </p>\n            )}\n\n            {tournament.type === \"groups_knockout\" && !tournament.groupStageComplete && (\n              <div className=\"p-3 bg-orange-50 dark:bg-orange-950 rounded-lg border border-orange-200 dark:border-orange-800 mb-4\">\n                <p className=\"text-orange-700 dark:text-orange-300 text-sm\" data-testid=\"text-group-stage-required\">\n                  سيتم توليد مباريات خروج المغلوب تلقائياً عند إكمال مرحلة المجموعات\n                </p>\n              </div>\n            )}\n\n            <div className=\"mt-4\" data-testid=\"container-knockout-bracket\">\n              <KnockoutBracket \n                matches={matches} \n                tournament={tournament}\n                groupStageComplete={tournament.groupStageComplete || tournament.type === \"knockout\"}\n              />\n            </div>\n          </CardContent>\n        </Card>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":153301,"size_tokens":null},"client/src/components/TeamBox.tsx":{"content":"import { Shield } from \"lucide-react\";\n\nexport interface TeamBoxProps {\n  team?: { \n    id: string; \n    name: string; \n    logoUrl?: string | null; \n    primaryJersey?: string | null;\n  };\n  showLogo?: boolean;\n  isWinner?: boolean;\n  score?: number | null;\n  size?: \"sm\" | \"md\" | \"lg\";\n  className?: string;\n}\n\nexport function getTeamColor(team?: { name: string; primaryJersey?: string | null }): string {\n  if (!team) return \"#6b7280\";\n  \n  if (team.primaryJersey) {\n    const jersey = team.primaryJersey.toLowerCase();\n    const colorMap: Record<string, string> = {\n      \"أحمر\": \"#dc2626\", \"red\": \"#dc2626\",\n      \"أزرق\": \"#2563eb\", \"blue\": \"#2563eb\",\n      \"أخضر\": \"#16a34a\", \"green\": \"#16a34a\",\n      \"أصفر\": \"#eab308\", \"yellow\": \"#eab308\",\n      \"برتقالي\": \"#ea580c\", \"orange\": \"#ea580c\",\n      \"أسود\": \"#1f2937\", \"black\": \"#1f2937\",\n      \"أبيض\": \"#f3f4f6\", \"white\": \"#f3f4f6\",\n      \"بنفسجي\": \"#7c3aed\", \"purple\": \"#7c3aed\",\n      \"وردي\": \"#ec4899\", \"pink\": \"#ec4899\",\n      \"بني\": \"#92400e\", \"brown\": \"#92400e\",\n      \"رمادي\": \"#6b7280\", \"gray\": \"#6b7280\", \"grey\": \"#6b7280\",\n      \"ذهبي\": \"#d97706\", \"gold\": \"#d97706\",\n      \"فضي\": \"#9ca3af\", \"silver\": \"#9ca3af\",\n      \"سماوي\": \"#06b6d4\", \"cyan\": \"#06b6d4\",\n      \"كحلي\": \"#1e3a5f\", \"navy\": \"#1e3a5f\",\n      \"عنابي\": \"#7f1d1d\", \"maroon\": \"#7f1d1d\",\n    };\n    \n    if (jersey.startsWith(\"#\") && (jersey.length === 4 || jersey.length === 7)) {\n      return jersey;\n    }\n    \n    for (const [key, value] of Object.entries(colorMap)) {\n      if (jersey.includes(key)) return value;\n    }\n  }\n  \n  let hash = 0;\n  const name = team.name;\n  for (let i = 0; i < name.length; i++) {\n    hash = name.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  \n  const colors = [\n    \"#dc2626\", \"#ea580c\", \"#d97706\", \"#16a34a\", \n    \"#059669\", \"#0d9488\", \"#0891b2\", \"#2563eb\", \n    \"#4f46e5\", \"#7c3aed\", \"#a855f7\", \"#c026d3\",\n    \"#db2777\", \"#e11d48\"\n  ];\n  \n  return colors[Math.abs(hash) % colors.length];\n}\n\nexport function isLightColor(hex: string): boolean {\n  let color = hex.replace(\"#\", \"\");\n  if (color.length === 3) {\n    color = color[0] + color[0] + color[1] + color[1] + color[2] + color[2];\n  }\n  if (color.length !== 6) {\n    return false;\n  }\n  const r = parseInt(color.substring(0, 2), 16);\n  const g = parseInt(color.substring(2, 4), 16);\n  const b = parseInt(color.substring(4, 6), 16);\n  if (isNaN(r) || isNaN(g) || isNaN(b)) return false;\n  const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\n  return luminance > 0.5;\n}\n\nexport const TEAM_COLORS = [\n  { name: \"أحمر\", value: \"#dc2626\" },\n  { name: \"أزرق\", value: \"#2563eb\" },\n  { name: \"أخضر\", value: \"#16a34a\" },\n  { name: \"أصفر\", value: \"#eab308\" },\n  { name: \"برتقالي\", value: \"#ea580c\" },\n  { name: \"أسود\", value: \"#1f2937\" },\n  { name: \"أبيض\", value: \"#f3f4f6\" },\n  { name: \"بنفسجي\", value: \"#7c3aed\" },\n  { name: \"وردي\", value: \"#ec4899\" },\n  { name: \"سماوي\", value: \"#06b6d4\" },\n  { name: \"كحلي\", value: \"#1e3a5f\" },\n  { name: \"عنابي\", value: \"#7f1d1d\" },\n  { name: \"ذهبي\", value: \"#d97706\" },\n  { name: \"فضي\", value: \"#9ca3af\" },\n];\n\nexport function TeamBox({ \n  team, \n  showLogo = true, \n  isWinner = false, \n  score,\n  size = \"md\",\n  className = \"\"\n}: TeamBoxProps) {\n  const bgColor = getTeamColor(team);\n  const textColor = isLightColor(bgColor) ? \"#1f2937\" : \"#ffffff\";\n  \n  const sizeClasses = {\n    sm: \"px-2 py-1 min-w-[80px] text-xs\",\n    md: \"px-3 py-2 min-w-[120px] text-sm\",\n    lg: \"px-4 py-3 min-w-[150px] text-base\"\n  };\n  \n  const logoSizes = {\n    sm: \"w-5 h-5\",\n    md: \"w-8 h-8\",\n    lg: \"w-10 h-10\"\n  };\n  \n  const iconSizes = {\n    sm: \"w-3 h-3\",\n    md: \"w-5 h-5\",\n    lg: \"w-6 h-6\"\n  };\n  \n  return (\n    <div \n      className={`flex items-center gap-2 rounded-lg ${sizeClasses[size]} ${isWinner ? \"ring-2 ring-yellow-400 ring-offset-1\" : \"\"} ${className}`}\n      style={{ backgroundColor: bgColor }}\n      data-testid={`team-box-${team?.id}`}\n    >\n      {showLogo && (\n        <div className={`${logoSizes[size]} rounded-full bg-white/20 flex items-center justify-center flex-shrink-0 overflow-hidden`}>\n          {team?.logoUrl ? (\n            <img src={team.logoUrl} alt={team.name} className=\"w-full h-full object-cover\" />\n          ) : (\n            <Shield className={iconSizes[size]} style={{ color: textColor }} />\n          )}\n        </div>\n      )}\n      <span \n        className=\"font-bold truncate flex-1\"\n        style={{ color: textColor }}\n      >\n        {team?.name || \"غير محدد\"}\n      </span>\n      {score !== undefined && score !== null && (\n        <span \n          className=\"font-bold min-w-[24px] text-center\"\n          style={{ color: textColor }}\n        >\n          {score}\n        </span>\n      )}\n    </div>\n  );\n}\n\nexport function TeamColorPicker({ \n  value, \n  onChange,\n  label = \"لون الفريق\"\n}: { \n  value?: string | null; \n  onChange: (color: string) => void;\n  label?: string;\n}) {\n  const currentColor = value || \"\";\n  \n  return (\n    <div className=\"space-y-2\">\n      <label className=\"text-sm font-medium\">{label}</label>\n      <div className=\"flex flex-wrap gap-2\">\n        {TEAM_COLORS.map((color) => (\n          <button\n            key={color.value}\n            type=\"button\"\n            onClick={() => onChange(color.value)}\n            className={`w-8 h-8 rounded-full border-2 transition-all ${\n              currentColor === color.value ? \"ring-2 ring-offset-2 ring-primary scale-110\" : \"hover:scale-105\"\n            }`}\n            style={{ backgroundColor: color.value }}\n            title={color.name}\n            data-testid={`color-picker-${color.value}`}\n          />\n        ))}\n      </div>\n      <input\n        type=\"color\"\n        value={currentColor.startsWith(\"#\") ? currentColor : \"#6b7280\"}\n        onChange={(e) => onChange(e.target.value)}\n        className=\"w-full h-8 rounded cursor-pointer\"\n        data-testid=\"color-picker-custom\"\n      />\n    </div>\n  );\n}\n\nexport default TeamBox;\n","path":null,"size_bytes":6053,"size_tokens":null},"attached_assets/content-1765688080086.md":{"content":"No markdown content returned","path":null,"size_bytes":28,"size_tokens":null},"attached_assets/content-1765688173780.md":{"content":"No markdown content returned","path":null,"size_bytes":28,"size_tokens":null}},"version":2}